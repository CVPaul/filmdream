var AP=Object.defineProperty;var MP=(n,e,t)=>e in n?AP(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Fn=(n,e,t)=>MP(n,typeof e!="symbol"?e+"":e,t);function CP(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function $1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var b2={exports:{}},T0={},w2={exports:{}},tn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lf=Symbol.for("react.element"),EP=Symbol.for("react.portal"),TP=Symbol.for("react.fragment"),NP=Symbol.for("react.strict_mode"),RP=Symbol.for("react.profiler"),IP=Symbol.for("react.provider"),PP=Symbol.for("react.context"),BP=Symbol.for("react.forward_ref"),LP=Symbol.for("react.suspense"),DP=Symbol.for("react.memo"),FP=Symbol.for("react.lazy"),VA=Symbol.iterator;function kP(n){return n===null||typeof n!="object"?null:(n=VA&&n[VA]||n["@@iterator"],typeof n=="function"?n:null)}var S2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A2=Object.assign,M2={};function Ju(n,e,t){this.props=n,this.context=e,this.refs=M2,this.updater=t||S2}Ju.prototype.isReactComponent={};Ju.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Ju.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function C2(){}C2.prototype=Ju.prototype;function eb(n,e,t){this.props=n,this.context=e,this.refs=M2,this.updater=t||S2}var tb=eb.prototype=new C2;tb.constructor=eb;A2(tb,Ju.prototype);tb.isPureReactComponent=!0;var WA=Array.isArray,E2=Object.prototype.hasOwnProperty,nb={current:null},T2={key:!0,ref:!0,__self:!0,__source:!0};function N2(n,e,t){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)E2.call(e,r)&&!T2.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:lf,type:n,key:s,ref:a,props:i,_owner:nb.current}}function jP(n,e){return{$$typeof:lf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function rb(n){return typeof n=="object"&&n!==null&&n.$$typeof===lf}function UP(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var XA=/\/+/g;function Hy(n,e){return typeof n=="object"&&n!==null&&n.key!=null?UP(""+n.key):e.toString(36)}function zm(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case lf:case EP:a=!0}}if(a)return a=n,i=i(a),n=r===""?"."+Hy(a,0):r,WA(i)?(t="",n!=null&&(t=n.replace(XA,"$&/")+"/"),zm(i,e,t,"",function(u){return u})):i!=null&&(rb(i)&&(i=jP(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(XA,"$&/")+"/")+n)),e.push(i)),1;if(a=0,r=r===""?".":r+":",WA(n))for(var o=0;o<n.length;o++){s=n[o];var c=r+Hy(s,o);a+=zm(s,e,t,c,i)}else if(c=kP(n),typeof c=="function")for(n=c.call(n),o=0;!(s=n.next()).done;)s=s.value,c=r+Hy(s,o++),a+=zm(s,e,t,c,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Cp(n,e,t){if(n==null)return n;var r=[],i=0;return zm(n,r,"","",function(s){return e.call(t,s,i++)}),r}function OP(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var ti={current:null},Hm={transition:null},zP={ReactCurrentDispatcher:ti,ReactCurrentBatchConfig:Hm,ReactCurrentOwner:nb};function R2(){throw Error("act(...) is not supported in production builds of React.")}tn.Children={map:Cp,forEach:function(n,e,t){Cp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Cp(n,function(){e++}),e},toArray:function(n){return Cp(n,function(e){return e})||[]},only:function(n){if(!rb(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};tn.Component=Ju;tn.Fragment=TP;tn.Profiler=RP;tn.PureComponent=eb;tn.StrictMode=NP;tn.Suspense=LP;tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zP;tn.act=R2;tn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=A2({},n.props),i=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=nb.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)E2.call(e,c)&&!T2.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:lf,type:n.type,key:i,ref:s,props:r,_owner:a}};tn.createContext=function(n){return n={$$typeof:PP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:IP,_context:n},n.Consumer=n};tn.createElement=N2;tn.createFactory=function(n){var e=N2.bind(null,n);return e.type=n,e};tn.createRef=function(){return{current:null}};tn.forwardRef=function(n){return{$$typeof:BP,render:n}};tn.isValidElement=rb;tn.lazy=function(n){return{$$typeof:FP,_payload:{_status:-1,_result:n},_init:OP}};tn.memo=function(n,e){return{$$typeof:DP,type:n,compare:e===void 0?null:e}};tn.startTransition=function(n){var e=Hm.transition;Hm.transition={};try{n()}finally{Hm.transition=e}};tn.unstable_act=R2;tn.useCallback=function(n,e){return ti.current.useCallback(n,e)};tn.useContext=function(n){return ti.current.useContext(n)};tn.useDebugValue=function(){};tn.useDeferredValue=function(n){return ti.current.useDeferredValue(n)};tn.useEffect=function(n,e){return ti.current.useEffect(n,e)};tn.useId=function(){return ti.current.useId()};tn.useImperativeHandle=function(n,e,t){return ti.current.useImperativeHandle(n,e,t)};tn.useInsertionEffect=function(n,e){return ti.current.useInsertionEffect(n,e)};tn.useLayoutEffect=function(n,e){return ti.current.useLayoutEffect(n,e)};tn.useMemo=function(n,e){return ti.current.useMemo(n,e)};tn.useReducer=function(n,e,t){return ti.current.useReducer(n,e,t)};tn.useRef=function(n){return ti.current.useRef(n)};tn.useState=function(n){return ti.current.useState(n)};tn.useSyncExternalStore=function(n,e,t){return ti.current.useSyncExternalStore(n,e,t)};tn.useTransition=function(){return ti.current.useTransition()};tn.version="18.3.1";w2.exports=tn;var F=w2.exports;const Ys=$1(F),HP=CP({__proto__:null,default:Ys},[F]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GP=F,VP=Symbol.for("react.element"),WP=Symbol.for("react.fragment"),XP=Object.prototype.hasOwnProperty,JP=GP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YP={key:!0,ref:!0,__self:!0,__source:!0};function I2(n,e,t){var r,i={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)XP.call(e,r)&&!YP.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:VP,type:n,key:s,ref:a,props:i,_owner:JP.current}}T0.Fragment=WP;T0.jsx=I2;T0.jsxs=I2;b2.exports=T0;var l=b2.exports,E_={},P2={exports:{}},ji={},B2={exports:{}},L2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,H){var W=U.length;U.push(H);e:for(;0<W;){var Y=W-1>>>1,G=U[Y];if(0<i(G,H))U[Y]=H,U[W]=G,W=Y;else break e}}function t(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],W=U.pop();if(W!==H){U[0]=W;e:for(var Y=0,G=U.length,de=G>>>1;Y<de;){var Ce=2*(Y+1)-1,be=U[Ce],se=Ce+1,_e=U[se];if(0>i(be,W))se<G&&0>i(_e,be)?(U[Y]=_e,U[se]=W,Y=se):(U[Y]=be,U[Ce]=W,Y=Ce);else if(se<G&&0>i(_e,W))U[Y]=_e,U[se]=W,Y=se;else break e}}return H}function i(U,H){var W=U.sortIndex-H.sortIndex;return W!==0?W:U.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],f=1,p=null,m=3,g=!1,y=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(U){for(var H=t(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=U)r(u),H.sortIndex=H.expirationTime,e(c,H);else break;H=t(u)}}function M(U){if(S=!1,b(U),!y)if(t(c)!==null)y=!0,K(N);else{var H=t(u);H!==null&&$(M,H.startTime-U)}}function N(U,H){y=!1,S&&(S=!1,x(P),P=-1),g=!0;var W=m;try{for(b(H),p=t(c);p!==null&&(!(p.expirationTime>H)||U&&!j());){var Y=p.callback;if(typeof Y=="function"){p.callback=null,m=p.priorityLevel;var G=Y(p.expirationTime<=H);H=n.unstable_now(),typeof G=="function"?p.callback=G:p===t(c)&&r(c),b(H)}else r(c);p=t(c)}if(p!==null)var de=!0;else{var Ce=t(u);Ce!==null&&$(M,Ce.startTime-H),de=!1}return de}finally{p=null,m=W,g=!1}}var C=!1,I=null,P=-1,T=5,R=-1;function j(){return!(n.unstable_now()-R<T)}function O(){if(I!==null){var U=n.unstable_now();R=U;var H=!0;try{H=I(!0,U)}finally{H?k():(C=!1,I=null)}}else C=!1}var k;if(typeof _=="function")k=function(){_(O)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,te=Z.port2;Z.port1.onmessage=O,k=function(){te.postMessage(null)}}else k=function(){w(O,0)};function K(U){I=U,C||(C=!0,k())}function $(U,H){P=w(function(){U(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,K(N))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(U){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var W=m;m=H;try{return U()}finally{m=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var W=m;m=U;try{return H()}finally{m=W}},n.unstable_scheduleCallback=function(U,H,W){var Y=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Y+W:Y):W=Y,U){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=W+G,U={id:f++,callback:H,priorityLevel:U,startTime:W,expirationTime:G,sortIndex:-1},W>Y?(U.sortIndex=W,e(u,U),t(c)===null&&U===t(u)&&(S?(x(P),P=-1):S=!0,$(M,W-Y))):(U.sortIndex=G,e(c,U),y||g||(y=!0,K(N))),U},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(U){var H=m;return function(){var W=m;m=H;try{return U.apply(this,arguments)}finally{m=W}}}})(L2);B2.exports=L2;var KP=B2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZP=F,Li=KP;function Je(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var D2=new Set,Ch={};function $l(n,e){wu(n,e),wu(n+"Capture",e)}function wu(n,e){for(Ch[n]=e,n=0;n<e.length;n++)D2.add(e[n])}var Ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),T_=Object.prototype.hasOwnProperty,qP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,JA={},YA={};function QP(n){return T_.call(YA,n)?!0:T_.call(JA,n)?!1:qP.test(n)?YA[n]=!0:(JA[n]=!0,!1)}function $P(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function eB(n,e,t,r){if(e===null||typeof e>"u"||$P(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ni(n,e,t,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Ar={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ar[n]=new ni(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ar[e]=new ni(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ar[n]=new ni(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ar[n]=new ni(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ar[n]=new ni(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ar[n]=new ni(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ar[n]=new ni(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ar[n]=new ni(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ar[n]=new ni(n,5,!1,n.toLowerCase(),null,!1,!1)});var ib=/[\-:]([a-z])/g;function sb(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ib,sb);Ar[e]=new ni(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ib,sb);Ar[e]=new ni(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ib,sb);Ar[e]=new ni(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ar[n]=new ni(n,1,!1,n.toLowerCase(),null,!1,!1)});Ar.xlinkHref=new ni("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ar[n]=new ni(n,1,!1,n.toLowerCase(),null,!0,!0)});function ab(n,e,t,r){var i=Ar.hasOwnProperty(e)?Ar[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(eB(e,t,i,r)&&(t=null),r||i===null?QP(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Pa=ZP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ep=Symbol.for("react.element"),Kc=Symbol.for("react.portal"),Zc=Symbol.for("react.fragment"),ob=Symbol.for("react.strict_mode"),N_=Symbol.for("react.profiler"),F2=Symbol.for("react.provider"),k2=Symbol.for("react.context"),lb=Symbol.for("react.forward_ref"),R_=Symbol.for("react.suspense"),I_=Symbol.for("react.suspense_list"),cb=Symbol.for("react.memo"),to=Symbol.for("react.lazy"),j2=Symbol.for("react.offscreen"),KA=Symbol.iterator;function Cd(n){return n===null||typeof n!="object"?null:(n=KA&&n[KA]||n["@@iterator"],typeof n=="function"?n:null)}var Ln=Object.assign,Gy;function $d(n){if(Gy===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Gy=e&&e[1]||""}return`
`+Gy+n}var Vy=!1;function Wy(n,e){if(!n||Vy)return"";Vy=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{Vy=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?$d(n):""}function tB(n){switch(n.tag){case 5:return $d(n.type);case 16:return $d("Lazy");case 13:return $d("Suspense");case 19:return $d("SuspenseList");case 0:case 2:case 15:return n=Wy(n.type,!1),n;case 11:return n=Wy(n.type.render,!1),n;case 1:return n=Wy(n.type,!0),n;default:return""}}function P_(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Zc:return"Fragment";case Kc:return"Portal";case N_:return"Profiler";case ob:return"StrictMode";case R_:return"Suspense";case I_:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case k2:return(n.displayName||"Context")+".Consumer";case F2:return(n._context.displayName||"Context")+".Provider";case lb:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case cb:return e=n.displayName||null,e!==null?e:P_(n.type)||"Memo";case to:e=n._payload,n=n._init;try{return P_(n(e))}catch{}}return null}function nB(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P_(e);case 8:return e===ob?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Eo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function U2(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rB(n){var e=U2(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Tp(n){n._valueTracker||(n._valueTracker=rB(n))}function O2(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=U2(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function rg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function B_(n,e){var t=e.checked;return Ln({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function ZA(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Eo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function z2(n,e){e=e.checked,e!=null&&ab(n,"checked",e,!1)}function L_(n,e){z2(n,e);var t=Eo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?D_(n,e.type,t):e.hasOwnProperty("defaultValue")&&D_(n,e.type,Eo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function qA(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function D_(n,e,t){(e!=="number"||rg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var eh=Array.isArray;function du(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Eo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function F_(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Je(91));return Ln({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function QA(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Je(92));if(eh(t)){if(1<t.length)throw Error(Je(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Eo(t)}}function H2(n,e){var t=Eo(e.value),r=Eo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function $A(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function G2(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function k_(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?G2(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Np,V2=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Np=Np||document.createElement("div"),Np.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Np.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Eh(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var lh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iB=["Webkit","ms","Moz","O"];Object.keys(lh).forEach(function(n){iB.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),lh[e]=lh[n]})});function W2(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||lh.hasOwnProperty(n)&&lh[n]?(""+e).trim():e+"px"}function X2(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=W2(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var sB=Ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function j_(n,e){if(e){if(sB[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Je(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Je(62))}}function U_(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var O_=null;function ub(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var z_=null,hu=null,fu=null;function eM(n){if(n=df(n)){if(typeof z_!="function")throw Error(Je(280));var e=n.stateNode;e&&(e=B0(e),z_(n.stateNode,n.type,e))}}function J2(n){hu?fu?fu.push(n):fu=[n]:hu=n}function Y2(){if(hu){var n=hu,e=fu;if(fu=hu=null,eM(n),e)for(n=0;n<e.length;n++)eM(e[n])}}function K2(n,e){return n(e)}function Z2(){}var Xy=!1;function q2(n,e,t){if(Xy)return n(e,t);Xy=!0;try{return K2(n,e,t)}finally{Xy=!1,(hu!==null||fu!==null)&&(Z2(),Y2())}}function Th(n,e){var t=n.stateNode;if(t===null)return null;var r=B0(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Je(231,e,typeof t));return t}var H_=!1;if(Ca)try{var Ed={};Object.defineProperty(Ed,"passive",{get:function(){H_=!0}}),window.addEventListener("test",Ed,Ed),window.removeEventListener("test",Ed,Ed)}catch{H_=!1}function aB(n,e,t,r,i,s,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(f){this.onError(f)}}var ch=!1,ig=null,sg=!1,G_=null,oB={onError:function(n){ch=!0,ig=n}};function lB(n,e,t,r,i,s,a,o,c){ch=!1,ig=null,aB.apply(oB,arguments)}function cB(n,e,t,r,i,s,a,o,c){if(lB.apply(this,arguments),ch){if(ch){var u=ig;ch=!1,ig=null}else throw Error(Je(198));sg||(sg=!0,G_=u)}}function ec(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Q2(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function tM(n){if(ec(n)!==n)throw Error(Je(188))}function uB(n){var e=n.alternate;if(!e){if(e=ec(n),e===null)throw Error(Je(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return tM(i),n;if(s===r)return tM(i),e;s=s.sibling}throw Error(Je(188))}if(t.return!==r.return)t=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,r=s;break}if(o===r){a=!0,r=i,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=i;break}if(o===r){a=!0,r=s,t=i;break}o=o.sibling}if(!a)throw Error(Je(189))}}if(t.alternate!==r)throw Error(Je(190))}if(t.tag!==3)throw Error(Je(188));return t.stateNode.current===t?n:e}function $2(n){return n=uB(n),n!==null?eT(n):null}function eT(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=eT(n);if(e!==null)return e;n=n.sibling}return null}var tT=Li.unstable_scheduleCallback,nM=Li.unstable_cancelCallback,dB=Li.unstable_shouldYield,hB=Li.unstable_requestPaint,Xn=Li.unstable_now,fB=Li.unstable_getCurrentPriorityLevel,db=Li.unstable_ImmediatePriority,nT=Li.unstable_UserBlockingPriority,ag=Li.unstable_NormalPriority,pB=Li.unstable_LowPriority,rT=Li.unstable_IdlePriority,N0=null,Zs=null;function mB(n){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(N0,n,void 0,(n.current.flags&128)===128)}catch{}}var ws=Math.clz32?Math.clz32:yB,gB=Math.log,xB=Math.LN2;function yB(n){return n>>>=0,n===0?32:31-(gB(n)/xB|0)|0}var Rp=64,Ip=4194304;function th(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function og(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?r=th(o):(s&=a,s!==0&&(r=th(s)))}else a=t&~i,a!==0?r=th(a):s!==0&&(r=th(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-ws(e),i=1<<t,r|=n[t],e&=~i;return r}function vB(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _B(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-ws(s),o=1<<a,c=i[a];c===-1?(!(o&t)||o&r)&&(i[a]=vB(o,e)):c<=e&&(n.expiredLanes|=o),s&=~o}}function V_(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function iT(){var n=Rp;return Rp<<=1,!(Rp&4194240)&&(Rp=64),n}function Jy(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function cf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ws(e),n[e]=t}function bB(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-ws(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function hb(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-ws(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var gn=0;function sT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var aT,fb,oT,lT,cT,W_=!1,Pp=[],go=null,xo=null,yo=null,Nh=new Map,Rh=new Map,io=[],wB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rM(n,e){switch(n){case"focusin":case"focusout":go=null;break;case"dragenter":case"dragleave":xo=null;break;case"mouseover":case"mouseout":yo=null;break;case"pointerover":case"pointerout":Nh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rh.delete(e.pointerId)}}function Td(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=df(e),e!==null&&fb(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function SB(n,e,t,r,i){switch(e){case"focusin":return go=Td(go,n,e,t,r,i),!0;case"dragenter":return xo=Td(xo,n,e,t,r,i),!0;case"mouseover":return yo=Td(yo,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return Nh.set(s,Td(Nh.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rh.set(s,Td(Rh.get(s)||null,n,e,t,r,i)),!0}return!1}function uT(n){var e=bl(n.target);if(e!==null){var t=ec(e);if(t!==null){if(e=t.tag,e===13){if(e=Q2(t),e!==null){n.blockedOn=e,cT(n.priority,function(){oT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Gm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=X_(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);O_=r,t.target.dispatchEvent(r),O_=null}else return e=df(t),e!==null&&fb(e),n.blockedOn=t,!1;e.shift()}return!0}function iM(n,e,t){Gm(n)&&t.delete(e)}function AB(){W_=!1,go!==null&&Gm(go)&&(go=null),xo!==null&&Gm(xo)&&(xo=null),yo!==null&&Gm(yo)&&(yo=null),Nh.forEach(iM),Rh.forEach(iM)}function Nd(n,e){n.blockedOn===e&&(n.blockedOn=null,W_||(W_=!0,Li.unstable_scheduleCallback(Li.unstable_NormalPriority,AB)))}function Ih(n){function e(i){return Nd(i,n)}if(0<Pp.length){Nd(Pp[0],n);for(var t=1;t<Pp.length;t++){var r=Pp[t];r.blockedOn===n&&(r.blockedOn=null)}}for(go!==null&&Nd(go,n),xo!==null&&Nd(xo,n),yo!==null&&Nd(yo,n),Nh.forEach(e),Rh.forEach(e),t=0;t<io.length;t++)r=io[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<io.length&&(t=io[0],t.blockedOn===null);)uT(t),t.blockedOn===null&&io.shift()}var pu=Pa.ReactCurrentBatchConfig,lg=!0;function MB(n,e,t,r){var i=gn,s=pu.transition;pu.transition=null;try{gn=1,pb(n,e,t,r)}finally{gn=i,pu.transition=s}}function CB(n,e,t,r){var i=gn,s=pu.transition;pu.transition=null;try{gn=4,pb(n,e,t,r)}finally{gn=i,pu.transition=s}}function pb(n,e,t,r){if(lg){var i=X_(n,e,t,r);if(i===null)rv(n,e,r,cg,t),rM(n,r);else if(SB(i,n,e,t,r))r.stopPropagation();else if(rM(n,r),e&4&&-1<wB.indexOf(n)){for(;i!==null;){var s=df(i);if(s!==null&&aT(s),s=X_(n,e,t,r),s===null&&rv(n,e,r,cg,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else rv(n,e,r,null,t)}}var cg=null;function X_(n,e,t,r){if(cg=null,n=ub(r),n=bl(n),n!==null)if(e=ec(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Q2(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return cg=n,null}function dT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fB()){case db:return 1;case nT:return 4;case ag:case pB:return 16;case rT:return 536870912;default:return 16}default:return 16}}var lo=null,mb=null,Vm=null;function hT(){if(Vm)return Vm;var n,e=mb,t=e.length,r,i="value"in lo?lo.value:lo.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===i[s-r];r++);return Vm=i.slice(n,1<r?1-r:void 0)}function Wm(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Bp(){return!0}function sM(){return!1}function Ui(n){function e(t,r,i,s,a){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Bp:sM,this.isPropagationStopped=sM,this}return Ln(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Bp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Bp)},persist:function(){},isPersistent:Bp}),e}var Yu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gb=Ui(Yu),uf=Ln({},Yu,{view:0,detail:0}),EB=Ui(uf),Yy,Ky,Rd,R0=Ln({},uf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xb,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rd&&(Rd&&n.type==="mousemove"?(Yy=n.screenX-Rd.screenX,Ky=n.screenY-Rd.screenY):Ky=Yy=0,Rd=n),Yy)},movementY:function(n){return"movementY"in n?n.movementY:Ky}}),aM=Ui(R0),TB=Ln({},R0,{dataTransfer:0}),NB=Ui(TB),RB=Ln({},uf,{relatedTarget:0}),Zy=Ui(RB),IB=Ln({},Yu,{animationName:0,elapsedTime:0,pseudoElement:0}),PB=Ui(IB),BB=Ln({},Yu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),LB=Ui(BB),DB=Ln({},Yu,{data:0}),oM=Ui(DB),FB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UB(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=jB[n])?!!e[n]:!1}function xb(){return UB}var OB=Ln({},uf,{key:function(n){if(n.key){var e=FB[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Wm(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?kB[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xb,charCode:function(n){return n.type==="keypress"?Wm(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Wm(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),zB=Ui(OB),HB=Ln({},R0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lM=Ui(HB),GB=Ln({},uf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xb}),VB=Ui(GB),WB=Ln({},Yu,{propertyName:0,elapsedTime:0,pseudoElement:0}),XB=Ui(WB),JB=Ln({},R0,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),YB=Ui(JB),KB=[9,13,27,32],yb=Ca&&"CompositionEvent"in window,uh=null;Ca&&"documentMode"in document&&(uh=document.documentMode);var ZB=Ca&&"TextEvent"in window&&!uh,fT=Ca&&(!yb||uh&&8<uh&&11>=uh),cM=" ",uM=!1;function pT(n,e){switch(n){case"keyup":return KB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var qc=!1;function qB(n,e){switch(n){case"compositionend":return mT(e);case"keypress":return e.which!==32?null:(uM=!0,cM);case"textInput":return n=e.data,n===cM&&uM?null:n;default:return null}}function QB(n,e){if(qc)return n==="compositionend"||!yb&&pT(n,e)?(n=hT(),Vm=mb=lo=null,qc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fT&&e.locale!=="ko"?null:e.data;default:return null}}var $B={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dM(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!$B[n.type]:e==="textarea"}function gT(n,e,t,r){J2(r),e=ug(e,"onChange"),0<e.length&&(t=new gb("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var dh=null,Ph=null;function eL(n){ET(n,0)}function I0(n){var e=eu(n);if(O2(e))return n}function tL(n,e){if(n==="change")return e}var xT=!1;if(Ca){var qy;if(Ca){var Qy="oninput"in document;if(!Qy){var hM=document.createElement("div");hM.setAttribute("oninput","return;"),Qy=typeof hM.oninput=="function"}qy=Qy}else qy=!1;xT=qy&&(!document.documentMode||9<document.documentMode)}function fM(){dh&&(dh.detachEvent("onpropertychange",yT),Ph=dh=null)}function yT(n){if(n.propertyName==="value"&&I0(Ph)){var e=[];gT(e,Ph,n,ub(n)),q2(eL,e)}}function nL(n,e,t){n==="focusin"?(fM(),dh=e,Ph=t,dh.attachEvent("onpropertychange",yT)):n==="focusout"&&fM()}function rL(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return I0(Ph)}function iL(n,e){if(n==="click")return I0(e)}function sL(n,e){if(n==="input"||n==="change")return I0(e)}function aL(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ms=typeof Object.is=="function"?Object.is:aL;function Bh(n,e){if(Ms(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!T_.call(e,i)||!Ms(n[i],e[i]))return!1}return!0}function pM(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function mM(n,e){var t=pM(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=pM(t)}}function vT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?vT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function _T(){for(var n=window,e=rg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=rg(n.document)}return e}function vb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function oL(n){var e=_T(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&vT(t.ownerDocument.documentElement,t)){if(r!==null&&vb(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=mM(t,s);var a=mM(t,r);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var lL=Ca&&"documentMode"in document&&11>=document.documentMode,Qc=null,J_=null,hh=null,Y_=!1;function gM(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Y_||Qc==null||Qc!==rg(r)||(r=Qc,"selectionStart"in r&&vb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hh&&Bh(hh,r)||(hh=r,r=ug(J_,"onSelect"),0<r.length&&(e=new gb("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Qc)))}function Lp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var $c={animationend:Lp("Animation","AnimationEnd"),animationiteration:Lp("Animation","AnimationIteration"),animationstart:Lp("Animation","AnimationStart"),transitionend:Lp("Transition","TransitionEnd")},$y={},bT={};Ca&&(bT=document.createElement("div").style,"AnimationEvent"in window||(delete $c.animationend.animation,delete $c.animationiteration.animation,delete $c.animationstart.animation),"TransitionEvent"in window||delete $c.transitionend.transition);function P0(n){if($y[n])return $y[n];if(!$c[n])return n;var e=$c[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in bT)return $y[n]=e[t];return n}var wT=P0("animationend"),ST=P0("animationiteration"),AT=P0("animationstart"),MT=P0("transitionend"),CT=new Map,xM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Do(n,e){CT.set(n,e),$l(e,[n])}for(var ev=0;ev<xM.length;ev++){var tv=xM[ev],cL=tv.toLowerCase(),uL=tv[0].toUpperCase()+tv.slice(1);Do(cL,"on"+uL)}Do(wT,"onAnimationEnd");Do(ST,"onAnimationIteration");Do(AT,"onAnimationStart");Do("dblclick","onDoubleClick");Do("focusin","onFocus");Do("focusout","onBlur");Do(MT,"onTransitionEnd");wu("onMouseEnter",["mouseout","mouseover"]);wu("onMouseLeave",["mouseout","mouseover"]);wu("onPointerEnter",["pointerout","pointerover"]);wu("onPointerLeave",["pointerout","pointerover"]);$l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$l("onBeforeInput",["compositionend","keypress","textInput","paste"]);$l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dL=new Set("cancel close invalid load scroll toggle".split(" ").concat(nh));function yM(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,cB(r,e,void 0,n),n.currentTarget=null}function ET(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==s&&i.isPropagationStopped())break e;yM(i,o,u),s=c}else for(a=0;a<r.length;a++){if(o=r[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==s&&i.isPropagationStopped())break e;yM(i,o,u),s=c}}}if(sg)throw n=G_,sg=!1,G_=null,n}function bn(n,e){var t=e[$_];t===void 0&&(t=e[$_]=new Set);var r=n+"__bubble";t.has(r)||(TT(e,n,2,!1),t.add(r))}function nv(n,e,t){var r=0;e&&(r|=4),TT(t,n,r,e)}var Dp="_reactListening"+Math.random().toString(36).slice(2);function Lh(n){if(!n[Dp]){n[Dp]=!0,D2.forEach(function(t){t!=="selectionchange"&&(dL.has(t)||nv(t,!1,n),nv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Dp]||(e[Dp]=!0,nv("selectionchange",!1,e))}}function TT(n,e,t,r){switch(dT(e)){case 1:var i=MB;break;case 4:i=CB;break;default:i=pb}t=i.bind(null,e,t,n),i=void 0,!H_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function rv(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=bl(o),a===null)return;if(c=a.tag,c===5||c===6){r=s=a;continue e}o=o.parentNode}}r=r.return}q2(function(){var u=s,f=ub(t),p=[];e:{var m=CT.get(n);if(m!==void 0){var g=gb,y=n;switch(n){case"keypress":if(Wm(t)===0)break e;case"keydown":case"keyup":g=zB;break;case"focusin":y="focus",g=Zy;break;case"focusout":y="blur",g=Zy;break;case"beforeblur":case"afterblur":g=Zy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=aM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=NB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=VB;break;case wT:case ST:case AT:g=PB;break;case MT:g=XB;break;case"scroll":g=EB;break;case"wheel":g=YB;break;case"copy":case"cut":case"paste":g=LB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=lM}var S=(e&4)!==0,w=!S&&n==="scroll",x=S?m!==null?m+"Capture":null:m;S=[];for(var _=u,b;_!==null;){b=_;var M=b.stateNode;if(b.tag===5&&M!==null&&(b=M,x!==null&&(M=Th(_,x),M!=null&&S.push(Dh(_,M,b)))),w)break;_=_.return}0<S.length&&(m=new g(m,y,null,t,f),p.push({event:m,listeners:S}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",m&&t!==O_&&(y=t.relatedTarget||t.fromElement)&&(bl(y)||y[Ea]))break e;if((g||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,g?(y=t.relatedTarget||t.toElement,g=u,y=y?bl(y):null,y!==null&&(w=ec(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(S=aM,M="onMouseLeave",x="onMouseEnter",_="mouse",(n==="pointerout"||n==="pointerover")&&(S=lM,M="onPointerLeave",x="onPointerEnter",_="pointer"),w=g==null?m:eu(g),b=y==null?m:eu(y),m=new S(M,_+"leave",g,t,f),m.target=w,m.relatedTarget=b,M=null,bl(f)===u&&(S=new S(x,_+"enter",y,t,f),S.target=b,S.relatedTarget=w,M=S),w=M,g&&y)t:{for(S=g,x=y,_=0,b=S;b;b=wc(b))_++;for(b=0,M=x;M;M=wc(M))b++;for(;0<_-b;)S=wc(S),_--;for(;0<b-_;)x=wc(x),b--;for(;_--;){if(S===x||x!==null&&S===x.alternate)break t;S=wc(S),x=wc(x)}S=null}else S=null;g!==null&&vM(p,m,g,S,!1),y!==null&&w!==null&&vM(p,w,y,S,!0)}}e:{if(m=u?eu(u):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var N=tL;else if(dM(m))if(xT)N=sL;else{N=rL;var C=nL}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(N=iL);if(N&&(N=N(n,u))){gT(p,N,t,f);break e}C&&C(n,m,u),n==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&D_(m,"number",m.value)}switch(C=u?eu(u):window,n){case"focusin":(dM(C)||C.contentEditable==="true")&&(Qc=C,J_=u,hh=null);break;case"focusout":hh=J_=Qc=null;break;case"mousedown":Y_=!0;break;case"contextmenu":case"mouseup":case"dragend":Y_=!1,gM(p,t,f);break;case"selectionchange":if(lL)break;case"keydown":case"keyup":gM(p,t,f)}var I;if(yb)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else qc?pT(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(fT&&t.locale!=="ko"&&(qc||P!=="onCompositionStart"?P==="onCompositionEnd"&&qc&&(I=hT()):(lo=f,mb="value"in lo?lo.value:lo.textContent,qc=!0)),C=ug(u,P),0<C.length&&(P=new oM(P,n,null,t,f),p.push({event:P,listeners:C}),I?P.data=I:(I=mT(t),I!==null&&(P.data=I)))),(I=ZB?qB(n,t):QB(n,t))&&(u=ug(u,"onBeforeInput"),0<u.length&&(f=new oM("onBeforeInput","beforeinput",null,t,f),p.push({event:f,listeners:u}),f.data=I))}ET(p,e)})}function Dh(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ug(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Th(n,t),s!=null&&r.unshift(Dh(n,s,i)),s=Th(n,e),s!=null&&r.push(Dh(n,s,i))),n=n.return}return r}function wc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function vM(n,e,t,r,i){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,c=o.alternate,u=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&u!==null&&(o=u,i?(c=Th(t,s),c!=null&&a.unshift(Dh(t,c,o))):i||(c=Th(t,s),c!=null&&a.push(Dh(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var hL=/\r\n?/g,fL=/\u0000|\uFFFD/g;function _M(n){return(typeof n=="string"?n:""+n).replace(hL,`
`).replace(fL,"")}function Fp(n,e,t){if(e=_M(e),_M(n)!==e&&t)throw Error(Je(425))}function dg(){}var K_=null,Z_=null;function q_(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Q_=typeof setTimeout=="function"?setTimeout:void 0,pL=typeof clearTimeout=="function"?clearTimeout:void 0,bM=typeof Promise=="function"?Promise:void 0,mL=typeof queueMicrotask=="function"?queueMicrotask:typeof bM<"u"?function(n){return bM.resolve(null).then(n).catch(gL)}:Q_;function gL(n){setTimeout(function(){throw n})}function iv(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Ih(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Ih(e)}function vo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function wM(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Ku=Math.random().toString(36).slice(2),Js="__reactFiber$"+Ku,Fh="__reactProps$"+Ku,Ea="__reactContainer$"+Ku,$_="__reactEvents$"+Ku,xL="__reactListeners$"+Ku,yL="__reactHandles$"+Ku;function bl(n){var e=n[Js];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ea]||t[Js]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=wM(n);n!==null;){if(t=n[Js])return t;n=wM(n)}return e}n=t,t=n.parentNode}return null}function df(n){return n=n[Js]||n[Ea],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function eu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Je(33))}function B0(n){return n[Fh]||null}var e1=[],tu=-1;function Fo(n){return{current:n}}function Sn(n){0>tu||(n.current=e1[tu],e1[tu]=null,tu--)}function _n(n,e){tu++,e1[tu]=n.current,n.current=e}var To={},Or=Fo(To),mi=Fo(!1),jl=To;function Su(n,e){var t=n.type.contextTypes;if(!t)return To;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function gi(n){return n=n.childContextTypes,n!=null}function hg(){Sn(mi),Sn(Or)}function SM(n,e,t){if(Or.current!==To)throw Error(Je(168));_n(Or,e),_n(mi,t)}function NT(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Je(108,nB(n)||"Unknown",i));return Ln({},t,r)}function fg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||To,jl=Or.current,_n(Or,n),_n(mi,mi.current),!0}function AM(n,e,t){var r=n.stateNode;if(!r)throw Error(Je(169));t?(n=NT(n,e,jl),r.__reactInternalMemoizedMergedChildContext=n,Sn(mi),Sn(Or),_n(Or,n)):Sn(mi),_n(mi,t)}var xa=null,L0=!1,sv=!1;function RT(n){xa===null?xa=[n]:xa.push(n)}function vL(n){L0=!0,RT(n)}function ko(){if(!sv&&xa!==null){sv=!0;var n=0,e=gn;try{var t=xa;for(gn=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}xa=null,L0=!1}catch(i){throw xa!==null&&(xa=xa.slice(n+1)),tT(db,ko),i}finally{gn=e,sv=!1}}return null}var nu=[],ru=0,pg=null,mg=0,Zi=[],qi=0,Ul=null,_a=1,ba="";function ml(n,e){nu[ru++]=mg,nu[ru++]=pg,pg=n,mg=e}function IT(n,e,t){Zi[qi++]=_a,Zi[qi++]=ba,Zi[qi++]=Ul,Ul=n;var r=_a;n=ba;var i=32-ws(r)-1;r&=~(1<<i),t+=1;var s=32-ws(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,_a=1<<32-ws(e)+i|t<<i|r,ba=s+n}else _a=1<<s|t<<i|r,ba=n}function _b(n){n.return!==null&&(ml(n,1),IT(n,1,0))}function bb(n){for(;n===pg;)pg=nu[--ru],nu[ru]=null,mg=nu[--ru],nu[ru]=null;for(;n===Ul;)Ul=Zi[--qi],Zi[qi]=null,ba=Zi[--qi],Zi[qi]=null,_a=Zi[--qi],Zi[qi]=null}var Ii=null,Ni=null,Mn=!1,vs=null;function PT(n,e){var t=$i(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function MM(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ii=n,Ni=vo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ii=n,Ni=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ul!==null?{id:_a,overflow:ba}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=$i(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ii=n,Ni=null,!0):!1;default:return!1}}function t1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function n1(n){if(Mn){var e=Ni;if(e){var t=e;if(!MM(n,e)){if(t1(n))throw Error(Je(418));e=vo(t.nextSibling);var r=Ii;e&&MM(n,e)?PT(r,t):(n.flags=n.flags&-4097|2,Mn=!1,Ii=n)}}else{if(t1(n))throw Error(Je(418));n.flags=n.flags&-4097|2,Mn=!1,Ii=n}}}function CM(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ii=n}function kp(n){if(n!==Ii)return!1;if(!Mn)return CM(n),Mn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!q_(n.type,n.memoizedProps)),e&&(e=Ni)){if(t1(n))throw BT(),Error(Je(418));for(;e;)PT(n,e),e=vo(e.nextSibling)}if(CM(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Je(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ni=vo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ni=null}}else Ni=Ii?vo(n.stateNode.nextSibling):null;return!0}function BT(){for(var n=Ni;n;)n=vo(n.nextSibling)}function Au(){Ni=Ii=null,Mn=!1}function wb(n){vs===null?vs=[n]:vs.push(n)}var _L=Pa.ReactCurrentBatchConfig;function Id(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Je(309));var r=t.stateNode}if(!r)throw Error(Je(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(Je(284));if(!t._owner)throw Error(Je(290,n))}return n}function jp(n,e){throw n=Object.prototype.toString.call(e),Error(Je(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function EM(n){var e=n._init;return e(n._payload)}function LT(n){function e(x,_){if(n){var b=x.deletions;b===null?(x.deletions=[_],x.flags|=16):b.push(_)}}function t(x,_){if(!n)return null;for(;_!==null;)e(x,_),_=_.sibling;return null}function r(x,_){for(x=new Map;_!==null;)_.key!==null?x.set(_.key,_):x.set(_.index,_),_=_.sibling;return x}function i(x,_){return x=So(x,_),x.index=0,x.sibling=null,x}function s(x,_,b){return x.index=b,n?(b=x.alternate,b!==null?(b=b.index,b<_?(x.flags|=2,_):b):(x.flags|=2,_)):(x.flags|=1048576,_)}function a(x){return n&&x.alternate===null&&(x.flags|=2),x}function o(x,_,b,M){return _===null||_.tag!==6?(_=hv(b,x.mode,M),_.return=x,_):(_=i(_,b),_.return=x,_)}function c(x,_,b,M){var N=b.type;return N===Zc?f(x,_,b.props.children,M,b.key):_!==null&&(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===to&&EM(N)===_.type)?(M=i(_,b.props),M.ref=Id(x,_,b),M.return=x,M):(M=Qm(b.type,b.key,b.props,null,x.mode,M),M.ref=Id(x,_,b),M.return=x,M)}function u(x,_,b,M){return _===null||_.tag!==4||_.stateNode.containerInfo!==b.containerInfo||_.stateNode.implementation!==b.implementation?(_=fv(b,x.mode,M),_.return=x,_):(_=i(_,b.children||[]),_.return=x,_)}function f(x,_,b,M,N){return _===null||_.tag!==7?(_=Bl(b,x.mode,M,N),_.return=x,_):(_=i(_,b),_.return=x,_)}function p(x,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return _=hv(""+_,x.mode,b),_.return=x,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ep:return b=Qm(_.type,_.key,_.props,null,x.mode,b),b.ref=Id(x,null,_),b.return=x,b;case Kc:return _=fv(_,x.mode,b),_.return=x,_;case to:var M=_._init;return p(x,M(_._payload),b)}if(eh(_)||Cd(_))return _=Bl(_,x.mode,b,null),_.return=x,_;jp(x,_)}return null}function m(x,_,b,M){var N=_!==null?_.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:o(x,_,""+b,M);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ep:return b.key===N?c(x,_,b,M):null;case Kc:return b.key===N?u(x,_,b,M):null;case to:return N=b._init,m(x,_,N(b._payload),M)}if(eh(b)||Cd(b))return N!==null?null:f(x,_,b,M,null);jp(x,b)}return null}function g(x,_,b,M,N){if(typeof M=="string"&&M!==""||typeof M=="number")return x=x.get(b)||null,o(_,x,""+M,N);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Ep:return x=x.get(M.key===null?b:M.key)||null,c(_,x,M,N);case Kc:return x=x.get(M.key===null?b:M.key)||null,u(_,x,M,N);case to:var C=M._init;return g(x,_,b,C(M._payload),N)}if(eh(M)||Cd(M))return x=x.get(b)||null,f(_,x,M,N,null);jp(_,M)}return null}function y(x,_,b,M){for(var N=null,C=null,I=_,P=_=0,T=null;I!==null&&P<b.length;P++){I.index>P?(T=I,I=null):T=I.sibling;var R=m(x,I,b[P],M);if(R===null){I===null&&(I=T);break}n&&I&&R.alternate===null&&e(x,I),_=s(R,_,P),C===null?N=R:C.sibling=R,C=R,I=T}if(P===b.length)return t(x,I),Mn&&ml(x,P),N;if(I===null){for(;P<b.length;P++)I=p(x,b[P],M),I!==null&&(_=s(I,_,P),C===null?N=I:C.sibling=I,C=I);return Mn&&ml(x,P),N}for(I=r(x,I);P<b.length;P++)T=g(I,x,P,b[P],M),T!==null&&(n&&T.alternate!==null&&I.delete(T.key===null?P:T.key),_=s(T,_,P),C===null?N=T:C.sibling=T,C=T);return n&&I.forEach(function(j){return e(x,j)}),Mn&&ml(x,P),N}function S(x,_,b,M){var N=Cd(b);if(typeof N!="function")throw Error(Je(150));if(b=N.call(b),b==null)throw Error(Je(151));for(var C=N=null,I=_,P=_=0,T=null,R=b.next();I!==null&&!R.done;P++,R=b.next()){I.index>P?(T=I,I=null):T=I.sibling;var j=m(x,I,R.value,M);if(j===null){I===null&&(I=T);break}n&&I&&j.alternate===null&&e(x,I),_=s(j,_,P),C===null?N=j:C.sibling=j,C=j,I=T}if(R.done)return t(x,I),Mn&&ml(x,P),N;if(I===null){for(;!R.done;P++,R=b.next())R=p(x,R.value,M),R!==null&&(_=s(R,_,P),C===null?N=R:C.sibling=R,C=R);return Mn&&ml(x,P),N}for(I=r(x,I);!R.done;P++,R=b.next())R=g(I,x,P,R.value,M),R!==null&&(n&&R.alternate!==null&&I.delete(R.key===null?P:R.key),_=s(R,_,P),C===null?N=R:C.sibling=R,C=R);return n&&I.forEach(function(O){return e(x,O)}),Mn&&ml(x,P),N}function w(x,_,b,M){if(typeof b=="object"&&b!==null&&b.type===Zc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ep:e:{for(var N=b.key,C=_;C!==null;){if(C.key===N){if(N=b.type,N===Zc){if(C.tag===7){t(x,C.sibling),_=i(C,b.props.children),_.return=x,x=_;break e}}else if(C.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===to&&EM(N)===C.type){t(x,C.sibling),_=i(C,b.props),_.ref=Id(x,C,b),_.return=x,x=_;break e}t(x,C);break}else e(x,C);C=C.sibling}b.type===Zc?(_=Bl(b.props.children,x.mode,M,b.key),_.return=x,x=_):(M=Qm(b.type,b.key,b.props,null,x.mode,M),M.ref=Id(x,_,b),M.return=x,x=M)}return a(x);case Kc:e:{for(C=b.key;_!==null;){if(_.key===C)if(_.tag===4&&_.stateNode.containerInfo===b.containerInfo&&_.stateNode.implementation===b.implementation){t(x,_.sibling),_=i(_,b.children||[]),_.return=x,x=_;break e}else{t(x,_);break}else e(x,_);_=_.sibling}_=fv(b,x.mode,M),_.return=x,x=_}return a(x);case to:return C=b._init,w(x,_,C(b._payload),M)}if(eh(b))return y(x,_,b,M);if(Cd(b))return S(x,_,b,M);jp(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,_!==null&&_.tag===6?(t(x,_.sibling),_=i(_,b),_.return=x,x=_):(t(x,_),_=hv(b,x.mode,M),_.return=x,x=_),a(x)):t(x,_)}return w}var Mu=LT(!0),DT=LT(!1),gg=Fo(null),xg=null,iu=null,Sb=null;function Ab(){Sb=iu=xg=null}function Mb(n){var e=gg.current;Sn(gg),n._currentValue=e}function r1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function mu(n,e){xg=n,Sb=iu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(fi=!0),n.firstContext=null)}function is(n){var e=n._currentValue;if(Sb!==n)if(n={context:n,memoizedValue:e,next:null},iu===null){if(xg===null)throw Error(Je(308));iu=n,xg.dependencies={lanes:0,firstContext:n}}else iu=iu.next=n;return e}var wl=null;function Cb(n){wl===null?wl=[n]:wl.push(n)}function FT(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Cb(e)):(t.next=i.next,i.next=t),e.interleaved=t,Ta(n,r)}function Ta(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var no=!1;function Eb(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kT(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Sa(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function _o(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,on&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ta(n,t)}return i=r.interleaved,i===null?(e.next=e,Cb(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ta(n,t)}function Xm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,hb(n,t)}}function TM(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function yg(n,e,t,r){var i=n.updateQueue;no=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?s=u:a.next=u,a=c;var f=n.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(s!==null){var p=i.baseState;a=0,f=u=c=null,o=s;do{var m=o.lane,g=o.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=n,S=o;switch(m=e,g=t,S.tag){case 1:if(y=S.payload,typeof y=="function"){p=y.call(g,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=S.payload,m=typeof y=="function"?y.call(g,p,m):y,m==null)break e;p=Ln({},p,m);break e;case 2:no=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,m=i.effects,m===null?i.effects=[o]:m.push(o))}else g={eventTime:g,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=g,c=p):f=f.next=g,a|=m;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(f===null&&(c=p),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);zl|=a,n.lanes=a,n.memoizedState=p}}function NM(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(Je(191,i));i.call(r)}}}var hf={},qs=Fo(hf),kh=Fo(hf),jh=Fo(hf);function Sl(n){if(n===hf)throw Error(Je(174));return n}function Tb(n,e){switch(_n(jh,e),_n(kh,n),_n(qs,hf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:k_(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=k_(e,n)}Sn(qs),_n(qs,e)}function Cu(){Sn(qs),Sn(kh),Sn(jh)}function jT(n){Sl(jh.current);var e=Sl(qs.current),t=k_(e,n.type);e!==t&&(_n(kh,n),_n(qs,t))}function Nb(n){kh.current===n&&(Sn(qs),Sn(kh))}var Rn=Fo(0);function vg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var av=[];function Rb(){for(var n=0;n<av.length;n++)av[n]._workInProgressVersionPrimary=null;av.length=0}var Jm=Pa.ReactCurrentDispatcher,ov=Pa.ReactCurrentBatchConfig,Ol=0,Bn=null,nr=null,mr=null,_g=!1,fh=!1,Uh=0,bL=0;function Br(){throw Error(Je(321))}function Ib(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ms(n[t],e[t]))return!1;return!0}function Pb(n,e,t,r,i,s){if(Ol=s,Bn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Jm.current=n===null||n.memoizedState===null?ML:CL,n=t(r,i),fh){s=0;do{if(fh=!1,Uh=0,25<=s)throw Error(Je(301));s+=1,mr=nr=null,e.updateQueue=null,Jm.current=EL,n=t(r,i)}while(fh)}if(Jm.current=bg,e=nr!==null&&nr.next!==null,Ol=0,mr=nr=Bn=null,_g=!1,e)throw Error(Je(300));return n}function Bb(){var n=Uh!==0;return Uh=0,n}function Ws(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Bn.memoizedState=mr=n:mr=mr.next=n,mr}function ss(){if(nr===null){var n=Bn.alternate;n=n!==null?n.memoizedState:null}else n=nr.next;var e=mr===null?Bn.memoizedState:mr.next;if(e!==null)mr=e,nr=n;else{if(n===null)throw Error(Je(310));nr=n,n={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},mr===null?Bn.memoizedState=mr=n:mr=mr.next=n}return mr}function Oh(n,e){return typeof e=="function"?e(n):e}function lv(n){var e=ss(),t=e.queue;if(t===null)throw Error(Je(311));t.lastRenderedReducer=n;var r=nr,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,c=null,u=s;do{var f=u.lane;if((Ol&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=p,a=r):c=c.next=p,Bn.lanes|=f,zl|=f}u=u.next}while(u!==null&&u!==s);c===null?a=r:c.next=o,Ms(r,e.memoizedState)||(fi=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Bn.lanes|=s,zl|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function cv(n){var e=ss(),t=e.queue;if(t===null)throw Error(Je(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do s=n(s,a.action),a=a.next;while(a!==i);Ms(s,e.memoizedState)||(fi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function UT(){}function OT(n,e){var t=Bn,r=ss(),i=e(),s=!Ms(r.memoizedState,i);if(s&&(r.memoizedState=i,fi=!0),r=r.queue,Lb(GT.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||mr!==null&&mr.memoizedState.tag&1){if(t.flags|=2048,zh(9,HT.bind(null,t,r,i,e),void 0,null),xr===null)throw Error(Je(349));Ol&30||zT(t,e,i)}return i}function zT(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Bn.updateQueue,e===null?(e={lastEffect:null,stores:null},Bn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function HT(n,e,t,r){e.value=t,e.getSnapshot=r,VT(e)&&WT(n)}function GT(n,e,t){return t(function(){VT(e)&&WT(n)})}function VT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ms(n,t)}catch{return!0}}function WT(n){var e=Ta(n,1);e!==null&&Ss(e,n,1,-1)}function RM(n){var e=Ws();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oh,lastRenderedState:n},e.queue=n,n=n.dispatch=AL.bind(null,Bn,n),[e.memoizedState,n]}function zh(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Bn.updateQueue,e===null?(e={lastEffect:null,stores:null},Bn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function XT(){return ss().memoizedState}function Ym(n,e,t,r){var i=Ws();Bn.flags|=n,i.memoizedState=zh(1|e,t,void 0,r===void 0?null:r)}function D0(n,e,t,r){var i=ss();r=r===void 0?null:r;var s=void 0;if(nr!==null){var a=nr.memoizedState;if(s=a.destroy,r!==null&&Ib(r,a.deps)){i.memoizedState=zh(e,t,s,r);return}}Bn.flags|=n,i.memoizedState=zh(1|e,t,s,r)}function IM(n,e){return Ym(8390656,8,n,e)}function Lb(n,e){return D0(2048,8,n,e)}function JT(n,e){return D0(4,2,n,e)}function YT(n,e){return D0(4,4,n,e)}function KT(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function ZT(n,e,t){return t=t!=null?t.concat([n]):null,D0(4,4,KT.bind(null,e,n),t)}function Db(){}function qT(n,e){var t=ss();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function QT(n,e){var t=ss();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function $T(n,e,t){return Ol&21?(Ms(t,e)||(t=iT(),Bn.lanes|=t,zl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,fi=!0),n.memoizedState=t)}function wL(n,e){var t=gn;gn=t!==0&&4>t?t:4,n(!0);var r=ov.transition;ov.transition={};try{n(!1),e()}finally{gn=t,ov.transition=r}}function eN(){return ss().memoizedState}function SL(n,e,t){var r=wo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},tN(n))nN(e,t);else if(t=FT(n,e,t,r),t!==null){var i=$r();Ss(t,n,r,i),rN(t,e,r)}}function AL(n,e,t){var r=wo(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(tN(n))nN(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(i.hasEagerState=!0,i.eagerState=o,Ms(o,a)){var c=e.interleaved;c===null?(i.next=i,Cb(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=FT(n,e,i,r),t!==null&&(i=$r(),Ss(t,n,r,i),rN(t,e,r))}}function tN(n){var e=n.alternate;return n===Bn||e!==null&&e===Bn}function nN(n,e){fh=_g=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function rN(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,hb(n,t)}}var bg={readContext:is,useCallback:Br,useContext:Br,useEffect:Br,useImperativeHandle:Br,useInsertionEffect:Br,useLayoutEffect:Br,useMemo:Br,useReducer:Br,useRef:Br,useState:Br,useDebugValue:Br,useDeferredValue:Br,useTransition:Br,useMutableSource:Br,useSyncExternalStore:Br,useId:Br,unstable_isNewReconciler:!1},ML={readContext:is,useCallback:function(n,e){return Ws().memoizedState=[n,e===void 0?null:e],n},useContext:is,useEffect:IM,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Ym(4194308,4,KT.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Ym(4194308,4,n,e)},useInsertionEffect:function(n,e){return Ym(4,2,n,e)},useMemo:function(n,e){var t=Ws();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Ws();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=SL.bind(null,Bn,n),[r.memoizedState,n]},useRef:function(n){var e=Ws();return n={current:n},e.memoizedState=n},useState:RM,useDebugValue:Db,useDeferredValue:function(n){return Ws().memoizedState=n},useTransition:function(){var n=RM(!1),e=n[0];return n=wL.bind(null,n[1]),Ws().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Bn,i=Ws();if(Mn){if(t===void 0)throw Error(Je(407));t=t()}else{if(t=e(),xr===null)throw Error(Je(349));Ol&30||zT(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,IM(GT.bind(null,r,s,n),[n]),r.flags|=2048,zh(9,HT.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Ws(),e=xr.identifierPrefix;if(Mn){var t=ba,r=_a;t=(r&~(1<<32-ws(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Uh++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=bL++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},CL={readContext:is,useCallback:qT,useContext:is,useEffect:Lb,useImperativeHandle:ZT,useInsertionEffect:JT,useLayoutEffect:YT,useMemo:QT,useReducer:lv,useRef:XT,useState:function(){return lv(Oh)},useDebugValue:Db,useDeferredValue:function(n){var e=ss();return $T(e,nr.memoizedState,n)},useTransition:function(){var n=lv(Oh)[0],e=ss().memoizedState;return[n,e]},useMutableSource:UT,useSyncExternalStore:OT,useId:eN,unstable_isNewReconciler:!1},EL={readContext:is,useCallback:qT,useContext:is,useEffect:Lb,useImperativeHandle:ZT,useInsertionEffect:JT,useLayoutEffect:YT,useMemo:QT,useReducer:cv,useRef:XT,useState:function(){return cv(Oh)},useDebugValue:Db,useDeferredValue:function(n){var e=ss();return nr===null?e.memoizedState=n:$T(e,nr.memoizedState,n)},useTransition:function(){var n=cv(Oh)[0],e=ss().memoizedState;return[n,e]},useMutableSource:UT,useSyncExternalStore:OT,useId:eN,unstable_isNewReconciler:!1};function xs(n,e){if(n&&n.defaultProps){e=Ln({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function i1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ln({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var F0={isMounted:function(n){return(n=n._reactInternals)?ec(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=$r(),i=wo(n),s=Sa(r,i);s.payload=e,t!=null&&(s.callback=t),e=_o(n,s,i),e!==null&&(Ss(e,n,i,r),Xm(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=$r(),i=wo(n),s=Sa(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=_o(n,s,i),e!==null&&(Ss(e,n,i,r),Xm(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=$r(),r=wo(n),i=Sa(t,r);i.tag=2,e!=null&&(i.callback=e),e=_o(n,i,r),e!==null&&(Ss(e,n,r,t),Xm(e,n,r))}};function PM(n,e,t,r,i,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Bh(t,r)||!Bh(i,s):!0}function iN(n,e,t){var r=!1,i=To,s=e.contextType;return typeof s=="object"&&s!==null?s=is(s):(i=gi(e)?jl:Or.current,r=e.contextTypes,s=(r=r!=null)?Su(n,i):To),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=F0,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function BM(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&F0.enqueueReplaceState(e,e.state,null)}function s1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Eb(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=is(s):(s=gi(e)?jl:Or.current,i.context=Su(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(i1(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&F0.enqueueReplaceState(i,i.state,null),yg(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Eu(n,e){try{var t="",r=e;do t+=tB(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function uv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function a1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var TL=typeof WeakMap=="function"?WeakMap:Map;function sN(n,e,t){t=Sa(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Sg||(Sg=!0,g1=r),a1(n,e)},t}function aN(n,e,t){t=Sa(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){a1(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){a1(n,e),typeof r!="function"&&(bo===null?bo=new Set([this]):bo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function LM(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new TL;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=HL.bind(null,n,e,t),e.then(n,n))}function DM(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function FM(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Sa(-1,1),e.tag=2,_o(t,e,1))),t.lanes|=1),n)}var NL=Pa.ReactCurrentOwner,fi=!1;function Kr(n,e,t,r){e.child=n===null?DT(e,null,t,r):Mu(e,n.child,t,r)}function kM(n,e,t,r,i){t=t.render;var s=e.ref;return mu(e,i),r=Pb(n,e,t,r,s,i),t=Bb(),n!==null&&!fi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Na(n,e,i)):(Mn&&t&&_b(e),e.flags|=1,Kr(n,e,r,i),e.child)}function jM(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Gb(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,oN(n,e,s,r,i)):(n=Qm(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:Bh,t(a,r)&&n.ref===e.ref)return Na(n,e,i)}return e.flags|=1,n=So(s,r),n.ref=e.ref,n.return=e,e.child=n}function oN(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Bh(s,r)&&n.ref===e.ref)if(fi=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(fi=!0);else return e.lanes=n.lanes,Na(n,e,i)}return o1(n,e,t,r,i)}function lN(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_n(au,Ei),Ei|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,_n(au,Ei),Ei|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,_n(au,Ei),Ei|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,_n(au,Ei),Ei|=r;return Kr(n,e,i,t),e.child}function cN(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function o1(n,e,t,r,i){var s=gi(t)?jl:Or.current;return s=Su(e,s),mu(e,i),t=Pb(n,e,t,r,s,i),r=Bb(),n!==null&&!fi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Na(n,e,i)):(Mn&&r&&_b(e),e.flags|=1,Kr(n,e,t,i),e.child)}function UM(n,e,t,r,i){if(gi(t)){var s=!0;fg(e)}else s=!1;if(mu(e,i),e.stateNode===null)Km(n,e),iN(e,t,r),s1(e,t,r,i),r=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=is(u):(u=gi(t)?jl:Or.current,u=Su(e,u));var f=t.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||c!==u)&&BM(e,a,r,u),no=!1;var m=e.memoizedState;a.state=m,yg(e,r,a,i),c=e.memoizedState,o!==r||m!==c||mi.current||no?(typeof f=="function"&&(i1(e,t,f,r),c=e.memoizedState),(o=no||PM(e,t,o,r,m,c,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,kT(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:xs(e.type,o),a.props=u,p=e.pendingProps,m=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=is(c):(c=gi(t)?jl:Or.current,c=Su(e,c));var g=t.getDerivedStateFromProps;(f=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||m!==c)&&BM(e,a,r,c),no=!1,m=e.memoizedState,a.state=m,yg(e,r,a,i);var y=e.memoizedState;o!==p||m!==y||mi.current||no?(typeof g=="function"&&(i1(e,t,g,r),y=e.memoizedState),(u=no||PM(e,t,u,r,m,y,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return l1(n,e,t,r,s,i)}function l1(n,e,t,r,i,s){cN(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&AM(e,t,!1),Na(n,e,s);r=e.stateNode,NL.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=Mu(e,n.child,null,s),e.child=Mu(e,null,o,s)):Kr(n,e,o,s),e.memoizedState=r.state,i&&AM(e,t,!0),e.child}function uN(n){var e=n.stateNode;e.pendingContext?SM(n,e.pendingContext,e.pendingContext!==e.context):e.context&&SM(n,e.context,!1),Tb(n,e.containerInfo)}function OM(n,e,t,r,i){return Au(),wb(i),e.flags|=256,Kr(n,e,t,r),e.child}var c1={dehydrated:null,treeContext:null,retryLane:0};function u1(n){return{baseLanes:n,cachePool:null,transitions:null}}function dN(n,e,t){var r=e.pendingProps,i=Rn.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),_n(Rn,i&1),n===null)return n1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=U0(a,r,0,null),n=Bl(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=u1(t),e.memoizedState=c1,n):Fb(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return RL(n,e,a,r,o,i,t);if(s){s=r.fallback,a=e.mode,i=n.child,o=i.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=So(i,c),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=So(o,s):(s=Bl(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=n.child.memoizedState,a=a===null?u1(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=c1,r}return s=n.child,n=s.sibling,r=So(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Fb(n,e){return e=U0({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Up(n,e,t,r){return r!==null&&wb(r),Mu(e,n.child,null,t),n=Fb(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function RL(n,e,t,r,i,s,a){if(t)return e.flags&256?(e.flags&=-257,r=uv(Error(Je(422))),Up(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=U0({mode:"visible",children:r.children},i,0,null),s=Bl(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Mu(e,n.child,null,a),e.child.memoizedState=u1(a),e.memoizedState=c1,s);if(!(e.mode&1))return Up(n,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Je(419)),r=uv(s,r,void 0),Up(n,e,a,r)}if(o=(a&n.childLanes)!==0,fi||o){if(r=xr,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ta(n,i),Ss(r,n,i,-1))}return Hb(),r=uv(Error(Je(421))),Up(n,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=GL.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Ni=vo(i.nextSibling),Ii=e,Mn=!0,vs=null,n!==null&&(Zi[qi++]=_a,Zi[qi++]=ba,Zi[qi++]=Ul,_a=n.id,ba=n.overflow,Ul=e),e=Fb(e,r.children),e.flags|=4096,e)}function zM(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),r1(n.return,e,t)}function dv(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function hN(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Kr(n,e,r.children,t),r=Rn.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&zM(n,t,e);else if(n.tag===19)zM(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(_n(Rn,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&vg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),dv(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&vg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}dv(e,!0,t,null,s);break;case"together":dv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Km(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Na(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),zl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Je(153));if(e.child!==null){for(n=e.child,t=So(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=So(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function IL(n,e,t){switch(e.tag){case 3:uN(e),Au();break;case 5:jT(e);break;case 1:gi(e.type)&&fg(e);break;case 4:Tb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;_n(gg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_n(Rn,Rn.current&1),e.flags|=128,null):t&e.child.childLanes?dN(n,e,t):(_n(Rn,Rn.current&1),n=Na(n,e,t),n!==null?n.sibling:null);_n(Rn,Rn.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return hN(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),_n(Rn,Rn.current),r)break;return null;case 22:case 23:return e.lanes=0,lN(n,e,t)}return Na(n,e,t)}var fN,d1,pN,mN;fN=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};d1=function(){};pN=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Sl(qs.current);var s=null;switch(t){case"input":i=B_(n,i),r=B_(n,r),s=[];break;case"select":i=Ln({},i,{value:void 0}),r=Ln({},r,{value:void 0}),s=[];break;case"textarea":i=F_(n,i),r=F_(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=dg)}j_(t,r);var a;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ch.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(s||(s=[]),s.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ch.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&bn("scroll",n),s||o===c||(s=[])):(s=s||[]).push(u,c))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};mN=function(n,e,t,r){t!==r&&(e.flags|=4)};function Pd(n,e){if(!Mn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Lr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function PL(n,e,t){var r=e.pendingProps;switch(bb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lr(e),null;case 1:return gi(e.type)&&hg(),Lr(e),null;case 3:return r=e.stateNode,Cu(),Sn(mi),Sn(Or),Rb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(kp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vs!==null&&(v1(vs),vs=null))),d1(n,e),Lr(e),null;case 5:Nb(e);var i=Sl(jh.current);if(t=e.type,n!==null&&e.stateNode!=null)pN(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Je(166));return Lr(e),null}if(n=Sl(qs.current),kp(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Js]=e,r[Fh]=s,n=(e.mode&1)!==0,t){case"dialog":bn("cancel",r),bn("close",r);break;case"iframe":case"object":case"embed":bn("load",r);break;case"video":case"audio":for(i=0;i<nh.length;i++)bn(nh[i],r);break;case"source":bn("error",r);break;case"img":case"image":case"link":bn("error",r),bn("load",r);break;case"details":bn("toggle",r);break;case"input":ZA(r,s),bn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},bn("invalid",r);break;case"textarea":QA(r,s),bn("invalid",r)}j_(t,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&Fp(r.textContent,o,n),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Fp(r.textContent,o,n),i=["children",""+o]):Ch.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&bn("scroll",r)}switch(t){case"input":Tp(r),qA(r,s,!0);break;case"textarea":Tp(r),$A(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=dg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=G2(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[Js]=e,n[Fh]=r,fN(n,e,!1,!1),e.stateNode=n;e:{switch(a=U_(t,r),t){case"dialog":bn("cancel",n),bn("close",n),i=r;break;case"iframe":case"object":case"embed":bn("load",n),i=r;break;case"video":case"audio":for(i=0;i<nh.length;i++)bn(nh[i],n);i=r;break;case"source":bn("error",n),i=r;break;case"img":case"image":case"link":bn("error",n),bn("load",n),i=r;break;case"details":bn("toggle",n),i=r;break;case"input":ZA(n,r),i=B_(n,r),bn("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Ln({},r,{value:void 0}),bn("invalid",n);break;case"textarea":QA(n,r),i=F_(n,r),bn("invalid",n);break;default:i=r}j_(t,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?X2(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&V2(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Eh(n,c):typeof c=="number"&&Eh(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ch.hasOwnProperty(s)?c!=null&&s==="onScroll"&&bn("scroll",n):c!=null&&ab(n,s,c,a))}switch(t){case"input":Tp(n),qA(n,r,!1);break;case"textarea":Tp(n),$A(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Eo(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?du(n,!!r.multiple,s,!1):r.defaultValue!=null&&du(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=dg)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Lr(e),null;case 6:if(n&&e.stateNode!=null)mN(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Je(166));if(t=Sl(jh.current),Sl(qs.current),kp(e)){if(r=e.stateNode,t=e.memoizedProps,r[Js]=e,(s=r.nodeValue!==t)&&(n=Ii,n!==null))switch(n.tag){case 3:Fp(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Fp(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Js]=e,e.stateNode=r}return Lr(e),null;case 13:if(Sn(Rn),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Mn&&Ni!==null&&e.mode&1&&!(e.flags&128))BT(),Au(),e.flags|=98560,s=!1;else if(s=kp(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(Je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Je(317));s[Js]=e}else Au(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Lr(e),s=!1}else vs!==null&&(v1(vs),vs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Rn.current&1?rr===0&&(rr=3):Hb())),e.updateQueue!==null&&(e.flags|=4),Lr(e),null);case 4:return Cu(),d1(n,e),n===null&&Lh(e.stateNode.containerInfo),Lr(e),null;case 10:return Mb(e.type._context),Lr(e),null;case 17:return gi(e.type)&&hg(),Lr(e),null;case 19:if(Sn(Rn),s=e.memoizedState,s===null)return Lr(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Pd(s,!1);else{if(rr!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=vg(n),a!==null){for(e.flags|=128,Pd(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return _n(Rn,Rn.current&1|2),e.child}n=n.sibling}s.tail!==null&&Xn()>Tu&&(e.flags|=128,r=!0,Pd(s,!1),e.lanes=4194304)}else{if(!r)if(n=vg(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Pd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Mn)return Lr(e),null}else 2*Xn()-s.renderingStartTime>Tu&&t!==1073741824&&(e.flags|=128,r=!0,Pd(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Xn(),e.sibling=null,t=Rn.current,_n(Rn,r?t&1|2:t&1),e):(Lr(e),null);case 22:case 23:return zb(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ei&1073741824&&(Lr(e),e.subtreeFlags&6&&(e.flags|=8192)):Lr(e),null;case 24:return null;case 25:return null}throw Error(Je(156,e.tag))}function BL(n,e){switch(bb(e),e.tag){case 1:return gi(e.type)&&hg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Cu(),Sn(mi),Sn(Or),Rb(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Nb(e),null;case 13:if(Sn(Rn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Je(340));Au()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Sn(Rn),null;case 4:return Cu(),null;case 10:return Mb(e.type._context),null;case 22:case 23:return zb(),null;case 24:return null;default:return null}}var Op=!1,jr=!1,LL=typeof WeakSet=="function"?WeakSet:Set,bt=null;function su(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){jn(n,e,r)}else t.current=null}function h1(n,e,t){try{t()}catch(r){jn(n,e,r)}}var HM=!1;function DL(n,e){if(K_=lg,n=_T(),vb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,u=0,f=0,p=n,m=null;t:for(;;){for(var g;p!==t||i!==0&&p.nodeType!==3||(o=a+i),p!==s||r!==0&&p.nodeType!==3||(c=a+r),p.nodeType===3&&(a+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===n)break t;if(m===t&&++u===i&&(o=a),m===s&&++f===r&&(c=a),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Z_={focusedElem:n,selectionRange:t},lg=!1,bt=e;bt!==null;)if(e=bt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,bt=n;else for(;bt!==null;){e=bt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var S=y.memoizedProps,w=y.memoizedState,x=e.stateNode,_=x.getSnapshotBeforeUpdate(e.elementType===e.type?S:xs(e.type,S),w);x.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(M){jn(e,e.return,M)}if(n=e.sibling,n!==null){n.return=e.return,bt=n;break}bt=e.return}return y=HM,HM=!1,y}function ph(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&h1(e,t,s)}i=i.next}while(i!==r)}}function k0(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function f1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function gN(n){var e=n.alternate;e!==null&&(n.alternate=null,gN(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Js],delete e[Fh],delete e[$_],delete e[xL],delete e[yL])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function xN(n){return n.tag===5||n.tag===3||n.tag===4}function GM(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||xN(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function p1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=dg));else if(r!==4&&(n=n.child,n!==null))for(p1(n,e,t),n=n.sibling;n!==null;)p1(n,e,t),n=n.sibling}function m1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(m1(n,e,t),n=n.sibling;n!==null;)m1(n,e,t),n=n.sibling}var br=null,ys=!1;function Va(n,e,t){for(t=t.child;t!==null;)yN(n,e,t),t=t.sibling}function yN(n,e,t){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(N0,t)}catch{}switch(t.tag){case 5:jr||su(t,e);case 6:var r=br,i=ys;br=null,Va(n,e,t),br=r,ys=i,br!==null&&(ys?(n=br,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):br.removeChild(t.stateNode));break;case 18:br!==null&&(ys?(n=br,t=t.stateNode,n.nodeType===8?iv(n.parentNode,t):n.nodeType===1&&iv(n,t),Ih(n)):iv(br,t.stateNode));break;case 4:r=br,i=ys,br=t.stateNode.containerInfo,ys=!0,Va(n,e,t),br=r,ys=i;break;case 0:case 11:case 14:case 15:if(!jr&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&h1(t,e,a),i=i.next}while(i!==r)}Va(n,e,t);break;case 1:if(!jr&&(su(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){jn(t,e,o)}Va(n,e,t);break;case 21:Va(n,e,t);break;case 22:t.mode&1?(jr=(r=jr)||t.memoizedState!==null,Va(n,e,t),jr=r):Va(n,e,t);break;default:Va(n,e,t)}}function VM(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new LL),e.forEach(function(r){var i=VL.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function hs(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:br=o.stateNode,ys=!1;break e;case 3:br=o.stateNode.containerInfo,ys=!0;break e;case 4:br=o.stateNode.containerInfo,ys=!0;break e}o=o.return}if(br===null)throw Error(Je(160));yN(s,a,i),br=null,ys=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){jn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vN(e,n),e=e.sibling}function vN(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(hs(e,n),js(n),r&4){try{ph(3,n,n.return),k0(3,n)}catch(S){jn(n,n.return,S)}try{ph(5,n,n.return)}catch(S){jn(n,n.return,S)}}break;case 1:hs(e,n),js(n),r&512&&t!==null&&su(t,t.return);break;case 5:if(hs(e,n),js(n),r&512&&t!==null&&su(t,t.return),n.flags&32){var i=n.stateNode;try{Eh(i,"")}catch(S){jn(n,n.return,S)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&z2(i,s),U_(o,a);var u=U_(o,s);for(a=0;a<c.length;a+=2){var f=c[a],p=c[a+1];f==="style"?X2(i,p):f==="dangerouslySetInnerHTML"?V2(i,p):f==="children"?Eh(i,p):ab(i,f,p,u)}switch(o){case"input":L_(i,s);break;case"textarea":H2(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?du(i,!!s.multiple,g,!1):m!==!!s.multiple&&(s.defaultValue!=null?du(i,!!s.multiple,s.defaultValue,!0):du(i,!!s.multiple,s.multiple?[]:"",!1))}i[Fh]=s}catch(S){jn(n,n.return,S)}}break;case 6:if(hs(e,n),js(n),r&4){if(n.stateNode===null)throw Error(Je(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(S){jn(n,n.return,S)}}break;case 3:if(hs(e,n),js(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Ih(e.containerInfo)}catch(S){jn(n,n.return,S)}break;case 4:hs(e,n),js(n);break;case 13:hs(e,n),js(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ub=Xn())),r&4&&VM(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?(jr=(u=jr)||f,hs(e,n),jr=u):hs(e,n),js(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!f&&n.mode&1)for(bt=n,f=n.child;f!==null;){for(p=bt=f;bt!==null;){switch(m=bt,g=m.child,m.tag){case 0:case 11:case 14:case 15:ph(4,m,m.return);break;case 1:su(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(S){jn(r,t,S)}}break;case 5:su(m,m.return);break;case 22:if(m.memoizedState!==null){XM(p);continue}}g!==null?(g.return=m,bt=g):XM(p)}f=f.sibling}e:for(f=null,p=n;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,c=p.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=W2("display",a))}catch(S){jn(n,n.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(S){jn(n,n.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:hs(e,n),js(n),r&4&&VM(n);break;case 21:break;default:hs(e,n),js(n)}}function js(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(xN(t)){var r=t;break e}t=t.return}throw Error(Je(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Eh(i,""),r.flags&=-33);var s=GM(n);m1(n,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=GM(n);p1(n,o,a);break;default:throw Error(Je(161))}}catch(c){jn(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function FL(n,e,t){bt=n,_N(n)}function _N(n,e,t){for(var r=(n.mode&1)!==0;bt!==null;){var i=bt,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Op;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||jr;o=Op;var u=jr;if(Op=a,(jr=c)&&!u)for(bt=i;bt!==null;)a=bt,c=a.child,a.tag===22&&a.memoizedState!==null?JM(i):c!==null?(c.return=a,bt=c):JM(i);for(;s!==null;)bt=s,_N(s),s=s.sibling;bt=i,Op=o,jr=u}WM(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,bt=s):WM(n)}}function WM(n){for(;bt!==null;){var e=bt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jr||k0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jr)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:xs(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&NM(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}NM(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Ih(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}jr||e.flags&512&&f1(e)}catch(m){jn(e,e.return,m)}}if(e===n){bt=null;break}if(t=e.sibling,t!==null){t.return=e.return,bt=t;break}bt=e.return}}function XM(n){for(;bt!==null;){var e=bt;if(e===n){bt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,bt=t;break}bt=e.return}}function JM(n){for(;bt!==null;){var e=bt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{k0(4,e)}catch(c){jn(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){jn(e,i,c)}}var s=e.return;try{f1(e)}catch(c){jn(e,s,c)}break;case 5:var a=e.return;try{f1(e)}catch(c){jn(e,a,c)}}}catch(c){jn(e,e.return,c)}if(e===n){bt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,bt=o;break}bt=e.return}}var kL=Math.ceil,wg=Pa.ReactCurrentDispatcher,kb=Pa.ReactCurrentOwner,ts=Pa.ReactCurrentBatchConfig,on=0,xr=null,$n=null,wr=0,Ei=0,au=Fo(0),rr=0,Hh=null,zl=0,j0=0,jb=0,mh=null,ui=null,Ub=0,Tu=1/0,ma=null,Sg=!1,g1=null,bo=null,zp=!1,co=null,Ag=0,gh=0,x1=null,Zm=-1,qm=0;function $r(){return on&6?Xn():Zm!==-1?Zm:Zm=Xn()}function wo(n){return n.mode&1?on&2&&wr!==0?wr&-wr:_L.transition!==null?(qm===0&&(qm=iT()),qm):(n=gn,n!==0||(n=window.event,n=n===void 0?16:dT(n.type)),n):1}function Ss(n,e,t,r){if(50<gh)throw gh=0,x1=null,Error(Je(185));cf(n,t,r),(!(on&2)||n!==xr)&&(n===xr&&(!(on&2)&&(j0|=t),rr===4&&so(n,wr)),xi(n,r),t===1&&on===0&&!(e.mode&1)&&(Tu=Xn()+500,L0&&ko()))}function xi(n,e){var t=n.callbackNode;_B(n,e);var r=og(n,n===xr?wr:0);if(r===0)t!==null&&nM(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&nM(t),e===1)n.tag===0?vL(YM.bind(null,n)):RT(YM.bind(null,n)),mL(function(){!(on&6)&&ko()}),t=null;else{switch(sT(r)){case 1:t=db;break;case 4:t=nT;break;case 16:t=ag;break;case 536870912:t=rT;break;default:t=ag}t=TN(t,bN.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function bN(n,e){if(Zm=-1,qm=0,on&6)throw Error(Je(327));var t=n.callbackNode;if(gu()&&n.callbackNode!==t)return null;var r=og(n,n===xr?wr:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Mg(n,r);else{e=r;var i=on;on|=2;var s=SN();(xr!==n||wr!==e)&&(ma=null,Tu=Xn()+500,Pl(n,e));do try{OL();break}catch(o){wN(n,o)}while(!0);Ab(),wg.current=s,on=i,$n!==null?e=0:(xr=null,wr=0,e=rr)}if(e!==0){if(e===2&&(i=V_(n),i!==0&&(r=i,e=y1(n,i))),e===1)throw t=Hh,Pl(n,0),so(n,r),xi(n,Xn()),t;if(e===6)so(n,r);else{if(i=n.current.alternate,!(r&30)&&!jL(i)&&(e=Mg(n,r),e===2&&(s=V_(n),s!==0&&(r=s,e=y1(n,s))),e===1))throw t=Hh,Pl(n,0),so(n,r),xi(n,Xn()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(Je(345));case 2:gl(n,ui,ma);break;case 3:if(so(n,r),(r&130023424)===r&&(e=Ub+500-Xn(),10<e)){if(og(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){$r(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Q_(gl.bind(null,n,ui,ma),e);break}gl(n,ui,ma);break;case 4:if(so(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var a=31-ws(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=Xn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kL(r/1960))-r,10<r){n.timeoutHandle=Q_(gl.bind(null,n,ui,ma),r);break}gl(n,ui,ma);break;case 5:gl(n,ui,ma);break;default:throw Error(Je(329))}}}return xi(n,Xn()),n.callbackNode===t?bN.bind(null,n):null}function y1(n,e){var t=mh;return n.current.memoizedState.isDehydrated&&(Pl(n,e).flags|=256),n=Mg(n,e),n!==2&&(e=ui,ui=t,e!==null&&v1(e)),n}function v1(n){ui===null?ui=n:ui.push.apply(ui,n)}function jL(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Ms(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function so(n,e){for(e&=~jb,e&=~j0,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ws(e),r=1<<t;n[t]=-1,e&=~r}}function YM(n){if(on&6)throw Error(Je(327));gu();var e=og(n,0);if(!(e&1))return xi(n,Xn()),null;var t=Mg(n,e);if(n.tag!==0&&t===2){var r=V_(n);r!==0&&(e=r,t=y1(n,r))}if(t===1)throw t=Hh,Pl(n,0),so(n,e),xi(n,Xn()),t;if(t===6)throw Error(Je(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,gl(n,ui,ma),xi(n,Xn()),null}function Ob(n,e){var t=on;on|=1;try{return n(e)}finally{on=t,on===0&&(Tu=Xn()+500,L0&&ko())}}function Hl(n){co!==null&&co.tag===0&&!(on&6)&&gu();var e=on;on|=1;var t=ts.transition,r=gn;try{if(ts.transition=null,gn=1,n)return n()}finally{gn=r,ts.transition=t,on=e,!(on&6)&&ko()}}function zb(){Ei=au.current,Sn(au)}function Pl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,pL(t)),$n!==null)for(t=$n.return;t!==null;){var r=t;switch(bb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hg();break;case 3:Cu(),Sn(mi),Sn(Or),Rb();break;case 5:Nb(r);break;case 4:Cu();break;case 13:Sn(Rn);break;case 19:Sn(Rn);break;case 10:Mb(r.type._context);break;case 22:case 23:zb()}t=t.return}if(xr=n,$n=n=So(n.current,null),wr=Ei=e,rr=0,Hh=null,jb=j0=zl=0,ui=mh=null,wl!==null){for(e=0;e<wl.length;e++)if(t=wl[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}t.pending=r}wl=null}return n}function wN(n,e){do{var t=$n;try{if(Ab(),Jm.current=bg,_g){for(var r=Bn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}_g=!1}if(Ol=0,mr=nr=Bn=null,fh=!1,Uh=0,kb.current=null,t===null||t.return===null){rr=1,Hh=e,$n=null;break}e:{var s=n,a=t.return,o=t,c=e;if(e=wr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var g=DM(a);if(g!==null){g.flags&=-257,FM(g,a,o,s,e),g.mode&1&&LM(s,u,e),e=g,c=u;var y=e.updateQueue;if(y===null){var S=new Set;S.add(c),e.updateQueue=S}else y.add(c);break e}else{if(!(e&1)){LM(s,u,e),Hb();break e}c=Error(Je(426))}}else if(Mn&&o.mode&1){var w=DM(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),FM(w,a,o,s,e),wb(Eu(c,o));break e}}s=c=Eu(c,o),rr!==4&&(rr=2),mh===null?mh=[s]:mh.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=sN(s,c,e);TM(s,x);break e;case 1:o=c;var _=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(bo===null||!bo.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=aN(s,o,e);TM(s,M);break e}}s=s.return}while(s!==null)}MN(t)}catch(N){e=N,$n===t&&t!==null&&($n=t=t.return);continue}break}while(!0)}function SN(){var n=wg.current;return wg.current=bg,n===null?bg:n}function Hb(){(rr===0||rr===3||rr===2)&&(rr=4),xr===null||!(zl&268435455)&&!(j0&268435455)||so(xr,wr)}function Mg(n,e){var t=on;on|=2;var r=SN();(xr!==n||wr!==e)&&(ma=null,Pl(n,e));do try{UL();break}catch(i){wN(n,i)}while(!0);if(Ab(),on=t,wg.current=r,$n!==null)throw Error(Je(261));return xr=null,wr=0,rr}function UL(){for(;$n!==null;)AN($n)}function OL(){for(;$n!==null&&!dB();)AN($n)}function AN(n){var e=EN(n.alternate,n,Ei);n.memoizedProps=n.pendingProps,e===null?MN(n):$n=e,kb.current=null}function MN(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=BL(t,e),t!==null){t.flags&=32767,$n=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{rr=6,$n=null;return}}else if(t=PL(t,e,Ei),t!==null){$n=t;return}if(e=e.sibling,e!==null){$n=e;return}$n=e=n}while(e!==null);rr===0&&(rr=5)}function gl(n,e,t){var r=gn,i=ts.transition;try{ts.transition=null,gn=1,zL(n,e,t,r)}finally{ts.transition=i,gn=r}return null}function zL(n,e,t,r){do gu();while(co!==null);if(on&6)throw Error(Je(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Je(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(bB(n,s),n===xr&&($n=xr=null,wr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||zp||(zp=!0,TN(ag,function(){return gu(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ts.transition,ts.transition=null;var a=gn;gn=1;var o=on;on|=4,kb.current=null,DL(n,t),vN(t,n),oL(Z_),lg=!!K_,Z_=K_=null,n.current=t,FL(t),hB(),on=o,gn=a,ts.transition=s}else n.current=t;if(zp&&(zp=!1,co=n,Ag=i),s=n.pendingLanes,s===0&&(bo=null),mB(t.stateNode),xi(n,Xn()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Sg)throw Sg=!1,n=g1,g1=null,n;return Ag&1&&n.tag!==0&&gu(),s=n.pendingLanes,s&1?n===x1?gh++:(gh=0,x1=n):gh=0,ko(),null}function gu(){if(co!==null){var n=sT(Ag),e=ts.transition,t=gn;try{if(ts.transition=null,gn=16>n?16:n,co===null)var r=!1;else{if(n=co,co=null,Ag=0,on&6)throw Error(Je(331));var i=on;for(on|=4,bt=n.current;bt!==null;){var s=bt,a=s.child;if(bt.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(bt=u;bt!==null;){var f=bt;switch(f.tag){case 0:case 11:case 15:ph(8,f,s)}var p=f.child;if(p!==null)p.return=f,bt=p;else for(;bt!==null;){f=bt;var m=f.sibling,g=f.return;if(gN(f),f===u){bt=null;break}if(m!==null){m.return=g,bt=m;break}bt=g}}}var y=s.alternate;if(y!==null){var S=y.child;if(S!==null){y.child=null;do{var w=S.sibling;S.sibling=null,S=w}while(S!==null)}}bt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,bt=a;else e:for(;bt!==null;){if(s=bt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ph(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,bt=x;break e}bt=s.return}}var _=n.current;for(bt=_;bt!==null;){a=bt;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,bt=b;else e:for(a=_;bt!==null;){if(o=bt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:k0(9,o)}}catch(N){jn(o,o.return,N)}if(o===a){bt=null;break e}var M=o.sibling;if(M!==null){M.return=o.return,bt=M;break e}bt=o.return}}if(on=i,ko(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(N0,n)}catch{}r=!0}return r}finally{gn=t,ts.transition=e}}return!1}function KM(n,e,t){e=Eu(t,e),e=sN(n,e,1),n=_o(n,e,1),e=$r(),n!==null&&(cf(n,1,e),xi(n,e))}function jn(n,e,t){if(n.tag===3)KM(n,n,t);else for(;e!==null;){if(e.tag===3){KM(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(bo===null||!bo.has(r))){n=Eu(t,n),n=aN(e,n,1),e=_o(e,n,1),n=$r(),e!==null&&(cf(e,1,n),xi(e,n));break}}e=e.return}}function HL(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=$r(),n.pingedLanes|=n.suspendedLanes&t,xr===n&&(wr&t)===t&&(rr===4||rr===3&&(wr&130023424)===wr&&500>Xn()-Ub?Pl(n,0):jb|=t),xi(n,e)}function CN(n,e){e===0&&(n.mode&1?(e=Ip,Ip<<=1,!(Ip&130023424)&&(Ip=4194304)):e=1);var t=$r();n=Ta(n,e),n!==null&&(cf(n,e,t),xi(n,t))}function GL(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),CN(n,t)}function VL(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(Je(314))}r!==null&&r.delete(e),CN(n,t)}var EN;EN=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||mi.current)fi=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return fi=!1,IL(n,e,t);fi=!!(n.flags&131072)}else fi=!1,Mn&&e.flags&1048576&&IT(e,mg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Km(n,e),n=e.pendingProps;var i=Su(e,Or.current);mu(e,t),i=Pb(null,e,r,n,i,t);var s=Bb();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gi(r)?(s=!0,fg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Eb(e),i.updater=F0,e.stateNode=i,i._reactInternals=e,s1(e,r,n,t),e=l1(null,e,r,!0,s,t)):(e.tag=0,Mn&&s&&_b(e),Kr(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Km(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=XL(r),n=xs(r,n),i){case 0:e=o1(null,e,r,n,t);break e;case 1:e=UM(null,e,r,n,t);break e;case 11:e=kM(null,e,r,n,t);break e;case 14:e=jM(null,e,r,xs(r.type,n),t);break e}throw Error(Je(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xs(r,i),o1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xs(r,i),UM(n,e,r,i,t);case 3:e:{if(uN(e),n===null)throw Error(Je(387));r=e.pendingProps,s=e.memoizedState,i=s.element,kT(n,e),yg(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Eu(Error(Je(423)),e),e=OM(n,e,r,t,i);break e}else if(r!==i){i=Eu(Error(Je(424)),e),e=OM(n,e,r,t,i);break e}else for(Ni=vo(e.stateNode.containerInfo.firstChild),Ii=e,Mn=!0,vs=null,t=DT(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Au(),r===i){e=Na(n,e,t);break e}Kr(n,e,r,t)}e=e.child}return e;case 5:return jT(e),n===null&&n1(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,a=i.children,q_(r,i)?a=null:s!==null&&q_(r,s)&&(e.flags|=32),cN(n,e),Kr(n,e,a,t),e.child;case 6:return n===null&&n1(e),null;case 13:return dN(n,e,t);case 4:return Tb(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Mu(e,null,r,t):Kr(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xs(r,i),kM(n,e,r,i,t);case 7:return Kr(n,e,e.pendingProps,t),e.child;case 8:return Kr(n,e,e.pendingProps.children,t),e.child;case 12:return Kr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,_n(gg,r._currentValue),r._currentValue=a,s!==null)if(Ms(s.value,a)){if(s.children===i.children&&!mi.current){e=Na(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Sa(-1,t&-t),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),r1(s.return,t,e),o.lanes|=t;break}c=c.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Je(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),r1(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Kr(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,mu(e,t),i=is(i),r=r(i),e.flags|=1,Kr(n,e,r,t),e.child;case 14:return r=e.type,i=xs(r,e.pendingProps),i=xs(r.type,i),jM(n,e,r,i,t);case 15:return oN(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xs(r,i),Km(n,e),e.tag=1,gi(r)?(n=!0,fg(e)):n=!1,mu(e,t),iN(e,r,i),s1(e,r,i,t),l1(null,e,r,!0,n,t);case 19:return hN(n,e,t);case 22:return lN(n,e,t)}throw Error(Je(156,e.tag))};function TN(n,e){return tT(n,e)}function WL(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $i(n,e,t,r){return new WL(n,e,t,r)}function Gb(n){return n=n.prototype,!(!n||!n.isReactComponent)}function XL(n){if(typeof n=="function")return Gb(n)?1:0;if(n!=null){if(n=n.$$typeof,n===lb)return 11;if(n===cb)return 14}return 2}function So(n,e){var t=n.alternate;return t===null?(t=$i(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Qm(n,e,t,r,i,s){var a=2;if(r=n,typeof n=="function")Gb(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Zc:return Bl(t.children,i,s,e);case ob:a=8,i|=8;break;case N_:return n=$i(12,t,e,i|2),n.elementType=N_,n.lanes=s,n;case R_:return n=$i(13,t,e,i),n.elementType=R_,n.lanes=s,n;case I_:return n=$i(19,t,e,i),n.elementType=I_,n.lanes=s,n;case j2:return U0(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case F2:a=10;break e;case k2:a=9;break e;case lb:a=11;break e;case cb:a=14;break e;case to:a=16,r=null;break e}throw Error(Je(130,n==null?n:typeof n,""))}return e=$i(a,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Bl(n,e,t,r){return n=$i(7,n,r,e),n.lanes=t,n}function U0(n,e,t,r){return n=$i(22,n,r,e),n.elementType=j2,n.lanes=t,n.stateNode={isHidden:!1},n}function hv(n,e,t){return n=$i(6,n,null,e),n.lanes=t,n}function fv(n,e,t){return e=$i(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function JL(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jy(0),this.expirationTimes=Jy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jy(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vb(n,e,t,r,i,s,a,o,c){return n=new JL(n,e,t,o,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=$i(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Eb(s),n}function YL(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kc,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function NN(n){if(!n)return To;n=n._reactInternals;e:{if(ec(n)!==n||n.tag!==1)throw Error(Je(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Je(171))}if(n.tag===1){var t=n.type;if(gi(t))return NT(n,t,e)}return e}function RN(n,e,t,r,i,s,a,o,c){return n=Vb(t,r,!0,n,i,s,a,o,c),n.context=NN(null),t=n.current,r=$r(),i=wo(t),s=Sa(r,i),s.callback=e??null,_o(t,s,i),n.current.lanes=i,cf(n,i,r),xi(n,r),n}function O0(n,e,t,r){var i=e.current,s=$r(),a=wo(i);return t=NN(t),e.context===null?e.context=t:e.pendingContext=t,e=Sa(s,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=_o(i,e,a),n!==null&&(Ss(n,i,a,s),Xm(n,i,a)),a}function Cg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function ZM(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Wb(n,e){ZM(n,e),(n=n.alternate)&&ZM(n,e)}function KL(){return null}var IN=typeof reportError=="function"?reportError:function(n){console.error(n)};function Xb(n){this._internalRoot=n}z0.prototype.render=Xb.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Je(409));O0(n,e,null,null)};z0.prototype.unmount=Xb.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Hl(function(){O0(null,n,null,null)}),e[Ea]=null}};function z0(n){this._internalRoot=n}z0.prototype.unstable_scheduleHydration=function(n){if(n){var e=lT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<io.length&&e!==0&&e<io[t].priority;t++);io.splice(t,0,n),t===0&&uT(n)}};function Jb(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function H0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function qM(){}function ZL(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Cg(a);s.call(u)}}var a=RN(e,r,n,0,null,!1,!1,"",qM);return n._reactRootContainer=a,n[Ea]=a.current,Lh(n.nodeType===8?n.parentNode:n),Hl(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=Cg(c);o.call(u)}}var c=Vb(n,0,!1,null,null,!1,!1,"",qM);return n._reactRootContainer=c,n[Ea]=c.current,Lh(n.nodeType===8?n.parentNode:n),Hl(function(){O0(e,c,t,r)}),c}function G0(n,e,t,r,i){var s=t._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var c=Cg(a);o.call(c)}}O0(e,a,n,i)}else a=ZL(t,e,n,i,r);return Cg(a)}aT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=th(e.pendingLanes);t!==0&&(hb(e,t|1),xi(e,Xn()),!(on&6)&&(Tu=Xn()+500,ko()))}break;case 13:Hl(function(){var r=Ta(n,1);if(r!==null){var i=$r();Ss(r,n,1,i)}}),Wb(n,1)}};fb=function(n){if(n.tag===13){var e=Ta(n,134217728);if(e!==null){var t=$r();Ss(e,n,134217728,t)}Wb(n,134217728)}};oT=function(n){if(n.tag===13){var e=wo(n),t=Ta(n,e);if(t!==null){var r=$r();Ss(t,n,e,r)}Wb(n,e)}};lT=function(){return gn};cT=function(n,e){var t=gn;try{return gn=n,e()}finally{gn=t}};z_=function(n,e,t){switch(e){case"input":if(L_(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=B0(r);if(!i)throw Error(Je(90));O2(r),L_(r,i)}}}break;case"textarea":H2(n,t);break;case"select":e=t.value,e!=null&&du(n,!!t.multiple,e,!1)}};K2=Ob;Z2=Hl;var qL={usingClientEntryPoint:!1,Events:[df,eu,B0,J2,Y2,Ob]},Bd={findFiberByHostInstance:bl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QL={bundleType:Bd.bundleType,version:Bd.version,rendererPackageName:Bd.rendererPackageName,rendererConfig:Bd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pa.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=$2(n),n===null?null:n.stateNode},findFiberByHostInstance:Bd.findFiberByHostInstance||KL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hp.isDisabled&&Hp.supportsFiber)try{N0=Hp.inject(QL),Zs=Hp}catch{}}ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qL;ji.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jb(e))throw Error(Je(200));return YL(n,e,null,t)};ji.createRoot=function(n,e){if(!Jb(n))throw Error(Je(299));var t=!1,r="",i=IN;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Vb(n,1,!1,null,null,t,!1,r,i),n[Ea]=e.current,Lh(n.nodeType===8?n.parentNode:n),new Xb(e)};ji.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Je(188)):(n=Object.keys(n).join(","),Error(Je(268,n)));return n=$2(e),n=n===null?null:n.stateNode,n};ji.flushSync=function(n){return Hl(n)};ji.hydrate=function(n,e,t){if(!H0(e))throw Error(Je(200));return G0(null,n,e,!0,t)};ji.hydrateRoot=function(n,e,t){if(!Jb(n))throw Error(Je(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",a=IN;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=RN(e,null,n,1,t??null,i,!1,s,a),n[Ea]=e.current,Lh(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new z0(e)};ji.render=function(n,e,t){if(!H0(e))throw Error(Je(200));return G0(null,n,e,!1,t)};ji.unmountComponentAtNode=function(n){if(!H0(n))throw Error(Je(40));return n._reactRootContainer?(Hl(function(){G0(null,null,n,!1,function(){n._reactRootContainer=null,n[Ea]=null})}),!0):!1};ji.unstable_batchedUpdates=Ob;ji.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!H0(t))throw Error(Je(200));if(n==null||n._reactInternals===void 0)throw Error(Je(38));return G0(n,e,t,!1,r)};ji.version="18.3.1-next-f1338f8080-20240426";function PN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PN)}catch(n){console.error(n)}}PN(),P2.exports=ji;var $L=P2.exports,BN,QM=$L;BN=E_.createRoot=QM.createRoot,E_.hydrateRoot=QM.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gh(){return Gh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Gh.apply(this,arguments)}var uo;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(uo||(uo={}));const $M="popstate";function eD(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:a,hash:o}=r.location;return _1("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Eg(i)}return nD(e,t,null,n)}function zn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Yb(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tD(){return Math.random().toString(36).substr(2,8)}function eC(n,e){return{usr:n.state,key:n.key,idx:e}}function _1(n,e,t,r){return t===void 0&&(t=null),Gh({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Zu(e):e,{state:t,key:e&&e.key||r||tD()})}function Eg(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Zu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function nD(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,o=uo.Pop,c=null,u=f();u==null&&(u=0,a.replaceState(Gh({},a.state,{idx:u}),""));function f(){return(a.state||{idx:null}).idx}function p(){o=uo.Pop;let w=f(),x=w==null?null:w-u;u=w,c&&c({action:o,location:S.location,delta:x})}function m(w,x){o=uo.Push;let _=_1(S.location,w,x);u=f()+1;let b=eC(_,u),M=S.createHref(_);try{a.pushState(b,"",M)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(M)}s&&c&&c({action:o,location:S.location,delta:1})}function g(w,x){o=uo.Replace;let _=_1(S.location,w,x);u=f();let b=eC(_,u),M=S.createHref(_);a.replaceState(b,"",M),s&&c&&c({action:o,location:S.location,delta:0})}function y(w){let x=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof w=="string"?w:Eg(w);return _=_.replace(/ $/,"%20"),zn(x,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,x)}let S={get action(){return o},get location(){return n(i,a)},listen(w){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener($M,p),c=w,()=>{i.removeEventListener($M,p),c=null}},createHref(w){return e(i,w)},createURL:y,encodeLocation(w){let x=y(w);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:m,replace:g,go(w){return a.go(w)}};return S}var tC;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(tC||(tC={}));function rD(n,e,t){return t===void 0&&(t="/"),iD(n,e,t)}function iD(n,e,t,r){let i=typeof e=="string"?Zu(e):e,s=Nu(i.pathname||"/",t);if(s==null)return null;let a=LN(n);sD(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=gD(s);o=pD(a[c],u)}return o}function LN(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,o)=>{let c={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};c.relativePath.startsWith("/")&&(zn(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ao([r,c.relativePath]),f=t.concat(c);s.children&&s.children.length>0&&(zn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),LN(s.children,e,f,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:hD(u,s.index),routesMeta:f})};return n.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let c of DN(s.path))i(s,a,c)}),e}function DN(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=DN(r.join("/")),o=[];return o.push(...a.map(c=>c===""?s:[s,c].join("/"))),i&&o.push(...a),o.map(c=>n.startsWith("/")&&c===""?"/":c)}function sD(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:fD(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const aD=/^:[\w-]+$/,oD=3,lD=2,cD=1,uD=10,dD=-2,nC=n=>n==="*";function hD(n,e){let t=n.split("/"),r=t.length;return t.some(nC)&&(r+=dD),e&&(r+=lD),t.filter(i=>!nC(i)).reduce((i,s)=>i+(aD.test(s)?oD:s===""?cD:uD),r)}function fD(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function pD(n,e,t){let{routesMeta:r}=n,i={},s="/",a=[];for(let o=0;o<r.length;++o){let c=r[o],u=o===r.length-1,f=s==="/"?e:e.slice(s.length)||"/",p=b1({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),m=c.route;if(!p)return null;Object.assign(i,p.params),a.push({params:i,pathname:Ao([s,p.pathname]),pathnameBase:bD(Ao([s,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(s=Ao([s,p.pathnameBase]))}return a}function b1(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=mD(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((u,f,p)=>{let{paramName:m,isOptional:g}=f;if(m==="*"){let S=o[p]||"";a=s.slice(0,s.length-S.length).replace(/(.)\/+$/,"$1")}const y=o[p];return g&&!y?u[m]=void 0:u[m]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:n}}function mD(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Yb(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(r.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function gD(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yb(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Nu(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const xD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yD=n=>xD.test(n);function vD(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Zu(n):n,s;if(t)if(yD(t))s=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),Yb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?s=rC(t.substring(1),"/"):s=rC(t,e)}else s=e;return{pathname:s,search:wD(r),hash:SD(i)}}function rC(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function pv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _D(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function FN(n,e){let t=_D(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function kN(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Zu(n):(i=Gh({},n),zn(!i.pathname||!i.pathname.includes("?"),pv("?","pathname","search",i)),zn(!i.pathname||!i.pathname.includes("#"),pv("#","pathname","hash",i)),zn(!i.search||!i.search.includes("#"),pv("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=t;else{let p=e.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}o=p>=0?e[p]:"/"}let c=vD(i,o),u=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Ao=n=>n.join("/").replace(/\/\/+/g,"/"),bD=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),wD=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,SD=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function AD(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const jN=["post","put","patch","delete"];new Set(jN);const MD=["get",...jN];new Set(MD);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vh(){return Vh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Vh.apply(this,arguments)}const V0=F.createContext(null),UN=F.createContext(null),jo=F.createContext(null),W0=F.createContext(null),Uo=F.createContext({outlet:null,matches:[],isDataRoute:!1}),ON=F.createContext(null);function CD(n,e){let{relative:t}=e===void 0?{}:e;ff()||zn(!1);let{basename:r,navigator:i}=F.useContext(jo),{hash:s,pathname:a,search:o}=X0(n,{relative:t}),c=a;return r!=="/"&&(c=a==="/"?r:Ao([r,a])),i.createHref({pathname:c,search:o,hash:s})}function ff(){return F.useContext(W0)!=null}function qu(){return ff()||zn(!1),F.useContext(W0).location}function zN(n){F.useContext(jo).static||F.useLayoutEffect(n)}function ED(){let{isDataRoute:n}=F.useContext(Uo);return n?HD():TD()}function TD(){ff()||zn(!1);let n=F.useContext(V0),{basename:e,future:t,navigator:r}=F.useContext(jo),{matches:i}=F.useContext(Uo),{pathname:s}=qu(),a=JSON.stringify(FN(i,t.v7_relativeSplatPath)),o=F.useRef(!1);return zN(()=>{o.current=!0}),F.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){r.go(u);return}let p=kN(u,JSON.parse(a),s,f.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ao([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,a,s,n])}const ND=F.createContext(null);function RD(n){let e=F.useContext(Uo).outlet;return e&&F.createElement(ND.Provider,{value:n},e)}function X0(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=F.useContext(jo),{matches:i}=F.useContext(Uo),{pathname:s}=qu(),a=JSON.stringify(FN(i,r.v7_relativeSplatPath));return F.useMemo(()=>kN(n,JSON.parse(a),s,t==="path"),[n,a,s,t])}function ID(n,e){return PD(n,e)}function PD(n,e,t,r){ff()||zn(!1);let{navigator:i}=F.useContext(jo),{matches:s}=F.useContext(Uo),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=qu(),f;if(e){var p;let w=typeof e=="string"?Zu(e):e;c==="/"||(p=w.pathname)!=null&&p.startsWith(c)||zn(!1),f=w}else f=u;let m=f.pathname||"/",g=m;if(c!=="/"){let w=c.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=rD(n,{pathname:g}),S=kD(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Ao([c,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Ao([c,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,t,r);return e&&S?F.createElement(W0.Provider,{value:{location:Vh({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:uo.Pop}},S):S}function BD(){let n=zD(),e=AD(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),t?F.createElement("pre",{style:i},t):null,null)}const LD=F.createElement(BD,null);class DD extends F.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?F.createElement(Uo.Provider,{value:this.props.routeContext},F.createElement(ON.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FD(n){let{routeContext:e,match:t,children:r}=n,i=F.useContext(V0);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),F.createElement(Uo.Provider,{value:e},r)}function kD(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let f=a.findIndex(p=>p.route.id&&(o==null?void 0:o[p.route.id])!==void 0);f>=0||zn(!1),a=a.slice(0,Math.min(a.length,f+1))}let c=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=f),p.route.id){let{loaderData:m,errors:g}=t,y=p.route.loader&&m[p.route.id]===void 0&&(!g||g[p.route.id]===void 0);if(p.route.lazy||y){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((f,p,m)=>{let g,y=!1,S=null,w=null;t&&(g=o&&p.route.id?o[p.route.id]:void 0,S=p.route.errorElement||LD,c&&(u<0&&m===0?(GD("route-fallback"),y=!0,w=null):u===m&&(y=!0,w=p.route.hydrateFallbackElement||null)));let x=e.concat(a.slice(0,m+1)),_=()=>{let b;return g?b=S:y?b=w:p.route.Component?b=F.createElement(p.route.Component,null):p.route.element?b=p.route.element:b=f,F.createElement(FD,{match:p,routeContext:{outlet:f,matches:x,isDataRoute:t!=null},children:b})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?F.createElement(DD,{location:t.location,revalidation:t.revalidation,component:S,error:g,children:_(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):_()},null)}var HN=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(HN||{}),GN=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(GN||{});function jD(n){let e=F.useContext(V0);return e||zn(!1),e}function UD(n){let e=F.useContext(UN);return e||zn(!1),e}function OD(n){let e=F.useContext(Uo);return e||zn(!1),e}function VN(n){let e=OD(),t=e.matches[e.matches.length-1];return t.route.id||zn(!1),t.route.id}function zD(){var n;let e=F.useContext(ON),t=UD(),r=VN();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function HD(){let{router:n}=jD(HN.UseNavigateStable),e=VN(GN.UseNavigateStable),t=F.useRef(!1);return zN(()=>{t.current=!0}),F.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Vh({fromRouteId:e},s)))},[n,e])}const iC={};function GD(n,e,t){iC[n]||(iC[n]=!0)}function VD(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function WD(n){return RD(n.context)}function Jr(n){zn(!1)}function XD(n){let{basename:e="/",children:t=null,location:r,navigationType:i=uo.Pop,navigator:s,static:a=!1,future:o}=n;ff()&&zn(!1);let c=e.replace(/^\/*/,"/"),u=F.useMemo(()=>({basename:c,navigator:s,static:a,future:Vh({v7_relativeSplatPath:!1},o)}),[c,o,s,a]);typeof r=="string"&&(r=Zu(r));let{pathname:f="/",search:p="",hash:m="",state:g=null,key:y="default"}=r,S=F.useMemo(()=>{let w=Nu(f,c);return w==null?null:{location:{pathname:w,search:p,hash:m,state:g,key:y},navigationType:i}},[c,f,p,m,g,y,i]);return S==null?null:F.createElement(jo.Provider,{value:u},F.createElement(W0.Provider,{children:t,value:S}))}function JD(n){let{children:e,location:t}=n;return ID(w1(e),t)}new Promise(()=>{});function w1(n,e){e===void 0&&(e=[]);let t=[];return F.Children.forEach(n,(r,i)=>{if(!F.isValidElement(r))return;let s=[...e,i];if(r.type===F.Fragment){t.push.apply(t,w1(r.props.children,s));return}r.type!==Jr&&zn(!1),!r.props.index||!r.props.children||zn(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=w1(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tg(){return Tg=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Tg.apply(this,arguments)}function WN(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function YD(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function KD(n,e){return n.button===0&&(!e||e==="_self")&&!YD(n)}const ZD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qD=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],QD="6";try{window.__reactRouterVersion=QD}catch{}const $D=F.createContext({isTransitioning:!1}),eF="startTransition",sC=HP[eF];function tF(n){let{basename:e,children:t,future:r,window:i}=n,s=F.useRef();s.current==null&&(s.current=eD({window:i,v5Compat:!0}));let a=s.current,[o,c]=F.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},f=F.useCallback(p=>{u&&sC?sC(()=>c(p)):c(p)},[c,u]);return F.useLayoutEffect(()=>a.listen(f),[a,f]),F.useEffect(()=>VD(r),[r]),F.createElement(XD,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:r})}const nF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vs=F.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:a,state:o,target:c,to:u,preventScrollReset:f,viewTransition:p}=e,m=WN(e,ZD),{basename:g}=F.useContext(jo),y,S=!1;if(typeof u=="string"&&rF.test(u)&&(y=u,nF))try{let b=new URL(window.location.href),M=u.startsWith("//")?new URL(b.protocol+u):new URL(u),N=Nu(M.pathname,g);M.origin===b.origin&&N!=null?u=N+M.search+M.hash:S=!0}catch{}let w=CD(u,{relative:i}),x=aF(u,{replace:a,state:o,target:c,preventScrollReset:f,relative:i,viewTransition:p});function _(b){r&&r(b),b.defaultPrevented||x(b)}return F.createElement("a",Tg({},m,{href:y||w,onClick:S||s?r:_,ref:t,target:c}))}),iF=F.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:a=!1,style:o,to:c,viewTransition:u,children:f}=e,p=WN(e,qD),m=X0(c,{relative:p.relative}),g=qu(),y=F.useContext(UN),{navigator:S,basename:w}=F.useContext(jo),x=y!=null&&oF(m)&&u===!0,_=S.encodeLocation?S.encodeLocation(m).pathname:m.pathname,b=g.pathname,M=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;i||(b=b.toLowerCase(),M=M?M.toLowerCase():null,_=_.toLowerCase()),M&&w&&(M=Nu(M,w)||M);const N=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let C=b===_||!a&&b.startsWith(_)&&b.charAt(N)==="/",I=M!=null&&(M===_||!a&&M.startsWith(_)&&M.charAt(_.length)==="/"),P={isActive:C,isPending:I,isTransitioning:x},T=C?r:void 0,R;typeof s=="function"?R=s(P):R=[s,C?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let j=typeof o=="function"?o(P):o;return F.createElement(Vs,Tg({},p,{"aria-current":T,className:R,ref:t,style:j,to:c,viewTransition:u}),typeof f=="function"?f(P):f)});var S1;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(S1||(S1={}));var aC;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(aC||(aC={}));function sF(n){let e=F.useContext(V0);return e||zn(!1),e}function aF(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,c=ED(),u=qu(),f=X0(n,{relative:a});return F.useCallback(p=>{if(KD(p,t)){p.preventDefault();let m=r!==void 0?r:Eg(u)===Eg(f);c(n,{replace:m,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[u,c,f,r,i,t,n,s,a,o])}function oF(n,e){e===void 0&&(e={});let t=F.useContext($D);t==null&&zn(!1);let{basename:r}=sF(S1.useViewTransitionState),i=X0(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Nu(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=Nu(t.nextLocation.pathname,r)||t.nextLocation.pathname;return b1(i.pathname,a)!=null||b1(i.pathname,s)!=null}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ot=(n,e)=>{const t=F.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:c,...u},f)=>F.createElement("svg",{ref:f,...lF,width:i,height:i,stroke:r,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${cF(n)}`,o].join(" "),...u},[...e.map(([p,m])=>F.createElement(p,m)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=ot("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=ot("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=ot("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=ot("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=ot("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=ot("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=ot("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=ot("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=ot("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=ot("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=ot("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=ot("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=ot("Clapperboard",[["path",{d:"M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z",key:"1tn4o7"}],["path",{d:"m6.2 5.3 3.1 3.9",key:"iuk76l"}],["path",{d:"m12.4 3.4 3.1 4",key:"6hsd6n"}],["path",{d:"M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z",key:"ltgou9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=ot("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=ot("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=ot("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=ot("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=ot("FileJson",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=ot("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=ot("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=ot("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=ot("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=ot("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=ot("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=ot("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=ot("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=ot("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=ot("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=ot("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=ot("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=ot("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=ot("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=ot("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=ot("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=ot("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=ot("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=ot("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=ot("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=ot("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=ot("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=ot("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=ot("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=ot("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=ot("MoveRight",[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=ot("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=ot("PanelLeftClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=ot("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=ot("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=ot("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=ot("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=ot("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=ot("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=ot("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=ot("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=ot("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=ot("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=ot("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=ot("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=ot("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=ot("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=ot("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=ot("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=ot("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=ot("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=ot("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=ot("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=ot("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=ot("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function i3(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=i3(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function rn(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=i3(n))&&(r&&(r+=" "),r+=e);return r}const jF=[{path:"/",icon:_F,label:"",description:""},{path:"/chat",icon:pf,label:"AI ",description:"LLM "},{path:"/gallery",icon:Di,label:"",description:"AI"},{path:"/assets3d",icon:Xh,label:"3D ",description:"3D "},{path:"/characters",icon:Wl,label:"",description:""},{path:"/story",icon:Wh,label:"",description:""},{path:"/scenes",icon:Vl,label:"",description:""},{path:"/scene-flow",icon:M1,label:"",description:""},{path:"/timeline",icon:Qu,label:"",description:""},{path:"/voiceover",icon:$b,label:"",description:""},{path:"/compositor",icon:Ng,label:"",description:""},{path:"/techniques",icon:ZN,label:"",description:""},{path:"/export",icon:Jh,label:"ComfyUI",description:""}];function UF(){return l.jsxs("aside",{className:"fixed left-0 top-0 h-screen w-64 bg-white border-r border-gray-200 flex flex-col z-40",children:[l.jsxs("div",{className:"h-16 flex items-center px-4 border-b border-gray-200",children:[l.jsx(JN,{className:"w-8 h-8 text-primary-600"}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"FilmDream"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Studio"})]})]}),l.jsx("nav",{className:"flex-1 py-4 overflow-y-auto",children:l.jsx("ul",{className:"space-y-1 px-3",children:jF.map(n=>l.jsx("li",{children:l.jsxs(iF,{to:n.path,end:n.path==="/",className:({isActive:e})=>rn("flex items-center px-3 py-2.5 rounded-lg transition-colors group",e?"bg-primary-50 text-primary-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"),children:[l.jsx(n.icon,{className:"w-5 h-5 flex-shrink-0"}),l.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-medium truncate",children:n.label}),l.jsx("p",{className:"text-xs text-gray-400 truncate group-hover:text-gray-500",children:n.description})]})]})},n.path))})}),l.jsx("div",{className:"p-4 border-t border-gray-200",children:l.jsxs("div",{className:"text-xs text-gray-400",children:[l.jsx("p",{children:"FilmDream Studio v1.0"}),l.jsx("p",{children:""})]})})]})}const OF={"/":"","/gallery":"","/characters":"","/story":"","/scenes":"","/timeline":"","/compositor":"","/techniques":"","/export":"ComfyUI"};function zF(){const n=qu(),e=OF[n.pathname]||"FilmDream Studio";return l.jsxs("header",{className:"h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6",children:[l.jsx("div",{children:l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(xF,{className:"w-5 h-5"})}),l.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(dF,{className:"w-5 h-5"})}),l.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(gf,{className:"w-5 h-5"})})]})]})}const HF={},uC=n=>{let e;const t=new Set,r=(f,p)=>{const m=typeof f=="function"?f(e):f;if(!Object.is(m,e)){const g=e;e=p??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(y=>y(e,g))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(HF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(r,i,c);return c},GF=n=>n?uC(n):uC;var s3={exports:{}},a3={},o3={exports:{}},l3={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ru=F;function VF(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var WF=typeof Object.is=="function"?Object.is:VF,XF=Ru.useState,JF=Ru.useEffect,YF=Ru.useLayoutEffect,KF=Ru.useDebugValue;function ZF(n,e){var t=e(),r=XF({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return YF(function(){i.value=t,i.getSnapshot=e,mv(i)&&s({inst:i})},[n,t,e]),JF(function(){return mv(i)&&s({inst:i}),n(function(){mv(i)&&s({inst:i})})},[n]),KF(t),t}function mv(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!WF(n,t)}catch{return!0}}function qF(n,e){return e()}var QF=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?qF:ZF;l3.useSyncExternalStore=Ru.useSyncExternalStore!==void 0?Ru.useSyncExternalStore:QF;o3.exports=l3;var $F=o3.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q0=F,ek=$F;function tk(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var nk=typeof Object.is=="function"?Object.is:tk,rk=ek.useSyncExternalStore,ik=Q0.useRef,sk=Q0.useEffect,ak=Q0.useMemo,ok=Q0.useDebugValue;a3.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var s=ik(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=ak(function(){function c(g){if(!u){if(u=!0,f=g,g=r(g),i!==void 0&&a.hasValue){var y=a.value;if(i(y,g))return p=y}return p=g}if(y=p,nk(f,g))return y;var S=r(g);return i!==void 0&&i(y,S)?(f=g,y):(f=g,p=S)}var u=!1,f,p,m=t===void 0?null:t;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,t,r,i]);var o=rk(n,s[0],s[1]);return sk(function(){a.hasValue=!0,a.value=o},[o]),ok(o),o};s3.exports=a3;var lk=s3.exports;const ck=$1(lk),c3={},{useDebugValue:uk}=Ys,{useSyncExternalStoreWithSelector:dk}=ck;let dC=!1;const hk=n=>n;function fk(n,e=hk,t){(c3?"production":void 0)!=="production"&&t&&!dC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),dC=!0);const r=dk(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return uk(r),r}const hC=n=>{(c3?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?GF(n):n,t=(r,i)=>fk(e,r,i);return Object.assign(t,e),t},Es=n=>n?hC(n):hC,pk=Es((n,e)=>({toasts:[],addToast:t=>{const r=Date.now(),i={id:r,type:"info",duration:3e3,...t};return n(s=>({toasts:[...s.toasts,i]})),i.duration>0&&setTimeout(()=>{e().removeToast(r)},i.duration),r},removeToast:t=>{n(r=>({toasts:r.toasts.filter(i=>i.id!==t)}))},success:t=>e().addToast({type:"success",message:t}),error:t=>e().addToast({type:"error",message:t,duration:5e3}),warning:t=>e().addToast({type:"warning",message:t}),info:t=>e().addToast({type:"info",message:t}),globalLoading:!1,setGlobalLoading:t=>n({globalLoading:t})})),fC={success:{icon:Gl,bgColor:"bg-green-50",borderColor:"border-green-200",textColor:"text-green-800",iconColor:"text-green-500"},error:{icon:Ba,bgColor:"bg-red-50",borderColor:"border-red-200",textColor:"text-red-800",iconColor:"text-red-500"},warning:{icon:uF,bgColor:"bg-yellow-50",borderColor:"border-yellow-200",textColor:"text-yellow-800",iconColor:"text-yellow-500"},info:{icon:vF,bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-800",iconColor:"text-blue-500"}};function mk(){const{toasts:n,removeToast:e}=pk();return n.length===0?null:l.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2 max-w-md",children:n.map(t=>{const r=fC[t.type]||fC.info,i=r.icon;return l.jsxs("div",{className:`flex items-start p-4 rounded-lg border shadow-lg ${r.bgColor} ${r.borderColor} animate-slide-in`,children:[l.jsx(i,{className:`w-5 h-5 ${r.iconColor} flex-shrink-0`}),l.jsx("p",{className:`ml-3 text-sm ${r.textColor} flex-1`,children:t.message}),l.jsx("button",{onClick:()=>e(t.id),className:`ml-3 ${r.iconColor} hover:opacity-70`,children:l.jsx(Hn,{className:"w-4 h-4"})})]},t.id)})})}function gk(){return l.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[l.jsx(UF,{}),l.jsxs("div",{className:"flex-1 flex flex-col ml-64",children:[l.jsx(zF,{}),l.jsx("main",{className:"flex-1 p-6 overflow-auto",children:l.jsx(WD,{})})]}),l.jsx(mk,{})]})}const gv="http://localhost:3001/api",xk=[{key:"images",label:"",icon:Di,path:"/gallery",color:"bg-blue-500"},{key:"characters",label:"",icon:Wl,path:"/characters",color:"bg-green-500"},{key:"stories",label:"",icon:Wh,path:"/story",color:"bg-purple-500"},{key:"scenes",label:"",icon:Vl,path:"/scenes",color:"bg-orange-500"},{key:"shots",label:"",icon:Qu,path:"/timeline",color:"bg-red-500"},{key:"voiceovers",label:"",icon:$b,path:"/voiceover",color:"bg-pink-500"}],yk=[{label:"",description:"AI",path:"/gallery",icon:Di},{label:"",description:"",path:"/characters",icon:Wl},{label:"",description:"",path:"/story",icon:Wh},{label:"",description:"",path:"/scenes",icon:Vl}],vk=[{title:"",description:"",path:"/compositor",icon:Z0,color:"text-yellow-500"},{title:"ComfyUI",description:"AnimateDiff/SVD/CogVideoX",path:"/export",icon:JN,color:"text-blue-500"},{title:"",description:"",path:"/techniques",icon:EF,color:"text-purple-500"}];function _k(){const[n,e]=F.useState(null),[t,r]=F.useState({characters:[],scenes:[]}),[i,s]=F.useState(!0),[a,o]=F.useState(null);F.useEffect(()=>{async function u(){try{s(!0);const[f,p,m]=await Promise.all([fetch(`${gv}/stats`),fetch(`${gv}/characters`),fetch(`${gv}/scenes`)]);if(!f.ok)throw new Error("");const g=await f.json();if(e(g),p.ok){const y=await p.json();r(S=>({...S,characters:y.slice(0,3)}))}if(m.ok){const y=await m.json();r(S=>({...S,scenes:y.slice(0,3)}))}}catch(f){o(f.message)}finally{s(!1)}}u()},[]);const c=n&&(n.images>0||n.characters>0||n.scenes>0);return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-800 rounded-xl p-8 text-white",children:[l.jsx("h1",{className:"text-3xl font-bold mb-2",children:" FilmDream Studio"}),l.jsx("p",{className:"text-primary-100 text-lg",children:" - AI"}),l.jsxs("div",{className:"mt-6 flex space-x-4",children:[l.jsx(Vs,{to:"/gallery",className:"px-6 py-2 bg-white text-primary-700 rounded-lg font-medium hover:bg-primary-50 transition-colors",children:""}),l.jsx(Vs,{to:"/techniques",className:"px-6 py-2 bg-primary-500 text-white rounded-lg font-medium hover:bg-primary-400 transition-colors",children:""})]})]}),l.jsx("div",{className:"grid grid-cols-6 gap-4",children:xk.map(u=>l.jsxs(Vs,{to:u.path,className:"bg-white rounded-xl p-5 border border-gray-200 hover:shadow-md transition-shadow",children:[l.jsx("div",{className:`w-10 h-10 ${u.color} rounded-lg flex items-center justify-center mb-3`,children:l.jsx(u.icon,{className:"w-5 h-5 text-white"})}),i?l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx(yi,{className:"w-5 h-5 animate-spin text-gray-400"})}):a?l.jsx("p",{className:"text-2xl font-bold text-gray-300",children:"-"}):l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(n==null?void 0:n[u.key])||0}),l.jsx("p",{className:"text-sm text-gray-500",children:u.label})]},u.key))}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),l.jsx("div",{className:"grid grid-cols-3 gap-4",children:vk.map(u=>l.jsx(Vs,{to:u.path,className:"bg-white rounded-xl p-5 border border-gray-200 hover:shadow-md hover:border-primary-300 transition-all group",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(u.icon,{className:`w-6 h-6 ${u.color} flex-shrink-0`}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900 group-hover:text-primary-600",children:u.title}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:u.description})]})]})},u.title))})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-4",children:yk.map(u=>l.jsx(Vs,{to:u.path,className:"bg-white rounded-xl p-5 border border-gray-200 hover:shadow-md hover:border-primary-300 transition-all group",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(u.icon,{className:"w-5 h-5 text-gray-400 group-hover:text-primary-500"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900 group-hover:text-primary-600",children:u.label}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:u.description})]})]}),l.jsx(Gp,{className:"w-5 h-5 text-gray-400 group-hover:text-primary-600 transition-colors"})]})},u.label))})]}),c&&l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.characters.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),l.jsx(Vs,{to:"/characters",className:"text-sm text-primary-600 hover:text-primary-700",children:""})]}),l.jsx("div",{className:"space-y-2",children:t.characters.map(u=>l.jsx(Vs,{to:"/characters",className:"block bg-white rounded-lg p-4 border border-gray-200 hover:border-primary-300 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${u.type==="mecha"?"bg-blue-100 text-blue-600":u.type==="kaiju"?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:l.jsx(Wl,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:u.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:[u.type==="mecha"?"":u.type==="kaiju"?"":u.type==="human"?"":"",u.height&&`  ${u.height}`]})]})]})},u.id))})]}),t.scenes.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),l.jsx(Vs,{to:"/scenes",className:"text-sm text-primary-600 hover:text-primary-700",children:""})]}),l.jsx("div",{className:"space-y-2",children:t.scenes.map(u=>l.jsx(Vs,{to:"/scenes",className:"block bg-white rounded-lg p-4 border border-gray-200 hover:border-primary-300 transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600",children:l.jsx(Vl,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:u.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:[u.environment,"  ",u.timeOfDay,"  ",u.weather]})]})]})},u.id))})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),l.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-bold",children:"1"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:"AI"}),l.jsx("p",{className:"text-sm text-gray-500",children:"/"})]})]}),l.jsx(Gp,{className:"w-5 h-5 text-gray-300"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-green-600 font-bold",children:"2"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:""}),l.jsx("p",{className:"text-sm text-gray-500",children:""})]})]}),l.jsx(Gp,{className:"w-5 h-5 text-gray-300"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-purple-600 font-bold",children:"3"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:""}),l.jsx("p",{className:"text-sm text-gray-500",children:""})]})]}),l.jsx(Gp,{className:"w-5 h-5 text-gray-300"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-orange-600 font-bold",children:"4"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:""}),l.jsx("p",{className:"text-sm text-gray-500",children:"ComfyUI"})]})]})]})})]}),a&&l.jsx("div",{className:"fixed bottom-4 right-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg shadow-lg",children:l.jsx("p",{className:"text-sm",children:a})})]})}const ou=[{value:"mecha",label:"",color:"bg-blue-500"},{value:"monster",label:"",color:"bg-red-500"},{value:"scene",label:"",color:"bg-green-500"},{value:"prop",label:"",color:"bg-yellow-500"},{value:"effect",label:"",color:"bg-purple-500"},{value:"uncategorized",label:"",color:"bg-gray-500"}],bk=[{value:"front",label:""},{value:"side",label:""},{value:"back",label:""},{value:"detail",label:""},{value:"action",label:""},{value:"expression",label:""}],rh=[{value:"pending",label:"",color:"bg-gray-500"},{value:"adopted",label:"",color:"bg-green-500"},{value:"rejected",label:"",color:"bg-red-500"}],tw=Es((n,e)=>({images:[],loading:!1,error:null,filter:{category:"all",status:"all",search:""},selectedImages:[],fetchImages:async()=>{n({loading:!0,error:null});try{const{filter:t}=e(),r=new URLSearchParams;t.category!=="all"&&r.append("category",t.category),t.status!=="all"&&r.append("status",t.status);const s=await(await fetch(`/api/images?${r}`)).json();n({images:s,loading:!1})}catch(t){n({error:t.message,loading:!1})}},uploadImages:async(t,r)=>{const i=new FormData;for(const s of t)i.append("images",s);try{const a=await(await fetch("/api/images/upload",{method:"POST",body:i})).json();return a.success&&e().fetchImages(),a}catch(s){throw s}},updateImage:async(t,r)=>{try{const s=await(await fetch(`/api/images/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>({images:a.images.map(o=>o.id===t?{...o,...s}:o)})),s}catch(i){throw i}},deleteImage:async t=>{try{await fetch(`/api/images/${t}`,{method:"DELETE"}),n(r=>({images:r.images.filter(i=>i.id!==t),selectedImages:r.selectedImages.filter(i=>i!==t)}))}catch(r){throw r}},batchUpdate:async t=>{const{selectedImages:r}=e();try{const s=await(await fetch("/api/images/batch-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:r,...t})})).json();return s.success&&(e().fetchImages(),n({selectedImages:[]})),s}catch(i){throw i}},setFilter:t=>{n(r=>({filter:{...r.filter,...t}})),e().fetchImages()},toggleSelect:t=>{n(r=>({selectedImages:r.selectedImages.includes(t)?r.selectedImages.filter(i=>i!==t):[...r.selectedImages,t]}))},toggleSelectAll:()=>{n(t=>({selectedImages:t.selectedImages.length===t.images.length?[]:t.images.map(r=>r.id)}))},clearSelection:()=>n({selectedImages:[]})}));function wk({image:n,onClose:e}){const{updateImage:t,deleteImage:r}=tw(),[i,s]=F.useState({category:(n==null?void 0:n.category)||"uncategorized",viewType:(n==null?void 0:n.viewType)||"",status:(n==null?void 0:n.status)||"pending",tags:(n==null?void 0:n.tags)||[]}),[a,o]=F.useState(""),[c,u]=F.useState(!1);if(F.useEffect(()=>{n&&s({category:n.category||"uncategorized",viewType:n.viewType||"",status:n.status||"pending",tags:n.tags||[]})},[n]),!n)return null;const f=async()=>{u(!0);try{await t(n.id,i),e()}catch(y){console.error("Save failed:",y)}finally{u(!1)}},p=async()=>{confirm("")&&(await r(n.id),e())},m=()=>{a.trim()&&!i.tags.includes(a.trim())&&(s({...i,tags:[...i.tags,a.trim()]}),o(""))},g=y=>{s({...i,tags:i.tags.filter(S=>S!==y)})};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:e,children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex",onClick:y=>y.stopPropagation(),children:[l.jsx("div",{className:"w-1/2 bg-gray-900 flex items-center justify-center p-4",children:l.jsx("img",{src:`/uploads/${n.filename}`,alt:n.originalName,className:"max-w-full max-h-[70vh] object-contain rounded-lg"})}),l.jsxs("div",{className:"w-1/2 flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[l.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:n.originalName}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[l.jsx(KN,{className:"w-4 h-4 mr-2"}),""]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:ou.map(y=>l.jsx("button",{onClick:()=>s({...i,category:y.value}),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all ${i.category===y.value?`${y.color} text-white`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:y.label},y.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[l.jsx(Y0,{className:"w-4 h-4 mr-2"}),""]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:bk.map(y=>l.jsx("button",{onClick:()=>s({...i,viewType:y.value}),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all ${i.viewType===y.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:y.label},y.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[l.jsx(Jn,{className:"w-4 h-4 mr-2"}),""]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:rh.map(y=>l.jsx("button",{onClick:()=>s({...i,status:y.value}),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all ${i.status===y.value?`${y.color} text-white`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:y.label},y.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[l.jsx(DF,{className:"w-4 h-4 mr-2"}),""]}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:i.tags.map(y=>l.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-primary-100 text-primary-700 rounded-full text-sm",children:[y,l.jsx("button",{onClick:()=>g(y),className:"ml-1 hover:text-primary-900",children:l.jsx(Hn,{className:"w-3 h-3"})})]},y))}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:a,onChange:y=>o(y.target.value),onKeyDown:y=>y.key==="Enter"&&(y.preventDefault(),m()),placeholder:"...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),l.jsx("button",{onClick:m,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm hover:bg-gray-200",children:""})]})]}),l.jsxs("div",{className:"text-xs text-gray-500 space-y-1 pt-2 border-t",children:[l.jsxs("p",{children:[": ",n.filename]}),l.jsxs("p",{children:[": ",new Date(n.createdAt).toLocaleString("zh-CN")]})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-gray-50",children:[l.jsxs("button",{onClick:p,className:"flex items-center px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:[l.jsx(zr,{className:"w-4 h-4 mr-2"}),""]}),l.jsxs("button",{onClick:f,disabled:c,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[l.jsx(mf,{className:"w-4 h-4 mr-2"}),c?"...":""]})]})]})]})})}function Sk({images:n,onClose:e,onRemoveImage:t}){const[r,i]=F.useState(1),[s,a]=F.useState({x:0,y:0}),[o,c]=F.useState(!1),[u,f]=F.useState({x:0,y:0}),[p,m]=F.useState(!1),g=F.useRef(null),y=.5,S=5,w=()=>i(T=>Math.min(T+.25,S)),x=()=>i(T=>Math.max(T-.25,y)),_=()=>{i(1),a({x:0,y:0})},b=F.useCallback(T=>{T.preventDefault();const R=T.deltaY>0?-.1:.1;i(j=>Math.min(Math.max(j+R,y),S))},[]),M=T=>{T.button===0&&(c(!0),f({x:T.clientX-s.x,y:T.clientY-s.y}))},N=F.useCallback(T=>{o&&a({x:T.clientX-u.x,y:T.clientY-u.y})},[o,u]),C=()=>c(!1),I=async()=>{var T;document.fullscreenElement?(await document.exitFullscreen(),m(!1)):(await((T=g.current)==null?void 0:T.requestFullscreen()),m(!0))};F.useEffect(()=>{const T=()=>{m(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",T),()=>document.removeEventListener("fullscreenchange",T)},[]),F.useEffect(()=>{const T=R=>{R.key==="Escape"&&!document.fullscreenElement&&e()};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[e]);const P=()=>{switch(n.length){case 2:return"grid-cols-2";case 3:return"grid-cols-3";case 4:return"grid-cols-2 grid-rows-2";default:return"grid-cols-1"}};return l.jsxs("div",{ref:g,className:"fixed inset-0 bg-black/95 z-50 flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-black/50 backdrop-blur-sm border-b border-white/10",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h3",{className:"text-white font-medium",children:""}),l.jsxs("span",{className:"text-gray-400 text-sm",children:["(",n.length," )"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex items-center bg-white/10 rounded-lg",children:[l.jsx("button",{onClick:x,disabled:r<=y,className:"p-2 text-white hover:bg-white/10 rounded-l-lg disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:l.jsx(r3,{className:"w-5 h-5"})}),l.jsxs("span",{className:"px-3 text-white text-sm min-w-[60px] text-center",children:[Math.round(r*100),"%"]}),l.jsx("button",{onClick:w,disabled:r>=S,className:"p-2 text-white hover:bg-white/10 rounded-r-lg disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:l.jsx(n3,{className:"w-5 h-5"})})]}),l.jsx("button",{onClick:_,className:"p-2 text-white hover:bg-white/10 rounded-lg",title:"",children:l.jsx(PF,{className:"w-5 h-5"})}),l.jsx("button",{onClick:I,className:"p-2 text-white hover:bg-white/10 rounded-lg",title:p?"":"",children:p?l.jsx(SF,{className:"w-5 h-5"}):l.jsx(Qb,{className:"w-5 h-5"})}),l.jsx("button",{onClick:e,className:"p-2 text-white hover:bg-white/10 rounded-lg ml-4",title:"",children:l.jsx(Hn,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"flex-1 overflow-hidden cursor-grab active:cursor-grabbing",onWheel:b,onMouseDown:M,onMouseMove:N,onMouseUp:C,onMouseLeave:C,children:l.jsx("div",{className:`h-full grid ${P()} gap-1 p-1`,style:{transform:`translate(${s.x}px, ${s.y}px) scale(${r})`,transformOrigin:"center center",transition:o?"none":"transform 0.1s ease-out"},children:n.map((T,R)=>l.jsxs("div",{className:"relative bg-gray-900 flex items-center justify-center overflow-hidden group",children:[l.jsx("img",{src:`/uploads/${T.filename}`,alt:T.originalName,className:"max-w-full max-h-full object-contain",draggable:!1}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-3 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("p",{className:"text-white text-sm font-medium truncate",children:T.originalName}),T.category&&l.jsx("p",{className:"text-gray-300 text-xs mt-0.5",children:T.category})]}),l.jsx("div",{className:"absolute top-2 left-2 w-6 h-6 bg-purple-600 text-white text-xs font-bold rounded-full flex items-center justify-center",children:R+1}),t&&l.jsx("button",{onClick:j=>{j.stopPropagation(),t(T.id)},className:"absolute top-2 right-2 p-1.5 bg-red-500/80 hover:bg-red-600 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",title:"",children:l.jsx(zr,{className:"w-4 h-4"})})]},T.id))})}),l.jsx("div",{className:"px-6 py-3 bg-black/50 backdrop-blur-sm border-t border-white/10 text-center",children:l.jsx("p",{className:"text-gray-400 text-sm",children:" |  | "})})]})}function Ak(){const{images:n,loading:e,filter:t,selectedImages:r,fetchImages:i,uploadImages:s,batchUpdate:a,deleteImage:o,setFilter:c,toggleSelect:u,toggleSelectAll:f,clearSelection:p}=tw(),[m,g]=F.useState("grid"),[y,S]=F.useState(!1),[w,x]=F.useState(!1),[_,b]=F.useState([]),[M,N]=F.useState(null),[C,I]=F.useState(!1),[P,T]=F.useState(!1),[R,j]=F.useState([]),[O,k]=F.useState(!1),Z=G=>{j(de=>de.find(be=>be.id===G.id)?de.filter(be=>be.id!==G.id):de.length<4?[...de,G]:de)};F.useEffect(()=>{i()},[]);const te=F.useCallback(G=>{G.preventDefault(),G.stopPropagation(),G.type==="dragenter"||G.type==="dragover"?S(!0):G.type==="dragleave"&&S(!1)},[]),K=F.useCallback(G=>{G.preventDefault(),G.stopPropagation(),S(!1),G.dataTransfer.files&&G.dataTransfer.files.length>0&&$(Array.from(G.dataTransfer.files))},[]),$=async G=>{const de=G.filter(Ce=>Ce.type.startsWith("image/"));if(de.length!==0){x(!0),b(de.map(Ce=>({name:Ce.name,status:"uploading"})));try{await s(de),b(Ce=>Ce.map(be=>({...be,status:"done"}))),setTimeout(()=>b([]),2e3)}catch(Ce){console.error("Upload failed:",Ce),b(be=>be.map(se=>({...se,status:"error"})))}finally{x(!1)}}},U=async(G,de)=>{if(I(!1),G==="category")await a({category:de});else if(G==="status")await a({status:de});else if(G==="delete"&&confirm(` ${r.length} `))for(const Ce of r)await o(Ce)},H=G=>ou.find(de=>de.value===G)||ou[5],W=G=>rh.find(de=>de.value===G)||rh[0],Y=n.filter(G=>{var de,Ce;return t.search===""||((de=G.originalName)==null?void 0:de.toLowerCase().includes(t.search.toLowerCase()))||((Ce=G.tags)==null?void 0:Ce.some(be=>be.toLowerCase().includes(t.search.toLowerCase())))});return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(nc,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"...",value:t.search,onChange:G=>c({search:G.target.value}),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent w-64"})]}),l.jsxs("select",{value:t.category,onChange:G=>c({category:G.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[l.jsx("option",{value:"all",children:""}),ou.map(G=>l.jsx("option",{value:G.value,children:G.label},G.value))]}),l.jsxs("select",{value:t.status,onChange:G=>c({status:G.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[l.jsx("option",{value:"all",children:""}),rh.map(G=>l.jsx("option",{value:G.value,children:G.label},G.value))]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{onClick:()=>{T(!P),P&&j([])},className:`flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors ${P?"bg-purple-100 text-purple-700 border border-purple-300":"text-gray-600 hover:bg-gray-100 border border-transparent"}`,children:[l.jsx(fF,{className:"w-4 h-4 mr-1.5"}),P?` (${R.length}/4)`:""]}),P&&R.length>=2&&l.jsxs("button",{onClick:()=>k(!0),className:"flex items-center px-3 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700",children:[l.jsx(Qb,{className:"w-4 h-4 mr-1.5"}),""]}),l.jsx("div",{className:"w-px h-6 bg-gray-300 mx-2"}),l.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-lg ${m==="grid"?"bg-primary-100 text-primary-600":"text-gray-500 hover:bg-gray-100"}`,children:l.jsx(K0,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-lg ${m==="list"?"bg-primary-100 text-primary-600":"text-gray-500 hover:bg-gray-100"}`,children:l.jsx(qb,{className:"w-5 h-5"})})]})]}),r.length>0&&l.jsxs("div",{className:"flex items-center justify-between bg-primary-50 border border-primary-200 rounded-lg px-4 py-3",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("button",{onClick:f,className:"flex items-center text-primary-700 hover:text-primary-800",children:[r.length===n.length?l.jsx(hF,{className:"w-5 h-5 mr-2"}):l.jsx(lC,{className:"w-5 h-5 mr-2"})," ",r.length," "]}),l.jsx("button",{onClick:p,className:"text-gray-500 hover:text-gray-700",children:l.jsx(Hn,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(C==="category"?!1:"category"),className:"flex items-center px-3 py-1.5 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50",children:[l.jsx(KN,{className:"w-4 h-4 mr-2"}),""]}),C==="category"&&l.jsx("div",{className:"absolute top-full mt-1 right-0 bg-white border rounded-lg shadow-lg py-1 z-10 min-w-[120px]",children:ou.map(G=>l.jsxs("button",{onClick:()=>U("category",G.value),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${G.color} mr-2`}),G.label]},G.value))})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(C==="status"?!1:"status"),className:"flex items-center px-3 py-1.5 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50",children:[l.jsx(Jn,{className:"w-4 h-4 mr-2"}),""]}),C==="status"&&l.jsx("div",{className:"absolute top-full mt-1 right-0 bg-white border rounded-lg shadow-lg py-1 z-10 min-w-[120px]",children:rh.map(G=>l.jsxs("button",{onClick:()=>U("status",G.value),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${G.color} mr-2`}),G.label]},G.value))})]}),l.jsxs("button",{onClick:()=>U("delete"),className:"flex items-center px-3 py-1.5 bg-red-50 text-red-600 border border-red-200 rounded-lg text-sm hover:bg-red-100",children:[l.jsx(zr,{className:"w-4 h-4 mr-2"}),""]})]})]}),l.jsxs("div",{onDragEnter:te,onDragLeave:te,onDragOver:te,onDrop:K,className:`border-2 border-dashed rounded-xl p-8 text-center transition-colors ${y?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-gray-400"}`,children:[l.jsx(q0,{className:`w-10 h-10 mx-auto mb-3 ${y?"text-primary-500":"text-gray-400"}`}),l.jsx("h3",{className:"text-base font-medium text-gray-900 mb-1",children:""}),l.jsx("p",{className:"text-sm text-gray-500 mb-3",children:" JPG, PNG, WebP, GIF 20"}),l.jsxs("label",{className:"inline-flex items-center px-5 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 cursor-pointer text-sm",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),"",l.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:G=>$(Array.from(G.target.files))})]})]}),_.length>0&&l.jsxs("div",{className:"bg-white border rounded-lg p-4 space-y-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"..."}),_.map((G,de)=>l.jsxs("div",{className:"flex items-center text-sm",children:[l.jsx("span",{className:"flex-1 truncate text-gray-600",children:G.name}),G.status==="uploading"&&l.jsx("span",{className:"text-primary-600",children:"..."}),G.status==="done"&&l.jsx(Jn,{className:"w-4 h-4 text-green-500"}),G.status==="error"&&l.jsx(Hn,{className:"w-4 h-4 text-red-500"})]},de))]}),l.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[l.jsxs("span",{children:[" ",Y.length," "]}),t.category!=="all"||t.status!=="all"||t.search?l.jsx("button",{onClick:()=>c({category:"all",status:"all",search:""}),className:"text-primary-600 hover:text-primary-700",children:""}):null]}),e?l.jsxs("div",{className:"text-center py-16",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"}),l.jsx("p",{className:"mt-2 text-gray-500",children:"..."})]}):Y.length===0?l.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border border-gray-200",children:[l.jsx(Di,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:n.length===0?"":""}),l.jsx("p",{className:"text-gray-400",children:n.length===0?"AI":""})]}):m==="grid"?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:Y.map(G=>{const de=H(G.category),Ce=W(G.status),be=r.includes(G.id),se=R.find(Le=>Le.id===G.id),_e=R.findIndex(Le=>Le.id===G.id);return l.jsxs("div",{className:`bg-white rounded-lg border overflow-hidden group cursor-pointer transition-all ${be?"ring-2 ring-primary-500 border-primary-500":""} ${se?"ring-2 ring-purple-500 border-purple-500":"border-gray-200 hover:shadow-lg"}`,children:[l.jsxs("div",{className:"aspect-square bg-gray-100 relative",onClick:()=>{P?Z(G):N(G)},children:[l.jsx("img",{src:`/uploads/${G.filename}`,alt:G.originalName,className:"w-full h-full object-cover",loading:"lazy"}),P&&l.jsx("div",{className:`absolute top-2 left-2 w-7 h-7 rounded-full flex items-center justify-center font-bold text-sm transition-all ${se?"bg-purple-500 text-white":"bg-white/90 text-gray-500 border-2 border-dashed border-gray-300"}`,children:se?_e+1:"+"}),!P&&l.jsx("button",{onClick:Le=>{Le.stopPropagation(),u(G.id)},className:`absolute top-2 left-2 w-6 h-6 rounded flex items-center justify-center transition-opacity ${be?"bg-primary-500 text-white":"bg-white/80 text-gray-600 opacity-0 group-hover:opacity-100"}`,children:be?l.jsx(Jn,{className:"w-4 h-4"}):l.jsx(lC,{className:"w-4 h-4"})}),G.status!=="pending"&&l.jsx("span",{className:`absolute top-2 right-2 px-2 py-0.5 rounded text-xs text-white ${Ce.color}`,children:Ce.label}),l.jsx("div",{className:`absolute inset-0 transition-colors ${P?se?"bg-purple-500/10":"bg-black/0 hover:bg-purple-500/10":"bg-black/0 group-hover:bg-black/20"}`})]}),l.jsxs("div",{className:"p-2.5",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:G.originalName}),l.jsxs("div",{className:"flex items-center mt-1",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${de.color} mr-1.5`}),l.jsx("span",{className:"text-xs text-gray-500",children:de.label}),G.viewType&&l.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:[" ",G.viewType]})]})]})]},G.id)})}):l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 divide-y",children:Y.map(G=>{var Le;const de=H(G.category),Ce=W(G.status),be=r.includes(G.id),se=R.find(yt=>yt.id===G.id),_e=R.findIndex(yt=>yt.id===G.id);return l.jsxs("div",{className:`flex items-center p-3 hover:bg-gray-50 cursor-pointer ${be?"bg-primary-50":""} ${se?"bg-purple-50":""}`,onClick:()=>{P?Z(G):N(G)},children:[P?l.jsx("div",{className:`w-6 h-6 mr-3 rounded-full flex items-center justify-center font-bold text-xs ${se?"bg-purple-500 text-white":"border-2 border-dashed border-gray-300 text-gray-400"}`,children:se?_e+1:"+"}):l.jsx("button",{onClick:yt=>{yt.stopPropagation(),u(G.id)},className:`w-5 h-5 mr-3 rounded flex items-center justify-center ${be?"bg-primary-500 text-white":"border border-gray-300"}`,children:be&&l.jsx(Jn,{className:"w-3 h-3"})}),l.jsx("div",{className:"w-12 h-12 rounded overflow-hidden bg-gray-100 mr-3 flex-shrink-0",children:l.jsx("img",{src:`/uploads/${G.filename}`,alt:G.originalName,className:"w-full h-full object-cover"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:G.originalName}),l.jsxs("div",{className:"flex items-center mt-0.5",children:[l.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs ${de.color} text-white mr-2`,children:de.label}),l.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-xs ${Ce.color} text-white`,children:Ce.label}),((Le=G.tags)==null?void 0:Le.length)>0&&l.jsx("span",{className:"text-xs text-gray-400 ml-2",children:G.tags.slice(0,3).join(", ")})]})]}),l.jsx("span",{className:"text-xs text-gray-400",children:new Date(G.createdAt).toLocaleDateString("zh-CN")})]},G.id)})}),M&&l.jsx(wk,{image:M,onClose:()=>N(null)}),O&&R.length>=2&&l.jsx(Sk,{images:R,onClose:()=>k(!1),onRemoveImage:G=>{j(de=>de.filter(Ce=>Ce.id!==G)),R.length<=2&&k(!1)}})]})}const yr=[{value:"mecha",label:"",color:"bg-blue-500",icon:""},{value:"monster",label:"",color:"bg-red-500",icon:""},{value:"human",label:"",color:"bg-amber-500",icon:""},{value:"vehicle",label:"",color:"bg-green-500",icon:""},{value:"other",label:"",color:"bg-gray-500",icon:""}],La=Es((n,e)=>({characters:[],loading:!1,error:null,filter:{type:"all",search:""},currentCharacter:null,fetchCharacters:async()=>{n({loading:!0,error:null});try{const{filter:t}=e(),r=new URLSearchParams;t.type!=="all"&&r.append("type",t.type);const s=await(await fetch(`/api/characters?${r}`)).json();n({characters:s,loading:!1})}catch(t){n({error:t.message,loading:!1})}},fetchCharacter:async t=>{n({loading:!0,error:null});try{const i=await(await fetch(`/api/characters/${t}`)).json();return n({currentCharacter:i,loading:!1}),i}catch(r){throw n({error:r.message,loading:!1}),r}},createCharacter:async t=>{try{const r=await fetch("/api/characters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await r.json();return r.ok&&e().fetchCharacters(),i}catch(r){throw r}},updateCharacter:async(t,r)=>{try{const s=await(await fetch(`/api/characters/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>{var o;return{characters:a.characters.map(c=>c.id===t?{...c,...s}:c),currentCharacter:((o=a.currentCharacter)==null?void 0:o.id)===t?{...a.currentCharacter,...s}:a.currentCharacter}}),s}catch(i){throw i}},deleteCharacter:async t=>{try{await fetch(`/api/characters/${t}`,{method:"DELETE"}),n(r=>{var i;return{characters:r.characters.filter(s=>s.id!==t),currentCharacter:((i=r.currentCharacter)==null?void 0:i.id)===t?null:r.currentCharacter}})}catch(r){throw r}},linkImages:async(t,r)=>{try{const s=await(await fetch(`/api/characters/${t}/images`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageIds:r})})).json();return s.success&&(e().fetchCharacter(t),e().fetchCharacters()),s}catch(i){throw i}},setFilter:t=>{n(r=>({filter:{...r.filter,...t}})),e().fetchCharacters()},clearCurrentCharacter:()=>n({currentCharacter:null})}));function Mk({character:n,onEdit:e,onDelete:t,onLinkImages:r,onViewDetail:i}){var c,u,f,p;const s=yr.find(m=>m.value===n.type)||yr[4],a=((c=n.images)==null?void 0:c.find(m=>m.id===n.coverImageId))||((u=n.images)==null?void 0:u[0]),o=m=>{m.stopPropagation(),n.promptTemplate&&navigator.clipboard.writeText(n.promptTemplate)};return l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden group hover:shadow-lg transition-all cursor-pointer",onClick:()=>i==null?void 0:i(n),children:[l.jsxs("div",{className:"aspect-[4/3] bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden",children:[a?l.jsx("img",{src:`/uploads/${a.filename}`,alt:n.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx("span",{className:"text-6xl opacity-50",children:s.icon})}),l.jsxs("span",{className:`absolute top-3 left-3 px-2.5 py-1 ${s.color} text-white text-xs font-medium rounded-full`,children:[s.icon," ",s.label]}),((f=n.images)==null?void 0:f.length)>0&&l.jsxs("span",{className:"absolute top-3 right-3 px-2 py-1 bg-black/50 text-white text-xs rounded-full flex items-center",children:[l.jsx(Di,{className:"w-3 h-3 mr-1"}),n.images.length]}),l.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:m=>{m.stopPropagation(),e==null||e(n)},className:"p-2.5 bg-white rounded-full shadow-lg hover:bg-gray-100",title:"",children:l.jsx($u,{className:"w-4 h-4 text-gray-700"})}),l.jsx("button",{onClick:m=>{m.stopPropagation(),r==null||r(n)},className:"p-2.5 bg-white rounded-full shadow-lg hover:bg-gray-100",title:"",children:l.jsx(Di,{className:"w-4 h-4 text-gray-700"})}),l.jsx("button",{onClick:m=>{m.stopPropagation(),t==null||t(n)},className:"p-2.5 bg-white rounded-full shadow-lg hover:bg-red-50",title:"",children:l.jsx(zr,{className:"w-4 h-4 text-red-500"})})]})})]}),l.jsxs("div",{className:"p-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 text-lg truncate",children:n.name}),n.height&&l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[": ",n.height]}),((p=n.abilities)==null?void 0:p.length)>0&&l.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[n.abilities.slice(0,3).map((m,g)=>l.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:m},g)),n.abilities.length>3&&l.jsxs("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 text-xs rounded",children:["+",n.abilities.length-3]})]}),n.promptTemplate&&l.jsxs("div",{className:"mt-3 pt-3 border-t",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-xs text-gray-400",children:""}),l.jsx("button",{onClick:o,className:"text-gray-400 hover:text-primary-600",title:"",children:l.jsx(di,{className:"w-3.5 h-3.5"})})]}),l.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 font-mono",children:n.promptTemplate})]})]})]})}function Ck({character:n,onClose:e,onSaved:t}){const{createCharacter:r,updateCharacter:i}=La(),s=!!n,[a,o]=F.useState({name:"",type:"mecha",height:"",abilities:[""],weaknesses:"",backstory:"",promptTemplate:""}),[c,u]=F.useState(!1),[f,p]=F.useState({});F.useEffect(()=>{var b;n&&o({name:n.name||"",type:n.type||"mecha",height:n.height||"",abilities:((b=n.abilities)==null?void 0:b.length)>0?n.abilities:[""],weaknesses:n.weaknesses||"",backstory:n.backstory||"",promptTemplate:n.promptTemplate||""})},[n]);const m=(b,M)=>{o(N=>({...N,[b]:M})),f[b]&&p(N=>({...N,[b]:null}))},g=(b,M)=>{const N=[...a.abilities];N[b]=M,o(C=>({...C,abilities:N}))},y=()=>{o(b=>({...b,abilities:[...b.abilities,""]}))},S=b=>{a.abilities.length>1&&o(M=>({...M,abilities:M.abilities.filter((N,C)=>C!==b)}))},w=()=>{const b=yr.find(C=>C.value===a.type),M=(b==null?void 0:b.label)||a.type;let N=`${a.name}, ${M}`;a.height&&(N+=`, ${a.height} tall`),a.abilities.filter(C=>C.trim()).length>0&&(N+=`, with abilities: ${a.abilities.filter(C=>C.trim()).join(", ")}`),N+=", highly detailed, cinematic lighting, epic scene",o(C=>({...C,promptTemplate:N}))},x=()=>{const b={};return a.name.trim()||(b.name=""),p(b),Object.keys(b).length===0},_=async b=>{if(b.preventDefault(),!!x()){u(!0);try{const M={...a,abilities:a.abilities.filter(N=>N.trim())};s?await i(n.id,M):await r(M),t==null||t(),e()}catch(M){console.error("Save failed:",M)}finally{u(!1)}}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:e,children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",onClick:b=>b.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"":""}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5 text-gray-500"})})]}),l.jsx("form",{onSubmit:_,className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:l.jsxs("div",{className:"p-6 space-y-5",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:a.name,onChange:b=>m("name",b.target.value),placeholder:"",className:`w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${f.name?"border-red-500":"border-gray-300"}`}),f.name&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2",children:yr.map(b=>l.jsxs("button",{type:"button",onClick:()=>m("type",b.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center ${a.type===b.value?`${b.color} text-white`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[l.jsx("span",{className:"mr-1.5",children:b.icon}),b.label]},b.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"/"}),l.jsx("input",{type:"text",value:a.height,onChange:b=>m("height",b.target.value),placeholder:"80",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"space-y-2",children:[a.abilities.map((b,M)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:b,onChange:N=>g(M,N.target.value),placeholder:` ${M+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"}),l.jsx("button",{type:"button",onClick:()=>S(M),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg",children:l.jsx(zr,{className:"w-4 h-4"})})]},M)),l.jsxs("button",{type:"button",onClick:y,className:"flex items-center text-sm text-primary-600 hover:text-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-1"}),""]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"text",value:a.weaknesses,onChange:b=>m("weaknesses",b.target.value),placeholder:"",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("textarea",{value:a.backstory,onChange:b=>m("backstory",b.target.value),placeholder:"...",rows:3,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 resize-none"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),l.jsxs("button",{type:"button",onClick:w,className:"flex items-center text-sm text-primary-600 hover:text-primary-700",children:[l.jsx(xf,{className:"w-4 h-4 mr-1"}),""]})]}),l.jsx("textarea",{value:a.promptTemplate,onChange:b=>m("promptTemplate",b.target.value),placeholder:"AI...",rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 resize-none font-mono text-sm"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ComfyUI"})]})]})}),l.jsxs("div",{className:"flex items-center justify-end px-6 py-4 border-t bg-gray-50 space-x-3",children:[l.jsx("button",{type:"button",onClick:e,className:"px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:""}),l.jsxs("button",{onClick:_,disabled:c,className:"flex items-center px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[l.jsx(mf,{className:"w-4 h-4 mr-2"}),c?"...":s?"":""]})]})]})})}function Ek({character:n,onClose:e,onEdit:t,onLinkImages:r}){var y;const{updateCharacter:i}=La(),[s,a]=F.useState(!1),[o,c]=F.useState(0);if(!n)return null;const u=yr.find(S=>S.value===n.type)||yr[4],f=n.images||[],p=f[o],m=()=>{n.promptTemplate&&(navigator.clipboard.writeText(n.promptTemplate),a(!0),setTimeout(()=>a(!1),2e3))},g=async S=>{await i(n.id,{coverImageId:S})};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:e,children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex",onClick:S=>S.stopPropagation(),children:[l.jsxs("div",{className:"w-1/2 bg-gray-900 flex flex-col",children:[l.jsx("div",{className:"flex-1 flex items-center justify-center p-6 min-h-0",children:p?l.jsx("img",{src:`/uploads/${p.filename}`,alt:n.name,className:"max-w-full max-h-full object-contain rounded-lg"}):l.jsxs("div",{className:"flex flex-col items-center text-gray-500",children:[l.jsx("span",{className:"text-8xl mb-4",children:u.icon}),l.jsx("p",{className:"text-gray-400",children:""}),l.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"mt-4 flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white text-sm",children:[l.jsx(Di,{className:"w-4 h-4 mr-2"}),""]})]})}),f.length>0&&l.jsxs("div",{className:"px-6 pb-4",children:[l.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[f.map((S,w)=>l.jsxs("div",{onClick:()=>c(w),className:`w-16 h-16 rounded-lg overflow-hidden flex-shrink-0 cursor-pointer border-2 transition-all ${w===o?"border-primary-500":"border-transparent opacity-60 hover:opacity-100"}`,children:[l.jsx("img",{src:`/uploads/${S.filename}`,alt:"",className:"w-full h-full object-cover"}),S.id===n.coverImageId&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:l.jsx(cC,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"})})]},S.id)),l.jsx("button",{onClick:()=>r==null?void 0:r(n),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-600 flex items-center justify-center text-gray-500 hover:border-gray-400 hover:text-gray-300 flex-shrink-0",children:l.jsx(Di,{className:"w-5 h-5"})})]}),p&&p.id!==n.coverImageId&&l.jsxs("button",{onClick:()=>g(p.id),className:"mt-2 text-xs text-gray-400 hover:text-white flex items-center",children:[l.jsx(cC,{className:"w-3 h-3 mr-1"}),""]})]})]}),l.jsxs("div",{className:"w-1/2 flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsxs("span",{className:`px-2.5 py-1 ${u.color} text-white text-xs font-medium rounded-full mr-3`,children:[u.icon," ",u.label]}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n.name})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>t==null?void 0:t(n),className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500 hover:text-gray-700",children:l.jsx($u,{className:"w-5 h-5"})}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5 text-gray-500"})})]})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5",children:[n.height&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"/"}),l.jsx("p",{className:"text-gray-900",children:n.height})]}),((y=n.abilities)==null?void 0:y.length)>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.abilities.map((S,w)=>l.jsx("span",{className:"px-3 py-1.5 bg-primary-50 text-primary-700 rounded-lg text-sm",children:S},w))})]}),n.weaknesses&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:""}),l.jsx("p",{className:"text-gray-900",children:n.weaknesses})]}),n.backstory&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:""}),l.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.backstory})]}),n.promptTemplate&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500",children:""}),l.jsx("button",{onClick:m,className:"flex items-center text-sm text-primary-600 hover:text-primary-700",children:s?l.jsxs(l.Fragment,{children:[l.jsx(Jn,{className:"w-4 h-4 mr-1"}),""]}):l.jsxs(l.Fragment,{children:[l.jsx(di,{className:"w-4 h-4 mr-1"}),""]})})]}),l.jsx("div",{className:"p-3 bg-gray-100 rounded-lg",children:l.jsx("p",{className:"text-sm text-gray-700 font-mono whitespace-pre-wrap",children:n.promptTemplate})})]}),l.jsx("div",{className:"pt-4 border-t",children:l.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[l.jsxs("span",{children:[": ",f.length," "]}),l.jsxs("span",{children:[": ",new Date(n.createdAt).toLocaleDateString("zh-CN")]})]})})]})]})]})})}function u3({title:n,selectedIds:e=[],onConfirm:t,onClose:r,multiple:i=!0}){const{images:s,fetchImages:a,loading:o}=tw(),[c,u]=F.useState(new Set(e)),[f,p]=F.useState(""),[m,g]=F.useState("all");F.useEffect(()=>{a()},[]);const y=x=>{u(i?_=>{const b=new Set(_);return b.has(x)?b.delete(x):b.add(x),b}:new Set([x]))},S=s.filter(x=>{var _;return!(m!=="all"&&x.category!==m||f&&!((_=x.originalName)!=null&&_.toLowerCase().includes(f.toLowerCase())))}),w=()=>{t(Array.from(c)),r()};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:r,children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] overflow-hidden flex flex-col",onClick:x=>x.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n||""}),l.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"flex items-center gap-3 px-6 py-3 border-b bg-gray-50",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(nc,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),l.jsx("input",{type:"text",value:f,onChange:x=>p(x.target.value),placeholder:"...",className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"})]}),l.jsxs("select",{value:m,onChange:x=>g(x.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500",children:[l.jsx("option",{value:"all",children:""}),ou.map(x=>l.jsx("option",{value:x.value,children:x.label},x.value))]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o?l.jsx("div",{className:"flex items-center justify-center h-48",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"})}):S.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500",children:[l.jsx(Di,{className:"w-12 h-12 mb-2 text-gray-300"}),l.jsx("p",{children:""})]}):l.jsx("div",{className:"grid grid-cols-4 gap-4",children:S.map(x=>{const _=c.has(x.id);return l.jsxs("div",{onClick:()=>y(x.id),className:`aspect-square rounded-lg overflow-hidden cursor-pointer relative border-2 transition-all ${_?"border-primary-500 ring-2 ring-primary-200":"border-transparent hover:border-gray-300"}`,children:[l.jsx("img",{src:`/uploads/${x.filename}`,alt:x.originalName,className:"w-full h-full object-cover"}),_&&l.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-primary-500 rounded-full flex items-center justify-center",children:l.jsx(Jn,{className:"w-4 h-4 text-white"})}),l.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/60 to-transparent p-2",children:l.jsx("p",{className:"text-white text-xs truncate",children:x.originalName})})]},x.id)})})}),l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t bg-gray-50",children:[l.jsxs("span",{className:"text-sm text-gray-500",children:[" ",c.size," "]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:r,className:"px-5 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:""}),l.jsx("button",{onClick:w,disabled:c.size===0,className:"px-5 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:""})]})]})]})})}function Tk(){var j;const{characters:n,loading:e,filter:t,fetchCharacters:r,deleteCharacter:i,linkImages:s,setFilter:a}=La(),[o,c]=F.useState(!1),[u,f]=F.useState(null),[p,m]=F.useState(null),[g,y]=F.useState(null),[S,w]=F.useState("grid"),[x,_]=F.useState("");F.useEffect(()=>{r()},[]);const b=O=>{_(O)},M=n.filter(O=>!(x&&!O.name.toLowerCase().includes(x.toLowerCase()))),N=O=>{f(O),c(!0),m(null)},C=async O=>{confirm(` "${O.name}" `)&&await i(O.id)},I=O=>{y(O),m(null)},P=async O=>{g&&await s(g.id,O)},T=()=>{c(!1),f(null)},R=yr.map(O=>({...O,count:n.filter(k=>k.type===O.value).length}));return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(nc,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"...",value:x,onChange:O=>b(O.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent w-64"})]})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden",children:[l.jsx("button",{onClick:()=>w("grid"),className:`p-2 ${S==="grid"?"bg-primary-50 text-primary-600":"text-gray-500 hover:bg-gray-50"}`,children:l.jsx(K0,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>w("list"),className:`p-2 ${S==="list"?"bg-primary-50 text-primary-600":"text-gray-500 hover:bg-gray-50"}`,children:l.jsx(qb,{className:"w-5 h-5"})})]}),l.jsxs("button",{onClick:()=>{f(null),c(!0)},className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 overflow-x-auto pb-2",children:[l.jsxs("button",{onClick:()=>a({type:"all"}),className:`px-4 py-2 text-sm rounded-lg whitespace-nowrap transition-colors ${t.type==="all"?"bg-gray-900 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",n.length,")"]}),R.map(O=>l.jsxs("button",{onClick:()=>a({type:O.value}),className:`flex items-center px-4 py-2 text-sm rounded-lg whitespace-nowrap transition-colors ${t.type===O.value?`${O.color} text-white`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[l.jsx("span",{className:"mr-1.5",children:O.icon}),O.label," (",O.count,")"]},O.value))]}),e?l.jsxs("div",{className:"text-center py-16",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"}),l.jsx("p",{className:"mt-2 text-gray-500",children:"..."})]}):M.length===0?l.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border border-gray-200",children:[l.jsx(Wl,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:n.length===0?"":""}),l.jsx("p",{className:"text-gray-400 mb-4",children:n.length===0?"":""}),n.length===0&&l.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})]}):S==="grid"?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:M.map(O=>l.jsx(Mk,{character:O,onEdit:N,onDelete:C,onLinkImages:I,onViewDetail:m},O.id))}):l.jsx("div",{className:"bg-white rounded-xl border border-gray-200 divide-y",children:M.map(O=>{var te,K,$,U;const k=yr.find(H=>H.value===O.type)||yr[4],Z=((te=O.images)==null?void 0:te.find(H=>H.id===O.coverImageId))||((K=O.images)==null?void 0:K[0]);return l.jsxs("div",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>m(O),children:[l.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0 mr-4",children:Z?l.jsx("img",{src:`/uploads/${Z.filename}`,alt:O.name,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:k.icon})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:O.name}),l.jsx("span",{className:`ml-2 px-2 py-0.5 ${k.color} text-white text-xs rounded-full`,children:k.label})]}),O.height&&l.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:O.height}),(($=O.abilities)==null?void 0:$.length)>0&&l.jsx("div",{className:"flex gap-1 mt-1",children:O.abilities.slice(0,3).map((H,W)=>l.jsx("span",{className:"text-xs text-gray-400",children:H},W))})]}),l.jsxs("div",{className:"text-sm text-gray-400 mr-4",children:[((U=O.images)==null?void 0:U.length)||0," "]}),l.jsx("div",{className:"text-sm text-gray-400",children:new Date(O.createdAt).toLocaleDateString("zh-CN")})]},O.id)})}),o&&l.jsx(Ck,{character:u,onClose:T,onSaved:()=>r()}),p&&l.jsx(Ek,{character:p,onClose:()=>m(null),onEdit:N,onLinkImages:I}),g&&l.jsx(u3,{title:` "${g.name}" `,selectedIds:((j=g.images)==null?void 0:j.map(O=>O.id))||[],onConfirm:P,onClose:()=>y(null)})]})}const Nk=Es((n,e)=>({chapters:[],currentChapter:null,loading:!1,error:null,saving:!1,hasUnsavedChanges:!1,fetchChapters:async()=>{n({loading:!0,error:null});try{const r=await(await fetch("/api/story")).json();return n({chapters:r,loading:!1}),r}catch(t){throw n({error:t.message,loading:!1}),t}},fetchChapter:async t=>{try{const i=await(await fetch(`/api/story/${t}`)).json();return n({currentChapter:i,hasUnsavedChanges:!1}),i}catch(r){throw r}},setCurrentChapter:t=>{n({currentChapter:t,hasUnsavedChanges:!1})},updateCurrentChapter:t=>{n(r=>({currentChapter:r.currentChapter?{...r.currentChapter,...t}:null,hasUnsavedChanges:!0}))},createChapter:async t=>{n({saving:!0});try{const r=await fetch("/api/story",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await r.json();return r.ok&&n(s=>({chapters:[...s.chapters,i],currentChapter:i,hasUnsavedChanges:!1})),i}catch(r){throw r}finally{n({saving:!1})}},saveChapter:async(t,r)=>{n({saving:!0});try{const s=await(await fetch(`/api/story/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>{var o;return{chapters:a.chapters.map(c=>c.id===t?{...c,...s}:c),currentChapter:((o=a.currentChapter)==null?void 0:o.id)===t?{...a.currentChapter,...s}:a.currentChapter,hasUnsavedChanges:!1}}),s}catch(i){throw i}finally{n({saving:!1})}},deleteChapter:async t=>{try{await fetch(`/api/story/${t}`,{method:"DELETE"}),n(r=>{var i;return{chapters:r.chapters.filter(s=>s.id!==t),currentChapter:((i=r.currentChapter)==null?void 0:i.id)===t?null:r.currentChapter}})}catch(r){throw r}},reorderChapters:async t=>{try{await fetch("/api/story/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t})}),n(r=>{const i=new Map(t.map(a=>[a.id,a.orderIndex]));return{chapters:[...r.chapters].sort((a,o)=>(i.get(a.id)||a.orderIndex)-(i.get(o.id)||o.orderIndex))}})}catch(r){throw r}},clearUnsavedChanges:()=>n({hasUnsavedChanges:!1})}));function Rk(){var te;const{chapters:n,currentChapter:e,loading:t,saving:r,hasUnsavedChanges:i,fetchChapters:s,setCurrentChapter:a,updateCurrentChapter:o,createChapter:c,saveChapter:u,deleteChapter:f}=Nk(),{characters:p,fetchCharacters:m}=La(),[g,y]=F.useState(!1),[S,w]=F.useState(""),[x,_]=F.useState(!1),[b,M]=F.useState(""),[N,C]=F.useState({top:0,left:0}),I=F.useRef(null);F.useEffect(()=>{s(),m()},[]),F.useEffect(()=>{n.length>0&&!e&&a(n[0])},[n,e]);const P=async()=>{S.trim()&&(await c({title:S,content:"",chapter:n.length+1}),w(""),y(!1))},T=async()=>{e&&await u(e.id,{title:e.title,content:e.content})},R=async K=>{confirm(` "${K.title}" `)&&await f(K.id)},j=K=>{const $=K.target.value;o({content:$});const U=K.target.selectionStart,H=$.slice(0,U),W=H.lastIndexOf("@");if(W!==-1){const Y=H.slice(W+1);!Y.includes(" ")&&!Y.includes(`
`)?(M(Y),_(!0),C({top:0,left:W*8})):_(!1)}else _(!1)},O=K=>{if(!e||!I.current)return;const $=I.current,U=$.selectionStart,H=e.content,W=H.slice(0,U).lastIndexOf("@"),Y=H.slice(0,W)+`@${K.name} `+H.slice(U);o({content:Y}),_(!1),setTimeout(()=>{$.focus();const G=W+K.name.length+2;$.setSelectionRange(G,G)},0)},k=p.filter(K=>K.name.toLowerCase().includes(b.toLowerCase())),Z=((te=e==null?void 0:e.content)==null?void 0:te.length)||0;return l.jsxs("div",{className:"flex h-[calc(100vh-8rem)] -m-6",children:[l.jsxs("div",{className:"w-72 bg-white border-r border-gray-200 flex flex-col",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:g?l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:S,onChange:K=>w(K.target.value),onKeyDown:K=>K.key==="Enter"&&P(),placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500",autoFocus:!0}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:P,className:"flex-1 py-1.5 bg-primary-600 text-white text-sm rounded-lg hover:bg-primary-700",children:""}),l.jsx("button",{onClick:()=>{y(!1),w("")},className:"flex-1 py-1.5 bg-gray-100 text-gray-600 text-sm rounded-lg hover:bg-gray-200",children:""})]})]}):l.jsxs("button",{onClick:()=>y(!0),className:"w-full flex items-center justify-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:t?l.jsx("div",{className:"text-center py-8 text-gray-400",children:l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-primary-500 border-t-transparent mx-auto"})}):n.length===0?l.jsxs("div",{className:"text-center py-8 text-gray-400 text-sm px-4",children:[l.jsx(Wh,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"mb-1",children:""}),l.jsx("p",{className:"text-xs",children:""})]}):l.jsx("ul",{className:"p-2 space-y-1",children:n.map((K,$)=>l.jsx("li",{children:l.jsxs("button",{onClick:()=>a(K),className:`w-full flex items-center px-3 py-2.5 text-left rounded-lg group transition-colors ${(e==null?void 0:e.id)===K.id?"bg-primary-50 text-primary-700":"hover:bg-gray-100 text-gray-700"}`,children:[l.jsx(qN,{className:"w-4 h-4 text-gray-300 mr-2 opacity-0 group-hover:opacity-100 cursor-grab"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsxs("span",{className:"text-xs text-gray-400 mr-2",children:["#",$+1]}),l.jsx("span",{className:"text-sm font-medium truncate",children:K.title})]}),K.content&&l.jsxs("p",{className:"text-xs text-gray-400 truncate mt-0.5",children:[K.content.slice(0,50),"..."]})]}),l.jsx("button",{onClick:U=>{U.stopPropagation(),R(K)},className:"p-1 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100",children:l.jsx(zr,{className:"w-4 h-4"})})]})},K.id))})}),l.jsxs("div",{className:"p-4 border-t border-gray-200 text-xs text-gray-500",children:[" ",n.length," "]})]}),l.jsx("div",{className:"flex-1 flex flex-col bg-gray-50",children:e?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"text",value:e.title,onChange:K=>o({title:K.target.value}),placeholder:"...",className:"text-lg font-medium text-gray-900 border-none focus:ring-0 p-0 bg-transparent"}),i&&l.jsxs("span",{className:"ml-3 flex items-center text-amber-600 text-sm",children:[l.jsx(Ba,{className:"w-4 h-4 mr-1"}),""]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[l.jsx(YN,{className:"w-4 h-4 mr-1"}),Z," "]}),l.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[l.jsx(Zb,{className:"w-4 h-4 mr-1"}),"v",e.version]}),l.jsxs("button",{onClick:T,disabled:r||!i,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[l.jsx(mf,{className:"w-4 h-4 mr-2"}),r?"...":""]})]})]}),l.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto relative",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 min-h-[70vh]",children:l.jsx("textarea",{ref:I,value:e.content,onChange:j,placeholder:`...


  @ 
 
 `,className:"w-full h-full min-h-[70vh] p-8 text-gray-800 leading-relaxed resize-none border-none focus:ring-0 rounded-xl text-base"})}),x&&k.length>0&&l.jsxs("div",{className:"absolute bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-10 max-h-64 overflow-y-auto w-48",style:{top:"100px",left:"50px"},children:[l.jsx("p",{className:"px-3 py-1 text-xs text-gray-400",children:""}),k.map(K=>l.jsxs("button",{onClick:()=>O(K),className:"w-full px-3 py-2 text-left hover:bg-gray-100 flex items-center",children:[l.jsx("span",{className:"w-6 h-6 rounded-full bg-primary-100 text-primary-600 flex items-center justify-center text-xs mr-2",children:K.name[0]}),l.jsx("span",{className:"text-sm text-gray-700",children:K.name})]},K.id))]})]})})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-gray-400",children:[l.jsx(Wh,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l.jsx("p",{className:"text-lg",children:""}),l.jsx("p",{className:"text-sm mt-1",children:""})]})})})]})}const Ig=[{value:"city",label:"",icon:""},{value:"downtown",label:"",icon:""},{value:"industrial",label:"",icon:""},{value:"harbor",label:"",icon:""},{value:"bridge",label:"",icon:""},{value:"mountain",label:"",icon:""},{value:"ocean",label:"",icon:""},{value:"sky",label:"",icon:""},{value:"space",label:"",icon:""},{value:"underground",label:"",icon:""}],Pg=[{value:"dawn",label:"",icon:""},{value:"day",label:"",icon:""},{value:"dusk",label:"",icon:""},{value:"night",label:"",icon:""}],C1=[{value:"clear",label:"",icon:""},{value:"cloudy",label:"",icon:""},{value:"rain",label:"",icon:""},{value:"storm",label:"",icon:""},{value:"snow",label:"",icon:""},{value:"fog",label:"",icon:""}],E1=[{value:"tense",label:""},{value:"epic",label:""},{value:"dramatic",label:""},{value:"peaceful",label:""},{value:"chaotic",label:""},{value:"mysterious",label:""}],ed=Es((n,e)=>({scenes:[],currentScene:null,loading:!1,error:null,fetchScenes:async()=>{n({loading:!0,error:null});try{const r=await(await fetch("/api/scenes")).json();return n({scenes:r,loading:!1}),r}catch(t){throw n({error:t.message,loading:!1}),t}},fetchScene:async t=>{try{const i=await(await fetch(`/api/scenes/${t}`)).json();return n({currentScene:i}),i}catch(r){throw r}},createScene:async t=>{try{const r=await fetch("/api/scenes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await r.json();return r.ok&&n(s=>({scenes:[i,...s.scenes]})),i}catch(r){throw r}},updateScene:async(t,r)=>{try{const s=await(await fetch(`/api/scenes/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>{var o;return{scenes:a.scenes.map(c=>c.id===t?{...c,...s}:c),currentScene:((o=a.currentScene)==null?void 0:o.id)===t?{...a.currentScene,...s}:a.currentScene}}),s}catch(i){throw i}},deleteScene:async t=>{try{await fetch(`/api/scenes/${t}`,{method:"DELETE"}),n(r=>{var i;return{scenes:r.scenes.filter(s=>s.id!==t),currentScene:((i=r.currentScene)==null?void 0:i.id)===t?null:r.currentScene}})}catch(r){throw r}},addCharacterToScene:async(t,r,i,s)=>{try{const o=await(await fetch(`/api/scenes/${t}/characters`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({characterId:r,position:i,role:s})})).json();return o.success&&(e().fetchScene(t),e().fetchScenes()),o}catch(a){throw a}},removeCharacterFromScene:async(t,r)=>{try{await fetch(`/api/scenes/${t}/characters/${r}`,{method:"DELETE"}),e().fetchScene(t),e().fetchScenes()}catch(i){throw i}},setCurrentScene:t=>n({currentScene:t}),clearCurrentScene:()=>n({currentScene:null})}));function Ik({scene:n,onClose:e,onSaved:t}){const{createScene:r,updateScene:i}=ed(),s=!!n,[a,o]=F.useState({name:"",description:"",environment:"city",timeOfDay:"day",weather:"clear",atmosphere:"epic",backgroundImageId:null}),[c,u]=F.useState(!1),[f,p]=F.useState(!1),[m,g]=F.useState(null);F.useEffect(()=>{n&&(o({name:n.name||"",description:n.description||"",environment:n.environment||"city",timeOfDay:n.timeOfDay||"day",weather:n.weather||"clear",atmosphere:n.atmosphere||"epic",backgroundImageId:n.backgroundImageId||null}),n.backgroundImage&&g(n.backgroundImage))},[n]);const y=(_,b)=>{o(M=>({...M,[_]:b}))},S=_=>{_.length>0&&(y("backgroundImageId",_[0]),fetch(`/api/images/${_[0]}`).then(b=>b.json()).then(b=>g(b)).catch(()=>{}))},w=()=>{const _=Ig.find(I=>I.value===a.environment),b=Pg.find(I=>I.value===a.timeOfDay),M=C1.find(I=>I.value===a.weather),N=E1.find(I=>I.value===a.atmosphere);let C=`${(b==null?void 0:b.label)||""}${(_==null?void 0:_.label)||""}`;M&&(C+=`${M.label}`),N&&(C+=`${N.label}`),C+="",y("description",C)},x=async()=>{if(a.name.trim()){u(!0);try{s?await i(n.id,a):await r(a),t==null||t(),e()}catch(_){console.error("Save failed:",_)}finally{u(!1)}}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:e,children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",onClick:_=>_.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"":""}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-140px)] p-6 space-y-5",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:a.name,onChange:_=>y("name",_.target.value),placeholder:"",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{onClick:()=>p(!0),className:"border-2 border-dashed border-gray-300 rounded-lg p-4 cursor-pointer hover:border-primary-400 transition-colors",children:m?l.jsxs("div",{className:"flex items-center",children:[l.jsx("img",{src:`/uploads/${m.filename}`,alt:"",className:"w-24 h-16 object-cover rounded mr-4"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-700",children:m.originalName}),l.jsx("p",{className:"text-xs text-gray-400",children:""})]})]}):l.jsxs("div",{className:"text-center py-4",children:[l.jsx(Di,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),l.jsx("p",{className:"text-sm text-gray-500",children:""})]})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-5 gap-2",children:Ig.map(_=>l.jsxs("button",{type:"button",onClick:()=>y("environment",_.value),className:`px-3 py-2 rounded-lg text-sm transition-all ${a.environment===_.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[l.jsx("span",{className:"block text-lg mb-1",children:_.icon}),_.label]},_.value))})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:Pg.map(_=>l.jsxs("button",{type:"button",onClick:()=>y("timeOfDay",_.value),className:`px-3 py-2 rounded-lg text-sm transition-all flex items-center justify-center ${a.timeOfDay===_.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[l.jsx("span",{className:"mr-1",children:_.icon}),_.label]},_.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:C1.map(_=>l.jsxs("button",{type:"button",onClick:()=>y("weather",_.value),className:`px-2 py-2 rounded-lg text-xs transition-all ${a.weather===_.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[l.jsx("span",{className:"block text-base mb-0.5",children:_.icon}),_.label]},_.value))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2",children:E1.map(_=>l.jsx("button",{type:"button",onClick:()=>y("atmosphere",_.value),className:`px-4 py-2 rounded-full text-sm transition-all ${a.atmosphere===_.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:_.label},_.value))})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),l.jsxs("button",{type:"button",onClick:w,className:"flex items-center text-sm text-primary-600 hover:text-primary-700",children:[l.jsx(xf,{className:"w-4 h-4 mr-1"}),""]})]}),l.jsx("textarea",{value:a.description,onChange:_=>y("description",_.target.value),placeholder:"...",rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 resize-none"})]})]}),l.jsxs("div",{className:"flex items-center justify-end px-6 py-4 border-t bg-gray-50 space-x-3",children:[l.jsx("button",{onClick:e,className:"px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:""}),l.jsxs("button",{onClick:x,disabled:c||!a.name.trim(),className:"flex items-center px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[l.jsx(mf,{className:"w-4 h-4 mr-2"}),c?"...":s?"":""]})]})]})}),f&&l.jsx(u3,{title:"",selectedIds:a.backgroundImageId?[a.backgroundImageId]:[],onConfirm:S,onClose:()=>p(!1),multiple:!1})]})}function Pk(){var k,Z,te,K,$,U,H,W;const{scenes:n,loading:e,fetchScenes:t,deleteScene:r,addCharacterToScene:i,removeCharacterFromScene:s}=ed(),{characters:a,fetchCharacters:o}=La(),[c,u]=F.useState(""),[f,p]=F.useState(!1),[m,g]=F.useState(null),[y,S]=F.useState(null),[w,x]=F.useState(!1);F.useEffect(()=>{t(),o()},[]);const _=n.filter(Y=>Y.name.toLowerCase().includes(c.toLowerCase())),b=Y=>{g(Y),p(!0)},M=async Y=>{confirm(` "${Y.name}" `)&&(await r(Y.id),(y==null?void 0:y.id)===Y.id&&S(null))},N=()=>{p(!1),g(null)},C=async Y=>{if(!y)return;await i(y.id,Y);const G=n.find(de=>de.id===y.id);G&&S(G),x(!1)},I=async Y=>{y&&await s(y.id,Y)},P=Y=>Ig.find(G=>G.value===Y),T=Y=>Pg.find(G=>G.value===Y),R=Y=>C1.find(G=>G.value===Y),j=Y=>E1.find(G=>G.value===Y),O=y?a.filter(Y=>{var G;return!((G=y.characters)!=null&&G.some(de=>de.id===Y.id))}):[];return l.jsxs("div",{className:"flex h-[calc(100vh-8rem)] -m-6",children:[l.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200 space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{g(null),p(!0)},className:"flex items-center px-3 py-1.5 bg-primary-600 text-white text-sm rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-1"}),""]})]}),l.jsxs("div",{className:"relative",children:[l.jsx(nc,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"...",value:c,onChange:Y=>u(Y.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:e?l.jsx("div",{className:"text-center py-8",children:l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-primary-500 border-t-transparent mx-auto"})}):_.length===0?l.jsxs("div",{className:"text-center py-8 text-gray-400 px-4",children:[l.jsx(Vl,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-sm",children:""}),l.jsx("p",{className:"text-xs mt-1",children:""})]}):l.jsx("div",{className:"p-2 space-y-2",children:_.map(Y=>{var be;const G=P(Y.environment),de=T(Y.timeOfDay),Ce=(y==null?void 0:y.id)===Y.id;return l.jsx("div",{onClick:()=>S(Y),className:`p-3 rounded-lg cursor-pointer transition-colors ${Ce?"bg-primary-50 border border-primary-200":"hover:bg-gray-50 border border-transparent"}`,children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"w-16 h-12 rounded bg-gray-100 overflow-hidden flex-shrink-0 mr-3",children:Y.backgroundImage?l.jsx("img",{src:`/uploads/${Y.backgroundImage.filename}`,alt:"",className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center text-xl",children:(G==null?void 0:G.icon)||""})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-medium text-gray-900 truncate",children:Y.name}),l.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[l.jsxs("span",{children:[G==null?void 0:G.icon," ",G==null?void 0:G.label]}),l.jsx("span",{children:""}),l.jsxs("span",{children:[de==null?void 0:de.icon," ",de==null?void 0:de.label]})]}),((be=Y.characters)==null?void 0:be.length)>0&&l.jsxs("div",{className:"flex items-center mt-1.5",children:[l.jsx(Wl,{className:"w-3 h-3 text-gray-400 mr-1"}),l.jsxs("span",{className:"text-xs text-gray-400",children:[Y.characters.length," "]})]})]})]})},Y.id)})})})]}),l.jsx("div",{className:"flex-1 bg-gray-50 overflow-y-auto",children:y?l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"relative rounded-xl overflow-hidden bg-gray-200 aspect-video mb-6",children:[y.backgroundImage?l.jsx("img",{src:`/uploads/${y.backgroundImage.filename}`,alt:y.name,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-gray-400",children:[l.jsx(Di,{className:"w-16 h-16 mx-auto mb-2"}),l.jsx("p",{children:""})]})}),l.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[l.jsx("button",{onClick:()=>b(y),className:"p-2 bg-white rounded-lg shadow-lg hover:bg-gray-50",children:l.jsx($u,{className:"w-4 h-4 text-gray-700"})}),l.jsx("button",{onClick:()=>M(y),className:"p-2 bg-white rounded-lg shadow-lg hover:bg-red-50",children:l.jsx(zr,{className:"w-4 h-4 text-red-500"})})]}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-6",children:[l.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:y.name}),l.jsxs("div",{className:"flex items-center gap-4 text-white/80 text-sm",children:[l.jsxs("span",{className:"flex items-center",children:[(k=P(y.environment))==null?void 0:k.icon," ",(Z=P(y.environment))==null?void 0:Z.label]}),l.jsxs("span",{className:"flex items-center",children:[(te=T(y.timeOfDay))==null?void 0:te.icon," ",(K=T(y.timeOfDay))==null?void 0:K.label]}),l.jsxs("span",{className:"flex items-center",children:[($=R(y.weather))==null?void 0:$.icon," ",(U=R(y.weather))==null?void 0:U.label]}),y.atmosphere&&l.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded",children:(H=j(y.atmosphere))==null?void 0:H.label})]})]})]}),y.description&&l.jsxs("div",{className:"bg-white rounded-xl p-5 mb-6",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:""}),l.jsx("p",{className:"text-gray-600",children:y.description})]}),l.jsxs("div",{className:"bg-white rounded-xl p-5",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:""}),l.jsxs("button",{onClick:()=>x(!0),className:"flex items-center px-3 py-1.5 text-sm text-primary-600 hover:bg-primary-50 rounded-lg",children:[l.jsx(vi,{className:"w-4 h-4 mr-1"}),""]})]}),((W=y.characters)==null?void 0:W.length)>0?l.jsx("div",{className:"grid grid-cols-2 gap-4",children:y.characters.map(Y=>{var Ce;const G=yr.find(be=>be.value===Y.type),de=(Ce=Y.images)==null?void 0:Ce[0];return l.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg group",children:[l.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-gray-200 mr-3 flex-shrink-0",children:de?l.jsx("img",{src:`/uploads/${de.filename}`,alt:"",className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center text-xl",children:G==null?void 0:G.icon})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 truncate",children:Y.name}),l.jsx("p",{className:"text-xs text-gray-500",children:G==null?void 0:G.label})]}),l.jsx("button",{onClick:()=>I(Y.id),className:"p-1.5 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100",children:l.jsx(zr,{className:"w-4 h-4"})})]},Y.id)})}):l.jsxs("div",{className:"text-center py-8 text-gray-400",children:[l.jsx(Wl,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-sm",children:""})]})]})]}):l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-gray-400",children:[l.jsx(Vl,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l.jsx("p",{className:"text-lg",children:""}),l.jsx("p",{className:"text-sm mt-1",children:""})]})})}),f&&l.jsx(Ik,{scene:m,onClose:N,onSaved:()=>t()}),w&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:()=>x(!1),children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[70vh] overflow-hidden",onClick:Y=>Y.stopPropagation(),children:[l.jsx("div",{className:"p-4 border-b",children:l.jsx("h3",{className:"font-medium",children:""})}),l.jsx("div",{className:"p-4 overflow-y-auto max-h-[50vh]",children:O.length===0?l.jsx("p",{className:"text-center text-gray-400 py-8",children:""}):l.jsx("div",{className:"space-y-2",children:O.map(Y=>{const G=yr.find(de=>de.value===Y.type);return l.jsxs("button",{onClick:()=>C(Y.id),className:"w-full flex items-center p-3 hover:bg-gray-50 rounded-lg text-left",children:[l.jsx("span",{className:"text-2xl mr-3",children:G==null?void 0:G.icon}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:Y.name}),l.jsx("p",{className:"text-xs text-gray-500",children:G==null?void 0:G.label})]})]},Y.id)})})})]})})]})}const Wc=[{value:"cut",label:"",icon:"",description:""},{value:"fade",label:"",icon:"",description:""},{value:"dissolve",label:"",icon:"",description:""},{value:"wipe",label:"",icon:"",description:""},{value:"zoom",label:"",icon:"",description:""},{value:"match",label:"",icon:"",description:"/"},{value:"flashback",label:"",icon:"",description:""},{value:"flashforward",label:"",icon:"",description:""}],ih=[{value:"sequential",label:"",color:"#3B82F6",description:""},{value:"branching",label:"",color:"#F59E0B",description:""},{value:"parallel",label:"",color:"#10B981",description:""},{value:"conditional",label:"",color:"#8B5CF6",description:""}],Bk=Es((n,e)=>({nodes:[],edges:[],selectedNodeId:null,selectedEdgeId:null,connectingFrom:null,loading:!1,error:null,zoom:1,panX:0,panY:0,fetchFlowData:async()=>{n({loading:!0,error:null});try{const r=await(await fetch("/api/scene-flow")).json();return n({nodes:r.nodes||[],edges:r.edges||[],loading:!1}),r}catch(t){throw n({error:t.message,loading:!1}),t}},createConnection:async(t,r,i={})=>{try{const s=await fetch("/api/scene-flow/connections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:t,targetId:r,transitionType:i.transitionType||"cut",condition:i.condition||"sequential",description:i.description||null})}),a=await s.json();if(s.ok)n(o=>({edges:[...o.edges,a]}));else throw new Error(a.error);return a}catch(s){throw s}},updateConnection:async(t,r)=>{try{const i=await fetch(`/api/scene-flow/connections/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await i.json();return i.ok&&n(a=>({edges:a.edges.map(o=>o.id===t?{...o,...s}:o)})),s}catch(i){throw i}},deleteConnection:async t=>{try{await fetch(`/api/scene-flow/connections/${t}`,{method:"DELETE"}),n(r=>({edges:r.edges.filter(i=>i.id!==t),selectedEdgeId:r.selectedEdgeId===t?null:r.selectedEdgeId}))}catch(r){throw r}},updateNodePosition:async(t,r,i)=>{n(s=>({nodes:s.nodes.map(a=>a.id===t?{...a,x:r,y:i}:a)}));try{await fetch(`/api/scene-flow/positions/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({x:r,y:i})})}catch(s){console.error("Failed to save position:",s)}},updatePositions:async t=>{try{await fetch("/api/scene-flow/positions",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({positions:t})})}catch(r){console.error("Failed to save positions:",r)}},autoLayout:async()=>{try{const r=await(await fetch("/api/scene-flow/auto-layout",{method:"POST"})).json();return r.success&&e().fetchFlowData(),r}catch(t){throw t}},selectNode:t=>n({selectedNodeId:t,selectedEdgeId:null}),selectEdge:t=>n({selectedEdgeId:t,selectedNodeId:null}),clearSelection:()=>n({selectedNodeId:null,selectedEdgeId:null}),startConnecting:t=>n({connectingFrom:t}),endConnecting:async t=>{const{connectingFrom:r,createConnection:i}=e();if(r&&r!==t)try{await i(r,t)}catch(s){console.error("Failed to create connection:",s)}n({connectingFrom:null})},cancelConnecting:()=>n({connectingFrom:null}),setZoom:t=>n({zoom:Math.max(.25,Math.min(2,t))}),setPan:(t,r)=>n({panX:t,panY:r}),resetView:()=>n({zoom:1,panX:0,panY:0})})),Xc=180,ao=100,xv=n=>Ig.find(e=>e.value===n),yv=n=>Pg.find(e=>e.value===n);function Lk(n,e,t,r){const i=t-n,s=Math.min(Math.abs(i)*.5,100),a=n+Xc,o=e+ao/2,c=t,u=r+ao/2;return`M ${a} ${o} C ${a+s} ${o}, ${c-s} ${u}, ${c} ${u}`}function Dk(n,e){const t=n,r=e+ao/2,i=8;return`${t},${r} ${t-i},${r-i/2} ${t-i},${r+i/2}`}function Fk(){var Be,Ie,Ye,Q,vt,et,Ct,Ge,J,L;const{nodes:n,edges:e,loading:t,selectedNodeId:r,selectedEdgeId:i,connectingFrom:s,zoom:a,panX:o,panY:c,fetchFlowData:u,createConnection:f,updateConnection:p,deleteConnection:m,updateNodePosition:g,autoLayout:y,selectNode:S,selectEdge:w,clearSelection:x,startConnecting:_,endConnecting:b,cancelConnecting:M,setZoom:N,setPan:C,resetView:I}=Bk(),P=F.useRef(null),[T,R]=F.useState(!1),[j,O]=F.useState(null),[k,Z]=F.useState({x:0,y:0}),[te,K]=F.useState(!1),[$,U]=F.useState({x:0,y:0}),[H,W]=F.useState({x:0,y:0}),[Y,G]=F.useState(!1),[de,Ce]=F.useState(null);F.useEffect(()=>{u()},[]);const be=F.useCallback((q,pe)=>{if(!P.current)return{x:0,y:0};const ve=P.current.getBoundingClientRect();return{x:(q-ve.left-o)/a,y:(pe-ve.top-c)/a}},[o,c,a]),se=(q,pe=null)=>{if(q.button===1||q.button===0&&q.altKey)q.preventDefault(),K(!0),U({x:q.clientX-o,y:q.clientY-c});else if(pe&&q.button===0){const ve=be(q.clientX,q.clientY),ge=n.find(st=>st.id===pe);ge&&(R(!0),O(pe),Z({x:ve.x-ge.x,y:ve.y-ge.y}),S(pe))}else q.button===0&&!pe&&(x(),M())},_e=q=>{const pe=be(q.clientX,q.clientY);if(W(pe),te)C(q.clientX-$.x,q.clientY-$.y);else if(T&&j){const ve=Math.max(0,pe.x-k.x),ge=Math.max(0,pe.y-k.y);g(j,ve,ge)}},Le=()=>{R(!1),O(null),K(!1)},yt=q=>{q.preventDefault();const pe=q.deltaY>0?-.1:.1;N(a+pe)},qe=(q,pe)=>{q.preventDefault(),s?b(pe):_(pe)},lt=q=>{Ce(q),G(!0)},kt=async q=>{de&&await p(de.id,q),G(!1),Ce(null)},it=n.find(q=>q.id===r),Me=e.find(q=>q.id===i);return l.jsxs("div",{className:"flex h-[calc(100vh-8rem)] -m-6",children:[l.jsxs("div",{className:"flex-1 relative bg-gray-100 overflow-hidden",children:[l.jsx("div",{className:"absolute top-4 left-4 z-10 flex items-center gap-2",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg flex items-center",children:[l.jsx("button",{onClick:()=>N(a+.1),className:"p-2 hover:bg-gray-100 rounded-l-lg",title:"",children:l.jsx(n3,{className:"w-5 h-5 text-gray-600"})}),l.jsxs("span",{className:"px-2 text-sm text-gray-600 min-w-[60px] text-center",children:[Math.round(a*100),"%"]}),l.jsx("button",{onClick:()=>N(a-.1),className:"p-2 hover:bg-gray-100",title:"",children:l.jsx(r3,{className:"w-5 h-5 text-gray-600"})}),l.jsx("div",{className:"w-px h-6 bg-gray-200"}),l.jsx("button",{onClick:I,className:"p-2 hover:bg-gray-100",title:"",children:l.jsx(Qb,{className:"w-5 h-5 text-gray-600"})}),l.jsx("button",{onClick:y,className:"p-2 hover:bg-gray-100 rounded-r-lg",title:"",children:l.jsx(RF,{className:"w-5 h-5 text-gray-600"})})]})}),s&&l.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-10 bg-primary-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2",children:[l.jsx(oC,{className:"w-4 h-4"}),l.jsx("span",{children:""}),l.jsx("button",{onClick:M,className:"ml-2 p-1 hover:bg-primary-700 rounded",children:l.jsx(Hn,{className:"w-4 h-4"})})]}),l.jsx("div",{ref:P,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:q=>se(q),onMouseMove:_e,onMouseUp:Le,onMouseLeave:Le,onWheel:yt,onContextMenu:q=>q.preventDefault(),children:l.jsxs("svg",{className:"w-full h-full",style:{transform:`translate(${o}px, ${c}px) scale(${a})`,transformOrigin:"0 0"},children:[l.jsx("defs",{children:l.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:l.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#e5e7eb",strokeWidth:"1"})})}),l.jsx("rect",{width:"5000",height:"5000",fill:"url(#grid)"}),e.map(q=>{var Ke,dt;const pe=n.find(_t=>_t.id===q.sourceId),ve=n.find(_t=>_t.id===q.targetId);if(!pe||!ve)return null;const ge=ih.find(_t=>_t.value===q.condition),st=i===q.id;return l.jsxs("g",{className:"cursor-pointer",onClick:()=>w(q.id),children:[l.jsx("path",{d:Lk(pe.x,pe.y,ve.x,ve.y),fill:"none",stroke:st?"#3B82F6":(ge==null?void 0:ge.color)||"#9CA3AF",strokeWidth:st?3:2,className:"transition-all"}),l.jsx("polygon",{points:Dk(ve.x,ve.y),fill:st?"#3B82F6":(ge==null?void 0:ge.color)||"#9CA3AF"}),q.transitionType&&l.jsxs("text",{x:(pe.x+Xc+ve.x)/2,y:(pe.y+ve.y+ao)/2-8,textAnchor:"middle",className:"text-xs fill-gray-500",children:[(Ke=Wc.find(_t=>_t.value===q.transitionType))==null?void 0:Ke.icon,(dt=Wc.find(_t=>_t.value===q.transitionType))==null?void 0:dt.label]})]},q.id)}),s&&l.jsx("line",{x1:((Be=n.find(q=>q.id===s))==null?void 0:Be.x)+Xc||0,y1:(((Ie=n.find(q=>q.id===s))==null?void 0:Ie.y)||0)+ao/2,x2:H.x,y2:H.y,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"5,5"}),n.map(q=>{var Ke;const pe=xv(q.environment),ve=yv(q.timeOfDay),ge=r===q.id,st=s===q.id;return l.jsxs("g",{transform:`translate(${q.x}, ${q.y})`,className:"cursor-move",onMouseDown:dt=>{dt.stopPropagation(),se(dt,q.id)},onContextMenu:dt=>qe(dt,q.id),children:[l.jsx("rect",{width:Xc,height:ao,rx:"8",fill:"white",stroke:ge?"#3B82F6":st?"#10B981":"#E5E7EB",strokeWidth:ge||st?3:1,className:"transition-all drop-shadow-md"}),l.jsx("text",{x:"12",y:"28",className:"text-lg",children:(pe==null?void 0:pe.icon)||""}),l.jsx("text",{x:"36",y:"28",className:"text-sm font-medium fill-gray-900",children:((Ke=q.name)==null?void 0:Ke.length)>12?q.name.slice(0,12)+"...":q.name}),l.jsxs("text",{x:"12",y:"52",className:"text-xs fill-gray-500",children:[ve==null?void 0:ve.icon," ",ve==null?void 0:ve.label,q.characterCount>0&&`  ${q.characterCount}`]}),l.jsx("circle",{cx:"0",cy:ao/2,r:"6",fill:"#fff",stroke:"#9CA3AF",strokeWidth:"2",className:"hover:stroke-primary-500"}),l.jsx("circle",{cx:Xc,cy:ao/2,r:"6",fill:st?"#10B981":"#fff",stroke:st?"#10B981":"#9CA3AF",strokeWidth:"2",className:"hover:stroke-primary-500 hover:fill-primary-100"}),ge&&l.jsxs("g",{transform:`translate(${Xc-30}, 70)`,children:[l.jsx("rect",{width:"24",height:"24",rx:"4",fill:"#3B82F6",className:"cursor-pointer"}),l.jsx("text",{x:"12",y:"16",textAnchor:"middle",className:"text-xs fill-white",children:""})]})]},q.id)})]})}),!t&&n.length===0&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-gray-400",children:[l.jsx(M1,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l.jsx("p",{className:"text-lg",children:""}),l.jsx("p",{className:"text-sm mt-1",children:'""'})]})}),t&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-500 border-t-transparent"})})]}),l.jsxs("div",{className:"w-80 bg-white border-l border-gray-200 flex flex-col",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200",children:[l.jsxs("h2",{className:"font-semibold text-gray-900 flex items-center",children:[l.jsx(M1,{className:"w-5 h-5 mr-2 text-primary-600"}),""]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:""})]}),l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsx("p",{className:"text-2xl font-bold text-primary-600",children:n.length}),l.jsx("p",{className:"text-xs text-gray-500",children:""})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.length}),l.jsx("p",{className:"text-xs text-gray-500",children:""})]})]})}),it&&l.jsxs("div",{className:"p-4 border-b border-gray-200",children:[l.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[l.jsx(Vl,{className:"w-4 h-4 mr-2"}),it.name]}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsxs("span",{children:[(Ye=xv(it.environment))==null?void 0:Ye.icon," ",(Q=xv(it.environment))==null?void 0:Q.label]})]}),l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsxs("span",{children:[(vt=yv(it.timeOfDay))==null?void 0:vt.icon," ",(et=yv(it.timeOfDay))==null?void 0:et.label]})]}),l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsxs("span",{children:[it.characterCount||0," "]})]})]}),l.jsx("div",{className:"mt-4",children:l.jsxs("button",{onClick:()=>_(it.id),className:"w-full flex items-center justify-center px-3 py-2 bg-primary-50 text-primary-700 rounded-lg hover:bg-primary-100",children:[l.jsx(oC,{className:"w-4 h-4 mr-2"}),""]})})]}),Me&&l.jsxs("div",{className:"p-4 border-b border-gray-200",children:[l.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[l.jsx(J0,{className:"w-4 h-4 mr-2"}),""]}),l.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsx("span",{children:Me.sourceName})]}),l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsx("span",{children:Me.targetName})]}),l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsxs("span",{children:[(Ct=Wc.find(q=>q.value===Me.transitionType))==null?void 0:Ct.icon,(Ge=Wc.find(q=>q.value===Me.transitionType))==null?void 0:Ge.label]})]}),l.jsxs("div",{className:"flex items-center text-gray-600",children:[l.jsx("span",{className:"w-16 text-gray-400",children:""}),l.jsx("span",{className:"px-2 py-0.5 rounded text-xs text-white",style:{backgroundColor:(J=ih.find(q=>q.value===Me.condition))==null?void 0:J.color},children:(L=ih.find(q=>q.value===Me.condition))==null?void 0:L.label})]}),Me.description&&l.jsxs("div",{className:"text-gray-600",children:[l.jsx("span",{className:"text-gray-400",children:""}),Me.description]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>lt(Me),className:"flex-1 flex items-center justify-center px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[l.jsx($u,{className:"w-4 h-4 mr-1"}),""]}),l.jsx("button",{onClick:()=>m(Me.id),className:"flex items-center justify-center px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100",children:l.jsx(zr,{className:"w-4 h-4"})})]})]}),l.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:""}),l.jsx("div",{className:"space-y-2",children:ih.map(q=>l.jsxs("div",{className:"flex items-center text-sm",children:[l.jsx("div",{className:"w-4 h-4 rounded mr-2",style:{backgroundColor:q.color}}),l.jsx("span",{className:"text-gray-700",children:q.label}),l.jsx("span",{className:"text-gray-400 ml-2 text-xs",children:q.description})]},q.value))}),l.jsx("h3",{className:"font-medium text-gray-900 mt-6 mb-3",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:Wc.map(q=>l.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[l.jsx("span",{className:"mr-1",children:q.icon}),l.jsx("span",{children:q.label})]},q.value))})]}),l.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 text-xs text-gray-500",children:[l.jsx("p",{children:" /"}),l.jsx("p",{children:" "}),l.jsx("p",{children:" Alt+"}),l.jsx("p",{children:" "})]})]}),Y&&de&&l.jsx(kk,{edge:de,onSave:kt,onClose:()=>{G(!1),Ce(null)}})]})}function kk({edge:n,onSave:e,onClose:t}){const[r,i]=F.useState(n.transitionType||"cut"),[s,a]=F.useState(n.condition||"sequential"),[o,c]=F.useState(n.description||""),u=f=>{f.preventDefault(),e({transitionType:r,condition:s,description:o})};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:t,children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full",onClick:f=>f.stopPropagation(),children:[l.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:""}),l.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded",children:l.jsx(Hn,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("form",{onSubmit:u,className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:[l.jsx("span",{className:"font-medium",children:n.sourceName}),l.jsx(J0,{className:"w-4 h-4 mx-2"}),l.jsx("span",{className:"font-medium",children:n.targetName})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:Wc.map(f=>l.jsxs("button",{type:"button",onClick:()=>i(f.value),className:`p-2 rounded-lg border text-center transition-colors ${r===f.value?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("span",{className:"text-lg block",children:f.icon}),l.jsx("span",{className:"text-xs",children:f.label})]},f.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:ih.map(f=>l.jsxs("button",{type:"button",onClick:()=>a(f.value),className:`p-3 rounded-lg border text-left transition-colors ${s===f.value?"border-2":"border-gray-200 hover:border-gray-300"}`,style:s===f.value?{borderColor:f.color}:{},children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-3 h-3 rounded mr-2",style:{backgroundColor:f.color}}),l.jsx("span",{className:"font-medium",children:f.label})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f.description})]},f.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("textarea",{value:o,onChange:f=>c(f.target.value),placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 resize-none",rows:3})]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:""})]})]})]})})}const Iu=[{value:"extreme_wide",label:"",description:""},{value:"wide",label:"",description:""},{value:"full",label:"",description:""},{value:"medium",label:"",description:""},{value:"close_up",label:"",description:""},{value:"extreme_close_up",label:"",description:""},{value:"over_shoulder",label:"",description:""},{value:"pov",label:"POV",description:""},{value:"low_angle",label:"",description:""},{value:"high_angle",label:"",description:""},{value:"dutch_angle",label:"",description:""}],Pu=[{value:"static",label:"",description:""},{value:"pan",label:"",description:""},{value:"tilt",label:"",description:""},{value:"dolly_in",label:"",description:""},{value:"dolly_out",label:"",description:""},{value:"tracking",label:"",description:""},{value:"crane",label:"",description:""},{value:"handheld",label:"",description:""},{value:"zoom_in",label:"",description:""},{value:"zoom_out",label:"",description:""},{value:"orbit",label:"",description:""}],$0=Es((n,e)=>({shots:[],currentShot:null,loading:!1,error:null,fetchShots:async(t=null)=>{n({loading:!0,error:null});try{const r=new URLSearchParams;t&&r.append("scene_id",t);const s=await(await fetch(`/api/shots?${r}`)).json();return n({shots:s,loading:!1}),s}catch(r){throw n({error:r.message,loading:!1}),r}},fetchShot:async t=>{try{const i=await(await fetch(`/api/shots/${t}`)).json();return n({currentShot:i}),i}catch(r){throw r}},createShot:async t=>{try{const r=await fetch("/api/shots",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await r.json();return r.ok&&n(s=>({shots:[...s.shots,i]})),i}catch(r){throw r}},updateShot:async(t,r)=>{try{const s=await(await fetch(`/api/shots/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>{var o;return{shots:a.shots.map(c=>c.id===t?{...c,...s}:c),currentShot:((o=a.currentShot)==null?void 0:o.id)===t?{...a.currentShot,...s}:a.currentShot}}),s}catch(i){throw i}},deleteShot:async t=>{try{await fetch(`/api/shots/${t}`,{method:"DELETE"}),n(r=>{var i;return{shots:r.shots.filter(s=>s.id!==t),currentShot:((i=r.currentShot)==null?void 0:i.id)===t?null:r.currentShot}})}catch(r){throw r}},reorderShots:async t=>{try{n(r=>{const i=new Map(t.map(a=>[a.id,a.orderIndex]));return{shots:[...r.shots].map(a=>({...a,orderIndex:i.get(a.id)??a.orderIndex})).sort((a,o)=>a.orderIndex-o.orderIndex)}}),await fetch("/api/shots/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t})})}catch(r){throw e().fetchShots(),r}},generatePrompt:async t=>{try{const i=await(await fetch(`/api/shots/${t}/generate-prompt`,{method:"POST"})).json();return i.success&&n(s=>{var a;return{shots:s.shots.map(o=>o.id===t?{...o,generatedPrompt:i.prompt}:o),currentShot:((a=s.currentShot)==null?void 0:a.id)===t?{...s.currentShot,generatedPrompt:i.prompt}:s.currentShot}}),i}catch(r){throw r}},addCharacterToShot:async(t,r,i)=>{try{const a=await(await fetch(`/api/shots/${t}/characters`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({characterId:r,action:i})})).json();return a.success&&(e().fetchShot(t),e().fetchShots()),a}catch(s){throw s}},setCurrentShot:t=>n({currentShot:t}),clearCurrentShot:()=>n({currentShot:null})})),jk=[{id:"dolly_in",name:" (Dolly In)",nameEn:"Dolly In",description:"",effect:"",usage:"",comfyuiHint:"camera: dolly in, slow approach"},{id:"dolly_out",name:" (Dolly Out)",nameEn:"Dolly Out",description:"",effect:"",usage:"",comfyuiHint:"camera: dolly out, revealing shot"},{id:"pan",name:" (Pan)",nameEn:"Pan",description:"",effect:"",usage:"",comfyuiHint:"camera: pan, horizontal movement"},{id:"tilt",name:" (Tilt)",nameEn:"Tilt",description:"",effect:"",usage:"",comfyuiHint:"camera: tilt up/down"},{id:"high_angle",name:" (High Angle)",nameEn:"High Angle",description:"",effect:"",usage:"/",comfyuiHint:"high angle shot, bird's eye view"},{id:"low_angle",name:" (Low Angle)",nameEn:"Low Angle",description:"",effect:"",usage:"",comfyuiHint:"low angle shot, looking up, heroic"},{id:"close_up",name:" (Close-up)",nameEn:"Close-up",description:"",effect:"",usage:"",comfyuiHint:"extreme close-up, detailed"},{id:"wide_shot",name:" (Wide Shot)",nameEn:"Wide Shot",description:"",effect:"",usage:"",comfyuiHint:"wide shot, establishing shot"},{id:"tracking",name:" (Tracking Shot)",nameEn:"Tracking Shot",description:"",effect:"",usage:"",comfyuiHint:"tracking shot, following movement"},{id:"pov",name:" (POV)",nameEn:"Point of View",description:"",effect:"",usage:"",comfyuiHint:"POV shot, first person view"}],Uk=[{id:"hard_cut",name:" (Hard Cut)",nameEn:"Hard Cut",description:"",effect:"",usage:""},{id:"fade",name:" (Fade)",nameEn:"Fade In/Out",description:"",effect:"",usage:""},{id:"dissolve",name:" (Dissolve)",nameEn:"Dissolve",description:"",effect:"",usage:""},{id:"match_cut",name:" (Match Cut)",nameEn:"Match Cut",description:"//",effect:"",usage:""},{id:"jump_cut",name:" (Jump Cut)",nameEn:"Jump Cut",description:"",effect:"",usage:""},{id:"wipe",name:" (Wipe)",nameEn:"Wipe",description:"",effect:"",usage:""}],Ok=[{id:"energy_beam",name:"",description:"/",comfyuiPrompt:"energy beam, laser blast, particle effects, glowing trail",suggestedFor:""},{id:"shockwave",name:"",description:"",comfyuiPrompt:"energy shockwave, ripple effect, glowing edges, expanding circle",suggestedFor:""},{id:"force_field",name:"/",description:"",comfyuiPrompt:"force field, energy shield, hexagonal pattern, translucent barrier",suggestedFor:""},{id:"explosion",name:"",description:"",comfyuiPrompt:"massive explosion, smoke plumes, debris flying, fire and smoke",suggestedFor:""},{id:"transformation",name:"",description:"",comfyuiPrompt:"mechanical transformation, parts shifting, metallic, complex movement",suggestedFor:""},{id:"charging",name:"",description:"",comfyuiPrompt:"energy charging, glowing particles gathering, power buildup",suggestedFor:""},{id:"hologram",name:"",description:"",comfyuiPrompt:"holographic display, blue glow, translucent, futuristic interface",suggestedFor:""},{id:"propulsion",name:"",description:"/",comfyuiPrompt:"thruster flames, jet propulsion, engine glow, exhaust trail",suggestedFor:""}],zk={foreground:["office interior with cracked window","silhouette of person watching through glass","venetian blinds partially open","desk with coffee cup trembling","broken glass on floor","evacuation alarm lights","trembling indoor plants","fallen office chair"],middleground:["destroyed skyscrapers","fleeing crowds on street below","military helicopters","falling debris and glass shards","overturned cars","collapsed bridge","smoke rising from buildings","emergency vehicles with flashing lights"],background:["giant mech in combat stance","massive monster roaring","energy beam clash","explosions and smoke plumes","collapsing building","aircraft flying around giants","city skyline in flames","dust cloud from destruction"],atmosphere:["apocalyptic atmosphere","orange sunset with fire glow","dust and smoke filling the air","lens flare from explosions","dramatic storm clouds","rain with fire reflections","emergency red lighting","ash falling like snow"],povOptions:[{id:"ground",label:"",height:"0m"},{id:"low",label:"",height:"1m"},{id:"eye_level",label:"",height:"1.7m"},{id:"floor_10",label:"10",height:"30m"},{id:"floor_30",label:"30",height:"90m"},{id:"floor_50",label:"50",height:"150m"},{id:"helicopter",label:"",height:"200m"},{id:"birds_eye",label:"",height:"500m"}],angleOptions:[{id:"level",label:"",degree:0},{id:"slight_down",label:" 15",degree:15},{id:"down_45",label:" 45",degree:45},{id:"slight_up",label:" 15",degree:-15},{id:"up_45",label:" 45",degree:-45},{id:"up_90",label:" 90",degree:-90}]},ci={shotTypes:jk,transitions:Uk,scifiEffects:Ok,cityBattleElements:zk},vv=[{id:"shotTypes",label:"",icon:tc,color:"bg-blue-500",description:""},{id:"transitions",label:"",icon:Qu,color:"bg-purple-500",description:""},{id:"scifiEffects",label:"",icon:Z0,color:"bg-orange-500",description:""}];function d3({onSelect:n,onClose:e,mode:t="modal",selectedTechniques:r=[],multiSelect:i=!1,filterCategory:s=null}){var N;const[a,o]=F.useState(""),[c,u]=F.useState(s||vv[0].id),[f,p]=F.useState(null),[m,g]=F.useState(null),y=()=>{const C=ci[c]||[];if(!a)return C;const I=a.toLowerCase();return C.filter(P=>{var T,R,j,O;return((T=P.name)==null?void 0:T.toLowerCase().includes(I))||((R=P.nameEn)==null?void 0:R.toLowerCase().includes(I))||((j=P.description)==null?void 0:j.toLowerCase().includes(I))||((O=P.effect)==null?void 0:O.toLowerCase().includes(I))})},S=C=>r.some(I=>I.id===C&&I.category===c),w=C=>{n(C,c),!i&&t==="modal"&&(e==null||e())},x=(C,I)=>{C.stopPropagation(),navigator.clipboard.writeText(I),g(I),setTimeout(()=>g(null),2e3)},_=y(),b=((N=vv.find(C=>C.id===c))==null?void 0:N.icon)||tc,M=()=>l.jsxs("div",{className:"flex h-full",children:[!s&&l.jsxs("div",{className:"w-48 bg-gray-50 border-r border-gray-200 p-3",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase mb-2 px-2",children:""}),l.jsx("div",{className:"space-y-1",children:vv.map(C=>{var T;const I=C.icon,P=c===C.id;return l.jsxs("button",{onClick:()=>u(C.id),className:`w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors ${P?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:bg-gray-100"}`,children:[l.jsx(I,{className:`w-4 h-4 mr-2 ${P?"text-primary-600":""}`}),C.label,l.jsx("span",{className:"ml-auto text-xs text-gray-400",children:((T=ci[C.id])==null?void 0:T.length)||0})]},C.id)})}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase mb-2 px-2",children:""}),l.jsxs("button",{onClick:()=>u("cityBattle"),className:`w-full flex items-center px-3 py-2 rounded-lg text-sm ${c==="cityBattle"?"bg-amber-100 text-amber-800":"text-gray-600 hover:bg-gray-100"}`,children:[l.jsx(t3,{className:"w-4 h-4 mr-2"}),""]})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(nc,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),l.jsx("input",{type:"text",value:a,onChange:C=>o(C.target.value),placeholder:"...",className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c==="cityBattle"?l.jsx(Hk,{onSelect:n}):_.length===0?l.jsxs("div",{className:"text-center py-12 text-gray-400",children:[l.jsx(b,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),l.jsx("p",{children:""})]}):l.jsx("div",{className:"grid grid-cols-1 gap-3",children:_.map(C=>{const I=S(C.id);return l.jsx("div",{onClick:()=>w(C),onMouseEnter:()=>p(C.id),onMouseLeave:()=>p(null),className:`p-4 rounded-lg border cursor-pointer transition-all ${I?"bg-primary-50 border-primary-300 ring-1 ring-primary-300":"bg-white border-gray-200 hover:border-gray-300 hover:shadow-sm"}`,children:l.jsx("div",{className:"flex items-start justify-between",children:l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:C.name}),C.nameEn&&l.jsx("span",{className:"text-xs text-gray-400",children:C.nameEn}),I&&l.jsx(Jn,{className:"w-4 h-4 text-primary-600"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:C.description}),C.effect&&l.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[l.jsx("span",{className:"font-medium",children:""}),C.effect]}),C.usage&&l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.jsx("span",{className:"font-medium",children:""}),C.usage]}),(C.comfyuiHint||C.comfyuiPrompt)&&l.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[l.jsx("code",{className:"flex-1 text-xs bg-gray-100 px-2 py-1 rounded text-gray-700 truncate",children:C.comfyuiHint||C.comfyuiPrompt}),l.jsx("button",{onClick:P=>x(P,C.comfyuiHint||C.comfyuiPrompt),className:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"",children:m===(C.comfyuiHint||C.comfyuiPrompt)?l.jsx(Jn,{className:"w-4 h-4 text-green-500"}):l.jsx(di,{className:"w-4 h-4"})})]})]})})},C.id)})})})]})]});return t==="modal"?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:e,children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col overflow-hidden",onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:""}),l.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:""})]}),l.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l.jsx(Hn,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"flex-1 overflow-hidden",children:M()})]})}):l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:M()})}function Hk({onSelect:n}){var a;const e=ci.cityBattleElements,[t,r]=F.useState(null),i=o=>{navigator.clipboard.writeText(o),r(o),setTimeout(()=>r(null),2e3)},s=[{key:"foreground",label:"",color:"bg-green-100 text-green-800"},{key:"middleground",label:"",color:"bg-blue-100 text-blue-800"},{key:"background",label:"",color:"bg-purple-100 text-purple-800"},{key:"atmosphere",label:"",color:"bg-orange-100 text-orange-800"}];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-amber-800 mb-1",children:""}),l.jsx("p",{className:"text-sm text-amber-700",children:'""'})]}),s.map(o=>{var c;return l.jsxs("div",{children:[l.jsx("h4",{className:`inline-flex items-center px-2 py-1 rounded text-sm font-medium mb-3 ${o.color}`,children:o.label}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:(c=e[o.key])==null?void 0:c.map((u,f)=>l.jsxs("button",{onClick:()=>{i(u),n==null||n({id:`${o.key}_${f}`,name:u,category:"cityBattle",layer:o.key},"cityBattle")},className:"flex items-center justify-between p-2 text-left text-sm bg-white border border-gray-200 rounded-lg hover:border-gray-300 hover:bg-gray-50",children:[l.jsx("span",{className:"text-gray-700",children:u}),t===u?l.jsx(Jn,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):l.jsx(di,{className:"w-3 h-3 text-gray-300 flex-shrink-0"})]},f))})]},o.key)}),l.jsxs("div",{children:[l.jsx("h4",{className:"inline-flex items-center px-2 py-1 rounded text-sm font-medium mb-3 bg-gray-100 text-gray-800",children:""}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:(a=e.povOptions)==null?void 0:a.map(o=>l.jsxs("button",{onClick:()=>n==null?void 0:n({id:o.id,name:o.label,height:o.height,category:"pov"},"pov"),className:"p-2 text-center text-sm bg-white border border-gray-200 rounded-lg hover:border-primary-300 hover:bg-primary-50",children:[l.jsx("div",{className:"font-medium text-gray-900",children:o.label}),l.jsx("div",{className:"text-xs text-gray-500",children:o.height})]},o.id))})]})]})}const Gk=(n,e)=>{const t=a=>e.find(o=>o.id===a),r=a=>{var o;return((o=Iu.find(c=>c.value===a))==null?void 0:o.label)||a},i=a=>{var o;return((o=Pu.find(c=>c.value===a))==null?void 0:o.label)||a};let s=`# 

`;return s+=`> : ${new Date().toLocaleString()}
`,s+=`> : ${n.length}
`,s+=`> : ${n.reduce((a,o)=>a+(o.duration||0),0)} 

`,s+=`---

`,n.forEach((a,o)=>{var u;const c=t(a.sceneId);s+=`##  ${o+1}

`,s+=`|  |  |
`,s+=`|------|----|
`,s+=`| **** | ${a.description||""} |
`,s+=`| **** | ${a.duration}  |
`,s+=`| **** | ${(c==null?void 0:c.name)||""} |
`,s+=`| **** | ${r(a.shotType)||""} |
`,s+=`| **** | ${i(a.cameraMovement)||""} |
`,a.dialogue&&(s+=`
**:**
> "${a.dialogue}"
`),((u=a.characters)==null?void 0:u.length)>0&&(s+=`
**:**
`,a.characters.forEach(f=>{s+=`- ${f.name}${f.action?` (${f.action})`:""}
`})),a.generatedPrompt&&(s+=`
**AI :**
\`\`\`
${a.generatedPrompt}
\`\`\`
`),a.notes&&(s+=`
**:** ${a.notes}
`),s+=`
---

`}),s},Vk=(n,e,t)=>{const r=new Blob([n],{type:t}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},Wk=(n,e)=>{const t=o=>e.find(c=>c.id===o),r=o=>{var c;return((c=Iu.find(u=>u.value===o))==null?void 0:c.label)||o},i=o=>{var c;return((c=Pu.find(u=>u.value===o))==null?void 0:c.label)||o},s=`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title></title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      padding: 40px;
      color: #1f2937;
    }
    h1 { font-size: 24px; margin-bottom: 8px; }
    .meta { color: #6b7280; margin-bottom: 24px; font-size: 14px; }
    .shot { 
      page-break-inside: avoid;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }
    .shot-header { 
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid #f3f4f6;
    }
    .shot-number {
      background: #111827;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
    }
    .shot-title { font-weight: 600; font-size: 16px; }
    .shot-scene { 
      background: #f3f4f6;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      color: #6b7280;
    }
    .shot-info { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 12px; }
    .info-item { }
    .info-label { font-size: 11px; color: #9ca3af; text-transform: uppercase; }
    .info-value { font-size: 14px; color: #1f2937; }
    .dialogue { 
      background: #fef3c7;
      padding: 12px;
      border-radius: 6px;
      font-style: italic;
      margin-top: 12px;
    }
    .prompt {
      background: #f3f4f6;
      padding: 12px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 12px;
      margin-top: 12px;
      white-space: pre-wrap;
    }
    .characters {
      margin-top: 12px;
    }
    .char-tag {
      display: inline-block;
      background: #dbeafe;
      color: #1e40af;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin-right: 6px;
      margin-bottom: 4px;
    }
    @media print {
      body { padding: 20px; }
      .shot { break-inside: avoid; }
    }
  </style>
</head>
<body>
  <h1></h1>
  <div class="meta">
    : ${new Date().toLocaleString()} | 
    : ${n.length} | 
    : ${n.reduce((o,c)=>o+(c.duration||0),0)} 
  </div>
  
  ${n.map((o,c)=>{var f;const u=t(o.sceneId);return`
    <div class="shot">
      <div class="shot-header">
        <div class="shot-number">${c+1}</div>
        <div class="shot-title">${o.description||""}</div>
        ${u?`<div class="shot-scene">${u.name}</div>`:""}
      </div>
      <div class="shot-info">
        <div class="info-item">
          <div class="info-label"></div>
          <div class="info-value">${o.duration} </div>
        </div>
        <div class="info-item">
          <div class="info-label"></div>
          <div class="info-value">${r(o.shotType)||"-"}</div>
        </div>
        <div class="info-item">
          <div class="info-label"></div>
          <div class="info-value">${i(o.cameraMovement)||"-"}</div>
        </div>
        <div class="info-item">
          <div class="info-label"></div>
          <div class="info-value">${(u==null?void 0:u.name)||"-"}</div>
        </div>
      </div>
      ${((f=o.characters)==null?void 0:f.length)>0?`
        <div class="characters">
          <div class="info-label" style="margin-bottom: 6px;"></div>
          ${o.characters.map(p=>`<span class="char-tag">${p.name}${p.action?`  ${p.action}`:""}</span>`).join("")}
        </div>
      `:""}
      ${o.dialogue?`<div class="dialogue">"${o.dialogue}"</div>`:""}
      ${o.generatedPrompt?`<div class="prompt">${o.generatedPrompt}</div>`:""}
    </div>
    `}).join("")}
</body>
</html>
  `,a=window.open("","_blank");a.document.write(s),a.document.close(),a.focus(),setTimeout(()=>{a.print()},500)};function Xk(){const{shots:n,loading:e,fetchShots:t,createShot:r,updateShot:i,deleteShot:s,reorderShots:a,generatePrompt:o}=$0(),{scenes:c,fetchScenes:u}=ed(),{characters:f,fetchCharacters:p}=La(),[m,g]=F.useState(null),[y,S]=F.useState(null),[w,x]=F.useState(!1),[_,b]=F.useState(null),[M,N]=F.useState(null),[C,I]=F.useState(!1);F.useEffect(()=>{t(),u(),p()},[]);const P=async H=>{await r(H),x(!1)},T=async H=>{confirm("")&&(await s(H.id),(m==null?void 0:m.id)===H.id&&g(null))},R=(H,W)=>{b(W),H.dataTransfer.effectAllowed="move"},j=(H,W)=>{H.preventDefault()},O=async(H,W)=>{if(H.preventDefault(),_===null||_===W)return;const Y=[...n],[G]=Y.splice(_,1);Y.splice(W,0,G);const de=Y.map((Ce,be)=>({id:Ce.id,orderIndex:be+1}));await a(de),b(null)},k=async H=>{await o(H.id);const W=n.find(Y=>Y.id===H.id);W&&g(W)},Z=H=>{H.generatedPrompt&&(navigator.clipboard.writeText(H.generatedPrompt),N(H.id),setTimeout(()=>N(null),2e3))},te=()=>{const H=Gk(n,c);Vk(H,`_${new Date().toISOString().slice(0,10)}.md`,"text/markdown"),I(!1)},K=()=>{Wk(n,c),I(!1)},$=H=>c.find(W=>W.id===H),U=n.reduce((H,W)=>H+(W.duration||0),0);return l.jsxs("div",{className:"flex h-[calc(100vh-8rem)] -m-6",children:[l.jsxs("div",{className:"flex-1 flex flex-col bg-white border-r border-gray-200",children:[l.jsxs("div",{className:"h-14 px-6 flex items-center justify-between border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("button",{className:"flex items-center px-3 py-1.5 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx(ew,{className:"w-4 h-4 mr-2"}),""]}),l.jsxs("span",{className:"text-sm text-gray-500",children:[n.length,"    ",U,""]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(!C),disabled:n.length===0,className:"flex items-center px-3 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Jh,{className:"w-4 h-4 mr-2"}),"",l.jsx(Kb,{className:"w-4 h-4 ml-1"})]}),C&&l.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[l.jsxs("button",{onClick:te,className:"flex items-center w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-50",children:[l.jsx(YN,{className:"w-4 h-4 mr-2"})," Markdown"]}),l.jsxs("button",{onClick:K,className:"flex items-center w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-50",children:[l.jsx(Jh,{className:"w-4 h-4 mr-2"})," PDF ()"]})]})]}),l.jsxs("button",{onClick:()=>x(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e?l.jsx("div",{className:"text-center py-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-500 border-t-transparent mx-auto"})}):n.length===0?l.jsxs("div",{className:"text-center py-16",children:[l.jsx(Qu,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:""}),l.jsx("p",{className:"text-gray-400 mb-4",children:""}),l.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})]}):l.jsx("div",{className:"space-y-2",children:n.map((H,W)=>{var be;const Y=$(H.sceneId),G=Iu.find(se=>se.value===H.shotType),de=Pu.find(se=>se.value===H.cameraMovement),Ce=(m==null?void 0:m.id)===H.id;return l.jsxs("div",{draggable:!0,onDragStart:se=>R(se,W),onDragOver:se=>j(se,W),onDrop:se=>O(se,W),onClick:()=>g(H),className:`flex items-center p-4 rounded-lg border cursor-pointer transition-all ${Ce?"bg-primary-50 border-primary-300 shadow-sm":"bg-gray-50 border-gray-200 hover:border-gray-300"} ${_===W?"opacity-50":""}`,children:[l.jsx(qN,{className:"w-5 h-5 text-gray-400 mr-3 cursor-grab"}),l.jsx("span",{className:"w-8 h-8 flex items-center justify-center bg-gray-900 text-white rounded text-sm font-medium mr-4",children:W+1}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h4",{className:"font-medium text-gray-900 truncate",children:H.description||""}),Y&&l.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded",children:Y.name})]}),l.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[l.jsxs("span",{className:"flex items-center",children:[l.jsx(Zb,{className:"w-3.5 h-3.5 mr-1"}),H.duration,""]}),G&&l.jsxs("span",{className:"flex items-center",children:[l.jsx(tc,{className:"w-3.5 h-3.5 mr-1"}),G.label]}),de&&l.jsxs("span",{className:"flex items-center",children:[l.jsx(CF,{className:"w-3.5 h-3.5 mr-1"}),de.label]}),((be=H.characters)==null?void 0:be.length)>0&&l.jsxs("span",{className:"text-primary-600",children:[H.characters.length," "]})]})]}),l.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[l.jsx("button",{onClick:se=>{se.stopPropagation(),S(H)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-white rounded-lg",children:l.jsx($u,{className:"w-4 h-4"})}),l.jsx("button",{onClick:se=>{se.stopPropagation(),T(H)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-white rounded-lg",children:l.jsx(zr,{className:"w-4 h-4"})})]})]},H.id)})})})]}),l.jsx("div",{className:"w-96 bg-gray-50 overflow-y-auto",children:m?l.jsx(Jk,{shot:m,scenes:c,onUpdate:i,onGeneratePrompt:k,onCopyPrompt:Z,copiedPrompt:M}):l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-gray-400",children:[l.jsx(gf,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),l.jsx("p",{children:""})]})})}),w&&l.jsx(Yk,{scenes:c,onClose:()=>x(!1),onCreate:P})]})}function Jk({shot:n,scenes:e,onUpdate:t,onGeneratePrompt:r,onCopyPrompt:i,copiedPrompt:s}){var w,x,_;const[a,o]=F.useState(!1),[c,u]=F.useState({}),[f,p]=F.useState(!1);F.useEffect(()=>{u({description:n.description||"",duration:n.duration||3,sceneId:n.sceneId||"",shotType:n.shotType||"",cameraMovement:n.cameraMovement||"",dialogue:n.dialogue||"",notes:n.notes||"",techniques:n.techniques||[]})},[n]);const m=async()=>{await t(n.id,c),o(!1)},g=e.find(b=>b.id===n.sceneId),y=Iu.find(b=>b.value===n.shotType),S=Pu.find(b=>b.value===n.cameraMovement);return l.jsxs("div",{className:"p-5 space-y-5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:""}),l.jsx("button",{onClick:()=>o(!a),className:`px-3 py-1.5 text-sm rounded-lg ${a?"bg-gray-200 text-gray-700":"bg-primary-50 text-primary-600 hover:bg-primary-100"}`,children:a?"":""})]}),a?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("textarea",{value:c.description,onChange:b=>u(M=>({...M,description:b.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"()"}),l.jsx("input",{type:"number",value:c.duration,onChange:b=>u(M=>({...M,duration:parseInt(b.target.value)||3})),min:1,max:60,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:c.sceneId,onChange:b=>u(M=>({...M,sceneId:parseInt(b.target.value)||null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[l.jsx("option",{value:"",children:""}),e.map(b=>l.jsx("option",{value:b.id,children:b.name},b.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:c.shotType,onChange:b=>u(M=>({...M,shotType:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[l.jsx("option",{value:"",children:""}),Iu.map(b=>l.jsxs("option",{value:b.value,children:[b.label," - ",b.description]},b.value))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:c.cameraMovement,onChange:b=>u(M=>({...M,cameraMovement:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[l.jsx("option",{value:"",children:""}),Pu.map(b=>l.jsxs("option",{value:b.value,children:[b.label," - ",b.description]},b.value))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("textarea",{value:c.dialogue,onChange:b=>u(M=>({...M,dialogue:b.target.value})),rows:2,placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("textarea",{value:c.notes,onChange:b=>u(M=>({...M,notes:b.target.value})),rows:2,placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("button",{type:"button",onClick:()=>p(!0),className:"flex items-center text-sm text-primary-600 hover:text-primary-700",children:[l.jsx(bF,{className:"w-4 h-4 mr-1"}),""]})]}),((w=c.techniques)==null?void 0:w.length)>0?l.jsx("div",{className:"flex flex-wrap gap-2",children:c.techniques.map((b,M)=>l.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-50 text-purple-700 text-xs rounded-lg",children:[b.name,l.jsx("button",{type:"button",onClick:()=>u(N=>({...N,techniques:N.techniques.filter((C,I)=>I!==M)})),className:"ml-1 text-purple-400 hover:text-purple-600",children:l.jsx(Hn,{className:"w-3 h-3"})})]},M))}):l.jsx("p",{className:"text-sm text-gray-400",children:""})]}),l.jsx("button",{onClick:m,className:"w-full py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:""}),f&&l.jsx(d3,{mode:"modal",multiSelect:!0,selectedTechniques:c.techniques||[],onSelect:(b,M)=>{u(N=>{var I;return((I=N.techniques)==null?void 0:I.some(P=>P.id===b.id&&P.category===M))?{...N,techniques:N.techniques.filter(P=>!(P.id===b.id&&P.category===M))}:{...N,techniques:[...N.techniques||[],{...b,category:M}]}})},onClose:()=>p(!1)})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),l.jsx("p",{className:"text-gray-900",children:n.description||""})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),l.jsxs("p",{className:"text-gray-900",children:[n.duration," "]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),l.jsx("p",{className:"text-gray-900",children:(g==null?void 0:g.name)||""})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),l.jsx("p",{className:"text-gray-900",children:(y==null?void 0:y.label)||""})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),l.jsx("p",{className:"text-gray-900",children:(S==null?void 0:S.label)||""})]})]}),n.dialogue&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),l.jsxs("p",{className:"text-gray-900 italic",children:['"',n.dialogue,'"']})]}),((x=n.characters)==null?void 0:x.length)>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-2",children:""}),l.jsx("div",{className:"space-y-2",children:n.characters.map(b=>{const M=yr.find(N=>N.value===b.type);return l.jsxs("div",{className:"flex items-center p-2 bg-white rounded-lg",children:[l.jsx("span",{className:"text-xl mr-2",children:M==null?void 0:M.icon}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.name}),b.action&&l.jsx("p",{className:"text-xs text-gray-500",children:b.action})]})]},b.id)})})]}),((_=n.techniques)==null?void 0:_.length)>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-2",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.techniques.map((b,M)=>{var C;const N=(C=ci[b.category])==null?void 0:C.find(I=>I.id===b.id);return l.jsxs("div",{className:"group relative",children:[l.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-50 text-purple-700 text-xs rounded-lg cursor-help",children:[l.jsx(Z0,{className:"w-3 h-3 mr-1"}),b.name]}),N&&l.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-64 p-3 bg-gray-900 text-white text-xs rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:[l.jsx("p",{className:"font-medium mb-1",children:N.name}),l.jsx("p",{className:"text-gray-300",children:N.description}),N.comfyuiHint&&l.jsx("p",{className:"mt-2 text-gray-400 font-mono text-[10px]",children:N.comfyuiHint}),l.jsx("div",{className:"absolute bottom-0 left-4 transform translate-y-1/2 rotate-45 w-2 h-2 bg-gray-900"})]})]},M)})})]}),l.jsxs("div",{className:"pt-4 border-t",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"AI "}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>r(n),className:"flex items-center text-sm text-primary-600 hover:text-primary-700",children:[l.jsx(xf,{className:"w-4 h-4 mr-1"}),""]}),n.generatedPrompt&&l.jsx("button",{onClick:()=>i(n),className:"flex items-center text-sm text-gray-500 hover:text-gray-700",children:s===n.id?l.jsxs(l.Fragment,{children:[l.jsx(Jn,{className:"w-4 h-4 mr-1"}),""]}):l.jsxs(l.Fragment,{children:[l.jsx(di,{className:"w-4 h-4 mr-1"}),""]})})]})]}),n.generatedPrompt?l.jsx("div",{className:"p-3 bg-gray-100 rounded-lg",children:l.jsx("p",{className:"text-sm text-gray-700 font-mono",children:n.generatedPrompt})}):l.jsx("p",{className:"text-sm text-gray-400",children:'""'})]})]})]})}function Yk({scenes:n,onClose:e,onCreate:t}){const[r,i]=F.useState({description:"",duration:3,sceneId:null,shotType:"",cameraMovement:"",techniques:[]}),[s,a]=F.useState(!1),o=[{id:"low_angle",name:"",category:"shotTypes"},{id:"high_angle",name:"",category:"shotTypes"},{id:"tracking",name:"",category:"shotTypes"},{id:"dolly_in",name:"",category:"shotTypes"},{id:"explosion",name:"",category:"scifiEffects"},{id:"energy_beam",name:"",category:"scifiEffects"}],c=()=>{r.description.trim()&&t(r)},u=f=>{i(p=>p.techniques.some(g=>g.id===f.id)?{...p,techniques:p.techniques.filter(g=>g.id!==f.id)}:{...p,techniques:[...p.techniques,f]})};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:e,children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full",onClick:f=>f.stopPropagation(),children:[l.jsx("div",{className:"p-5 border-b",children:l.jsx("h3",{className:"font-semibold text-lg",children:""})}),l.jsxs("div",{className:"p-5 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("textarea",{value:r.description,onChange:f=>i(p=>({...p,description:f.target.value})),rows:3,placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"()"}),l.jsx("input",{type:"number",value:r.duration,onChange:f=>i(p=>({...p,duration:parseInt(f.target.value)||3})),min:1,max:60,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:r.sceneId||"",onChange:f=>i(p=>({...p,sceneId:parseInt(f.target.value)||null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"",children:""}),n.map(f=>l.jsx("option",{value:f.id,children:f.name},f.id))]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:r.shotType,onChange:f=>i(p=>({...p,shotType:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"",children:""}),Iu.map(f=>l.jsx("option",{value:f.value,children:f.label},f.value))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:r.cameraMovement,onChange:f=>i(p=>({...p,cameraMovement:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"",children:""}),Pu.map(f=>l.jsx("option",{value:f.value,children:f.label},f.value))]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("button",{type:"button",onClick:()=>a(!0),className:"text-sm text-primary-600 hover:text-primary-700",children:"..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(f=>{const p=r.techniques.some(m=>m.id===f.id);return l.jsxs("button",{type:"button",onClick:()=>u(f),className:`px-3 py-1.5 text-sm rounded-lg border transition-colors ${p?"bg-purple-100 border-purple-300 text-purple-700":"bg-white border-gray-200 text-gray-600 hover:border-gray-300"}`,children:[p&&l.jsx(Jn,{className:"w-3 h-3 inline mr-1"}),f.name]},f.id)})}),r.techniques.length>0&&l.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[" ",r.techniques.length," "]})]})]}),l.jsxs("div",{className:"p-5 border-t bg-gray-50 flex justify-end gap-3",children:[l.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:""}),l.jsx("button",{onClick:c,disabled:!r.description.trim(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:""})]}),s&&l.jsx(d3,{mode:"modal",multiSelect:!0,selectedTechniques:r.techniques,onSelect:(f,p)=>{i(m=>m.techniques.some(y=>y.id===f.id&&y.category===p)?{...m,techniques:m.techniques.filter(y=>!(y.id===f.id&&y.category===p))}:{...m,techniques:[...m.techniques,{...f,category:p}]})},onClose:()=>a(!1)})]})})}const Kk=[{id:"window_frame",label:"",icon:"",prompt:"window frame in foreground"},{id:"office_desk",label:"",icon:"",prompt:"office desk and chair silhouette"},{id:"person_silhouette",label:"",icon:"",prompt:"person silhouette watching"},{id:"debris",label:"",icon:"",prompt:"flying debris and broken glass"},{id:"rain_drops",label:"",icon:"",prompt:"rain drops on window"},{id:"smoke",label:"",icon:"",prompt:"smoke and dust particles"},{id:"curtain",label:"",icon:"",prompt:"flowing curtain"},{id:"hand",label:"/",icon:"",prompt:"human hand reaching"}],Zk=[{id:"city_street",label:"",icon:"",prompt:"city street with cars and pedestrians fleeing"},{id:"buildings",label:"",icon:"",prompt:"urban buildings and skyscrapers"},{id:"collapsed",label:"",icon:"",prompt:"collapsed and damaged buildings"},{id:"fire",label:"",icon:"",prompt:"fire and explosions"},{id:"military",label:"",icon:"",prompt:"military helicopters and tanks"},{id:"evacuation",label:"",icon:"",prompt:"crowd of people evacuating"},{id:"bridge",label:"",icon:"",prompt:"massive bridge structure"},{id:"highway",label:"",icon:"",prompt:"elevated highway"}],qk=[{id:"giant_mecha",label:"",icon:"",prompt:"giant mecha robot"},{id:"giant_monster",label:"",icon:"",prompt:"giant kaiju monster"},{id:"battle",label:"",icon:"",prompt:"epic battle between mecha and monster"},{id:"beam",label:"",icon:"",prompt:"energy beam attack"},{id:"city_skyline",label:"",icon:"",prompt:"city skyline"},{id:"storm_clouds",label:"",icon:"",prompt:"dramatic storm clouds"},{id:"sunset",label:"",icon:"",prompt:"dramatic sunset"},{id:"mountains",label:"",icon:"",prompt:"distant mountains"}],Wa={height:[{value:"ground",label:"",prompt:"ground level view"},{value:"low",label:"",prompt:"low angle shot"},{value:"eye",label:"",prompt:"eye level"},{value:"floor10",label:"10",prompt:"view from 10th floor window"},{value:"floor30",label:"30",prompt:"view from 30th floor window"},{value:"floor50",label:"50",prompt:"view from skyscraper window"},{value:"aerial",label:"/",prompt:"aerial view"}],angle:[{value:"level",label:"",prompt:""},{value:"tilt_down_15",label:" 15",prompt:"slight downward angle"},{value:"tilt_down_45",label:" 45",prompt:"looking down"},{value:"tilt_up_15",label:" 15",prompt:"slight upward angle"},{value:"tilt_up_45",label:" 45",prompt:"dramatic low angle looking up"}],location:[{value:"outdoor",label:"",prompt:"outdoor"},{value:"window",label:"",prompt:"from inside, looking through window"},{value:"indoor_deep",label:"",prompt:"from deep inside building"},{value:"car",label:"",prompt:"from inside car"},{value:"helicopter",label:"",prompt:"from inside helicopter"}],atmosphere:[{value:"normal",label:"",prompt:""},{value:"apocalyptic",label:"",prompt:"apocalyptic atmosphere"},{value:"tense",label:"",prompt:"tense atmosphere"},{value:"epic",label:"",prompt:"epic cinematic"},{value:"horror",label:"",prompt:"horror atmosphere"},{value:"hopeful",label:"",prompt:"hopeful atmosphere"}]};function Qk(){const{characters:n,fetchCharacters:e}=La(),{shots:t,fetchShots:r,currentShot:i,setCurrentShot:s,updateShot:a}=$0(),{scenes:o,fetchScenes:c}=ed(),[u,f]=F.useState({foreground:[],middleground:[],background:[]}),[p,m]=F.useState({height:"floor30",angle:"level",location:"window",atmosphere:"epic"}),[g,y]=F.useState(""),[S,w]=F.useState(!1),[x,_]=F.useState(null),[b,M]=F.useState(null);F.useEffect(()=>{e(),r(),c()},[]),F.useEffect(()=>{if(x!=null&&x.compositorData){const k=x.compositorData;k.layers&&f(k.layers),k.pov&&m(k.pov),k.prompt&&y(k.prompt)}},[x]);const N=(k,Z)=>{f(te=>({...te,[k]:[...te[k],Z]})),M(null)},C=(k,Z)=>{var te;N(k,{id:`char_${Z.id}_${Date.now()}`,type:"character",characterId:Z.id,label:Z.name,icon:((te=yr.find(K=>K.value===Z.type))==null?void 0:te.icon)||"",prompt:Z.promptTemplate||Z.name,action:""})},I=(k,Z)=>{f(te=>({...te,[k]:te[k].filter(K=>K.id!==Z)}))},P=(k,Z,te)=>{f(K=>({...K,[k]:K[k].map($=>$.id===Z?{...$,action:te}:$)}))},T=()=>{const k=[],Z=[];if(p.height){const K=Wa.height.find($=>$.value===p.height);K!=null&&K.prompt&&Z.push(K.prompt)}if(p.location){const K=Wa.location.find($=>$.value===p.location);K!=null&&K.prompt&&Z.push(K.prompt)}if(p.angle){const K=Wa.angle.find($=>$.value===p.angle);K!=null&&K.prompt&&Z.push(K.prompt)}if(Z.length&&k.push(Z.join(", ")),u.foreground.length){const K=u.foreground.map($=>{let U=$.prompt;return $.action&&(U+=` ${$.action}`),U});k.push(`foreground: ${K.join(", ")}`)}if(u.middleground.length){const K=u.middleground.map($=>{let U=$.prompt;return $.action&&(U+=` ${$.action}`),U});k.push(`middleground: ${K.join(", ")}`)}if(u.background.length){const K=u.background.map($=>{let U=$.prompt;return $.action&&(U+=` ${$.action}`),U});k.push(`background: ${K.join(", ")}`)}if(p.atmosphere){const K=Wa.atmosphere.find($=>$.value===p.atmosphere);K!=null&&K.prompt&&k.push(K.prompt)}k.push("cinematic lighting, dramatic composition, high detail, 4K, masterpiece");const te=k.join(", ");return y(te),te},R=()=>{navigator.clipboard.writeText(g),w(!0),setTimeout(()=>w(!1),2e3)},j=async()=>{if(!x)return;const k={layers:u,pov:p,prompt:g};await a(x.id,{compositorData:k})},O=(k,Z,te,K,$)=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[l.jsxs("div",{className:"p-4 border-b border-gray-100",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[$,l.jsx("span",{className:"ml-2",children:Z})]}),l.jsx("button",{onClick:()=>M(b===k?null:k),className:"p-1.5 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg",children:l.jsx(vi,{className:"w-5 h-5"})})]}),l.jsx("p",{className:"text-xs text-gray-500",children:te})]}),b===k&&l.jsxs("div",{className:"p-3 bg-gray-50 border-b border-gray-100",children:[l.jsx("p",{className:"text-xs text-gray-500 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-1.5 mb-3",children:K.map(U=>l.jsxs("button",{onClick:()=>N(k,{...U,action:""}),className:"flex items-center px-2 py-1.5 text-xs bg-white border border-gray-200 rounded hover:border-primary-300 hover:bg-primary-50",children:[l.jsx("span",{className:"mr-1.5",children:U.icon}),U.label]},U.id))}),l.jsx("p",{className:"text-xs text-gray-500 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:n.slice(0,6).map(U=>{const H=yr.find(W=>W.value===U.type);return l.jsxs("button",{onClick:()=>C(k,U),className:"flex items-center px-2 py-1.5 text-xs bg-white border border-gray-200 rounded hover:border-primary-300 hover:bg-primary-50",children:[l.jsx("span",{className:"mr-1.5",children:H==null?void 0:H.icon}),U.name]},U.id)})})]}),l.jsx("div",{className:"p-3 min-h-[120px]",children:u[k].length===0?l.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-sm",children:" + "}):l.jsx("div",{className:"space-y-2",children:u[k].map(U=>l.jsxs("div",{className:"flex items-center p-2 bg-gray-50 rounded-lg group",children:[l.jsx("span",{className:"text-lg mr-2",children:U.icon}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:U.label}),l.jsx("input",{type:"text",value:U.action||"",onChange:H=>P(k,U.id,H.target.value),placeholder:"/...",className:"w-full text-xs text-gray-500 bg-transparent border-none p-0 focus:ring-0"})]}),l.jsx("button",{onClick:()=>I(k,U.id),className:"p-1 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100",children:l.jsx(zr,{className:"w-4 h-4"})})]},U.id))})})]});return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsxs("select",{value:(x==null?void 0:x.id)||"",onChange:k=>{const Z=t.find(te=>te.id===parseInt(k.target.value));_(Z||null)},className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",children:[l.jsx("option",{value:"",children:""}),t.map(k=>{var Z;return l.jsxs("option",{value:k.id,children:["#",k.orderIndex,": ",((Z=k.description)==null?void 0:Z.slice(0,30))||""]},k.id)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:T,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(xf,{className:"w-4 h-4 mr-2"}),""]}),x&&l.jsxs("button",{onClick:j,className:"flex items-center px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx(mf,{className:"w-4 h-4 mr-2"}),""]})]})]}),l.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-amber-900",children:" "}),l.jsx("p",{className:"text-sm text-amber-700 mt-1",children:""})]}),l.jsx("button",{onClick:()=>{f({foreground:[{id:"preset_window",label:"",icon:"",prompt:"window frame in foreground",action:""},{id:"preset_person",label:"",icon:"",prompt:"person silhouette watching in fear",action:""}],middleground:[{id:"preset_buildings",label:"",icon:"",prompt:"urban buildings and skyscrapers",action:"partially damaged"},{id:"preset_fire",label:"",icon:"",prompt:"fire and explosions",action:""}],background:[{id:"preset_mecha",label:"",icon:"",prompt:"giant mecha robot",action:"fighting"},{id:"preset_monster",label:"",icon:"",prompt:"giant kaiju monster",action:"attacking"}]}),m({height:"floor30",angle:"level",location:"window",atmosphere:"epic"})},className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm",children:""})]})}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[O("foreground"," (Foreground)","",Kk,l.jsx(Ng,{className:"w-4 h-4 text-blue-500"})),O("middleground"," (Middleground)","",Zk,l.jsx(XN,{className:"w-4 h-4 text-green-500"})),O("background"," (Background)","",qk,l.jsx(MF,{className:"w-4 h-4 text-purple-500"}))]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-4 flex items-center",children:[l.jsx(Y0,{className:"w-4 h-4 mr-2"})," (POV)"]}),l.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("select",{value:p.height,onChange:k=>m(Z=>({...Z,height:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:Wa.height.map(k=>l.jsx("option",{value:k.value,children:k.label},k.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("select",{value:p.angle,onChange:k=>m(Z=>({...Z,angle:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:Wa.angle.map(k=>l.jsx("option",{value:k.value,children:k.label},k.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("select",{value:p.location,onChange:k=>m(Z=>({...Z,location:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:Wa.location.map(k=>l.jsx("option",{value:k.value,children:k.label},k.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("select",{value:p.atmosphere,onChange:k=>m(Z=>({...Z,atmosphere:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:Wa.atmosphere.map(k=>l.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),l.jsxs("div",{className:"bg-gray-900 rounded-xl p-5 text-white",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"font-medium flex items-center",children:[l.jsx(Ng,{className:"w-5 h-5 mr-2"}),""]}),g&&l.jsx("button",{onClick:R,className:"flex items-center px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-lg text-sm",children:S?l.jsxs(l.Fragment,{children:[l.jsx(Jn,{className:"w-4 h-4 mr-1.5"}),""]}):l.jsxs(l.Fragment,{children:[l.jsx(di,{className:"w-4 h-4 mr-1.5"}),""]})})]}),l.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:g?l.jsx("p",{className:"text-sm text-gray-300 font-mono whitespace-pre-wrap",children:g}):l.jsx("p",{className:"text-sm text-gray-500",children:'""'})})]})]})}const pC=[{id:"shotTypes",name:"",icon:tc,description:""},{id:"transitions",name:"",icon:BF,description:""},{id:"scifiEffects",name:"",icon:Z0,description:"AI"},{id:"cityBattle",name:"",icon:XN,description:""}];function $k(){var y;const[n,e]=F.useState("shotTypes"),[t,r]=F.useState(""),[i,s]=F.useState(null),[a,o]=F.useState("foreground"),c=(S,w)=>{navigator.clipboard.writeText(S),s(w),setTimeout(()=>s(null),2e3)},u=()=>{switch(n){case"shotTypes":return f();case"transitions":return p();case"scifiEffects":return m();case"cityBattle":return g();default:return null}},f=()=>{const S=ci.shotTypes.filter(w=>w.name.toLowerCase().includes(t.toLowerCase())||w.description.toLowerCase().includes(t.toLowerCase()));return l.jsx("div",{className:"grid grid-cols-2 gap-4",children:S.map(w=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:w.name}),l.jsx("span",{className:"text-xs text-gray-400",children:w.nameEn})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w.description}),l.jsxs("div",{className:"space-y-2 text-xs",children:[l.jsxs("div",{className:"flex",children:[l.jsx("span",{className:"w-16 text-gray-500 flex-shrink-0",children:":"}),l.jsx("span",{className:"text-gray-700",children:w.effect})]}),l.jsxs("div",{className:"flex",children:[l.jsx("span",{className:"w-16 text-gray-500 flex-shrink-0",children:":"}),l.jsx("span",{className:"text-gray-700",children:w.usage})]})]}),w.comfyuiHint&&l.jsxs("div",{className:"mt-3 p-2 bg-gray-50 rounded-lg flex items-center justify-between",children:[l.jsx("code",{className:"text-xs text-primary-600",children:w.comfyuiHint}),l.jsx("button",{onClick:()=>c(w.comfyuiHint,w.id),className:"p-1 text-gray-400 hover:text-primary-600",children:i===w.id?l.jsx(Jn,{className:"w-4 h-4"}):l.jsx(di,{className:"w-4 h-4"})})]})]},w.id))})},p=()=>{const S=ci.transitions.filter(w=>w.name.toLowerCase().includes(t.toLowerCase())||w.description.toLowerCase().includes(t.toLowerCase()));return l.jsx("div",{className:"grid grid-cols-2 gap-4",children:S.map(w=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:w.name}),l.jsx("span",{className:"text-xs text-gray-400",children:w.nameEn})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w.description}),l.jsxs("div",{className:"space-y-2 text-xs",children:[l.jsxs("div",{className:"flex",children:[l.jsx("span",{className:"w-16 text-gray-500 flex-shrink-0",children:":"}),l.jsx("span",{className:"text-gray-700",children:w.effect})]}),l.jsxs("div",{className:"flex",children:[l.jsx("span",{className:"w-16 text-gray-500 flex-shrink-0",children:":"}),l.jsx("span",{className:"text-gray-700",children:w.usage})]})]})]},w.id))})},m=()=>{const S=ci.scifiEffects.filter(w=>w.name.toLowerCase().includes(t.toLowerCase())||w.description.toLowerCase().includes(t.toLowerCase()));return l.jsx("div",{className:"grid grid-cols-2 gap-4",children:S.map(w=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:w.name}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:w.description}),l.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:[l.jsx("span",{className:"font-medium",children:":"})," ",w.suggestedFor]}),l.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg flex items-start justify-between",children:[l.jsx("code",{className:"text-xs text-green-400 flex-1",children:w.comfyuiPrompt}),l.jsx("button",{onClick:()=>c(w.comfyuiPrompt,w.id),className:"ml-2 p-1 text-gray-400 hover:text-white flex-shrink-0",children:i===w.id?l.jsx(Jn,{className:"w-4 h-4"}):l.jsx(di,{className:"w-4 h-4"})})]})]},w.id))})},g=()=>{var _;const S=ci.cityBattleElements,w=[{id:"foreground",name:"",data:S.foreground},{id:"middleground",name:"",data:S.middleground},{id:"background",name:"",data:S.background},{id:"atmosphere",name:"",data:S.atmosphere},{id:"pov",name:"",data:null}],x=w.find(b=>b.id===a);return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-4",children:[l.jsx("h4",{className:"font-medium text-amber-900 mb-1",children:" "}),l.jsx("p",{className:"text-sm text-amber-700",children:'"" '})]}),l.jsx("div",{className:"flex gap-2",children:w.map(b=>l.jsx("button",{onClick:()=>o(b.id),className:`px-4 py-2 rounded-lg text-sm transition-colors ${a===b.id?"bg-gray-900 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:b.name},b.id))}),a==="pov"?l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[l.jsx(Y0,{className:"w-4 h-4 mr-2"}),""]}),l.jsx("div",{className:"space-y-2",children:S.povOptions.map(b=>l.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[l.jsx("span",{className:"text-sm text-gray-900",children:b.label}),l.jsx("span",{className:"text-xs text-gray-500",children:b.height}),l.jsx("button",{onClick:()=>c(`camera height: ${b.height}, ${b.label}`,b.id),className:"p-1 text-gray-400 hover:text-primary-600",children:i===b.id?l.jsx(Jn,{className:"w-4 h-4"}):l.jsx(di,{className:"w-4 h-4"})})]},b.id))})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[l.jsx(tc,{className:"w-4 h-4 mr-2"}),""]}),l.jsx("div",{className:"space-y-2",children:S.angleOptions.map(b=>l.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[l.jsx("span",{className:"text-sm text-gray-900",children:b.label}),l.jsxs("span",{className:"text-xs text-gray-500",children:[b.degree>0?"+":"",b.degree,""]}),l.jsx("button",{onClick:()=>c(`camera angle: ${b.label}, ${b.degree} degrees`,b.id),className:"p-1 text-gray-400 hover:text-primary-600",children:i===b.id?l.jsx(Jn,{className:"w-4 h-4"}):l.jsx(di,{className:"w-4 h-4"})})]},b.id))})]})]}):l.jsx("div",{className:"grid grid-cols-2 gap-3",children:(_=x==null?void 0:x.data)==null?void 0:_.map((b,M)=>l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3 flex items-center justify-between hover:border-primary-300 transition-colors",children:[l.jsx("span",{className:"text-sm text-gray-700",children:b}),l.jsx("button",{onClick:()=>c(b,`${a}_${M}`),className:"p-1.5 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded",children:i===`${a}_${M}`?l.jsx(Jn,{className:"w-4 h-4"}):l.jsx(di,{className:"w-4 h-4"})})]},M))})]})};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"relative",children:[l.jsx(nc,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"...",value:t,onChange:S=>r(S.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),l.jsx("div",{className:"flex items-center gap-2",children:pC.map(S=>l.jsxs("button",{onClick:()=>{e(S.id),r("")},className:`flex items-center px-4 py-2.5 rounded-lg transition-colors ${n===S.id?"bg-primary-600 text-white":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(S.icon,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"font-medium",children:S.name})]},S.id))}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:"text-sm text-gray-500",children:(y=pC.find(S=>S.id===n))==null?void 0:y.description}),n!=="cityBattle"&&l.jsxs("span",{className:"text-sm text-gray-400",children:[n==="shotTypes"&&`${ci.shotTypes.length} `,n==="transitions"&&`${ci.transitions.length} `,n==="scifiEffects"&&`${ci.scifiEffects.length} `]})]}),u(),t&&(n==="shotTypes"&&ci.shotTypes.filter(S=>S.name.toLowerCase().includes(t.toLowerCase())).length===0||n==="transitions"&&ci.transitions.filter(S=>S.name.toLowerCase().includes(t.toLowerCase())).length===0||n==="scifiEffects"&&ci.scifiEffects.filter(S=>S.name.toLowerCase().includes(t.toLowerCase())).length===0)&&l.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border border-gray-200",children:[l.jsx(ZN,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:""}),l.jsx("p",{className:"text-gray-400",children:""})]})]})}const _v={animatediff:{name:"AnimateDiff",description:" SD 1.5 ",type:"text2video",requirements:["ComfyUI-AnimateDiff-Evolved","ComfyUI-VideoHelperSuite"],recommended:{resolution:"512x512",frames:16,model:"v3_sd15_mm.ckpt"}},svd:{name:"Stable Video Diffusion",description:"",type:"image2video",requirements:["ComfyUI-VideoHelperSuite"],recommended:{resolution:"1024x576",frames:25,model:"svd_xt_1_1.safetensors"}},cogvideo:{name:"CogVideoX",description:"24GB+",type:"text2video",requirements:["ComfyUI-CogVideoXWrapper","ComfyUI-VideoHelperSuite"],recommended:{resolution:"720x480",frames:49,model:"CogVideoX-5b"}}};function e4(){const{shots:n,fetchShots:e,generatePrompt:t}=$0(),{scenes:r,fetchScenes:i}=ed(),{characters:s,fetchCharacters:a}=La(),[o,c]=F.useState(!1),[u,f]=F.useState("json"),[p,m]=F.useState("animatediff"),[g,y]=F.useState([]),[S,w]=F.useState(null),[x,_]=F.useState(!1),[b,M]=F.useState({resolution:"1024x576",sampler:"euler_ancestral",steps:20,cfg:7,frames:16,fps:8,motionScale:1});F.useEffect(()=>{e(),i(),a()},[]),F.useEffect(()=>{n.length>0&&g.length===0&&y(n.map(O=>O.id))},[n]);const N=O=>{y(k=>k.includes(O)?k.filter(Z=>Z!==O):[...k,O])},C=()=>{g.length===n.length?y([]):y(n.map(O=>O.id))},I=async()=>{_(!0);for(const O of g){const k=n.find(Z=>Z.id===O);k&&!k.generatedPrompt&&await t(O)}await e(),_(!1)},P=()=>{const O=n.filter($=>g.includes($.id)),[k,Z]=b.resolution.split("x").map(Number),te=_v[p],K={version:"1.0",generator:"FilmDream Studio",template:{id:p,name:te.name,type:te.type,requirements:te.requirements},settings:{resolution:{width:k,height:Z},sampler:b.sampler,steps:b.steps,cfg_scale:b.cfg,frames_per_shot:b.frames,fps:b.fps,motion_scale:b.motionScale},shots:O.map(($,U)=>{const H=r.find(G=>G.id===$.sceneId),W=$.characters||[];let Y=$.generatedPrompt||$.description||"";if(H){const G=[H.environment,H.atmosphere,H.timeOfDay,H.weather].filter(Boolean).join(", ");G&&!Y.includes(G)&&(Y=`${Y}, ${G}`)}return{index:U+1,id:$.id,description:$.description,duration:$.duration,scene:{name:(H==null?void 0:H.name)||null,environment:(H==null?void 0:H.environment)||null,atmosphere:(H==null?void 0:H.atmosphere)||null},characters:W.map(G=>({name:G.name,type:G.type,action:G.action})),prompt:Y,negative_prompt:"blurry, low quality, distorted, deformed, ugly, bad anatomy, watermark, text",compositor_data:$.compositorData||null,shot_type:$.shotType||null,camera_movement:$.cameraMovement||null}}),batch_queue:O.map(($,U)=>({id:`batch_${$.id}`,shot_index:U+1,output_filename:`filmdream_shot_${String(U+1).padStart(3,"0")}`,prompt:$.generatedPrompt||$.description,seed:Math.floor(Math.random()*2147483647)})),total_shots:O.length,total_duration:O.reduce(($,U)=>$+(U.duration||0),0),estimated_frames:O.length*b.frames,created_at:new Date().toISOString()};return w(K),K},T=O=>{const k=S||P();let Z,te,K;switch(O){case"json":Z=JSON.stringify(k,null,2),te="filmdream_workflow.json",K="application/json";break;case"prompts":Z=k.shots.map((W,Y)=>`# Shot ${Y+1}: ${W.description||"Untitled"}
Duration: ${W.duration}s
Scene: ${W.scene||"N/A"}
Prompt: ${W.prompt}
Negative: ${W.negative_prompt}
`).join(`
---

`),te="filmdream_prompts.txt",K="text/plain";break;case"markdown":Z=`# FilmDream Studio - 

: ${new Date().toLocaleString("zh-CN")}

: ${k.total_duration} 

---

`+k.shots.map((W,Y)=>`##  ${Y+1}

****: ${W.description||""}

****: ${W.duration} 

****: ${W.scene||""}

****:
\`\`\`
${W.prompt}
\`\`\`
`).join(`
---

`),te="filmdream_storyboard.md",K="text/markdown";break;default:return}const $=new Blob([Z],{type:K}),U=URL.createObjectURL($),H=document.createElement("a");H.href=U,H.download=te,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(U)},R=()=>{const O=S||P();navigator.clipboard.writeText(JSON.stringify(O,null,2)),c(!0),setTimeout(()=>c(!1),2e3)},j=O=>{var k;return(k=r.find(Z=>Z.id===O))==null?void 0:k.name};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(t3,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),l.jsx("div",{className:"grid grid-cols-3 gap-4 mb-4",children:Object.entries(_v).map(([O,k])=>l.jsxs("div",{onClick:()=>m(O),className:`p-4 border-2 rounded-xl cursor-pointer transition-all ${p===O?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:k.name}),l.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${k.type==="text2video"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:k.type==="text2video"?"":""})]}),l.jsx("p",{className:"text-sm text-gray-500 mb-3",children:k.description}),l.jsxs("div",{className:"text-xs text-gray-400",children:[": ",k.recommended.resolution,"  ",k.recommended.frames," "]})]},O))}),l.jsxs("div",{className:"flex items-start p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[l.jsx(Ba,{className:"w-5 h-5 text-amber-500 mr-2 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm",children:[l.jsx("p",{className:"font-medium text-amber-800 mb-1",children:" ComfyUI :"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:_v[p].requirements.map(O=>l.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded text-xs",children:O},O))})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(gf,{className:"w-5 h-5 mr-2"}),""]}),l.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsxs("select",{value:u,onChange:O=>f(O.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[l.jsx("option",{value:"json",children:"ComfyUI  (.json)"}),l.jsx("option",{value:"prompts",children:" (.txt)"}),l.jsx("option",{value:"markdown",children:" (.md)"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsxs("select",{value:b.resolution,onChange:O=>M(k=>({...k,resolution:O.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[l.jsx("option",{value:"512x512",children:"512 x 512 (1:1)"}),l.jsx("option",{value:"768x768",children:"768 x 768 (1:1)"}),l.jsx("option",{value:"1024x576",children:"1024 x 576 (16:9)"}),l.jsx("option",{value:"576x1024",children:"576 x 1024 (9:16)"}),l.jsx("option",{value:"720x480",children:"720 x 480 (CogVideo)"}),l.jsx("option",{value:"1280x720",children:"1280 x 720 (HD)"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("input",{type:"number",value:b.frames,onChange:O=>M(k=>({...k,frames:parseInt(O.target.value)||16})),min:8,max:64,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:" FPS"}),l.jsx("input",{type:"number",value:b.fps,onChange:O=>M(k=>({...k,fps:parseInt(O.target.value)||8})),min:4,max:30,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:""}),l.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsxs("select",{value:b.sampler,onChange:O=>M(k=>({...k,sampler:O.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[l.jsx("option",{value:"euler_ancestral",children:"Euler Ancestral"}),l.jsx("option",{value:"euler",children:"Euler"}),l.jsx("option",{value:"dpm++_2m",children:"DPM++ 2M"}),l.jsx("option",{value:"dpm++_sde",children:"DPM++ SDE"}),l.jsx("option",{value:"ddim",children:"DDIM"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("input",{type:"number",value:b.steps,onChange:O=>M(k=>({...k,steps:parseInt(O.target.value)||20})),min:10,max:50,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"CFG Scale"}),l.jsx("input",{type:"number",value:b.cfg,onChange:O=>M(k=>({...k,cfg:parseFloat(O.target.value)||7})),step:.5,min:1,max:20,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"FPS"}),l.jsx("input",{type:"number",value:b.fps,onChange:O=>M(k=>({...k,fps:parseInt(O.target.value)||8})),min:4,max:30,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:""}),l.jsx("input",{type:"number",value:b.motionScale,onChange:O=>M(k=>({...k,motionScale:parseFloat(O.target.value)||1})),step:.1,min:.1,max:2,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:""}),l.jsx("button",{onClick:C,className:"text-sm text-primary-600 hover:text-primary-700",children:g.length===n.length?"":""})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-sm text-gray-500",children:[" ",g.length,"/",n.length," "]}),l.jsxs("button",{onClick:I,disabled:x||g.length===0,className:"flex items-center px-3 py-1.5 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:[l.jsx(Rg,{className:`w-4 h-4 mr-1.5 ${x?"animate-spin":""}`}),""]})]})]}),n.length===0?l.jsxs("div",{className:"text-center py-12 text-gray-400",children:[l.jsx(Qu,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),l.jsx("p",{children:""})]}):l.jsx("div",{className:"divide-y divide-gray-100",children:n.map((O,k)=>l.jsxs("div",{className:`flex items-center p-4 ${g.includes(O.id)?"bg-primary-50":""}`,children:[l.jsx("input",{type:"checkbox",checked:g.includes(O.id),onChange:()=>N(O.id),className:"w-4 h-4 text-primary-600 rounded mr-4"}),l.jsx("span",{className:"w-8 h-8 flex items-center justify-center bg-gray-900 text-white rounded text-sm font-medium mr-4",children:k+1}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 truncate",children:O.description||""}),l.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500 mt-0.5",children:[l.jsxs("span",{children:[O.duration,""]}),O.sceneId&&l.jsx("span",{children:j(O.sceneId)})]})]}),l.jsx("div",{className:"flex items-center gap-2",children:O.generatedPrompt?l.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded",children:""}):l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 text-xs rounded",children:""})})]},O.id))})]}),l.jsxs("div",{className:"bg-gray-900 rounded-xl p-6 text-white",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h3",{className:"font-semibold flex items-center",children:[l.jsx(mF,{className:"w-5 h-5 mr-2"}),""]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:P,className:"flex items-center px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600",children:[l.jsx(Rg,{className:"w-4 h-4 mr-2"}),""]}),l.jsxs("button",{onClick:R,className:"flex items-center px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600",children:[o?l.jsx(Jn,{className:"w-4 h-4 mr-2"}):l.jsx(di,{className:"w-4 h-4 mr-2"}),o?"":""]}),l.jsxs("button",{onClick:()=>T(u),className:"flex items-center px-4 py-2 bg-primary-600 rounded-lg hover:bg-primary-700",children:[l.jsx(Jh,{className:"w-4 h-4 mr-2"})," ",u.toUpperCase()]})]})]}),l.jsx("pre",{className:"bg-gray-800 rounded-lg p-4 text-sm text-gray-300 overflow-x-auto max-h-96",children:S?JSON.stringify(S,null,2):`{
  // ""
  // 
}`})]})]})}const Us="http://localhost:3001/api",Bg=[{value:"neutral",label:"",description:""},{value:"cheerful",label:"",description:""},{value:"sad",label:"",description:""},{value:"angry",label:"",description:""},{value:"fearful",label:"",description:""},{value:"serious",label:"",description:""},{value:"excited",label:"",description:""},{value:"whisper",label:"",description:""},{value:"shouting",label:"",description:""}],h3=[{value:"x-slow",label:"",multiplier:.5},{value:"slow",label:"",multiplier:.75},{value:"medium",label:"",multiplier:1},{value:"fast",label:"",multiplier:1.25},{value:"x-fast",label:"",multiplier:1.5}],Lg=[{value:"dialogue",label:"",icon:"",description:""},{value:"monologue",label:"",icon:"",description:""},{value:"narration",label:"",icon:"",description:""},{value:"sfx",label:"",icon:"",description:""}],t4=Es((n,e)=>({voiceProfiles:[],voiceovers:[],currentVoiceover:null,loading:!1,error:null,fetchVoiceProfiles:async()=>{n({loading:!0});try{const r=await(await fetch(`${Us}/voiceovers/profiles`)).json();n({voiceProfiles:r,loading:!1})}catch(t){n({error:t.message,loading:!1})}},saveVoiceProfile:async(t,r)=>{try{const s=await(await fetch(`${Us}/voiceovers/profiles/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>a.voiceProfiles.find(c=>c.characterId===t)?{voiceProfiles:a.voiceProfiles.map(c=>c.characterId===t?s:c)}:{voiceProfiles:[...a.voiceProfiles,s]}),s}catch(i){throw i}},fetchVoiceovers:async(t=null)=>{n({loading:!0});try{const r=t?`${Us}/voiceovers?shotId=${t}`:`${Us}/voiceovers`,s=await(await fetch(r)).json();n({voiceovers:s,loading:!1})}catch(r){n({error:r.message,loading:!1})}},createVoiceover:async t=>{try{const i=await(await fetch(`${Us}/voiceovers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return n(s=>({voiceovers:[...s.voiceovers,i]})),i}catch(r){throw r}},updateVoiceover:async(t,r)=>{try{const s=await(await fetch(`${Us}/voiceovers/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();return n(a=>{var o;return{voiceovers:a.voiceovers.map(c=>c.id===t?s:c),currentVoiceover:((o=a.currentVoiceover)==null?void 0:o.id)===t?s:a.currentVoiceover}}),s}catch(i){throw i}},deleteVoiceover:async t=>{try{await fetch(`${Us}/voiceovers/${t}`,{method:"DELETE"}),n(r=>{var i;return{voiceovers:r.voiceovers.filter(s=>s.id!==t),currentVoiceover:((i=r.currentVoiceover)==null?void 0:i.id)===t?null:r.currentVoiceover}})}catch(r){throw r}},uploadAudio:async(t,r)=>{try{const i=new FormData;i.append("audio",r);const a=await(await fetch(`${Us}/voiceovers/${t}/audio`,{method:"POST",body:i})).json();return n(o=>({voiceovers:o.voiceovers.map(c=>c.id===t?{...c,...a}:c)})),a}catch(i){throw i}},generateTTSPrompt:async t=>{try{const i=await(await fetch(`${Us}/voiceovers/${t}/generate-tts`,{method:"POST"})).json();return n(s=>({voiceovers:s.voiceovers.map(a=>a.id===t?{...a,ttsPrompt:i.ttsPrompt}:a)})),i}catch(r){throw r}},reorderVoiceovers:async(t,r)=>{try{await fetch(`${Us}/voiceovers/reorder`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shotId:t,order:r})}),e().fetchVoiceovers(t)}catch(i){throw i}},setCurrentVoiceover:t=>n({currentVoiceover:t})}));function n4(){const{voiceProfiles:n,voiceovers:e,loading:t,fetchVoiceProfiles:r,fetchVoiceovers:i,saveVoiceProfile:s,createVoiceover:a,updateVoiceover:o,deleteVoiceover:c,uploadAudio:u,generateTTSPrompt:f}=t4(),{characters:p,fetchCharacters:m}=La(),{shots:g,fetchShots:y}=$0(),{scenes:S,fetchScenes:w}=ed(),[x,_]=F.useState("voicelines"),[b,M]=F.useState(null),[N,C]=F.useState(!1),[I,P]=F.useState(null),[T,R]=F.useState(null),[j,O]=F.useState(null),[k,Z]=F.useState(null),te=F.useRef(null);F.useEffect(()=>{r(),i(),m(),y(),w()},[]);const K=Y=>p.find(G=>G.id===Y),$=Y=>S.find(G=>G.id===Y),U=(Y,G)=>{navigator.clipboard.writeText(Y),O(G),setTimeout(()=>O(null),2e3)},H=Y=>{var G;Y.audioFile&&(k===Y.id?((G=te.current)==null||G.pause(),Z(null)):te.current&&(te.current.src=`/uploads/audio/${Y.audioFile}`,te.current.play(),Z(Y.id)))},W=g.map(Y=>({shot:Y,scene:$(Y.sceneId),voiceovers:e.filter(G=>G.shotId===Y.id).sort((G,de)=>G.orderIndex-de.orderIndex)})).filter(Y=>Y.voiceovers.length>0||(b==null?void 0:b.id)===Y.shot.id);return l.jsxs("div",{className:"space-y-6",children:[l.jsx("audio",{ref:te,onEnded:()=>Z(null),className:"hidden"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>_("voicelines"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${x==="voicelines"?"bg-primary-600 text-white":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(pf,{className:"w-4 h-4 mr-2"}),""]}),l.jsxs("button",{onClick:()=>_("profiles"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${x==="profiles"?"bg-primary-600 text-white":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(FF,{className:"w-4 h-4 mr-2"}),""]}),l.jsxs("button",{onClick:()=>_("timeline"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${x==="timeline"?"bg-primary-600 text-white":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[l.jsx(Qu,{className:"w-4 h-4 mr-2"}),""]})]}),x==="voicelines"&&l.jsxs("button",{onClick:()=>C(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})]}),x==="voicelines"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("select",{value:(b==null?void 0:b.id)||"",onChange:Y=>{const G=g.find(de=>de.id===parseInt(Y.target.value));M(G||null)},className:"px-4 py-2 border border-gray-300 rounded-lg text-sm",children:[l.jsx("option",{value:"",children:""}),g.map((Y,G)=>{var de;return l.jsxs("option",{value:Y.id,children:["#",G+1,": ",((de=Y.description)==null?void 0:de.slice(0,30))||""]},Y.id)})]}),l.jsxs("span",{className:"text-sm text-gray-500",children:[" ",e.length," "]})]}),t?l.jsx("div",{className:"text-center py-12",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-500 border-t-transparent mx-auto"})}):e.length===0?l.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border border-gray-200",children:[l.jsx($b,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:""}),l.jsx("p",{className:"text-gray-400 mb-4",children:""}),l.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[l.jsx(vi,{className:"w-4 h-4 mr-2"}),""]})]}):l.jsx("div",{className:"space-y-4",children:W.map(({shot:Y,scene:G,voiceovers:de})=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[l.jsxs("div",{className:"px-5 py-3 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"w-8 h-8 flex items-center justify-center bg-gray-900 text-white rounded text-sm font-medium",children:g.findIndex(Ce=>Ce.id===Y.id)+1}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:Y.description||""}),l.jsxs("p",{className:"text-xs text-gray-500",children:[(G==null?void 0:G.name)||"","  ",Y.duration,""]})]})]}),l.jsx("button",{onClick:()=>{M(Y),C(!0)},className:"text-sm text-primary-600 hover:text-primary-700",children:"+ "})]}),l.jsx("div",{className:"divide-y divide-gray-100",children:de.map(Ce=>{const be=K(Ce.characterId),se=Lg.find(Le=>Le.value===Ce.type),_e=yr.find(Le=>Le.value===(be==null?void 0:be.type));return l.jsx(r4,{voiceover:Ce,character:be,charType:_e,typeInfo:se,isPlaying:k===Ce.id,copiedId:j,onPlay:()=>H(Ce),onCopy:Le=>U(Le,Ce.id),onEdit:()=>P(Ce),onDelete:()=>c(Ce.id),onGenerateTTS:()=>f(Ce.id),onUploadAudio:Le=>u(Ce.id,Le)},Ce.id)})})]},Y.id))})]}),x==="profiles"&&l.jsx(s4,{characters:p,voiceProfiles:n,onSave:s,editingProfile:T,setEditingProfile:R}),x==="timeline"&&l.jsx(a4,{shots:g,scenes:S,voiceovers:e,characters:p,getCharacter:K}),(N||I)&&l.jsx(i4,{voiceover:I,shots:g,characters:p,voiceProfiles:n,defaultShotId:b==null?void 0:b.id,onClose:()=>{C(!1),P(null)},onSave:async Y=>{I?await o(I.id,Y):await a(Y),C(!1),P(null)}})]})}function r4({voiceover:n,character:e,charType:t,typeInfo:r,isPlaying:i,copiedId:s,onPlay:a,onCopy:o,onEdit:c,onDelete:u,onGenerateTTS:f,onUploadAudio:p}){var w;const m=F.useRef(null),[g,y]=F.useState(!1),S=async()=>{y(!0);try{await f()}finally{y(!1)}};return l.jsx("div",{className:"p-4 hover:bg-gray-50 group",children:l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center text-xl flex-shrink-0",children:(r==null?void 0:r.icon)||""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e&&l.jsxs("span",{className:"flex items-center text-sm",children:[l.jsx("span",{className:"mr-1",children:t==null?void 0:t.icon}),l.jsx("span",{className:"font-medium text-gray-900",children:e.name})]}),!e&&n.type==="narration"&&l.jsx("span",{className:"text-sm font-medium text-gray-900",children:""}),l.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:r==null?void 0:r.label}),n.emotion&&l.jsxs("span",{className:"text-xs text-gray-400",children:[" ",(w=Bg.find(x=>x.value===n.emotion))==null?void 0:w.label]})]}),l.jsx("p",{className:"text-gray-800 mb-2",children:n.text}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.startTime!==void 0&&l.jsxs("span",{className:"flex items-center",children:[l.jsx(Zb,{className:"w-3.5 h-3.5 mr-1"}),n.startTime,"s - ",n.endTime,"s"]}),n.audioFile&&l.jsx("button",{onClick:a,className:"flex items-center text-primary-600 hover:text-primary-700",children:i?l.jsxs(l.Fragment,{children:[l.jsx(IF,{className:"w-3.5 h-3.5 mr-1"})," "]}):l.jsxs(l.Fragment,{children:[l.jsx(ew,{className:"w-3.5 h-3.5 mr-1"})," "]})})]}),n.ttsPrompt&&l.jsxs("div",{className:"mt-3 p-2 bg-gray-900 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-xs text-gray-400",children:"TTS "}),l.jsx("button",{onClick:()=>o(n.ttsPrompt),className:"text-xs text-gray-400 hover:text-white",children:s===n.id?l.jsxs(l.Fragment,{children:[l.jsx(Jn,{className:"w-3 h-3 inline mr-1"}),""]}):l.jsxs(l.Fragment,{children:[l.jsx(di,{className:"w-3 h-3 inline mr-1"}),""]})})]}),l.jsx("p",{className:"text-xs text-green-400 font-mono",children:n.ttsPrompt})]})]}),l.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:S,disabled:g,className:"p-2 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg",title:"TTS",children:l.jsx(xf,{className:`w-4 h-4 ${g?"animate-spin":""}`})}),l.jsx("button",{onClick:()=>{var x;return(x=m.current)==null?void 0:x.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"",children:l.jsx(q0,{className:"w-4 h-4"})}),l.jsx("input",{ref:m,type:"file",accept:"audio/*",className:"hidden",onChange:x=>{var _;(_=x.target.files)!=null&&_[0]&&p(x.target.files[0])}}),l.jsx("button",{onClick:c,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:l.jsx($u,{className:"w-4 h-4"})}),l.jsx("button",{onClick:u,className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg",children:l.jsx(zr,{className:"w-4 h-4"})})]})]})})}function i4({voiceover:n,shots:e,characters:t,voiceProfiles:r,defaultShotId:i,onClose:s,onSave:a}){const[o,c]=F.useState({shotId:(n==null?void 0:n.shotId)||i||"",characterId:(n==null?void 0:n.characterId)||"",type:(n==null?void 0:n.type)||"dialogue",text:(n==null?void 0:n.text)||"",emotion:(n==null?void 0:n.emotion)||"neutral",speechRate:(n==null?void 0:n.speechRate)||"medium",startTime:(n==null?void 0:n.startTime)||0,endTime:(n==null?void 0:n.endTime)||3,notes:(n==null?void 0:n.notes)||""}),[u,f]=F.useState(!1),p=async()=>{if(!(!o.shotId||!o.text.trim())){f(!0);try{await a({...o,shotId:parseInt(o.shotId),characterId:o.characterId?parseInt(o.characterId):null})}finally{f(!1)}}},m=g=>{if(c(y=>({...y,characterId:g})),g){const y=r.find(S=>S.characterId===parseInt(g));y&&c(S=>({...S,characterId:g,emotion:y.defaultEmotion||S.emotion,speechRate:y.defaultRate||S.speechRate}))}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60",onClick:s,children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:g=>g.stopPropagation(),children:[l.jsx("div",{className:"p-5 border-b",children:l.jsx("h3",{className:"text-lg font-semibold",children:n?"":""})}),l.jsxs("div",{className:"p-5 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsxs("select",{value:o.shotId,onChange:g=>c(y=>({...y,shotId:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"",children:""}),e.map((g,y)=>{var S;return l.jsxs("option",{value:g.id,children:["#",y+1,": ",((S=g.description)==null?void 0:S.slice(0,40))||""]},g.id)})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("select",{value:o.type,onChange:g=>c(y=>({...y,type:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:Lg.map(g=>l.jsxs("option",{value:g.value,children:[g.icon," ",g.label]},g.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.type==="narration"&&"()"]}),l.jsxs("select",{value:o.characterId,onChange:g=>m(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"",children:o.type==="narration"?"":""}),t.map(g=>{const y=yr.find(S=>S.value===g.type);return l.jsxs("option",{value:g.id,children:[y==null?void 0:y.icon," ",g.name]},g.id)})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("textarea",{value:o.text,onChange:g=>c(y=>({...y,text:g.target.value})),rows:4,placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg resize-none"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"/"}),l.jsx("select",{value:o.emotion,onChange:g=>c(y=>({...y,emotion:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:Bg.map(g=>l.jsxs("option",{value:g.value,children:[g.label," - ",g.description]},g.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("select",{value:o.speechRate,onChange:g=>c(y=>({...y,speechRate:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:h3.map(g=>l.jsx("option",{value:g.value,children:g.label},g.value))})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" ()"}),l.jsx("input",{type:"number",value:o.startTime,onChange:g=>c(y=>({...y,startTime:parseFloat(g.target.value)||0})),step:.1,min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" ()"}),l.jsx("input",{type:"number",value:o.endTime,onChange:g=>c(y=>({...y,endTime:parseFloat(g.target.value)||0})),step:.1,min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"text",value:o.notes,onChange:g=>c(y=>({...y,notes:g.target.value})),placeholder:"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),l.jsxs("div",{className:"p-5 border-t bg-gray-50 flex justify-end gap-3",children:[l.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:""}),l.jsx("button",{onClick:p,disabled:u||!o.shotId||!o.text.trim(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:u?"...":n?"":""})]})]})})}function s4({characters:n,voiceProfiles:e,onSave:t,editingProfile:r,setEditingProfile:i}){var p;const[s,a]=F.useState({}),[o,c]=F.useState(null),u=m=>{const g=e.find(y=>y.characterId===m.id)||{};a({voiceType:g.voiceType||"male-adult",pitch:g.pitch||"medium",defaultEmotion:g.defaultEmotion||"neutral",defaultRate:g.defaultRate||"medium",accent:g.accent||"",notes:g.notes||""}),i(m)},f=async()=>{if(r){c(r.id);try{await t(r.id,s),i(null)}finally{c(null)}}};return l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:""}),l.jsx("p",{className:"text-sm text-gray-500",children:""}),n.length===0?l.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:[l.jsx(e3,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-400",children:""})]}):l.jsx("div",{className:"space-y-2",children:n.map(m=>{var w;const g=yr.find(x=>x.value===m.type),y=e.find(x=>x.characterId===m.id),S=(r==null?void 0:r.id)===m.id;return l.jsx("div",{className:`p-4 bg-white rounded-xl border cursor-pointer transition-all ${S?"border-primary-300 ring-2 ring-primary-100":"border-gray-200 hover:border-gray-300"}`,onClick:()=>u(m),children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-2xl mr-3",children:g==null?void 0:g.icon}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900",children:m.name}),y?l.jsxs("p",{className:"text-xs text-gray-500",children:[y.voiceType,"  ",((w=Bg.find(x=>x.value===y.defaultEmotion))==null?void 0:w.label)||""]}):l.jsx("p",{className:"text-xs text-gray-400",children:""})]}),y&&l.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded",children:""})]})},m.id)})})]}),l.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:r?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900",children:[(p=yr.find(m=>m.value===r.type))==null?void 0:p.icon," ",r.name," "]}),l.jsx("button",{onClick:()=>i(null),className:"text-sm text-gray-400 hover:text-gray-600",children:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:s.voiceType,onChange:m=>a(g=>({...g,voiceType:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"male-adult",children:""}),l.jsx("option",{value:"male-young",children:""}),l.jsx("option",{value:"male-old",children:""}),l.jsx("option",{value:"female-adult",children:""}),l.jsx("option",{value:"female-young",children:""}),l.jsx("option",{value:"female-old",children:""}),l.jsx("option",{value:"child",children:""}),l.jsx("option",{value:"robot",children:"/"}),l.jsx("option",{value:"monster",children:"/"}),l.jsx("option",{value:"narrator",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsxs("select",{value:s.pitch,onChange:m=>a(g=>({...g,pitch:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[l.jsx("option",{value:"x-low",children:""}),l.jsx("option",{value:"low",children:""}),l.jsx("option",{value:"medium",children:""}),l.jsx("option",{value:"high",children:""}),l.jsx("option",{value:"x-high",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("select",{value:s.defaultEmotion,onChange:m=>a(g=>({...g,defaultEmotion:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:Bg.map(m=>l.jsx("option",{value:m.value,children:m.label},m.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("select",{value:s.defaultRate,onChange:m=>a(g=>({...g,defaultRate:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:h3.map(m=>l.jsx("option",{value:m.value,children:m.label},m.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"/"}),l.jsx("input",{type:"text",value:s.accent,onChange:m=>a(g=>({...g,accent:m.target.value})),placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("textarea",{value:s.notes,onChange:m=>a(g=>({...g,notes:m.target.value})),rows:2,placeholder:"...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg resize-none"})]}),l.jsx("button",{onClick:f,disabled:o===r.id,className:"w-full py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:o===r.id?"...":""})]}):l.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:l.jsxs("div",{className:"text-center",children:[l.jsx(gf,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),l.jsx("p",{children:""})]})})})]})}function a4({shots:n,scenes:e,voiceovers:t,characters:r,getCharacter:i}){const s=u=>t.filter(f=>f.shotId===u).sort((f,p)=>f.startTime-p.startTime);let a=0;const o=n.map(u=>{const f={...u,timeOffset:a};return a+=u.duration||3,f}),c=n.reduce((u,f)=>u+(f.duration||3),0);return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:""}),l.jsxs("span",{className:"text-sm text-gray-500",children:[": ",c,""]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[l.jsx("div",{className:"h-8 bg-gray-100 border-b border-gray-200 relative",children:Array.from({length:Math.ceil(c/5)+1}).map((u,f)=>l.jsxs("div",{className:"absolute top-0 h-full flex items-center",style:{left:`${f*5/c*100}%`},children:[l.jsx("div",{className:"h-3 w-px bg-gray-300"}),l.jsxs("span",{className:"text-xs text-gray-400 ml-1",children:[f*5,"s"]})]},f))}),l.jsx("div",{className:"divide-y divide-gray-100",children:o.map((u,f)=>{var y;e.find(S=>S.id===u.sceneId);const p=s(u.id),m=(u.duration||3)/c*100,g=u.timeOffset/c*100;return l.jsxs("div",{className:"relative",style:{minHeight:80},children:[l.jsxs("div",{className:"absolute left-0 top-0 w-32 h-full p-2 border-r border-gray-100 bg-gray-50",children:[l.jsxs("p",{className:"text-xs font-medium text-gray-900 truncate",children:["#",f+1," ",(y=u.description)==null?void 0:y.slice(0,15)]}),l.jsxs("p",{className:"text-xs text-gray-400",children:[u.duration,"s"]})]}),l.jsxs("div",{className:"ml-32 relative h-full",style:{minHeight:60},children:[l.jsx("div",{className:"absolute top-1 h-6 bg-gray-200 rounded opacity-30",style:{left:`${g}%`,width:`${m}%`}}),p.map((S,w)=>{const x=i(S.characterId),_=u.timeOffset+(S.startTime||0),b=(S.endTime||3)-(S.startTime||0),M=_/c*100,N=b/c*100,C=Lg.find(I=>I.value===S.type);return l.jsx("div",{className:"absolute h-5 rounded text-xs flex items-center px-1 overflow-hidden cursor-pointer hover:opacity-90",style:{left:`${M}%`,width:`${Math.max(N,2)}%`,top:28+w*24,backgroundColor:S.type==="narration"?"#8b5cf6":S.type==="dialogue"?"#3b82f6":S.type==="monologue"?"#10b981":"#f59e0b"},title:`${(x==null?void 0:x.name)||""}: ${S.text}`,children:l.jsxs("span",{className:"text-white truncate",children:[C==null?void 0:C.icon," ",(x==null?void 0:x.name)||"",": ",S.text.slice(0,20)]})},S.id)})]})]},u.id)})})]}),l.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[l.jsx("span",{className:"text-gray-500",children:":"}),Lg.map(u=>l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-3 h-3 rounded",style:{backgroundColor:u.value==="narration"?"#8b5cf6":u.value==="dialogue"?"#3b82f6":u.value==="monologue"?"#10b981":"#f59e0b"}}),u.label]},u.value))]})]})}const Ai="http://localhost:3001/api",ex=Es((n,e)=>({messages:[],isLoading:!1,isStreaming:!1,error:null,conversations:[],currentConversationId:null,isLoadingConversations:!1,providers:[],models:[],currentProvider:"github-copilot",currentModel:"claude-sonnet-4",authStatus:{},deviceFlowInfo:null,isAuthenticating:!1,toolCallHistory:[],loadConversations:async()=>{n({isLoadingConversations:!0});try{const r=await(await fetch(`${Ai}/llm/conversations`)).json();r.success&&n({conversations:r.data,isLoadingConversations:!1})}catch(t){console.error("Failed to load conversations:",t),n({isLoadingConversations:!1})}},createConversation:async(t="")=>{try{const{currentProvider:r,currentModel:i}=e(),a=await(await fetch(`${Ai}/llm/conversations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,provider:r,model:i})})).json();if(a.success)return n(o=>({conversations:[a.data,...o.conversations],currentConversationId:a.data.id,messages:[],toolCallHistory:[]})),a.data}catch(r){console.error("Failed to create conversation:",r)}return null},selectConversation:async t=>{if(t===null){n({currentConversationId:null,messages:[],toolCallHistory:[]});return}n({isLoading:!0});try{const i=await(await fetch(`${Ai}/llm/conversations/${t}`)).json();if(i.success){const s=(i.data.messages||[]).map(a=>({id:a.id.toString(),role:a.role,content:a.content,timestamp:a.createdAt,toolCalls:a.toolCalls}));n({currentConversationId:t,messages:s,toolCallHistory:[],isLoading:!1})}}catch(r){console.error("Failed to select conversation:",r),n({isLoading:!1})}},updateConversationTitle:async(t,r)=>{try{(await(await fetch(`${Ai}/llm/conversations/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r})})).json()).success&&n(a=>({conversations:a.conversations.map(o=>o.id===t?{...o,title:r}:o)}))}catch(i){console.error("Failed to update conversation:",i)}},deleteConversation:async t=>{try{if((await(await fetch(`${Ai}/llm/conversations/${t}`,{method:"DELETE"})).json()).success){const{currentConversationId:s}=e();n(a=>({conversations:a.conversations.filter(o=>o.id!==t),...s===t?{currentConversationId:null,messages:[],toolCallHistory:[]}:{}}))}}catch(r){console.error("Failed to delete conversation:",r)}},startNewChat:()=>{n({currentConversationId:null,messages:[],toolCallHistory:[],error:null})},loadProviders:async()=>{try{const r=await(await fetch(`${Ai}/llm/providers`)).json();r.success&&n({providers:r.data})}catch(t){console.error("Failed to load providers:",t)}},loadModels:async()=>{var t,r;try{const s=await(await fetch(`${Ai}/llm/models`)).json();s.success&&n({models:s.data,currentProvider:((t=s.defaults)==null?void 0:t.provider)||"github-copilot",currentModel:((r=s.defaults)==null?void 0:r.model)||"claude-sonnet-4"})}catch(i){console.error("Failed to load models:",i)}},checkAuthStatus:async()=>{try{const r=await(await fetch(`${Ai}/llm/auth/status`)).json();r.success&&n({authStatus:r.data})}catch(t){console.error("Failed to check auth status:",t)}},startAuth:async t=>{n({isAuthenticating:!0,error:null});try{const i=await(await fetch(`${Ai}/llm/auth/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:t})})).json();if(i.success)return n({deviceFlowInfo:i.data}),i.data;throw new Error(i.error)}catch(r){throw n({error:r.message,isAuthenticating:!1}),r}},pollAuth:async(t,r)=>{try{const s=await(await fetch(`${Ai}/llm/auth/poll`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:t,deviceCode:r})})).json();return s.success?(s.data.status==="success"&&(n({isAuthenticating:!1,deviceFlowInfo:null,authStatus:{...e().authStatus,[t]:!0}}),e().loadModels()),s.data):{status:"error",message:s.error}}catch(i){return{status:"error",message:i.message}}},logout:async t=>{try{await fetch(`${Ai}/llm/auth/${t}`,{method:"DELETE"}),n({authStatus:{...e().authStatus,[t]:!1},models:[]})}catch(r){console.error("Failed to logout:",r)}},setModel:(t,r)=>{n({currentProvider:t,currentModel:r})},addUserMessage:t=>{const r={id:Date.now().toString(),role:"user",content:t,timestamp:new Date().toISOString()};return n(i=>({messages:[...i.messages,r]})),r},sendMessage:async t=>{const{currentProvider:r,currentModel:i,messages:s,currentConversationId:a}=e();let o=a;if(!o){const c=await e().createConversation();c&&(o=c.id)}e().addUserMessage(t),n({isLoading:!0,error:null,toolCallHistory:[]});try{const c=[...s,{role:"user",content:t}].map(p=>({role:p.role,content:p.content})),f=await(await fetch(`${Ai}/llm/chat/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:r,model:i,messages:c,conversationId:o})})).json();if(f.success){const p={id:Date.now().toString(),role:"assistant",content:f.data.content,timestamp:new Date().toISOString(),toolCalls:f.data.toolCallHistory};return n(m=>({messages:[...m.messages,p],toolCallHistory:f.data.toolCallHistory||[],isLoading:!1})),e().loadConversations(),p}else throw new Error(f.error)}catch(c){throw n({error:c.message,isLoading:!1}),c}},sendMessageStream:async t=>{const{currentProvider:r,currentModel:i,messages:s,currentConversationId:a}=e();let o=a;if(!o){const f=await e().createConversation();f&&(o=f.id)}e().addUserMessage(t),n({isStreaming:!0,error:null,toolCallHistory:[]});const c=Date.now().toString(),u={id:c,role:"assistant",content:"",timestamp:new Date().toISOString(),toolCalls:[],isStreaming:!0};n(f=>({messages:[...f.messages,u]}));try{const f=[...s,{role:"user",content:t}].map(S=>({role:S.role,content:S.content})),m=(await fetch(`${Ai}/llm/chat/complete/stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:r,model:i,messages:f})})).body.getReader(),g=new TextDecoder;let y="";for(;;){const{done:S,value:w}=await m.read();if(S)break;y+=g.decode(w,{stream:!0});const x=y.split(`
`);y=x.pop();for(const _ of x){if(_.startsWith("event: ")){const b=_.slice(7);continue}if(_.startsWith("data: ")){const b=_.slice(6);if(b==="[DONE]")continue;try{const M=JSON.parse(b);M.content&&n(N=>({messages:N.messages.map(C=>C.id===c?{...C,content:C.content+M.content}:C)})),M.id&&M.name&&n(N=>({toolCallHistory:[...N.toolCallHistory,{id:M.id,name:M.name,arguments:M.arguments,status:"calling"}]})),M.result&&n(N=>({toolCallHistory:N.toolCallHistory.map(C=>C.id===M.id?{...C,result:M.result,status:"done"}:C)}))}catch{}}}}n(S=>({messages:S.messages.map(w=>w.id===c?{...w,isStreaming:!1}:w),isStreaming:!1})),e().loadConversations()}catch(f){throw n({error:f.message,isStreaming:!1}),f}},clearMessages:()=>{n({messages:[],toolCallHistory:[],error:null})},clearError:()=>{n({error:null})}}));function o4(n){if(!n)return null;let e=n.replace(/```(\w*)\n([\s\S]*?)```/g,(t,r,i)=>`<pre class="bg-gray-800 text-gray-100 p-3 rounded-lg overflow-x-auto my-2"><code class="text-sm">${l4(i.trim())}</code></pre>`);return e=e.replace(/`([^`]+)`/g,'<code class="bg-gray-100 px-1.5 py-0.5 rounded text-sm text-pink-600">$1</code>'),e=e.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),e=e.replace(/\*([^*]+)\*/g,"<em>$1</em>"),e=e.replace(/\n/g,"<br/>"),l.jsx("div",{dangerouslySetInnerHTML:{__html:e}})}function l4(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c4({toolCall:n}){const[e,t]=F.useState(!1);let r=null;try{r=JSON.parse(n.result)}catch{r=n.result}const i=r==null?void 0:r.error;return l.jsxs("div",{className:rn("border rounded-lg my-2 text-sm",i?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50"),children:[l.jsxs("button",{onClick:()=>t(!e),className:"w-full flex items-center justify-between px-3 py-2 text-left",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(kF,{className:rn("w-4 h-4",i?"text-red-500":"text-blue-500")}),l.jsx("span",{className:"font-medium",children:n.name}),n.status==="calling"&&l.jsx(yi,{className:"w-4 h-4 animate-spin text-blue-500"}),n.status==="done"&&!i&&l.jsx(Gl,{className:"w-4 h-4 text-green-500"}),i&&l.jsx(Ba,{className:"w-4 h-4 text-red-500"})]}),e?l.jsx(Kb,{className:"w-4 h-4"}):l.jsx(J0,{className:"w-4 h-4"})]}),e&&l.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[n.arguments&&l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:":"}),l.jsx("pre",{className:"bg-white p-2 rounded text-xs overflow-x-auto",children:typeof n.arguments=="string"?n.arguments:JSON.stringify(JSON.parse(n.arguments),null,2)})]}),r&&l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:":"}),l.jsx("pre",{className:rn("p-2 rounded text-xs overflow-x-auto max-h-48",i?"bg-red-100":"bg-white"),children:typeof r=="string"?r:JSON.stringify(r,null,2)})]})]})]})}function u4({message:n,toolCallHistory:e}){const t=n.role==="user",r=n.toolCalls||(n.role==="assistant"&&(e==null?void 0:e.length)>0?e:[]);return l.jsxs("div",{className:rn("flex gap-3 py-4",t?"flex-row-reverse":""),children:[l.jsx("div",{className:rn("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",t?"bg-primary-100":"bg-gray-100"),children:t?l.jsx(e3,{className:"w-5 h-5 text-primary-600"}):l.jsx(A1,{className:"w-5 h-5 text-gray-600"})}),l.jsxs("div",{className:rn("flex-1 max-w-[80%]",t?"text-right":""),children:[l.jsx("div",{className:rn("inline-block rounded-lg px-4 py-2 text-left",t?"bg-primary-600 text-white":"bg-gray-100 text-gray-900"),children:n.isStreaming&&!n.content?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yi,{className:"w-4 h-4 animate-spin"}),l.jsx("span",{className:"text-sm",children:"..."})]}):l.jsx("div",{className:"prose prose-sm max-w-none",children:o4(n.content)})}),!t&&r.length>0&&l.jsx("div",{className:"mt-2",children:r.map((i,s)=>l.jsx(c4,{toolCall:i},i.id||s))}),l.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(n.timestamp).toLocaleTimeString()})]})]})}function d4({provider:n,onClose:e}){const{deviceFlowInfo:t,pollAuth:r,isAuthenticating:i}=ex(),[s,a]=F.useState("waiting"),[o,c]=F.useState(!1),u=F.useRef(null);F.useEffect(()=>{if(t&&n){const p=(t.interval||5)*1e3;return u.current=setInterval(async()=>{const m=await r(n,t.deviceCode);m.status==="success"?(a("success"),clearInterval(u.current),setTimeout(e,1500)):(m.status==="expired"||m.status==="denied"||m.status==="error")&&(a("error"),clearInterval(u.current))},p),()=>{u.current&&clearInterval(u.current)}}},[t,n]);const f=()=>{navigator.clipboard.writeText((t==null?void 0:t.userCode)||""),c(!0),setTimeout(()=>c(!1),2e3)};return t?l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-xl",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"GitHub Copilot "}),s==="waiting"&&l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"text-gray-600 mb-4",children:""}),l.jsxs("a",{href:t.verificationUri,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-primary-600 hover:text-primary-700 mb-4",children:[t.verificationUri,l.jsx(pF,{className:"w-4 h-4"})]}),l.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 text-center mb-4",children:[l.jsx("p",{className:"text-sm text-gray-500 mb-2",children:""}),l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("code",{className:"text-2xl font-mono font-bold tracking-wider",children:t.userCode}),l.jsx("button",{onClick:f,className:"p-2 hover:bg-gray-200 rounded",children:o?l.jsx(Gl,{className:"w-5 h-5 text-green-500"}):l.jsx(di,{className:"w-5 h-5"})})]})]}),l.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-500",children:[l.jsx(yi,{className:"w-5 h-5 animate-spin"}),l.jsx("span",{children:"..."})]})]}),s==="success"&&l.jsxs("div",{className:"text-center py-4",children:[l.jsx(Gl,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),l.jsx("p",{className:"text-lg font-medium text-green-600",children:""})]}),s==="error"&&l.jsxs("div",{className:"text-center py-4",children:[l.jsx(Ba,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),l.jsx("p",{className:"text-lg font-medium text-red-600",children:""}),l.jsx("button",{onClick:e,className:"mt-4 px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:""})]}),s==="waiting"&&l.jsx("button",{onClick:e,className:"mt-4 w-full py-2 text-gray-500 hover:text-gray-700",children:""})]})}):null}function h4({onClose:n}){const{providers:e,models:t,currentProvider:r,currentModel:i,authStatus:s,setModel:a,startAuth:o,logout:c,loadProviders:u,loadModels:f,checkAuthStatus:p}=ex(),[m,g]=F.useState(!1),[y,S]=F.useState(null);F.useEffect(()=>{u(),f(),p()},[]);const w=async x=>{S(x);try{await o(x),g(!0)}catch(_){console.error("Auth error:",_)}};return l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:n,children:l.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full mx-4 shadow-xl max-h-[80vh] overflow-y-auto",onClick:x=>x.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"LLM "}),l.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:""})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"font-medium mb-3",children:"Provider"}),l.jsx("div",{className:"space-y-2",children:e.map(x=>l.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:x.name}),l.jsx("p",{className:"text-sm text-gray-500",children:x.isConfigured?"":""})]}),l.jsx("div",{className:"flex items-center gap-2",children:x.isConfigured?l.jsxs(l.Fragment,{children:[l.jsx(Gl,{className:"w-5 h-5 text-green-500"}),l.jsx("button",{onClick:()=>c(x.id),className:"p-2 text-red-500 hover:bg-red-50 rounded",title:"",children:l.jsx(wF,{className:"w-4 h-4"})})]}):l.jsx("button",{onClick:()=>w(x.id),className:"px-3 py-1.5 bg-primary-600 text-white rounded-lg text-sm hover:bg-primary-700",children:""})})]},x.id))})]}),t.length>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium mb-3",children:""}),l.jsx("div",{className:"space-y-3",children:t.map(x=>l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 mb-2",children:x.providerName}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.models.map(_=>l.jsxs("button",{onClick:()=>a(x.provider,_.id),className:rn("p-2 border rounded-lg text-left text-sm transition-colors",r===x.provider&&i===_.id?"border-primary-500 bg-primary-50":"hover:bg-gray-50"),children:[l.jsx("p",{className:"font-medium",children:_.name}),_.description&&l.jsx("p",{className:"text-xs text-gray-400 truncate",children:_.description})]},_.id))})]},x.provider))})]}),m&&l.jsx(d4,{provider:y,onClose:()=>{g(!1),f(),p()}})]})})}function f4({conversation:n,isActive:e,onSelect:t,onDelete:r,onRename:i}){const[s,a]=F.useState(!1),[o,c]=F.useState(!1),[u,f]=F.useState(n.title),p=F.useRef(null);F.useEffect(()=>{const g=y=>{p.current&&!p.current.contains(y.target)&&a(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const m=()=>{u.trim()&&u!==n.title&&i(n.id,u.trim()),c(!1)};return l.jsxs("div",{className:rn("group relative flex items-center gap-2 px-3 py-2.5 rounded-lg cursor-pointer transition-colors",e?"bg-primary-100 text-primary-700":"hover:bg-gray-100 text-gray-700"),onClick:()=>!o&&t(n.id),children:[l.jsx(pf,{className:"w-4 h-4 flex-shrink-0"}),o?l.jsx("input",{type:"text",value:u,onChange:g=>f(g.target.value),onBlur:m,onKeyDown:g=>{g.key==="Enter"&&m(),g.key==="Escape"&&c(!1)},className:"flex-1 text-sm bg-white border rounded px-1 py-0.5 focus:outline-none focus:ring-1 focus:ring-primary-500",autoFocus:!0,onClick:g=>g.stopPropagation()}):l.jsx("span",{className:"flex-1 text-sm truncate",children:n.title}),l.jsxs("div",{className:"relative",ref:p,children:[l.jsx("button",{onClick:g=>{g.stopPropagation(),a(!s)},className:rn("p-1 rounded hover:bg-gray-200 transition-opacity",s?"opacity-100":"opacity-0 group-hover:opacity-100"),children:l.jsx(AF,{className:"w-4 h-4"})}),s&&l.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border rounded-lg shadow-lg z-10 py-1 min-w-[120px]",children:[l.jsxs("button",{onClick:g=>{g.stopPropagation(),c(!0),f(n.title),a(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[l.jsx(QN,{className:"w-4 h-4"}),""]}),l.jsxs("button",{onClick:g=>{g.stopPropagation(),r(n.id),a(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[l.jsx(zr,{className:"w-4 h-4"}),""]})]})]})]})}function p4({isOpen:n,onClose:e}){const{conversations:t,currentConversationId:r,isLoadingConversations:i,loadConversations:s,selectConversation:a,deleteConversation:o,updateConversationTitle:c,startNewChat:u}=ex();return F.useEffect(()=>{s()},[]),n?l.jsxs("div",{className:"w-72 border-r bg-gray-50 flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yF,{className:"w-5 h-5 text-gray-500"}),l.jsx("h3",{className:"font-medium",children:""})]}),l.jsx("button",{onClick:e,className:"p-1.5 hover:bg-gray-200 rounded-lg lg:hidden",children:l.jsx(Hn,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"p-3",children:l.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center gap-2 py-2.5 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-primary-400 hover:text-primary-600 transition-colors",children:[l.jsx(vi,{className:"w-5 h-5"}),""]})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-3 pb-3",children:i?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx(yi,{className:"w-6 h-6 animate-spin text-gray-400"})}):t.length===0?l.jsxs("div",{className:"text-center py-8 text-gray-400",children:[l.jsx(pf,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-sm",children:""})]}):l.jsx("div",{className:"space-y-1",children:t.map(f=>l.jsx(f4,{conversation:f,isActive:f.id===r,onSelect:a,onDelete:o,onRename:c},f.id))})})]}):null}function m4(){const{messages:n,isLoading:e,isStreaming:t,error:r,toolCallHistory:i,currentModel:s,authStatus:a,currentConversationId:o,sendMessage:c,sendMessageStream:u,clearMessages:f,clearError:p,loadProviders:m,loadModels:g,checkAuthStatus:y,startNewChat:S,loadConversations:w}=ex(),[x,_]=F.useState(""),[b,M]=F.useState(!1),[N,C]=F.useState(!0),[I,P]=F.useState(!0),T=F.useRef(null),R=F.useRef(null);F.useEffect(()=>{m(),g(),y(),w()},[]),F.useEffect(()=>{var k;(k=T.current)==null||k.scrollIntoView({behavior:"smooth"})},[n,i]);const j=Object.values(a).some(k=>k),O=async k=>{var te;if(k.preventDefault(),!x.trim()||e||t)return;const Z=x.trim();_("");try{N?await u(Z):await c(Z)}catch(K){console.error("Send message error:",K)}(te=R.current)==null||te.focus()};return l.jsxs("div",{className:"h-full flex",children:[l.jsx(p4,{isOpen:I,onClose:()=>P(!1)}),l.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>P(!I),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:I?"":"",children:I?l.jsx(TF,{className:"w-5 h-5"}):l.jsx(NF,{className:"w-5 h-5"})}),l.jsx(pf,{className:"w-6 h-6 text-primary-600"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-semibold",children:"AI "}),l.jsxs("p",{className:"text-sm text-gray-500",children:[": ",s,o&&l.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["#",o]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[l.jsx("input",{type:"checkbox",checked:N,onChange:k=>C(k.target.checked),className:"rounded"}),""]}),l.jsx("button",{onClick:S,className:"p-2 text-gray-400 hover:text-gray-600",title:"",children:l.jsx(vi,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>M(!0),className:"p-2 text-gray-400 hover:text-gray-600",title:"",children:l.jsx(gf,{className:"w-5 h-5"})})]})]}),r&&l.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[l.jsx(Ba,{className:"w-5 h-5"}),l.jsx("span",{children:r})]}),l.jsx("button",{onClick:p,className:"text-red-400 hover:text-red-600",children:""})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:n.length===0?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center max-w-md",children:[l.jsx(A1,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-medium text-gray-600 mb-2",children:"FilmDream AI "}),l.jsx("p",{className:"text-gray-400 mb-6",children:" ComfyUI "}),j?l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-sm text-gray-500 mb-3",children:":"}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:["","","",""].map((k,Z)=>l.jsx("button",{onClick:()=>_(k),className:"px-3 py-1.5 bg-gray-100 text-gray-600 rounded-full text-sm hover:bg-gray-200",children:k},Z))})]}):l.jsx("button",{onClick:()=>M(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:" LLM Provider"})]})}):l.jsxs("div",{className:"py-4",children:[n.map((k,Z)=>l.jsx(u4,{message:k,toolCallHistory:Z===n.length-1?i:[]},k.id)),e&&!t&&l.jsxs("div",{className:"flex items-center gap-3 py-4",children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:l.jsx(A1,{className:"w-5 h-5 text-gray-600"})}),l.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[l.jsx(yi,{className:"w-5 h-5 animate-spin"}),l.jsx("span",{children:"..."})]})]}),l.jsx("div",{ref:T})]})}),l.jsx("div",{className:"border-t p-4",children:l.jsxs("form",{onSubmit:O,className:"flex gap-3",children:[l.jsx("input",{ref:R,type:"text",value:x,onChange:k=>_(k.target.value),placeholder:j?"...":" LLM Provider...",disabled:!j||e||t,className:"flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-400"}),l.jsx("button",{type:"submit",disabled:!x.trim()||!j||e||t,className:"px-6 py-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:e||t?l.jsx(yi,{className:"w-5 h-5 animate-spin"}):l.jsx(LF,{className:"w-5 h-5"})})]})}),b&&l.jsx(h4,{onClose:()=>M(!1)})]})]})}const Os="http://localhost:3001/api",g4=Es((n,e)=>({assets:[],currentAsset:null,isLoading:!1,error:null,filters:{type:null,status:null,characterId:null},stats:null,loadAssets:async(t={})=>{n({isLoading:!0,error:null});try{const r=new URLSearchParams,i={...e().filters,...t};i.type&&r.append("type",i.type),i.status&&r.append("status",i.status),i.characterId&&r.append("characterId",i.characterId);const s=`${Os}/assets3d${r.toString()?"?"+r.toString():""}`,o=await(await fetch(s)).json();if(o.success)n({assets:o.data,isLoading:!1,filters:i});else throw new Error(o.error)}catch(r){n({error:r.message,isLoading:!1})}},loadAsset:async t=>{n({isLoading:!0,error:null});try{const i=await(await fetch(`${Os}/assets3d/${t}`)).json();if(i.success)return n({currentAsset:i.data,isLoading:!1}),i.data;throw new Error(i.error)}catch(r){return n({error:r.message,isLoading:!1}),null}},createAsset:async t=>{n({isLoading:!0,error:null});try{const i=await(await fetch(`${Os}/assets3d`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(i.success)return n(s=>({assets:[i.data,...s.assets],isLoading:!1})),i.data;throw new Error(i.error)}catch(r){return n({error:r.message,isLoading:!1}),null}},uploadAsset:async(t,r={})=>{n({isLoading:!0,error:null});try{const i=new FormData;i.append("model",t),r.name&&i.append("name",r.name),r.description&&i.append("description",r.description),r.type&&i.append("type",r.type),r.characterId&&i.append("characterId",r.characterId),r.tags&&i.append("tags",JSON.stringify(r.tags));const a=await(await fetch(`${Os}/assets3d/upload`,{method:"POST",body:i})).json();if(a.success)return n(o=>({assets:[a.data,...o.assets],isLoading:!1})),a.data;throw new Error(a.error)}catch(i){return n({error:i.message,isLoading:!1}),null}},updateAsset:async(t,r)=>{try{const s=await(await fetch(`${Os}/assets3d/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();if(s.success)return n(a=>{var o;return{assets:a.assets.map(c=>c.id===t?{...c,...s.data}:c),currentAsset:((o=a.currentAsset)==null?void 0:o.id)===t?{...a.currentAsset,...s.data}:a.currentAsset}}),s.data;throw new Error(s.error)}catch(i){return n({error:i.message}),null}},deleteAsset:async t=>{try{const i=await(await fetch(`${Os}/assets3d/${t}`,{method:"DELETE"})).json();if(i.success)return n(s=>{var a;return{assets:s.assets.filter(o=>o.id!==t),currentAsset:((a=s.currentAsset)==null?void 0:a.id)===t?null:s.currentAsset}}),!0;throw new Error(i.error)}catch(r){return n({error:r.message}),!1}},generateFromImage:async(t,r={})=>{n({isLoading:!0,error:null});try{const s=await(await fetch(`${Os}/assets3d/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:t,...r})})).json();if(s.success)return n(a=>({assets:[s.data,...a.assets],isLoading:!1})),s.data;throw new Error(s.error)}catch(i){return n({error:i.message,isLoading:!1}),null}},addVariant:async(t,r)=>{var i;try{const a=await(await fetch(`${Os}/assets3d/${t}/variants`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();if(a.success)return((i=e().currentAsset)==null?void 0:i.id)===t&&n(o=>({currentAsset:{...o.currentAsset,variants:[...o.currentAsset.variants||[],a.data]}})),a.data;throw new Error(a.error)}catch(s){return n({error:s.message}),null}},deleteVariant:async(t,r)=>{var i;try{const a=await(await fetch(`${Os}/assets3d/${t}/variants/${r}`,{method:"DELETE"})).json();if(a.success)return((i=e().currentAsset)==null?void 0:i.id)===t&&n(o=>({currentAsset:{...o.currentAsset,variants:(o.currentAsset.variants||[]).filter(c=>c.id!==r)}})),!0;throw new Error(a.error)}catch(s){return n({error:s.message}),!1}},loadStats:async()=>{try{const r=await(await fetch(`${Os}/assets3d/stats`)).json();if(r.success)return n({stats:r.data}),r.data}catch(t){console.error("Failed to load 3D stats:",t)}return null},setFilters:t=>{n({filters:{...e().filters,...t}})},clearFilters:()=>{n({filters:{type:null,status:null,characterId:null}})},clearCurrentAsset:()=>{n({currentAsset:null})},clearError:()=>{n({error:null})}}));/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const td="182",xl={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},yl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},f3=0,T1=1,p3=2,x4=3,m3=0,xu=1,xh=2,Al=3,Qs=0,Ur=1,Ti=2,As=0,Ll=1,N1=2,R1=3,I1=4,g3=5,oo=100,x3=101,y3=102,v3=103,_3=104,b3=200,w3=201,S3=202,A3=203,Dg=204,Fg=205,M3=206,C3=207,E3=208,T3=209,N3=210,R3=211,I3=212,P3=213,B3=214,kg=0,jg=1,Ug=2,Xl=3,Og=4,zg=5,Hg=6,Gg=7,yf=0,L3=1,D3=2,ns=0,nw=1,rw=2,iw=3,tx=4,sw=5,aw=6,ow=7,P1="attached",F3="detached",No=300,Cs=301,Ro=302,Bu=303,Yh=304,nd=306,Io=1e3,Pn=1001,Lu=1002,Un=1003,nx=1004,y4=1004,Ml=1005,v4=1005,en=1006,yu=1007,_4=1007,es=1008,B1=1008,gr=1009,rx=1010,ix=1011,Du=1012,vf=1013,Fi=1014,En=1015,On=1016,sx=1017,ax=1018,Fu=1020,lw=35902,cw=35899,uw=1021,dw=1022,Yn=1023,$s=1026,ho=1027,_f=1028,bf=1029,Jl=1030,ox=1031,b4=1032,lx=1033,yh=33776,vh=33777,_h=33778,bh=33779,Vg=35840,Wg=35841,Xg=35842,Jg=35843,Yg=36196,Kg=37492,Zg=37496,qg=37488,Qg=37489,$g=37490,e0=37491,t0=37808,n0=37809,r0=37810,i0=37811,s0=37812,a0=37813,o0=37814,l0=37815,c0=37816,u0=37817,d0=37818,h0=37819,f0=37820,p0=37821,m0=36492,g0=36494,x0=36495,y0=36283,v0=36284,_0=36285,b0=36286,k3=2200,j3=2201,U3=2202,ku=2300,ju=2301,$m=2302,Cl=2400,El=2401,Kh=2402,cx=2500,hw=2501,O3=0,fw=1,w0=2,z3=3200,w4=3201,S4=3202,A4=3203,Oo=0,H3=1,ya="",qr="srgb",ea="srgb-linear",Zh="linear",fn="srgb",M4="",C4="rg",E4="ga",T4=0,vl=7680,N4=7681,R4=7682,I4=7683,P4=34055,B4=34056,L4=5386,D4=512,F4=513,k4=514,j4=515,U4=516,O4=517,z4=518,L1=519,G3=512,V3=513,W3=514,ux=515,X3=516,J3=517,dx=518,Y3=519,qh=35044,H4=35048,G4=35040,V4=35045,W4=35049,X4=35041,J4=35046,Y4=35050,K4=35042,Z4="100",D1="300 es",Ri=2e3,Uu=2001,q4={COMPUTE:"compute",RENDER:"render"},Q4={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},$4={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function K3(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const ej={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function lu(n,e){return new ej[n](e)}function Z3(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Qh(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function q3(){const n=Qh("canvas");return n.style.display="block",n}const mC={};let Po=null;function tj(n){Po=n}function nj(){return Po}function $h(...n){const e="THREE."+n.shift();Po?Po("log",e,...n):console.log(e,...n)}function ct(...n){const e="THREE."+n.shift();Po?Po("warn",e,...n):console.warn(e,...n)}function It(...n){const e="THREE."+n.shift();Po?Po("error",e,...n):console.error(e,...n)}function Ou(...n){const e=n.join(" ");e in mC||(mC[e]=!0,ct(...n))}function rj(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}let ta=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const r=t[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}};const Dr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let gC=1234567;const Dl=Math.PI/180,zu=180/Math.PI;function Pi(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Dr[n&255]+Dr[n>>8&255]+Dr[n>>16&255]+Dr[n>>24&255]+"-"+Dr[e&255]+Dr[e>>8&255]+"-"+Dr[e>>16&15|64]+Dr[e>>24&255]+"-"+Dr[t&63|128]+Dr[t>>8&255]+"-"+Dr[t>>16&255]+Dr[t>>24&255]+Dr[r&255]+Dr[r>>8&255]+Dr[r>>16&255]+Dr[r>>24&255]).toLowerCase()}function Ft(n,e,t){return Math.max(e,Math.min(t,n))}function pw(n,e){return(n%e+e)%e}function ij(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function sj(n,e,t){return n!==e?(t-n)/(e-n):0}function wh(n,e,t){return(1-t)*n+t*e}function aj(n,e,t,r){return wh(n,e,1-Math.exp(-t*r))}function oj(n,e=1){return e-Math.abs(pw(n,e*2)-e)}function lj(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function cj(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function uj(n,e){return n+Math.floor(Math.random()*(e-n+1))}function dj(n,e){return n+Math.random()*(e-n)}function hj(n){return n*(.5-Math.random())}function fj(n){n!==void 0&&(gC=n);let e=gC+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function pj(n){return n*Dl}function mj(n){return n*zu}function gj(n){return(n&n-1)===0&&n!==0}function xj(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function yj(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function vj(n,e,t,r,i){const s=Math.cos,a=Math.sin,o=s(t/2),c=a(t/2),u=s((e+r)/2),f=a((e+r)/2),p=s((e-r)/2),m=a((e-r)/2),g=s((r-e)/2),y=a((r-e)/2);switch(i){case"XYX":n.set(o*f,c*p,c*m,o*u);break;case"YZY":n.set(c*m,o*f,c*p,o*u);break;case"ZXZ":n.set(c*p,c*m,o*f,o*u);break;case"XZX":n.set(o*f,c*y,c*g,o*u);break;case"YXY":n.set(c*g,o*f,c*y,o*u);break;case"ZYZ":n.set(c*y,c*g,o*f,o*u);break;default:ct("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Qr(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Wt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const mw={DEG2RAD:Dl,RAD2DEG:zu,generateUUID:Pi,clamp:Ft,euclideanModulo:pw,mapLinear:ij,inverseLerp:sj,lerp:wh,damp:aj,pingpong:oj,smoothstep:lj,smootherstep:cj,randInt:uj,randFloat:dj,randFloatSpread:hj,seededRandom:fj,degToRad:pj,radToDeg:mj,isPowerOfTwo:gj,ceilPowerOfTwo:xj,floorPowerOfTwo:yj,setQuaternionFromProperEuler:vj,normalize:Wt,denormalize:Qr};class Te{constructor(e=0,t=0){Te.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Ft(this.x,e.x,t.x),this.y=Ft(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Ft(this.x,e,t),this.y=Ft(this.y,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ft(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ft(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class vr{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,o){let c=r[i+0],u=r[i+1],f=r[i+2],p=r[i+3],m=s[a+0],g=s[a+1],y=s[a+2],S=s[a+3];if(o<=0){e[t+0]=c,e[t+1]=u,e[t+2]=f,e[t+3]=p;return}if(o>=1){e[t+0]=m,e[t+1]=g,e[t+2]=y,e[t+3]=S;return}if(p!==S||c!==m||u!==g||f!==y){let w=c*m+u*g+f*y+p*S;w<0&&(m=-m,g=-g,y=-y,S=-S,w=-w);let x=1-o;if(w<.9995){const _=Math.acos(w),b=Math.sin(_);x=Math.sin(x*_)/b,o=Math.sin(o*_)/b,c=c*x+m*o,u=u*x+g*o,f=f*x+y*o,p=p*x+S*o}else{c=c*x+m*o,u=u*x+g*o,f=f*x+y*o,p=p*x+S*o;const _=1/Math.sqrt(c*c+u*u+f*f+p*p);c*=_,u*=_,f*=_,p*=_}}e[t]=c,e[t+1]=u,e[t+2]=f,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,i,s,a){const o=r[i],c=r[i+1],u=r[i+2],f=r[i+3],p=s[a],m=s[a+1],g=s[a+2],y=s[a+3];return e[t]=o*y+f*p+c*g-u*m,e[t+1]=c*y+f*m+u*p-o*g,e[t+2]=u*y+f*g+o*m-c*p,e[t+3]=f*y-o*p-c*m-u*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,c=Math.sin,u=o(r/2),f=o(i/2),p=o(s/2),m=c(r/2),g=c(i/2),y=c(s/2);switch(a){case"XYZ":this._x=m*f*p+u*g*y,this._y=u*g*p-m*f*y,this._z=u*f*y+m*g*p,this._w=u*f*p-m*g*y;break;case"YXZ":this._x=m*f*p+u*g*y,this._y=u*g*p-m*f*y,this._z=u*f*y-m*g*p,this._w=u*f*p+m*g*y;break;case"ZXY":this._x=m*f*p-u*g*y,this._y=u*g*p+m*f*y,this._z=u*f*y+m*g*p,this._w=u*f*p-m*g*y;break;case"ZYX":this._x=m*f*p-u*g*y,this._y=u*g*p+m*f*y,this._z=u*f*y-m*g*p,this._w=u*f*p+m*g*y;break;case"YZX":this._x=m*f*p+u*g*y,this._y=u*g*p+m*f*y,this._z=u*f*y-m*g*p,this._w=u*f*p-m*g*y;break;case"XZY":this._x=m*f*p-u*g*y,this._y=u*g*p-m*f*y,this._z=u*f*y+m*g*p,this._w=u*f*p+m*g*y;break;default:ct("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],o=t[5],c=t[9],u=t[2],f=t[6],p=t[10],m=r+o+p;if(m>0){const g=.5/Math.sqrt(m+1);this._w=.25/g,this._x=(f-c)*g,this._y=(s-u)*g,this._z=(a-i)*g}else if(r>o&&r>p){const g=2*Math.sqrt(1+r-o-p);this._w=(f-c)/g,this._x=.25*g,this._y=(i+a)/g,this._z=(s+u)/g}else if(o>p){const g=2*Math.sqrt(1+o-r-p);this._w=(s-u)/g,this._x=(i+a)/g,this._y=.25*g,this._z=(c+f)/g}else{const g=2*Math.sqrt(1+p-r-o);this._w=(a-i)/g,this._x=(s+u)/g,this._y=(c+f)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<1e-8?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ft(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,o=t._x,c=t._y,u=t._z,f=t._w;return this._x=r*f+a*o+i*u-s*c,this._y=i*f+a*c+s*o-r*u,this._z=s*f+a*u+r*c-i*o,this._w=a*f-r*o-i*c-s*u,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let r=e._x,i=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(r=-r,i=-i,s=-s,a=-a,o=-o);let c=1-t;if(o<.9995){const u=Math.acos(o),f=Math.sin(u);c=Math.sin(c*u)/f,t=Math.sin(t*u)/f,this._x=this._x*c+r*t,this._y=this._y*c+i*t,this._z=this._z*c+s*t,this._w=this._w*c+a*t,this._onChangeCallback()}else this._x=this._x*c+r*t,this._y=this._y*c+i*t,this._z=this._z*c+s*t,this._w=this._w*c+a*t,this.normalize();return this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class X{constructor(e=0,t=0,r=0){X.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(xC.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(xC.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,c=e.w,u=2*(a*i-o*r),f=2*(o*t-s*i),p=2*(s*r-a*t);return this.x=t+c*u+a*p-o*f,this.y=r+c*f+o*u-s*p,this.z=i+c*p+s*f-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Ft(this.x,e.x,t.x),this.y=Ft(this.y,e.y,t.y),this.z=Ft(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Ft(this.x,e,t),this.y=Ft(this.y,e,t),this.z=Ft(this.z,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ft(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,o=t.y,c=t.z;return this.x=i*c-s*o,this.y=s*a-r*c,this.z=r*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return bv.copy(this).projectOnVector(e),this.sub(bv)}reflect(e){return this.sub(bv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ft(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const bv=new X,xC=new vr;class Vt{constructor(e,t,r,i,s,a,o,c,u){Vt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,c,u)}set(e,t,r,i,s,a,o,c,u){const f=this.elements;return f[0]=e,f[1]=i,f[2]=o,f[3]=t,f[4]=s,f[5]=c,f[6]=r,f[7]=a,f[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[3],c=r[6],u=r[1],f=r[4],p=r[7],m=r[2],g=r[5],y=r[8],S=i[0],w=i[3],x=i[6],_=i[1],b=i[4],M=i[7],N=i[2],C=i[5],I=i[8];return s[0]=a*S+o*_+c*N,s[3]=a*w+o*b+c*C,s[6]=a*x+o*M+c*I,s[1]=u*S+f*_+p*N,s[4]=u*w+f*b+p*C,s[7]=u*x+f*M+p*I,s[2]=m*S+g*_+y*N,s[5]=m*w+g*b+y*C,s[8]=m*x+g*M+y*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],c=e[6],u=e[7],f=e[8];return t*a*f-t*o*u-r*s*f+r*o*c+i*s*u-i*a*c}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],c=e[6],u=e[7],f=e[8],p=f*a-o*u,m=o*c-f*s,g=u*s-a*c,y=t*p+r*m+i*g;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const S=1/y;return e[0]=p*S,e[1]=(i*u-f*r)*S,e[2]=(o*r-i*a)*S,e[3]=m*S,e[4]=(f*t-i*c)*S,e[5]=(i*s-o*t)*S,e[6]=g*S,e[7]=(r*c-u*t)*S,e[8]=(a*t-r*s)*S,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,o){const c=Math.cos(s),u=Math.sin(s);return this.set(r*c,r*u,-r*(c*a+u*o)+a+e,-i*u,i*c,-i*(-u*a+c*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(wv.makeScale(e,t)),this}rotate(e){return this.premultiply(wv.makeRotation(-e)),this}translate(e,t){return this.premultiply(wv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const wv=new Vt,yC=new Vt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),vC=new Vt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function _j(){const n={enabled:!0,workingColorSpace:ea,spaces:{},convert:function(i,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===fn&&(i.r=Aa(i.r),i.g=Aa(i.g),i.b=Aa(i.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===fn&&(i.r=vu(i.r),i.g=vu(i.g),i.b=vu(i.b))),i},workingToColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},colorSpaceToWorking:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===ya?Zh:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,a){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,s){return Ou("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(i,s)},toWorkingColorSpace:function(i,s){return Ou("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(i,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],r=[.3127,.329];return n.define({[ea]:{primaries:e,whitePoint:r,transfer:Zh,toXYZ:yC,fromXYZ:vC,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:qr},outputColorSpaceConfig:{drawingBufferColorSpace:qr}},[qr]:{primaries:e,whitePoint:r,transfer:fn,toXYZ:yC,fromXYZ:vC,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:qr}}}),n}const nn=_j();function Aa(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function vu(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Sc;class Q3{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{Sc===void 0&&(Sc=Qh("canvas")),Sc.width=e.width,Sc.height=e.height;const i=Sc.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=Sc}return r.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Qh("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Aa(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Aa(t[r]/255)*255):t[r]=Aa(t[r]);return{data:t,width:e.width,height:e.height}}else return ct("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let bj=0;class fo{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:bj++}),this.uuid=Pi(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(Sv(i[a].image)):s.push(Sv(i[a]))}else s=Sv(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function Sv(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Q3.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(ct("Texture: Unable to serialize Texture."),{})}let wj=0;const Av=new X;class pn extends ta{constructor(e=pn.DEFAULT_IMAGE,t=pn.DEFAULT_MAPPING,r=Pn,i=Pn,s=en,a=es,o=Yn,c=gr,u=pn.DEFAULT_ANISOTROPY,f=ya){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wj++}),this.uuid=Pi(),this.name="",this.source=new fo(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=o,this.internalFormat=null,this.type=c,this.offset=new Te(0,0),this.repeat=new Te(1,1),this.center=new Te(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Av).x}get height(){return this.source.getSize(Av).y}get depth(){return this.source.getSize(Av).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const r=e[t];if(r===void 0){ct(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){ct(`Texture.setValues(): property '${t}' does not exist.`);continue}i&&r&&i.isVector2&&r.isVector2||i&&r&&i.isVector3&&r.isVector3||i&&r&&i.isMatrix3&&r.isMatrix3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==No)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Io:e.x=e.x-Math.floor(e.x);break;case Pn:e.x=e.x<0?0:1;break;case Lu:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Io:e.y=e.y-Math.floor(e.y);break;case Pn:e.y=e.y<0?0:1;break;case Lu:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}pn.DEFAULT_IMAGE=null;pn.DEFAULT_MAPPING=No;pn.DEFAULT_ANISOTROPY=1;class yn{constructor(e=0,t=0,r=0,i=1){yn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const c=e.elements,u=c[0],f=c[4],p=c[8],m=c[1],g=c[5],y=c[9],S=c[2],w=c[6],x=c[10];if(Math.abs(f-m)<.01&&Math.abs(p-S)<.01&&Math.abs(y-w)<.01){if(Math.abs(f+m)<.1&&Math.abs(p+S)<.1&&Math.abs(y+w)<.1&&Math.abs(u+g+x-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(u+1)/2,M=(g+1)/2,N=(x+1)/2,C=(f+m)/4,I=(p+S)/4,P=(y+w)/4;return b>M&&b>N?b<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(b),i=C/r,s=I/r):M>N?M<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(M),r=C/i,s=P/i):N<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(N),r=I/s,i=P/s),this.set(r,i,s,t),this}let _=Math.sqrt((w-y)*(w-y)+(p-S)*(p-S)+(m-f)*(m-f));return Math.abs(_)<.001&&(_=1),this.x=(w-y)/_,this.y=(p-S)/_,this.z=(m-f)/_,this.w=Math.acos((u+g+x-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Ft(this.x,e.x,t.x),this.y=Ft(this.y,e.y,t.y),this.z=Ft(this.z,e.z,t.z),this.w=Ft(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Ft(this.x,e,t),this.y=Ft(this.y,e,t),this.z=Ft(this.z,e,t),this.w=Ft(this.w,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ft(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class gw extends ta{constructor(e=1,t=1,r={}){super(),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:en,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},r),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=r.depth,this.scissor=new yn(0,0,e,t),this.scissorTest=!1,this.viewport=new yn(0,0,e,t);const i={width:e,height:t,depth:r.depth},s=new pn(i);this.textures=[];const a=r.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(r),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}_setTextureOptions(e={}){const t={minFilter:en,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let r=0;r<this.textures.length;r++)this.textures[r].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r,this.textures[i].isData3DTexture!==!0&&(this.textures[i].isArrayTexture=this.textures[i].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new fo(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ei extends gw{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class hx extends pn{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Un,this.minFilter=Un,this.wrapR=Pn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Sj extends ei{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new hx(null,e,t,r),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class fx extends pn{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Un,this.minFilter=Un,this.wrapR=Pn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Aj extends ei{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new fx(null,e,t,r),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class ir{constructor(e=new X(1/0,1/0,1/0),t=new X(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(fs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(fs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=fs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,fs):fs.fromBufferAttribute(s,a),fs.applyMatrix4(e.matrixWorld),this.expandByPoint(fs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Vp.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Vp.copy(r.boundingBox)),Vp.applyMatrix4(e.matrixWorld),this.union(Vp)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,fs),fs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ld),Wp.subVectors(this.max,Ld),Ac.subVectors(e.a,Ld),Mc.subVectors(e.b,Ld),Cc.subVectors(e.c,Ld),Xa.subVectors(Mc,Ac),Ja.subVectors(Cc,Mc),el.subVectors(Ac,Cc);let t=[0,-Xa.z,Xa.y,0,-Ja.z,Ja.y,0,-el.z,el.y,Xa.z,0,-Xa.x,Ja.z,0,-Ja.x,el.z,0,-el.x,-Xa.y,Xa.x,0,-Ja.y,Ja.x,0,-el.y,el.x,0];return!Mv(t,Ac,Mc,Cc,Wp)||(t=[1,0,0,0,1,0,0,0,1],!Mv(t,Ac,Mc,Cc,Wp))?!1:(Xp.crossVectors(Xa,Ja),t=[Xp.x,Xp.y,Xp.z],Mv(t,Ac,Mc,Cc,Wp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(fs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(la[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),la[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),la[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),la[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),la[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),la[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),la[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),la[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(la),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const la=[new X,new X,new X,new X,new X,new X,new X,new X],fs=new X,Vp=new ir,Ac=new X,Mc=new X,Cc=new X,Xa=new X,Ja=new X,el=new X,Ld=new X,Wp=new X,Xp=new X,tl=new X;function Mv(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){tl.fromArray(n,s);const o=i.x*Math.abs(tl.x)+i.y*Math.abs(tl.y)+i.z*Math.abs(tl.z),c=e.dot(tl),u=t.dot(tl),f=r.dot(tl);if(Math.max(-Math.max(c,u,f),Math.min(c,u,f))>o)return!1}return!0}const Mj=new ir,Dd=new X,Cv=new X;class sr{constructor(e=new X,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):Mj.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Dd.subVectors(e,this.center);const t=Dd.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Dd,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Cv.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Dd.copy(e.center).add(Cv)),this.expandByPoint(Dd.copy(e.center).sub(Cv))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const ca=new X,Ev=new X,Jp=new X,Ya=new X,Tv=new X,Yp=new X,Nv=new X;class rc{constructor(e=new X,t=new X(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ca)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ca.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ca.copy(this.origin).addScaledVector(this.direction,t),ca.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){Ev.copy(e).add(t).multiplyScalar(.5),Jp.copy(t).sub(e).normalize(),Ya.copy(this.origin).sub(Ev);const s=e.distanceTo(t)*.5,a=-this.direction.dot(Jp),o=Ya.dot(this.direction),c=-Ya.dot(Jp),u=Ya.lengthSq(),f=Math.abs(1-a*a);let p,m,g,y;if(f>0)if(p=a*c-o,m=a*o-c,y=s*f,p>=0)if(m>=-y)if(m<=y){const S=1/f;p*=S,m*=S,g=p*(p+a*m+2*o)+m*(a*p+m+2*c)+u}else m=s,p=Math.max(0,-(a*m+o)),g=-p*p+m*(m+2*c)+u;else m=-s,p=Math.max(0,-(a*m+o)),g=-p*p+m*(m+2*c)+u;else m<=-y?(p=Math.max(0,-(-a*s+o)),m=p>0?-s:Math.min(Math.max(-s,-c),s),g=-p*p+m*(m+2*c)+u):m<=y?(p=0,m=Math.min(Math.max(-s,-c),s),g=m*(m+2*c)+u):(p=Math.max(0,-(a*s+o)),m=p>0?s:Math.min(Math.max(-s,-c),s),g=-p*p+m*(m+2*c)+u);else m=a>0?-s:s,p=Math.max(0,-(a*m+o)),g=-p*p+m*(m+2*c)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,p),i&&i.copy(Ev).addScaledVector(Jp,m),g}intersectSphere(e,t){ca.subVectors(e.center,this.origin);const r=ca.dot(this.direction),i=ca.dot(ca)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,c=r+a;return c<0?null:o<0?this.at(c,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,o,c;const u=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,m=this.origin;return u>=0?(r=(e.min.x-m.x)*u,i=(e.max.x-m.x)*u):(r=(e.max.x-m.x)*u,i=(e.min.x-m.x)*u),f>=0?(s=(e.min.y-m.y)*f,a=(e.max.y-m.y)*f):(s=(e.max.y-m.y)*f,a=(e.min.y-m.y)*f),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),p>=0?(o=(e.min.z-m.z)*p,c=(e.max.z-m.z)*p):(o=(e.max.z-m.z)*p,c=(e.min.z-m.z)*p),r>c||o>i)||((o>r||r!==r)&&(r=o),(c<i||i!==i)&&(i=c),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,ca)!==null}intersectTriangle(e,t,r,i,s){Tv.subVectors(t,e),Yp.subVectors(r,e),Nv.crossVectors(Tv,Yp);let a=this.direction.dot(Nv),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Ya.subVectors(this.origin,e);const c=o*this.direction.dot(Yp.crossVectors(Ya,Yp));if(c<0)return null;const u=o*this.direction.dot(Tv.cross(Ya));if(u<0||c+u>a)return null;const f=-o*Ya.dot(Nv);return f<0?null:this.at(f/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Dt{constructor(e,t,r,i,s,a,o,c,u,f,p,m,g,y,S,w){Dt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,c,u,f,p,m,g,y,S,w)}set(e,t,r,i,s,a,o,c,u,f,p,m,g,y,S,w){const x=this.elements;return x[0]=e,x[4]=t,x[8]=r,x[12]=i,x[1]=s,x[5]=a,x[9]=o,x[13]=c,x[2]=u,x[6]=f,x[10]=p,x[14]=m,x[3]=g,x[7]=y,x[11]=S,x[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Dt().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),r.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this)}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,r=e.elements,i=1/Ec.setFromMatrixColumn(e,0).length(),s=1/Ec.setFromMatrixColumn(e,1).length(),a=1/Ec.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),c=Math.cos(i),u=Math.sin(i),f=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const m=a*f,g=a*p,y=o*f,S=o*p;t[0]=c*f,t[4]=-c*p,t[8]=u,t[1]=g+y*u,t[5]=m-S*u,t[9]=-o*c,t[2]=S-m*u,t[6]=y+g*u,t[10]=a*c}else if(e.order==="YXZ"){const m=c*f,g=c*p,y=u*f,S=u*p;t[0]=m+S*o,t[4]=y*o-g,t[8]=a*u,t[1]=a*p,t[5]=a*f,t[9]=-o,t[2]=g*o-y,t[6]=S+m*o,t[10]=a*c}else if(e.order==="ZXY"){const m=c*f,g=c*p,y=u*f,S=u*p;t[0]=m-S*o,t[4]=-a*p,t[8]=y+g*o,t[1]=g+y*o,t[5]=a*f,t[9]=S-m*o,t[2]=-a*u,t[6]=o,t[10]=a*c}else if(e.order==="ZYX"){const m=a*f,g=a*p,y=o*f,S=o*p;t[0]=c*f,t[4]=y*u-g,t[8]=m*u+S,t[1]=c*p,t[5]=S*u+m,t[9]=g*u-y,t[2]=-u,t[6]=o*c,t[10]=a*c}else if(e.order==="YZX"){const m=a*c,g=a*u,y=o*c,S=o*u;t[0]=c*f,t[4]=S-m*p,t[8]=y*p+g,t[1]=p,t[5]=a*f,t[9]=-o*f,t[2]=-u*f,t[6]=g*p+y,t[10]=m-S*p}else if(e.order==="XZY"){const m=a*c,g=a*u,y=o*c,S=o*u;t[0]=c*f,t[4]=-p,t[8]=u*f,t[1]=m*p+S,t[5]=a*f,t[9]=g*p-y,t[2]=y*p-g,t[6]=o*f,t[10]=S*p+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Cj,e,Ej)}lookAt(e,t,r){const i=this.elements;return Mi.subVectors(e,t),Mi.lengthSq()===0&&(Mi.z=1),Mi.normalize(),Ka.crossVectors(r,Mi),Ka.lengthSq()===0&&(Math.abs(r.z)===1?Mi.x+=1e-4:Mi.z+=1e-4,Mi.normalize(),Ka.crossVectors(r,Mi)),Ka.normalize(),Kp.crossVectors(Mi,Ka),i[0]=Ka.x,i[4]=Kp.x,i[8]=Mi.x,i[1]=Ka.y,i[5]=Kp.y,i[9]=Mi.y,i[2]=Ka.z,i[6]=Kp.z,i[10]=Mi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[4],c=r[8],u=r[12],f=r[1],p=r[5],m=r[9],g=r[13],y=r[2],S=r[6],w=r[10],x=r[14],_=r[3],b=r[7],M=r[11],N=r[15],C=i[0],I=i[4],P=i[8],T=i[12],R=i[1],j=i[5],O=i[9],k=i[13],Z=i[2],te=i[6],K=i[10],$=i[14],U=i[3],H=i[7],W=i[11],Y=i[15];return s[0]=a*C+o*R+c*Z+u*U,s[4]=a*I+o*j+c*te+u*H,s[8]=a*P+o*O+c*K+u*W,s[12]=a*T+o*k+c*$+u*Y,s[1]=f*C+p*R+m*Z+g*U,s[5]=f*I+p*j+m*te+g*H,s[9]=f*P+p*O+m*K+g*W,s[13]=f*T+p*k+m*$+g*Y,s[2]=y*C+S*R+w*Z+x*U,s[6]=y*I+S*j+w*te+x*H,s[10]=y*P+S*O+w*K+x*W,s[14]=y*T+S*k+w*$+x*Y,s[3]=_*C+b*R+M*Z+N*U,s[7]=_*I+b*j+M*te+N*H,s[11]=_*P+b*O+M*K+N*W,s[15]=_*T+b*k+M*$+N*Y,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],c=e[9],u=e[13],f=e[2],p=e[6],m=e[10],g=e[14],y=e[3],S=e[7],w=e[11],x=e[15],_=c*g-u*m,b=o*g-u*p,M=o*m-c*p,N=a*g-u*f,C=a*m-c*f,I=a*p-o*f;return t*(S*_-w*b+x*M)-r*(y*_-w*N+x*C)+i*(y*b-S*N+x*I)-s*(y*M-S*C+w*I)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],c=e[6],u=e[7],f=e[8],p=e[9],m=e[10],g=e[11],y=e[12],S=e[13],w=e[14],x=e[15],_=p*w*u-S*m*u+S*c*g-o*w*g-p*c*x+o*m*x,b=y*m*u-f*w*u-y*c*g+a*w*g+f*c*x-a*m*x,M=f*S*u-y*p*u+y*o*g-a*S*g-f*o*x+a*p*x,N=y*p*c-f*S*c-y*o*m+a*S*m+f*o*w-a*p*w,C=t*_+r*b+i*M+s*N;if(C===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/C;return e[0]=_*I,e[1]=(S*m*s-p*w*s-S*i*g+r*w*g+p*i*x-r*m*x)*I,e[2]=(o*w*s-S*c*s+S*i*u-r*w*u-o*i*x+r*c*x)*I,e[3]=(p*c*s-o*m*s-p*i*u+r*m*u+o*i*g-r*c*g)*I,e[4]=b*I,e[5]=(f*w*s-y*m*s+y*i*g-t*w*g-f*i*x+t*m*x)*I,e[6]=(y*c*s-a*w*s-y*i*u+t*w*u+a*i*x-t*c*x)*I,e[7]=(a*m*s-f*c*s+f*i*u-t*m*u-a*i*g+t*c*g)*I,e[8]=M*I,e[9]=(y*p*s-f*S*s-y*r*g+t*S*g+f*r*x-t*p*x)*I,e[10]=(a*S*s-y*o*s+y*r*u-t*S*u-a*r*x+t*o*x)*I,e[11]=(f*o*s-a*p*s-f*r*u+t*p*u+a*r*g-t*o*g)*I,e[12]=N*I,e[13]=(f*S*i-y*p*i+y*r*m-t*S*m-f*r*w+t*p*w)*I,e[14]=(y*o*i-a*S*i-y*r*c+t*S*c+a*r*w-t*o*w)*I,e[15]=(a*p*i-f*o*i+f*r*c-t*p*c-a*r*m+t*o*m)*I,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,o=e.y,c=e.z,u=s*a,f=s*o;return this.set(u*a+r,u*o-i*c,u*c+i*o,0,u*o+i*c,f*o+r,f*c-i*a,0,u*c-i*o,f*c+i*a,s*c*c+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,o=t._z,c=t._w,u=s+s,f=a+a,p=o+o,m=s*u,g=s*f,y=s*p,S=a*f,w=a*p,x=o*p,_=c*u,b=c*f,M=c*p,N=r.x,C=r.y,I=r.z;return i[0]=(1-(S+x))*N,i[1]=(g+M)*N,i[2]=(y-b)*N,i[3]=0,i[4]=(g-M)*C,i[5]=(1-(m+x))*C,i[6]=(w+_)*C,i[7]=0,i[8]=(y+b)*I,i[9]=(w-_)*I,i[10]=(1-(m+S))*I,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;if(e.x=i[12],e.y=i[13],e.z=i[14],this.determinant()===0)return r.set(1,1,1),t.identity(),this;let s=Ec.set(i[0],i[1],i[2]).length();const a=Ec.set(i[4],i[5],i[6]).length(),o=Ec.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),ps.copy(this);const u=1/s,f=1/a,p=1/o;return ps.elements[0]*=u,ps.elements[1]*=u,ps.elements[2]*=u,ps.elements[4]*=f,ps.elements[5]*=f,ps.elements[6]*=f,ps.elements[8]*=p,ps.elements[9]*=p,ps.elements[10]*=p,t.setFromRotationMatrix(ps),r.x=s,r.y=a,r.z=o,this}makePerspective(e,t,r,i,s,a,o=Ri,c=!1){const u=this.elements,f=2*s/(t-e),p=2*s/(r-i),m=(t+e)/(t-e),g=(r+i)/(r-i);let y,S;if(c)y=s/(a-s),S=a*s/(a-s);else if(o===Ri)y=-(a+s)/(a-s),S=-2*a*s/(a-s);else if(o===Uu)y=-a/(a-s),S=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return u[0]=f,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=p,u[9]=g,u[13]=0,u[2]=0,u[6]=0,u[10]=y,u[14]=S,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,r,i,s,a,o=Ri,c=!1){const u=this.elements,f=2/(t-e),p=2/(r-i),m=-(t+e)/(t-e),g=-(r+i)/(r-i);let y,S;if(c)y=1/(a-s),S=a/(a-s);else if(o===Ri)y=-2/(a-s),S=-(a+s)/(a-s);else if(o===Uu)y=-1/(a-s),S=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return u[0]=f,u[4]=0,u[8]=0,u[12]=m,u[1]=0,u[5]=p,u[9]=0,u[13]=g,u[2]=0,u[6]=0,u[10]=y,u[14]=S,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Ec=new X,ps=new Dt,Cj=new X(0,0,0),Ej=new X(1,1,1),Ka=new X,Kp=new X,Mi=new X,_C=new Dt,bC=new vr;class ki{constructor(e=0,t=0,r=0,i=ki.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],c=i[1],u=i[5],f=i[9],p=i[2],m=i[6],g=i[10];switch(t){case"XYZ":this._y=Math.asin(Ft(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-f,g),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(m,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Ft(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(o,g),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ft(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Ft(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Ft(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(o,g));break;case"XZY":this._z=Math.asin(-Ft(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,u),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-f,g),this._y=0);break;default:ct("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return _C.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_C,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return bC.setFromEuler(this),this.setFromQuaternion(bC,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ki.DEFAULT_ORDER="XYZ";class Fl{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Tj=0;const wC=new X,Tc=new vr,ua=new Dt,Zp=new X,Fd=new X,Nj=new X,Rj=new vr,SC=new X(1,0,0),AC=new X(0,1,0),MC=new X(0,0,1),CC={type:"added"},Ij={type:"removed"},Nc={type:"childadded",child:null},Rv={type:"childremoved",child:null};class sn extends ta{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Tj++}),this.uuid=Pi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=sn.DEFAULT_UP.clone();const e=new X,t=new ki,r=new vr,i=new X(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Dt},normalMatrix:{value:new Vt}}),this.matrix=new Dt,this.matrixWorld=new Dt,this.matrixAutoUpdate=sn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=sn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Fl,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Tc.setFromAxisAngle(e,t),this.quaternion.multiply(Tc),this}rotateOnWorldAxis(e,t){return Tc.setFromAxisAngle(e,t),this.quaternion.premultiply(Tc),this}rotateX(e){return this.rotateOnAxis(SC,e)}rotateY(e){return this.rotateOnAxis(AC,e)}rotateZ(e){return this.rotateOnAxis(MC,e)}translateOnAxis(e,t){return wC.copy(e).applyQuaternion(this.quaternion),this.position.add(wC.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(SC,e)}translateY(e){return this.translateOnAxis(AC,e)}translateZ(e){return this.translateOnAxis(MC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ua.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Zp.copy(e):Zp.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Fd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ua.lookAt(Fd,Zp,this.up):ua.lookAt(Zp,Fd,this.up),this.quaternion.setFromRotationMatrix(ua),i&&(ua.extractRotation(i.matrixWorld),Tc.setFromRotationMatrix(ua),this.quaternion.premultiply(Tc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(It("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(CC),Nc.child=e,this.dispatchEvent(Nc),Nc.child=null):It("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ij),Rv.child=e,this.dispatchEvent(Rv),Rv.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ua.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ua.multiply(e.parent.matrixWorld)),e.applyMatrix4(ua),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(CC),Nc.child=e,this.dispatchEvent(Nc),Nc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fd,e,Nj),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fd,Rj,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function s(o,c){return o[c.uuid]===void 0&&(o[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const c=o.shapes;if(Array.isArray(c))for(let u=0,f=c.length;u<f;u++){const p=c[u];s(e.shapes,p)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let c=0,u=this.material.length;c<u;c++)o.push(s(e.materials,this.material[c]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const c=this.animations[o];i.animations.push(s(e.animations,c))}}if(t){const o=a(e.geometries),c=a(e.materials),u=a(e.textures),f=a(e.images),p=a(e.shapes),m=a(e.skeletons),g=a(e.animations),y=a(e.nodes);o.length>0&&(r.geometries=o),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),f.length>0&&(r.images=f),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),g.length>0&&(r.animations=g),y.length>0&&(r.nodes=y)}return r.object=i,r;function a(o){const c=[];for(const u in o){const f=o[u];delete f.metadata,c.push(f)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}sn.DEFAULT_UP=new X(0,1,0);sn.DEFAULT_MATRIX_AUTO_UPDATE=!0;sn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ms=new X,da=new X,Iv=new X,ha=new X,Rc=new X,Ic=new X,EC=new X,Pv=new X,Bv=new X,Lv=new X,Dv=new yn,Fv=new yn,kv=new yn;class hi{constructor(e=new X,t=new X,r=new X){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),ms.subVectors(e,t),i.cross(ms);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){ms.subVectors(i,t),da.subVectors(r,t),Iv.subVectors(e,t);const a=ms.dot(ms),o=ms.dot(da),c=ms.dot(Iv),u=da.dot(da),f=da.dot(Iv),p=a*u-o*o;if(p===0)return s.set(0,0,0),null;const m=1/p,g=(u*c-o*f)*m,y=(a*f-o*c)*m;return s.set(1-g-y,y,g)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,ha)===null?!1:ha.x>=0&&ha.y>=0&&ha.x+ha.y<=1}static getInterpolation(e,t,r,i,s,a,o,c){return this.getBarycoord(e,t,r,i,ha)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,ha.x),c.addScaledVector(a,ha.y),c.addScaledVector(o,ha.z),c)}static getInterpolatedAttribute(e,t,r,i,s,a){return Dv.setScalar(0),Fv.setScalar(0),kv.setScalar(0),Dv.fromBufferAttribute(e,t),Fv.fromBufferAttribute(e,r),kv.fromBufferAttribute(e,i),a.setScalar(0),a.addScaledVector(Dv,s.x),a.addScaledVector(Fv,s.y),a.addScaledVector(kv,s.z),a}static isFrontFacing(e,t,r,i){return ms.subVectors(r,t),da.subVectors(e,t),ms.cross(da).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ms.subVectors(this.c,this.b),da.subVectors(this.a,this.b),ms.cross(da).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return hi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return hi.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return hi.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return hi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return hi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,o;Rc.subVectors(i,r),Ic.subVectors(s,r),Pv.subVectors(e,r);const c=Rc.dot(Pv),u=Ic.dot(Pv);if(c<=0&&u<=0)return t.copy(r);Bv.subVectors(e,i);const f=Rc.dot(Bv),p=Ic.dot(Bv);if(f>=0&&p<=f)return t.copy(i);const m=c*p-f*u;if(m<=0&&c>=0&&f<=0)return a=c/(c-f),t.copy(r).addScaledVector(Rc,a);Lv.subVectors(e,s);const g=Rc.dot(Lv),y=Ic.dot(Lv);if(y>=0&&g<=y)return t.copy(s);const S=g*u-c*y;if(S<=0&&u>=0&&y<=0)return o=u/(u-y),t.copy(r).addScaledVector(Ic,o);const w=f*y-g*p;if(w<=0&&p-f>=0&&g-y>=0)return EC.subVectors(s,i),o=(p-f)/(p-f+(g-y)),t.copy(i).addScaledVector(EC,o);const x=1/(w+S+m);return a=S*x,o=m*x,t.copy(r).addScaledVector(Rc,a).addScaledVector(Ic,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const $3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Za={h:0,s:0,l:0},qp={h:0,s:0,l:0};function jv(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class ut{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=qr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,nn.colorSpaceToWorking(this,t),this}setRGB(e,t,r,i=nn.workingColorSpace){return this.r=e,this.g=t,this.b=r,nn.colorSpaceToWorking(this,i),this}setHSL(e,t,r,i=nn.workingColorSpace){if(e=pw(e,1),t=Ft(t,0,1),r=Ft(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=jv(a,s,e+1/3),this.g=jv(a,s,e),this.b=jv(a,s,e-1/3)}return nn.colorSpaceToWorking(this,i),this}setStyle(e,t=qr){function r(s){s!==void 0&&parseFloat(s)<1&&ct("Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:ct("Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);ct("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=qr){const r=$3[e.toLowerCase()];return r!==void 0?this.setHex(r,t):ct("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Aa(e.r),this.g=Aa(e.g),this.b=Aa(e.b),this}copyLinearToSRGB(e){return this.r=vu(e.r),this.g=vu(e.g),this.b=vu(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=qr){return nn.workingToColorSpace(Fr.copy(this),e),Math.round(Ft(Fr.r*255,0,255))*65536+Math.round(Ft(Fr.g*255,0,255))*256+Math.round(Ft(Fr.b*255,0,255))}getHexString(e=qr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=nn.workingColorSpace){nn.workingToColorSpace(Fr.copy(this),t);const r=Fr.r,i=Fr.g,s=Fr.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let c,u;const f=(o+a)/2;if(o===a)c=0,u=0;else{const p=a-o;switch(u=f<=.5?p/(a+o):p/(2-a-o),a){case r:c=(i-s)/p+(i<s?6:0);break;case i:c=(s-r)/p+2;break;case s:c=(r-i)/p+4;break}c/=6}return e.h=c,e.s=u,e.l=f,e}getRGB(e,t=nn.workingColorSpace){return nn.workingToColorSpace(Fr.copy(this),t),e.r=Fr.r,e.g=Fr.g,e.b=Fr.b,e}getStyle(e=qr){nn.workingToColorSpace(Fr.copy(this),e);const t=Fr.r,r=Fr.g,i=Fr.b;return e!==qr?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Za),this.setHSL(Za.h+e,Za.s+t,Za.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Za),e.getHSL(qp);const r=wh(Za.h,qp.h,t),i=wh(Za.s,qp.s,t),s=wh(Za.l,qp.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Fr=new ut;ut.NAMES=$3;let Pj=0;class ar extends ta{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Pj++}),this.uuid=Pi(),this.name="",this.type="Material",this.blending=Ll,this.side=Qs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Dg,this.blendDst=Fg,this.blendEquation=oo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ut(0,0,0),this.blendAlpha=0,this.depthFunc=Xl,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=L1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=vl,this.stencilZFail=vl,this.stencilZPass=vl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){ct(`Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){ct(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(r.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(r.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Ll&&(r.blending=this.blending),this.side!==Qs&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==Dg&&(r.blendSrc=this.blendSrc),this.blendDst!==Fg&&(r.blendDst=this.blendDst),this.blendEquation!==oo&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Xl&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==L1&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==vl&&(r.stencilFail=this.stencilFail),this.stencilZFail!==vl&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==vl&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.allowOverride===!1&&(r.allowOverride=!1),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const c=s[o];delete c.metadata,a.push(c)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class pi extends ar{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ki,this.combine=yf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const va=Bj();function Bj(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let c=0;c<256;++c){const u=c-127;u<-27?(r[c]=0,r[c|256]=32768,i[c]=24,i[c|256]=24):u<-14?(r[c]=1024>>-u-14,r[c|256]=1024>>-u-14|32768,i[c]=-u-1,i[c|256]=-u-1):u<=15?(r[c]=u+15<<10,r[c|256]=u+15<<10|32768,i[c]=13,i[c|256]=13):u<128?(r[c]=31744,r[c|256]=64512,i[c]=24,i[c|256]=24):(r[c]=31744,r[c|256]=64512,i[c]=13,i[c|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let c=1;c<1024;++c){let u=c<<13,f=0;for(;!(u&8388608);)u<<=1,f-=8388608;u&=-8388609,f+=947912704,s[c]=u|f}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(o[c]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}function li(n){Math.abs(n)>65504&&ct("DataUtils.toHalfFloat(): Value out of range."),n=Ft(n,-65504,65504),va.floatView[0]=n;const e=va.uint32View[0],t=e>>23&511;return va.baseTable[t]+((e&8388607)>>va.shiftTable[t])}function sh(n){const e=n>>10;return va.uint32View[0]=va.mantissaTable[va.offsetTable[e]+(n&1023)]+va.exponentTable[e],va.floatView[0]}class Tl{static toHalfFloat(e){return li(e)}static fromHalfFloat(e){return sh(e)}}const Qn=new X,Qp=new Te;let Lj=0;class ln{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Lj++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=qh,this.updateRanges=[],this.gpuType=En,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Qp.fromBufferAttribute(this,t),Qp.applyMatrix3(e),this.setXY(t,Qp.x,Qp.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.applyMatrix3(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.applyMatrix4(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.applyNormalMatrix(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.transformDirection(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Qr(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Wt(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array),i=Wt(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array),i=Wt(i,this.array),s=Wt(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==qh&&(e.usage=this.usage),e}}class Dj extends ln{constructor(e,t,r){super(new Int8Array(e),t,r)}}class Fj extends ln{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class kj extends ln{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class jj extends ln{constructor(e,t,r){super(new Int16Array(e),t,r)}}class xw extends ln{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Uj extends ln{constructor(e,t,r){super(new Int32Array(e),t,r)}}class yw extends ln{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Oj extends ln{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=sh(this.array[e*this.itemSize]);return this.normalized&&(t=Qr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize]=li(t),this}getY(e){let t=sh(this.array[e*this.itemSize+1]);return this.normalized&&(t=Qr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+1]=li(t),this}getZ(e){let t=sh(this.array[e*this.itemSize+2]);return this.normalized&&(t=Qr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+2]=li(t),this}getW(e){let t=sh(this.array[e*this.itemSize+3]);return this.normalized&&(t=Qr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+3]=li(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array)),this.array[e+0]=li(t),this.array[e+1]=li(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array),i=Wt(i,this.array)),this.array[e+0]=li(t),this.array[e+1]=li(r),this.array[e+2]=li(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array),i=Wt(i,this.array),s=Wt(s,this.array)),this.array[e+0]=li(t),this.array[e+1]=li(r),this.array[e+2]=li(i),this.array[e+3]=li(s),this}}class wt extends ln{constructor(e,t,r){super(new Float32Array(e),t,r)}}let zj=0;const Yi=new Dt,Uv=new sn,Pc=new X,Ci=new ir,kd=new ir,pr=new X;class jt extends ta{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:zj++}),this.uuid=Pi(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(K3(e)?yw:xw)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Vt().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Yi.makeRotationFromQuaternion(e),this.applyMatrix4(Yi),this}rotateX(e){return Yi.makeRotationX(e),this.applyMatrix4(Yi),this}rotateY(e){return Yi.makeRotationY(e),this.applyMatrix4(Yi),this}rotateZ(e){return Yi.makeRotationZ(e),this.applyMatrix4(Yi),this}translate(e,t,r){return Yi.makeTranslation(e,t,r),this.applyMatrix4(Yi),this}scale(e,t,r){return Yi.makeScale(e,t,r),this.applyMatrix4(Yi),this}lookAt(e){return Uv.lookAt(e),Uv.updateMatrix(),this.applyMatrix4(Uv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Pc).negate(),this.translate(Pc.x,Pc.y,Pc.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];r.push(a.x,a.y,a.z||0)}this.setAttribute("position",new wt(r,3))}else{const r=Math.min(e.length,t.count);for(let i=0;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&ct("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ir);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){It("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new X(-1/0,-1/0,-1/0),new X(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Ci.setFromBufferAttribute(s),this.morphTargetsRelative?(pr.addVectors(this.boundingBox.min,Ci.min),this.boundingBox.expandByPoint(pr),pr.addVectors(this.boundingBox.max,Ci.max),this.boundingBox.expandByPoint(pr)):(this.boundingBox.expandByPoint(Ci.min),this.boundingBox.expandByPoint(Ci.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&It('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){It("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new X,1/0);return}if(e){const r=this.boundingSphere.center;if(Ci.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];kd.setFromBufferAttribute(o),this.morphTargetsRelative?(pr.addVectors(Ci.min,kd.min),Ci.expandByPoint(pr),pr.addVectors(Ci.max,kd.max),Ci.expandByPoint(pr)):(Ci.expandByPoint(kd.min),Ci.expandByPoint(kd.max))}Ci.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)pr.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(pr));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],c=this.morphTargetsRelative;for(let u=0,f=o.count;u<f;u++)pr.fromBufferAttribute(o,u),c&&(Pc.fromBufferAttribute(e,u),pr.add(Pc)),i=Math.max(i,r.distanceToSquared(pr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&It('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){It("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ln(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),o=[],c=[];for(let P=0;P<r.count;P++)o[P]=new X,c[P]=new X;const u=new X,f=new X,p=new X,m=new Te,g=new Te,y=new Te,S=new X,w=new X;function x(P,T,R){u.fromBufferAttribute(r,P),f.fromBufferAttribute(r,T),p.fromBufferAttribute(r,R),m.fromBufferAttribute(s,P),g.fromBufferAttribute(s,T),y.fromBufferAttribute(s,R),f.sub(u),p.sub(u),g.sub(m),y.sub(m);const j=1/(g.x*y.y-y.x*g.y);isFinite(j)&&(S.copy(f).multiplyScalar(y.y).addScaledVector(p,-g.y).multiplyScalar(j),w.copy(p).multiplyScalar(g.x).addScaledVector(f,-y.x).multiplyScalar(j),o[P].add(S),o[T].add(S),o[R].add(S),c[P].add(w),c[T].add(w),c[R].add(w))}let _=this.groups;_.length===0&&(_=[{start:0,count:e.count}]);for(let P=0,T=_.length;P<T;++P){const R=_[P],j=R.start,O=R.count;for(let k=j,Z=j+O;k<Z;k+=3)x(e.getX(k+0),e.getX(k+1),e.getX(k+2))}const b=new X,M=new X,N=new X,C=new X;function I(P){N.fromBufferAttribute(i,P),C.copy(N);const T=o[P];b.copy(T),b.sub(N.multiplyScalar(N.dot(T))).normalize(),M.crossVectors(C,T);const j=M.dot(c[P])<0?-1:1;a.setXYZW(P,b.x,b.y,b.z,j)}for(let P=0,T=_.length;P<T;++P){const R=_[P],j=R.start,O=R.count;for(let k=j,Z=j+O;k<Z;k+=3)I(e.getX(k+0)),I(e.getX(k+1)),I(e.getX(k+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new ln(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let m=0,g=r.count;m<g;m++)r.setXYZ(m,0,0,0);const i=new X,s=new X,a=new X,o=new X,c=new X,u=new X,f=new X,p=new X;if(e)for(let m=0,g=e.count;m<g;m+=3){const y=e.getX(m+0),S=e.getX(m+1),w=e.getX(m+2);i.fromBufferAttribute(t,y),s.fromBufferAttribute(t,S),a.fromBufferAttribute(t,w),f.subVectors(a,s),p.subVectors(i,s),f.cross(p),o.fromBufferAttribute(r,y),c.fromBufferAttribute(r,S),u.fromBufferAttribute(r,w),o.add(f),c.add(f),u.add(f),r.setXYZ(y,o.x,o.y,o.z),r.setXYZ(S,c.x,c.y,c.z),r.setXYZ(w,u.x,u.y,u.z)}else for(let m=0,g=t.count;m<g;m+=3)i.fromBufferAttribute(t,m+0),s.fromBufferAttribute(t,m+1),a.fromBufferAttribute(t,m+2),f.subVectors(a,s),p.subVectors(i,s),f.cross(p),r.setXYZ(m+0,f.x,f.y,f.z),r.setXYZ(m+1,f.x,f.y,f.z),r.setXYZ(m+2,f.x,f.y,f.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)pr.fromBufferAttribute(e,t),pr.normalize(),e.setXYZ(t,pr.x,pr.y,pr.z)}toNonIndexed(){function e(o,c){const u=o.array,f=o.itemSize,p=o.normalized,m=new u.constructor(c.length*f);let g=0,y=0;for(let S=0,w=c.length;S<w;S++){o.isInterleavedBufferAttribute?g=c[S]*o.data.stride+o.offset:g=c[S]*f;for(let x=0;x<f;x++)m[y++]=u[g++]}return new ln(m,f,p)}if(this.index===null)return ct("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new jt,r=this.index.array,i=this.attributes;for(const o in i){const c=i[o],u=e(c,r);t.setAttribute(o,u)}const s=this.morphAttributes;for(const o in s){const c=[],u=s[o];for(let f=0,p=u.length;f<p;f++){const m=u[f],g=e(m,r);c.push(g)}t.morphAttributes[o]=c}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,c=a.length;o<c;o++){const u=a[o];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const c in r){const u=r[c];e.data.attributes[c]=u.toJSON(e.data)}const i={};let s=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],f=[];for(let p=0,m=u.length;p<m;p++){const g=u[p];f.push(g.toJSON(e.data))}f.length>0&&(i[c]=f,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const u in i){const f=i[u];this.setAttribute(u,f.clone(t))}const s=e.morphAttributes;for(const u in s){const f=[],p=s[u];for(let m=0,g=p.length;m<g;m++)f.push(p[m].clone(t));this.morphAttributes[u]=f}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,f=a.length;u<f;u++){const p=a[u];this.addGroup(p.start,p.count,p.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const TC=new Dt,nl=new rc,$p=new sr,NC=new X,em=new X,tm=new X,nm=new X,Ov=new X,rm=new X,RC=new X,im=new X;class Tn extends sn{constructor(e=new jt,t=new pi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){rm.set(0,0,0);for(let c=0,u=s.length;c<u;c++){const f=o[c],p=s[c];f!==0&&(Ov.fromBufferAttribute(p,e),a?rm.addScaledVector(Ov,f):rm.addScaledVector(Ov.sub(t),f))}t.add(rm)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),$p.copy(r.boundingSphere),$p.applyMatrix4(s),nl.copy(e.ray).recast(e.near),!($p.containsPoint(nl.origin)===!1&&(nl.intersectSphere($p,NC)===null||nl.origin.distanceToSquared(NC)>(e.far-e.near)**2))&&(TC.copy(s).invert(),nl.copy(e.ray).applyMatrix4(TC),!(r.boundingBox!==null&&nl.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,nl)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,o=s.index,c=s.attributes.position,u=s.attributes.uv,f=s.attributes.uv1,p=s.attributes.normal,m=s.groups,g=s.drawRange;if(o!==null)if(Array.isArray(a))for(let y=0,S=m.length;y<S;y++){const w=m[y],x=a[w.materialIndex],_=Math.max(w.start,g.start),b=Math.min(o.count,Math.min(w.start+w.count,g.start+g.count));for(let M=_,N=b;M<N;M+=3){const C=o.getX(M),I=o.getX(M+1),P=o.getX(M+2);i=sm(this,x,e,r,u,f,p,C,I,P),i&&(i.faceIndex=Math.floor(M/3),i.face.materialIndex=w.materialIndex,t.push(i))}}else{const y=Math.max(0,g.start),S=Math.min(o.count,g.start+g.count);for(let w=y,x=S;w<x;w+=3){const _=o.getX(w),b=o.getX(w+1),M=o.getX(w+2);i=sm(this,a,e,r,u,f,p,_,b,M),i&&(i.faceIndex=Math.floor(w/3),t.push(i))}}else if(c!==void 0)if(Array.isArray(a))for(let y=0,S=m.length;y<S;y++){const w=m[y],x=a[w.materialIndex],_=Math.max(w.start,g.start),b=Math.min(c.count,Math.min(w.start+w.count,g.start+g.count));for(let M=_,N=b;M<N;M+=3){const C=M,I=M+1,P=M+2;i=sm(this,x,e,r,u,f,p,C,I,P),i&&(i.faceIndex=Math.floor(M/3),i.face.materialIndex=w.materialIndex,t.push(i))}}else{const y=Math.max(0,g.start),S=Math.min(c.count,g.start+g.count);for(let w=y,x=S;w<x;w+=3){const _=w,b=w+1,M=w+2;i=sm(this,a,e,r,u,f,p,_,b,M),i&&(i.faceIndex=Math.floor(w/3),t.push(i))}}}}function Hj(n,e,t,r,i,s,a,o){let c;if(e.side===Ur?c=r.intersectTriangle(a,s,i,!0,o):c=r.intersectTriangle(i,s,a,e.side===Qs,o),c===null)return null;im.copy(o),im.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(im);return u<t.near||u>t.far?null:{distance:u,point:im.clone(),object:n}}function sm(n,e,t,r,i,s,a,o,c,u){n.getVertexPosition(o,em),n.getVertexPosition(c,tm),n.getVertexPosition(u,nm);const f=Hj(n,e,t,r,em,tm,nm,RC);if(f){const p=new X;hi.getBarycoord(RC,em,tm,nm,p),i&&(f.uv=hi.getInterpolatedAttribute(i,o,c,u,p,new Te)),s&&(f.uv1=hi.getInterpolatedAttribute(s,o,c,u,p,new Te)),a&&(f.normal=hi.getInterpolatedAttribute(a,o,c,u,p,new X),f.normal.dot(r.direction)>0&&f.normal.multiplyScalar(-1));const m={a:o,b:c,c:u,normal:new X,materialIndex:0};hi.getNormal(em,tm,nm,m.normal),f.face=m,f.barycoord=p}return f}class ic extends jt{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const c=[],u=[],f=[],p=[];let m=0,g=0;y("z","y","x",-1,-1,r,t,e,a,s,0),y("z","y","x",1,-1,r,t,-e,a,s,1),y("x","z","y",1,1,e,r,t,i,a,2),y("x","z","y",1,-1,e,r,-t,i,a,3),y("x","y","z",1,-1,e,t,r,i,s,4),y("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(c),this.setAttribute("position",new wt(u,3)),this.setAttribute("normal",new wt(f,3)),this.setAttribute("uv",new wt(p,2));function y(S,w,x,_,b,M,N,C,I,P,T){const R=M/I,j=N/P,O=M/2,k=N/2,Z=C/2,te=I+1,K=P+1;let $=0,U=0;const H=new X;for(let W=0;W<K;W++){const Y=W*j-k;for(let G=0;G<te;G++){const de=G*R-O;H[S]=de*_,H[w]=Y*b,H[x]=Z,u.push(H.x,H.y,H.z),H[S]=0,H[w]=0,H[x]=C>0?1:-1,f.push(H.x,H.y,H.z),p.push(G/I),p.push(1-W/P),$+=1}}for(let W=0;W<P;W++)for(let Y=0;Y<I;Y++){const G=m+Y+te*W,de=m+Y+te*(W+1),Ce=m+(Y+1)+te*(W+1),be=m+(Y+1)+te*W;c.push(G,de,be),c.push(de,Ce,be),U+=6}o.addGroup(g,U,T),g+=U,m+=$}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ic(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Hu(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(ct("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Yr(n){const e={};for(let t=0;t<n.length;t++){const r=Hu(n[t]);for(const i in r)e[i]=r[i]}return e}function Gj(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function eR(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:nn.workingColorSpace}const vw={clone:Hu,merge:Yr};var Vj=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Wj=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Hr extends ar{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Vj,this.fragmentShader=Wj,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hu(e.uniforms),this.uniformsGroups=Gj(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class wf extends sn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Dt,this.projectionMatrix=new Dt,this.projectionMatrixInverse=new Dt,this.coordinateSystem=Ri,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const qa=new X,IC=new Te,PC=new Te;class Cn extends wf{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=zu*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Dl*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return zu*2*Math.atan(Math.tan(Dl*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){qa.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(qa.x,qa.y).multiplyScalar(-e/qa.z),qa.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(qa.x,qa.y).multiplyScalar(-e/qa.z)}getViewSize(e,t){return this.getViewBounds(e,IC,PC),t.subVectors(PC,IC)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Dl*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,u=a.fullHeight;s+=a.offsetX*i/c,t-=a.offsetY*r/u,i*=a.width/c,r*=a.height/u}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Bc=-90,Lc=1;class tR extends sn{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Cn(Bc,Lc,e,t);i.layers=this.layers,this.add(i);const s=new Cn(Bc,Lc,e,t);s.layers=this.layers,this.add(s);const a=new Cn(Bc,Lc,e,t);a.layers=this.layers,this.add(a);const o=new Cn(Bc,Lc,e,t);o.layers=this.layers,this.add(o);const c=new Cn(Bc,Lc,e,t);c.layers=this.layers,this.add(c);const u=new Cn(Bc,Lc,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,o,c]=t;for(const u of t)this.remove(u);if(e===Ri)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Uu)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,c,u,f]=this.children,p=e.getRenderTarget(),m=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const S=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,c),e.setRenderTarget(r,4,i),e.render(t,u),r.texture.generateMipmaps=S,e.setRenderTarget(r,5,i),e.render(t,f),e.setRenderTarget(p,m,g),e.xr.enabled=y,r.texture.needsPMREMUpdate=!0}}class Sf extends pn{constructor(e=[],t=Cs,r,i,s,a,o,c,u,f){super(e,t,r,i,s,a,o,c,u,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class px extends ei{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new Sf(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ic(5,5,5),s=new Hr({name:"CubemapFromEquirect",uniforms:Hu(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Ur,blending:As});s.uniforms.tEquirect.value=t;const a=new Tn(i,s),o=t.minFilter;return t.minFilter===es&&(t.minFilter=en),new tR(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,r=!0,i=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}class wa extends sn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Xj={type:"move"};class eg{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new X,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new X),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new X,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new X),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const o=this._targetRay,c=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const S of e.hand.values()){const w=t.getJointPose(S,r),x=this._getHandJoint(u,S);w!==null&&(x.matrix.fromArray(w.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),x.matrixWorldNeedsUpdate=!0,x.jointRadius=w.radius),x.visible=w!==null}const f=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],m=f.position.distanceTo(p.position),g=.02,y=.005;u.inputState.pinching&&m>g+y?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&m<=g-y&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Xj)))}return o!==null&&(o.visible=i!==null),c!==null&&(c.visible=s!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new wa;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class mx{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new ut(e),this.density=t}clone(){return new mx(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class gx{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new ut(e),this.near=t,this.far=r}clone(){return new gx(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Af extends sn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ki,this.environmentIntensity=1,this.environmentRotation=new ki,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Mf{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=qh,this.updateRanges=[],this.version=0,this.uuid=Pi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Pi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Pi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Xr=new X;class Bo{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Xr.fromBufferAttribute(this,t),Xr.applyMatrix4(e),this.setXYZ(t,Xr.x,Xr.y,Xr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Xr.fromBufferAttribute(this,t),Xr.applyNormalMatrix(e),this.setXYZ(t,Xr.x,Xr.y,Xr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Xr.fromBufferAttribute(this,t),Xr.transformDirection(e),this.setXYZ(t,Xr.x,Xr.y,Xr.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Qr(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Wt(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Qr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Qr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Qr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Qr(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array),i=Wt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wt(t,this.array),r=Wt(r,this.array),i=Wt(i,this.array),s=Wt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){$h("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new ln(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Bo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){$h("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class _w extends ar{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Dc;const jd=new X,Fc=new X,kc=new X,jc=new Te,Ud=new Te,nR=new Dt,am=new X,Od=new X,om=new X,BC=new Te,zv=new Te,LC=new Te;class rR extends sn{constructor(e=new _w){if(super(),this.isSprite=!0,this.type="Sprite",Dc===void 0){Dc=new jt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Mf(t,5);Dc.setIndex([0,1,2,0,2,3]),Dc.setAttribute("position",new Bo(r,3,0,!1)),Dc.setAttribute("uv",new Bo(r,2,3,!1))}this.geometry=Dc,this.material=e,this.center=new Te(.5,.5),this.count=1}raycast(e,t){e.camera===null&&It('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Fc.setFromMatrixScale(this.matrixWorld),nR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),kc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Fc.multiplyScalar(-kc.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const a=this.center;lm(am.set(-.5,-.5,0),kc,a,Fc,i,s),lm(Od.set(.5,-.5,0),kc,a,Fc,i,s),lm(om.set(.5,.5,0),kc,a,Fc,i,s),BC.set(0,0),zv.set(1,0),LC.set(1,1);let o=e.ray.intersectTriangle(am,Od,om,!1,jd);if(o===null&&(lm(Od.set(-.5,.5,0),kc,a,Fc,i,s),zv.set(0,1),o=e.ray.intersectTriangle(am,om,Od,!1,jd),o===null))return;const c=e.ray.origin.distanceTo(jd);c<e.near||c>e.far||t.push({distance:c,point:jd.clone(),uv:hi.getInterpolation(jd,am,Od,om,BC,zv,LC,new Te),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function lm(n,e,t,r,i,s){jc.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(Ud.x=s*jc.x-i*jc.y,Ud.y=i*jc.x+s*jc.y):Ud.copy(jc),n.copy(e),n.x+=Ud.x,n.y+=Ud.y,n.applyMatrix4(nR)}const cm=new X,DC=new X;class iR extends sn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let r=0;r<t.length;r++)if(t[r].distance===e){const i=t.splice(r,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){cm.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(cm);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){cm.setFromMatrixPosition(e.matrixWorld),DC.setFromMatrixPosition(this.matrixWorld);const r=cm.distanceTo(DC)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),r>=a)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const a=r[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const FC=new X,kC=new yn,jC=new yn,Jj=new X,UC=new Dt,um=new X,Hv=new sr,OC=new Dt,Gv=new rc;class bw extends Tn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=P1,this.bindMatrix=new Dt,this.bindMatrixInverse=new Dt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ir),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,um),this.boundingBox.expandByPoint(um)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new sr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,um),this.boundingSphere.expandByPoint(um)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Hv.copy(this.boundingSphere),Hv.applyMatrix4(i),e.ray.intersectsSphere(Hv)!==!1&&(OC.copy(i).invert(),Gv.copy(e.ray).applyMatrix4(OC),!(this.boundingBox!==null&&Gv.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Gv)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new yn,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===P1?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===F3?this.bindMatrixInverse.copy(this.bindMatrix).invert():ct("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;kC.fromBufferAttribute(i.attributes.skinIndex,e),jC.fromBufferAttribute(i.attributes.skinWeight,e),FC.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=jC.getComponent(s);if(a!==0){const o=kC.getComponent(s);UC.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),t.addScaledVector(Jj.copy(FC).applyMatrix4(UC),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class xx extends sn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class rs extends pn{constructor(e=null,t=1,r=1,i,s,a,o,c,u=Un,f=Un,p,m){super(null,a,o,c,u,f,i,s,p,m),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const zC=new Dt,Yj=new Dt;class Cf{constructor(e=[],t=[]){this.uuid=Pi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){ct("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Dt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Dt;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:Yj;zC.multiplyMatrices(o,t[s]),zC.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new Cf(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new rs(t,e,e,Yn,En);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let a=t[s];a===void 0&&(ct("Skeleton: No bone found with UUID:",s),a=new xx),this.bones.push(a),this.boneInverses.push(new Dt().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const o=r[i];e.boneInverses.push(o.toArray())}return e}}class Yl extends ln{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Uc=new Dt,HC=new Dt,dm=[],GC=new ir,Kj=new Dt,zd=new Tn,Hd=new sr;class ww extends Tn{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Yl(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,Kj)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ir),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Uc),GC.copy(e.boundingBox).applyMatrix4(Uc),this.boundingBox.union(GC)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new sr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Uc),Hd.copy(e.boundingSphere).applyMatrix4(Uc),this.boundingSphere.union(Hd)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=r.length+1,a=e*s+1;for(let o=0;o<r.length;o++)r[o]=i[a+o]}raycast(e,t){const r=this.matrixWorld,i=this.count;if(zd.geometry=this.geometry,zd.material=this.material,zd.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Hd.copy(this.boundingSphere),Hd.applyMatrix4(r),e.ray.intersectsSphere(Hd)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,Uc),HC.multiplyMatrices(r,Uc),zd.matrixWorld=HC,zd.raycast(e,dm);for(let a=0,o=dm.length;a<o;a++){const c=dm[a];c.instanceId=s,c.object=this,t.push(c)}dm.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Yl(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,i=r.length+1;this.morphTexture===null&&(this.morphTexture=new rs(new Float32Array(i*this.count),i,this.count,_f,En));const s=this.morphTexture.source.data.data;let a=0;for(let u=0;u<r.length;u++)a+=r[u];const o=this.geometry.morphTargetsRelative?1:1-a,c=i*e;s[c]=o,s.set(r,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Vv=new X,Zj=new X,qj=new Vt;class Xs{constructor(e=new X(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=Vv.subVectors(r,t).cross(Zj.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(Vv),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||qj.getNormalMatrix(e),i=this.coplanarPoint(Vv).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const rl=new sr,Qj=new Te(.5,.5),hm=new X;class rd{constructor(e=new Xs,t=new Xs,r=new Xs,i=new Xs,s=new Xs,a=new Xs){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Ri,r=!1){const i=this.planes,s=e.elements,a=s[0],o=s[1],c=s[2],u=s[3],f=s[4],p=s[5],m=s[6],g=s[7],y=s[8],S=s[9],w=s[10],x=s[11],_=s[12],b=s[13],M=s[14],N=s[15];if(i[0].setComponents(u-a,g-f,x-y,N-_).normalize(),i[1].setComponents(u+a,g+f,x+y,N+_).normalize(),i[2].setComponents(u+o,g+p,x+S,N+b).normalize(),i[3].setComponents(u-o,g-p,x-S,N-b).normalize(),r)i[4].setComponents(c,m,w,M).normalize(),i[5].setComponents(u-c,g-m,x-w,N-M).normalize();else if(i[4].setComponents(u-c,g-m,x-w,N-M).normalize(),t===Ri)i[5].setComponents(u+c,g+m,x+w,N+M).normalize();else if(t===Uu)i[5].setComponents(c,m,w,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),rl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),rl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(rl)}intersectsSprite(e){rl.center.set(0,0,0);const t=Qj.distanceTo(e.center);return rl.radius=.7071067811865476+t,rl.applyMatrix4(e.matrixWorld),this.intersectsSphere(rl)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(hm.x=i.normal.x>0?e.max.x:e.min.x,hm.y=i.normal.y>0?e.max.y:e.min.y,hm.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(hm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const zs=new Dt,Hs=new rd;class yx{constructor(){this.coordinateSystem=Ri}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(zs.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Hs.setFromProjectionMatrix(zs,i.coordinateSystem,i.reversedDepth),Hs.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(zs.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Hs.setFromProjectionMatrix(zs,i.coordinateSystem,i.reversedDepth),Hs.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(zs.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Hs.setFromProjectionMatrix(zs,i.coordinateSystem,i.reversedDepth),Hs.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(zs.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Hs.setFromProjectionMatrix(zs,i.coordinateSystem,i.reversedDepth),Hs.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(zs.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Hs.setFromProjectionMatrix(zs,i.coordinateSystem,i.reversedDepth),Hs.containsPoint(e))return!0}return!1}clone(){return new yx}}function Wv(n,e){return n-e}function $j(n,e){return n.z-e.z}function eU(n,e){return e.z-n.z}class tU{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,r,i){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=r,o.index=i}reset(){this.list.length=0,this.index=0}}const oi=new Dt,nU=new ut(1,1,1),VC=new rd,rU=new yx,fm=new ir,il=new sr,Gd=new X,WC=new X,iU=new X,Xv=new tU,kr=new Tn,pm=[];function sU(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let a=0;a<r;a++)e.setComponent(s+t,a,n.getComponent(s,a))}else e.array.set(n.array,t*r);e.needsUpdate=!0}function sl(n,e){if(n.constructor!==e.constructor){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++)e[r]=n[r]}else{const t=Math.min(n.length,e.length);e.set(new n.constructor(n.buffer,0,t))}}class sR extends Tn{constructor(e,t,r=t*2,i){super(new jt,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new rs(t,e,e,Yn,En);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),r=new rs(t,e,e,bf,Fi);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),r=new rs(t,e,e,Yn,En);r.colorSpace=nn.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:c,normalized:u}=a,f=new o.constructor(r*c),p=new ln(f,c,u);t.setAttribute(s,p)}if(e.getIndex()!==null){const s=r>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new ln(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(!e.hasAttribute(r))throw new Error(`THREE.BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ir);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,oi),this.getBoundingBoxAt(s,fm).applyMatrix4(oi),e.union(fm)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,oi),this.getBoundingSphereAt(s,il).applyMatrix4(oi),e.union(il)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const r={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(Wv),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=r):(i=this._instanceInfo.length,this._instanceInfo.push(r));const s=this._matricesTexture;oi.identity().toArray(s.image.data,i*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(nU.toArray(a.image.data,i*4),a.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,r=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=r===-1?a.count:r),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(Wv),c=this._availableGeometryIds.shift(),s[c]=i):(c=this._geometryCount,this._geometryCount++,s.push(i)),this.setGeometryAt(c,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,c}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(i&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=o.vertexStart,u=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const f in r.attributes){const p=t.getAttribute(f),m=r.getAttribute(f);sU(p,m,c);const g=p.itemSize;for(let y=p.count,S=u;y<S;y++){const w=c+y;for(let x=0;x<g;x++)m.setComponent(w,x,0)}m.needsUpdate=!0,m.addUpdateRange(c*g,u*g)}if(i){const f=o.indexStart,p=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let m=0;m<a.count;m++)s.setX(f+m,c+a.getX(m));for(let m=a.count,g=p;m<g;m++)s.setX(f+m,c);s.needsUpdate=!0,s.addUpdateRange(f,o.reservedIndexCount)}return o.start=i?o.indexStart:o.vertexStart,o.count=i?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const r=this._instanceInfo;for(let i=0,s=r.length;i<s;i++)r[i].active&&r[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const r=this._geometryInfo,i=r.map((a,o)=>o).sort((a,o)=>r[a].vertexStart-r[o].vertexStart),s=this.geometry;for(let a=0,o=r.length;a<o;a++){const c=i[a],u=r[c];if(u.active!==!1){if(s.index!==null){if(u.indexStart!==t){const{indexStart:f,vertexStart:p,reservedIndexCount:m}=u,g=s.index,y=g.array,S=e-p;for(let w=f;w<f+m;w++)y[w]=y[w]+S;g.array.copyWithin(t,f,f+m),g.addUpdateRange(t,m),g.needsUpdate=!0,u.indexStart=t}t+=u.reservedIndexCount}if(u.vertexStart!==e){const{vertexStart:f,reservedVertexCount:p}=u,m=s.attributes;for(const g in m){const y=m[g],{array:S,itemSize:w}=y;S.copyWithin(e*w,f*w,(f+p)*w),y.addUpdateRange(e*w,p*w),y.needsUpdate=!0}u.vertexStart=e}e+=u.reservedVertexCount,u.start=s.index?u.indexStart:u.vertexStart,this._nextIndexStart=s.index?u.indexStart+u.reservedIndexCount:0,this._nextVertexStart=u.vertexStart+u.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const s=new ir,a=r.index,o=r.attributes.position;for(let c=i.start,u=i.start+i.count;c<u;c++){let f=c;a&&(f=a.getX(f)),s.expandByPoint(Gd.fromBufferAttribute(o,f))}i.boundingBox=s}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const s=new sr;this.getBoundingBoxAt(e,fm),fm.getCenter(s.center);const a=r.index,o=r.attributes.position;let c=0;for(let u=i.start,f=i.start+i.count;u<f;u++){let p=u;a&&(p=a.getX(p)),Gd.fromBufferAttribute(o,p),c=Math.max(c,s.center.distanceToSquared(Gd))}s.radius=Math.sqrt(c),i.boundingSphere=s}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const r=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),r.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const r=this._geometryInfo[e];return t.vertexStart=r.vertexStart,t.vertexCount=r.vertexCount,t.reservedVertexCount=r.reservedVertexCount,t.indexStart=r.indexStart,t.indexCount=r.indexCount,t.reservedIndexCount=r.reservedIndexCount,t.start=r.start,t.count=r.count,t}setInstanceCount(e){const t=this._availableInstanceIds,r=this._instanceInfo;for(t.sort(Wv);t[t.length-1]===r.length-1;)r.pop(),t.pop();if(e<r.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),s=new Int32Array(e);sl(this._multiDrawCounts,i),sl(this._multiDrawStarts,s),this._multiDrawCounts=i,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,c=this._colorsTexture;a.dispose(),this._initIndirectTexture(),sl(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),sl(o.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),sl(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const r=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...r.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...r.map(c=>c.indexStart+c.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new jt,this._initializeGeometry(s));const a=this.geometry;s.index&&sl(s.index.array,a.index.array);for(const o in s.attributes)sl(s.attributes[o].array,a.attributes[o].array)}raycast(e,t){const r=this._instanceInfo,i=this._geometryInfo,s=this.matrixWorld,a=this.geometry;kr.material=this.material,kr.geometry.index=a.index,kr.geometry.attributes=a.attributes,kr.geometry.boundingBox===null&&(kr.geometry.boundingBox=new ir),kr.geometry.boundingSphere===null&&(kr.geometry.boundingSphere=new sr);for(let o=0,c=r.length;o<c;o++){if(!r[o].visible||!r[o].active)continue;const u=r[o].geometryIndex,f=i[u];kr.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(o,kr.matrixWorld).premultiply(s),this.getBoundingBoxAt(u,kr.geometry.boundingBox),this.getBoundingSphereAt(u,kr.geometry.boundingSphere),kr.raycast(e,pm);for(let p=0,m=pm.length;p<m;p++){const g=pm[p];g.object=this,g.batchId=o,t.push(g)}pm.length=0}kr.material=null,kr.geometry.index=null,kr.geometry.attributes={},kr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=i.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,c=this._instanceInfo,u=this._multiDrawStarts,f=this._multiDrawCounts,p=this._geometryInfo,m=this.perObjectFrustumCulled,g=this._indirectTexture,y=g.image.data,S=r.isArrayCamera?rU:VC;m&&!r.isArrayCamera&&(oi.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),VC.setFromProjectionMatrix(oi,r.coordinateSystem,r.reversedDepth));let w=0;if(this.sortObjects){oi.copy(this.matrixWorld).invert(),Gd.setFromMatrixPosition(r.matrixWorld).applyMatrix4(oi),WC.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(oi);for(let b=0,M=c.length;b<M;b++)if(c[b].visible&&c[b].active){const N=c[b].geometryIndex;this.getMatrixAt(b,oi),this.getBoundingSphereAt(N,il).applyMatrix4(oi);let C=!1;if(m&&(C=!S.intersectsSphere(il,r)),!C){const I=p[N],P=iU.subVectors(il.center,Gd).dot(WC);Xv.push(I.start,I.count,P,b)}}const x=Xv.list,_=this.customSort;_===null?x.sort(s.transparent?eU:$j):_.call(this,x,r);for(let b=0,M=x.length;b<M;b++){const N=x[b];u[w]=N.start*o,f[w]=N.count,y[w]=N.index,w++}Xv.reset()}else for(let x=0,_=c.length;x<_;x++)if(c[x].visible&&c[x].active){const b=c[x].geometryIndex;let M=!1;if(m&&(this.getMatrixAt(x,oi),this.getBoundingSphereAt(b,il).applyMatrix4(oi),M=!S.intersectsSphere(il,r)),!M){const N=p[b];u[w]=N.start*o,f[w]=N.count,y[w]=x,w++}}g.needsUpdate=!0,this._multiDrawCount=w,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,a){this.onBeforeRender(e,null,i,s,a)}}class Gr extends ar{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ut(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const S0=new X,A0=new X,XC=new Dt,Vd=new rc,mm=new sr,Jv=new X,JC=new X;class Ra extends sn{constructor(e=new jt,t=new Gr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)S0.fromBufferAttribute(t,i-1),A0.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=S0.distanceTo(A0);e.setAttribute("lineDistance",new wt(r,1))}else ct("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),mm.copy(r.boundingSphere),mm.applyMatrix4(i),mm.radius+=s,e.ray.intersectsSphere(mm)===!1)return;XC.copy(i).invert(),Vd.copy(e.ray).applyMatrix4(XC);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,u=this.isLineSegments?2:1,f=r.index,m=r.attributes.position;if(f!==null){const g=Math.max(0,a.start),y=Math.min(f.count,a.start+a.count);for(let S=g,w=y-1;S<w;S+=u){const x=f.getX(S),_=f.getX(S+1),b=gm(this,e,Vd,c,x,_,S);b&&t.push(b)}if(this.isLineLoop){const S=f.getX(y-1),w=f.getX(g),x=gm(this,e,Vd,c,S,w,y-1);x&&t.push(x)}}else{const g=Math.max(0,a.start),y=Math.min(m.count,a.start+a.count);for(let S=g,w=y-1;S<w;S+=u){const x=gm(this,e,Vd,c,S,S+1,S);x&&t.push(x)}if(this.isLineLoop){const S=gm(this,e,Vd,c,y-1,g,y-1);S&&t.push(S)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function gm(n,e,t,r,i,s,a){const o=n.geometry.attributes.position;if(S0.fromBufferAttribute(o,i),A0.fromBufferAttribute(o,s),t.distanceSqToSegment(S0,A0,Jv,JC)>r)return;Jv.applyMatrix4(n.matrixWorld);const u=e.ray.origin.distanceTo(Jv);if(!(u<e.near||u>e.far))return{distance:u,point:JC.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}const YC=new X,KC=new X;class Ts extends Ra{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)YC.fromBufferAttribute(t,i),KC.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+YC.distanceTo(KC);e.setAttribute("lineDistance",new wt(r,1))}else ct("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Sw extends Ra{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class vx extends ar{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const ZC=new Dt,F1=new rc,xm=new sr,ym=new X;class Aw extends sn{constructor(e=new jt,t=new vx){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),xm.copy(r.boundingSphere),xm.applyMatrix4(i),xm.radius+=s,e.ray.intersectsSphere(xm)===!1)return;ZC.copy(i).invert(),F1.copy(e.ray).applyMatrix4(ZC);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,u=r.index,p=r.attributes.position;if(u!==null){const m=Math.max(0,a.start),g=Math.min(u.count,a.start+a.count);for(let y=m,S=g;y<S;y++){const w=u.getX(y);ym.fromBufferAttribute(p,w),qC(ym,w,c,i,e,t,this)}}else{const m=Math.max(0,a.start),g=Math.min(p.count,a.start+a.count);for(let y=m,S=g;y<S;y++)ym.fromBufferAttribute(p,y),qC(ym,y,c,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function qC(n,e,t,r,i,s,a){const o=F1.distanceSqToPoint(n);if(o<t){const c=new X;F1.closestPointToPoint(n,c),c.applyMatrix4(r);const u=i.ray.origin.distanceTo(c);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class aR extends pn{constructor(e,t,r,i,s=en,a=en,o,c,u){super(e,t,r,i,s,a,o,c,u),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const f=this;function p(){f.needsUpdate=!0,f._requestVideoFrameCallbackId=e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(p))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class aU extends aR{constructor(e,t,r,i,s,a,o,c){super({},e,t,r,i,s,a,o,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class oU extends pn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Un,this.minFilter=Un,this.generateMipmaps=!1,this.needsUpdate=!0}}class _x extends pn{constructor(e,t,r,i,s,a,o,c,u,f,p,m){super(null,a,o,c,u,f,i,s,p,m),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class lU extends _x{constructor(e,t,r,i,s,a){super(e,t,r,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Pn,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class cU extends _x{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,Cs),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class uU extends pn{constructor(e,t,r,i,s,a,o,c,u){super(e,t,r,i,s,a,o,c,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Gu extends pn{constructor(e,t,r=Fi,i,s,a,o=Un,c=Un,u,f=$s,p=1){if(f!==$s&&f!==ho)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const m={width:e,height:t,depth:p};super(m,i,s,a,o,c,f,r,u),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new fo(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class oR extends Gu{constructor(e,t=Fi,r=Cs,i,s,a=Un,o=Un,c,u=$s){const f={width:e,height:e,depth:1},p=[f,f,f,f,f,f];super(e,e,t,r,i,s,a,o,c,u),this.image=p,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class Mw extends pn{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class bx extends jt{constructor(e=1,t=1,r=4,i=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:r,radialSegments:i,heightSegments:s},t=Math.max(0,t),r=Math.max(1,Math.floor(r)),i=Math.max(3,Math.floor(i)),s=Math.max(1,Math.floor(s));const a=[],o=[],c=[],u=[],f=t/2,p=Math.PI/2*e,m=t,g=2*p+m,y=r*2+s,S=i+1,w=new X,x=new X;for(let _=0;_<=y;_++){let b=0,M=0,N=0,C=0;if(_<=r){const T=_/r,R=T*Math.PI/2;M=-f-e*Math.cos(R),N=e*Math.sin(R),C=-e*Math.cos(R),b=T*p}else if(_<=r+s){const T=(_-r)/s;M=-f+T*t,N=e,C=0,b=p+T*m}else{const T=(_-r-s)/r,R=T*Math.PI/2;M=f+e*Math.sin(R),N=e*Math.cos(R),C=e*Math.sin(R),b=p+m+T*p}const I=Math.max(0,Math.min(1,b/g));let P=0;_===0?P=.5/i:_===y&&(P=-.5/i);for(let T=0;T<=i;T++){const R=T/i,j=R*Math.PI*2,O=Math.sin(j),k=Math.cos(j);x.x=-N*k,x.y=M,x.z=N*O,o.push(x.x,x.y,x.z),w.set(-N*k,C,N*O),w.normalize(),c.push(w.x,w.y,w.z),u.push(R+P,I)}if(_>0){const T=(_-1)*S;for(let R=0;R<i;R++){const j=T+R,O=T+R+1,k=_*S+R,Z=_*S+R+1;a.push(j,O,k),a.push(O,Z,k)}}}this.setIndex(a),this.setAttribute("position",new wt(o,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bx(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class wx extends jt{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],a=[],o=[],c=[],u=new X,f=new Te;a.push(0,0,0),o.push(0,0,1),c.push(.5,.5);for(let p=0,m=3;p<=t;p++,m+=3){const g=r+p/t*i;u.x=e*Math.cos(g),u.y=e*Math.sin(g),a.push(u.x,u.y,u.z),o.push(0,0,1),f.x=(a[m]/e+1)/2,f.y=(a[m+1]/e+1)/2,c.push(f.x,f.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new wt(a,3)),this.setAttribute("normal",new wt(o,3)),this.setAttribute("uv",new wt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wx(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ef extends jt{constructor(e=1,t=1,r=1,i=32,s=1,a=!1,o=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:c};const u=this;i=Math.floor(i),s=Math.floor(s);const f=[],p=[],m=[],g=[];let y=0;const S=[],w=r/2;let x=0;_(),a===!1&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(f),this.setAttribute("position",new wt(p,3)),this.setAttribute("normal",new wt(m,3)),this.setAttribute("uv",new wt(g,2));function _(){const M=new X,N=new X;let C=0;const I=(t-e)/r;for(let P=0;P<=s;P++){const T=[],R=P/s,j=R*(t-e)+e;for(let O=0;O<=i;O++){const k=O/i,Z=k*c+o,te=Math.sin(Z),K=Math.cos(Z);N.x=j*te,N.y=-R*r+w,N.z=j*K,p.push(N.x,N.y,N.z),M.set(te,I,K).normalize(),m.push(M.x,M.y,M.z),g.push(k,1-R),T.push(y++)}S.push(T)}for(let P=0;P<i;P++)for(let T=0;T<s;T++){const R=S[T][P],j=S[T+1][P],O=S[T+1][P+1],k=S[T][P+1];(e>0||T!==0)&&(f.push(R,j,k),C+=3),(t>0||T!==s-1)&&(f.push(j,O,k),C+=3)}u.addGroup(x,C,0),x+=C}function b(M){const N=y,C=new Te,I=new X;let P=0;const T=M===!0?e:t,R=M===!0?1:-1;for(let O=1;O<=i;O++)p.push(0,w*R,0),m.push(0,R,0),g.push(.5,.5),y++;const j=y;for(let O=0;O<=i;O++){const Z=O/i*c+o,te=Math.cos(Z),K=Math.sin(Z);I.x=T*K,I.y=w*R,I.z=T*te,p.push(I.x,I.y,I.z),m.push(0,R,0),C.x=te*.5+.5,C.y=K*.5*R+.5,g.push(C.x,C.y),y++}for(let O=0;O<i;O++){const k=N+O,Z=j+O;M===!0?f.push(Z,Z+1,k):f.push(Z+1,Z,k),P+=3}u.addGroup(x,P,M===!0?1:2),x+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ef(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Tf extends Ef{constructor(e=1,t=1,r=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new Tf(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class zo extends jt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],a=[];o(i),u(r),f(),this.setAttribute("position",new wt(s,3)),this.setAttribute("normal",new wt(s.slice(),3)),this.setAttribute("uv",new wt(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(_){const b=new X,M=new X,N=new X;for(let C=0;C<t.length;C+=3)g(t[C+0],b),g(t[C+1],M),g(t[C+2],N),c(b,M,N,_)}function c(_,b,M,N){const C=N+1,I=[];for(let P=0;P<=C;P++){I[P]=[];const T=_.clone().lerp(M,P/C),R=b.clone().lerp(M,P/C),j=C-P;for(let O=0;O<=j;O++)O===0&&P===C?I[P][O]=T:I[P][O]=T.clone().lerp(R,O/j)}for(let P=0;P<C;P++)for(let T=0;T<2*(C-P)-1;T++){const R=Math.floor(T/2);T%2===0?(m(I[P][R+1]),m(I[P+1][R]),m(I[P][R])):(m(I[P][R+1]),m(I[P+1][R+1]),m(I[P+1][R]))}}function u(_){const b=new X;for(let M=0;M<s.length;M+=3)b.x=s[M+0],b.y=s[M+1],b.z=s[M+2],b.normalize().multiplyScalar(_),s[M+0]=b.x,s[M+1]=b.y,s[M+2]=b.z}function f(){const _=new X;for(let b=0;b<s.length;b+=3){_.x=s[b+0],_.y=s[b+1],_.z=s[b+2];const M=w(_)/2/Math.PI+.5,N=x(_)/Math.PI+.5;a.push(M,1-N)}y(),p()}function p(){for(let _=0;_<a.length;_+=6){const b=a[_+0],M=a[_+2],N=a[_+4],C=Math.max(b,M,N),I=Math.min(b,M,N);C>.9&&I<.1&&(b<.2&&(a[_+0]+=1),M<.2&&(a[_+2]+=1),N<.2&&(a[_+4]+=1))}}function m(_){s.push(_.x,_.y,_.z)}function g(_,b){const M=_*3;b.x=e[M+0],b.y=e[M+1],b.z=e[M+2]}function y(){const _=new X,b=new X,M=new X,N=new X,C=new Te,I=new Te,P=new Te;for(let T=0,R=0;T<s.length;T+=9,R+=6){_.set(s[T+0],s[T+1],s[T+2]),b.set(s[T+3],s[T+4],s[T+5]),M.set(s[T+6],s[T+7],s[T+8]),C.set(a[R+0],a[R+1]),I.set(a[R+2],a[R+3]),P.set(a[R+4],a[R+5]),N.copy(_).add(b).add(M).divideScalar(3);const j=w(N);S(C,R+0,_,j),S(I,R+2,b,j),S(P,R+4,M,j)}}function S(_,b,M,N){N<0&&_.x===1&&(a[b]=_.x-1),M.x===0&&M.z===0&&(a[b]=N/2/Math.PI+.5)}function w(_){return Math.atan2(_.z,-_.x)}function x(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zo(e.vertices,e.indices,e.radius,e.detail)}}class Sx extends zo{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Sx(e.radius,e.detail)}}const vm=new X,_m=new X,Yv=new X,bm=new hi;class lR extends jt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Dl*t),a=e.getIndex(),o=e.getAttribute("position"),c=a?a.count:o.count,u=[0,0,0],f=["a","b","c"],p=new Array(3),m={},g=[];for(let y=0;y<c;y+=3){a?(u[0]=a.getX(y),u[1]=a.getX(y+1),u[2]=a.getX(y+2)):(u[0]=y,u[1]=y+1,u[2]=y+2);const{a:S,b:w,c:x}=bm;if(S.fromBufferAttribute(o,u[0]),w.fromBufferAttribute(o,u[1]),x.fromBufferAttribute(o,u[2]),bm.getNormal(Yv),p[0]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,p[1]=`${Math.round(w.x*i)},${Math.round(w.y*i)},${Math.round(w.z*i)}`,p[2]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let _=0;_<3;_++){const b=(_+1)%3,M=p[_],N=p[b],C=bm[f[_]],I=bm[f[b]],P=`${M}_${N}`,T=`${N}_${M}`;T in m&&m[T]?(Yv.dot(m[T].normal)<=s&&(g.push(C.x,C.y,C.z),g.push(I.x,I.y,I.z)),m[T]=null):P in m||(m[P]={index0:u[_],index1:u[b],normal:Yv.clone()})}}for(const y in m)if(m[y]){const{index0:S,index1:w}=m[y];vm.fromBufferAttribute(o,S),_m.fromBufferAttribute(o,w),g.push(vm.x,vm.y,vm.z),g.push(_m.x,_m.y,_m.z)}this.setAttribute("position",new wt(g,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Ns{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){ct("Curve: .getPoint() not implemented.")}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const r=this.getLengths();let i=0;const s=r.length;let a;t?a=t:a=e*r[s-1];let o=0,c=s-1,u;for(;o<=c;)if(i=Math.floor(o+(c-o)/2),u=r[i]-a,u<0)o=i+1;else if(u>0)c=i-1;else{c=i;break}if(i=c,r[i]===a)return i/(s-1);const f=r[i],m=r[i+1]-f,g=(a-f)/m;return(i+g)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),o=this.getPoint(s),c=t||(a.isVector2?new Te:new X);return c.copy(o).sub(a).normalize(),c}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t=!1){const r=new X,i=[],s=[],a=[],o=new X,c=new Dt;for(let g=0;g<=e;g++){const y=g/e;i[g]=this.getTangentAt(y,new X)}s[0]=new X,a[0]=new X;let u=Number.MAX_VALUE;const f=Math.abs(i[0].x),p=Math.abs(i[0].y),m=Math.abs(i[0].z);f<=u&&(u=f,r.set(1,0,0)),p<=u&&(u=p,r.set(0,1,0)),m<=u&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]);for(let g=1;g<=e;g++){if(s[g]=s[g-1].clone(),a[g]=a[g-1].clone(),o.crossVectors(i[g-1],i[g]),o.length()>Number.EPSILON){o.normalize();const y=Math.acos(Ft(i[g-1].dot(i[g]),-1,1));s[g].applyMatrix4(c.makeRotationAxis(o,y))}a[g].crossVectors(i[g],s[g])}if(t===!0){let g=Math.acos(Ft(s[0].dot(s[e]),-1,1));g/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(g=-g);for(let y=1;y<=e;y++)s[y].applyMatrix4(c.makeRotationAxis(i[y],g*y)),a[y].crossVectors(i[y],s[y])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ax extends Ns{constructor(e=0,t=0,r=1,i=1,s=0,a=Math.PI*2,o=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=c}getPoint(e,t=new Te){const r=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const o=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const f=Math.cos(this.aRotation),p=Math.sin(this.aRotation),m=c-this.aX,g=u-this.aY;c=m*f-g*p+this.aX,u=m*p+g*f+this.aY}return r.set(c,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class cR extends Ax{constructor(e,t,r,i,s,a){super(e,t,r,r,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Cw(){let n=0,e=0,t=0,r=0;function i(s,a,o,c){n=s,e=o,t=-3*s+3*a-2*o-c,r=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,u){i(a,o,u*(o-s),u*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,u,f,p){let m=(a-s)/u-(o-s)/(u+f)+(o-a)/f,g=(o-a)/f-(c-a)/(f+p)+(c-o)/p;m*=f,g*=f,i(a,o,m,g)},calc:function(s){const a=s*s,o=a*s;return n+e*s+t*a+r*o}}}const wm=new X,Kv=new Cw,Zv=new Cw,qv=new Cw;class uR extends Ns{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new X){const r=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),c=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:c===0&&o===s-1&&(o=s-2,c=1);let u,f;this.closed||o>0?u=i[(o-1)%s]:(wm.subVectors(i[0],i[1]).add(i[0]),u=wm);const p=i[o%s],m=i[(o+1)%s];if(this.closed||o+2<s?f=i[(o+2)%s]:(wm.subVectors(i[s-1],i[s-2]).add(i[s-1]),f=wm),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let y=Math.pow(u.distanceToSquared(p),g),S=Math.pow(p.distanceToSquared(m),g),w=Math.pow(m.distanceToSquared(f),g);S<1e-4&&(S=1),y<1e-4&&(y=S),w<1e-4&&(w=S),Kv.initNonuniformCatmullRom(u.x,p.x,m.x,f.x,y,S,w),Zv.initNonuniformCatmullRom(u.y,p.y,m.y,f.y,y,S,w),qv.initNonuniformCatmullRom(u.z,p.z,m.z,f.z,y,S,w)}else this.curveType==="catmullrom"&&(Kv.initCatmullRom(u.x,p.x,m.x,f.x,this.tension),Zv.initCatmullRom(u.y,p.y,m.y,f.y,this.tension),qv.initCatmullRom(u.z,p.z,m.z,f.z,this.tension));return r.set(Kv.calc(c),Zv.calc(c),qv.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new X().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function QC(n,e,t,r,i){const s=(r-e)*.5,a=(i-t)*.5,o=n*n,c=n*o;return(2*t-2*r+s+a)*c+(-3*t+3*r-2*s-a)*o+s*n+t}function dU(n,e){const t=1-n;return t*t*e}function hU(n,e){return 2*(1-n)*n*e}function fU(n,e){return n*n*e}function Sh(n,e,t,r){return dU(n,e)+hU(n,t)+fU(n,r)}function pU(n,e){const t=1-n;return t*t*t*e}function mU(n,e){const t=1-n;return 3*t*t*n*e}function gU(n,e){return 3*(1-n)*n*n*e}function xU(n,e){return n*n*n*e}function Ah(n,e,t,r,i){return pU(n,e)+mU(n,t)+gU(n,r)+xU(n,i)}class Ew extends Ns{constructor(e=new Te,t=new Te,r=new Te,i=new Te){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Te){const r=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(Ah(e,i.x,s.x,a.x,o.x),Ah(e,i.y,s.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class dR extends Ns{constructor(e=new X,t=new X,r=new X,i=new X){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new X){const r=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(Ah(e,i.x,s.x,a.x,o.x),Ah(e,i.y,s.y,a.y,o.y),Ah(e,i.z,s.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Tw extends Ns{constructor(e=new Te,t=new Te){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Te){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Te){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hR extends Ns{constructor(e=new X,t=new X){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new X){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new X){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Nw extends Ns{constructor(e=new Te,t=new Te,r=new Te){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Te){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(Sh(e,i.x,s.x,a.x),Sh(e,i.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Rw extends Ns{constructor(e=new X,t=new X,r=new X){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new X){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(Sh(e,i.x,s.x,a.x),Sh(e,i.y,s.y,a.y),Sh(e,i.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Iw extends Ns{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Te){const r=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),o=s-a,c=i[a===0?a:a-1],u=i[a],f=i[a>i.length-2?i.length-1:a+1],p=i[a>i.length-3?i.length-1:a+2];return r.set(QC(o,c.x,u.x,f.x,p.x),QC(o,c.y,u.y,f.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Te().fromArray(i))}return this}}var M0=Object.freeze({__proto__:null,ArcCurve:cR,CatmullRomCurve3:uR,CubicBezierCurve:Ew,CubicBezierCurve3:dR,EllipseCurve:Ax,LineCurve:Tw,LineCurve3:hR,QuadraticBezierCurve:Nw,QuadraticBezierCurve3:Rw,SplineCurve:Iw});class fR extends Ns{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new M0[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const a=i[s]-r,o=this.curves[s],c=o.getLength(),u=c===0?0:1-a/c;return o.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,c=a.getPoints(o);for(let u=0;u<c.length;u++){const f=c[u];r&&r.equals(f)||(t.push(f),r=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new M0[i.type]().fromJSON(i))}return this}}class C0 extends fR{constructor(e){super(),this.type="Path",this.currentPoint=new Te,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new Tw(this.currentPoint.clone(),new Te(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new Nw(this.currentPoint.clone(),new Te(e,t),new Te(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,a){const o=new Ew(this.currentPoint.clone(),new Te(e,t),new Te(r,i),new Te(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new Iw(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,a){const o=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+o,t+c,r,i,s,a),this}absarc(e,t,r,i,s,a){return this.absellipse(e,t,r,r,i,s,a),this}ellipse(e,t,r,i,s,a,o,c){const u=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+u,t+f,r,i,s,a,o,c),this}absellipse(e,t,r,i,s,a,o,c){const u=new Ax(e,t,r,i,s,a,o,c);if(this.curves.length>0){const p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);const f=u.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class kl extends C0{constructor(e){super(e),this.uuid=Pi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new C0().fromJSON(i))}return this}}function yU(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=pR(n,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,c,u;if(r&&(s=SU(n,e,s,t)),n.length>80*t){o=n[0],c=n[1];let f=o,p=c;for(let m=t;m<i;m+=t){const g=n[m],y=n[m+1];g<o&&(o=g),y<c&&(c=y),g>f&&(f=g),y>p&&(p=y)}u=Math.max(f-o,p-c),u=u!==0?32767/u:0}return ef(s,a,t,o,c,u,0),a}function pR(n,e,t,r,i){let s;if(i===LU(n,e,t,r)>0)for(let a=e;a<t;a+=r)s=$C(a/r|0,n[a],n[a+1],s);else for(let a=t-r;a>=e;a-=r)s=$C(a/r|0,n[a],n[a+1],s);return s&&Vu(s,s.next)&&(nf(s),s=s.next),s}function Kl(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Vu(t,t.next)||In(t.prev,t,t.next)===0)){if(nf(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function ef(n,e,t,r,i,s,a){if(!n)return;!a&&s&&TU(n,r,i,s);let o=n;for(;n.prev!==n.next;){const c=n.prev,u=n.next;if(s?_U(n,r,i,s):vU(n)){e.push(c.i,n.i,u.i),nf(n),n=u.next,o=u.next;continue}if(n=u,n===o){a?a===1?(n=bU(Kl(n),e),ef(n,e,t,r,i,s,2)):a===2&&wU(n,e,t,r,i,s):ef(Kl(n),e,t,r,i,s,1);break}}}function vU(n){const e=n.prev,t=n,r=n.next;if(In(e,t,r)>=0)return!1;const i=e.x,s=t.x,a=r.x,o=e.y,c=t.y,u=r.y,f=Math.min(i,s,a),p=Math.min(o,c,u),m=Math.max(i,s,a),g=Math.max(o,c,u);let y=r.next;for(;y!==e;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=g&&ah(i,o,s,c,a,u,y.x,y.y)&&In(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function _U(n,e,t,r){const i=n.prev,s=n,a=n.next;if(In(i,s,a)>=0)return!1;const o=i.x,c=s.x,u=a.x,f=i.y,p=s.y,m=a.y,g=Math.min(o,c,u),y=Math.min(f,p,m),S=Math.max(o,c,u),w=Math.max(f,p,m),x=k1(g,y,e,t,r),_=k1(S,w,e,t,r);let b=n.prevZ,M=n.nextZ;for(;b&&b.z>=x&&M&&M.z<=_;){if(b.x>=g&&b.x<=S&&b.y>=y&&b.y<=w&&b!==i&&b!==a&&ah(o,f,c,p,u,m,b.x,b.y)&&In(b.prev,b,b.next)>=0||(b=b.prevZ,M.x>=g&&M.x<=S&&M.y>=y&&M.y<=w&&M!==i&&M!==a&&ah(o,f,c,p,u,m,M.x,M.y)&&In(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;b&&b.z>=x;){if(b.x>=g&&b.x<=S&&b.y>=y&&b.y<=w&&b!==i&&b!==a&&ah(o,f,c,p,u,m,b.x,b.y)&&In(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;M&&M.z<=_;){if(M.x>=g&&M.x<=S&&M.y>=y&&M.y<=w&&M!==i&&M!==a&&ah(o,f,c,p,u,m,M.x,M.y)&&In(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function bU(n,e){let t=n;do{const r=t.prev,i=t.next.next;!Vu(r,i)&&gR(r,t,t.next,i)&&tf(r,i)&&tf(i,r)&&(e.push(r.i,t.i,i.i),nf(t),nf(t.next),t=n=i),t=t.next}while(t!==n);return Kl(t)}function wU(n,e,t,r,i,s){let a=n;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&IU(a,o)){let c=xR(a,o);a=Kl(a,a.next),c=Kl(c,c.next),ef(a,e,t,r,i,s,0),ef(c,e,t,r,i,s,0);return}o=o.next}a=a.next}while(a!==n)}function SU(n,e,t,r){const i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*r,c=s<a-1?e[s+1]*r:n.length,u=pR(n,o,c,r,!1);u===u.next&&(u.steiner=!0),i.push(RU(u))}i.sort(AU);for(let s=0;s<i.length;s++)t=MU(i[s],t);return t}function AU(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=r-i}return t}function MU(n,e){const t=CU(n,e);if(!t)return e;const r=xR(t,n);return Kl(r,r.next),Kl(t,t.next)}function CU(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,a;if(Vu(n,t))return t;do{if(Vu(n,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const p=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=r&&p>s&&(s=p,a=t.x<t.next.x?t:t.next,p===r))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,c=a.x,u=a.y;let f=1/0;t=a;do{if(r>=t.x&&t.x>=c&&r!==t.x&&mR(i<u?r:s,i,c,u,i<u?s:r,i,t.x,t.y)){const p=Math.abs(i-t.y)/(r-t.x);tf(t,n)&&(p<f||p===f&&(t.x>a.x||t.x===a.x&&EU(a,t)))&&(a=t,f=p)}t=t.next}while(t!==o);return a}function EU(n,e){return In(n.prev,n,e.prev)<0&&In(e.next,n,n.next)<0}function TU(n,e,t,r){let i=n;do i.z===0&&(i.z=k1(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,NU(i)}function NU(n){let e,t=1;do{let r=n,i;n=null;let s=null;for(e=0;r;){e++;let a=r,o=0;for(let u=0;u<t&&(o++,a=a.nextZ,!!a);u++);let c=t;for(;o>0||c>0&&a;)o!==0&&(c===0||!a||r.z<=a.z)?(i=r,r=r.nextZ,o--):(i=a,a=a.nextZ,c--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;r=a}s.nextZ=null,t*=2}while(e>1);return n}function k1(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function RU(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function mR(n,e,t,r,i,s,a,o){return(i-a)*(e-o)>=(n-a)*(s-o)&&(n-a)*(r-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(i-a)*(r-o)}function ah(n,e,t,r,i,s,a,o){return!(n===a&&e===o)&&mR(n,e,t,r,i,s,a,o)}function IU(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!PU(n,e)&&(tf(n,e)&&tf(e,n)&&BU(n,e)&&(In(n.prev,n,e.prev)||In(n,e.prev,e))||Vu(n,e)&&In(n.prev,n,n.next)>0&&In(e.prev,e,e.next)>0)}function In(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Vu(n,e){return n.x===e.x&&n.y===e.y}function gR(n,e,t,r){const i=Am(In(n,e,t)),s=Am(In(n,e,r)),a=Am(In(t,r,n)),o=Am(In(t,r,e));return!!(i!==s&&a!==o||i===0&&Sm(n,t,e)||s===0&&Sm(n,r,e)||a===0&&Sm(t,n,r)||o===0&&Sm(t,e,r))}function Sm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Am(n){return n>0?1:n<0?-1:0}function PU(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&gR(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function tf(n,e){return In(n.prev,n,n.next)<0?In(n,e,n.next)>=0&&In(n,n.prev,e)>=0:In(n,e,n.prev)<0||In(n,n.next,e)<0}function BU(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function xR(n,e){const t=j1(n.i,n.x,n.y),r=j1(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function $C(n,e,t,r){const i=j1(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function nf(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function j1(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function LU(n,e,t,r){let i=0;for(let s=e,a=t-r;s<t;s+=r)i+=(n[a]-n[s])*(n[s+1]+n[a+1]),a=s;return i}class DU{static triangulate(e,t,r=2){return yU(e,t,r)}}class bs{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return bs.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];eE(e),tE(r,e);let a=e.length;t.forEach(eE);for(let c=0;c<t.length;c++)i.push(a),a+=t[c].length,tE(r,t[c]);const o=DU.triangulate(r,i);for(let c=0;c<o.length;c+=3)s.push(o.slice(c,c+3));return s}}function eE(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function tE(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Mx extends jt{constructor(e=new kl([new Te(.5,.5),new Te(-.5,.5),new Te(-.5,-.5),new Te(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let o=0,c=e.length;o<c;o++){const u=e[o];a(u)}this.setAttribute("position",new wt(i,3)),this.setAttribute("uv",new wt(s,2)),this.computeVertexNormals();function a(o){const c=[],u=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let m=t.bevelEnabled!==void 0?t.bevelEnabled:!0,g=t.bevelThickness!==void 0?t.bevelThickness:.2,y=t.bevelSize!==void 0?t.bevelSize:g-.1,S=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const x=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:FU;let b,M=!1,N,C,I,P;if(x){b=x.getSpacedPoints(f),M=!0,m=!1;const Me=x.isCatmullRomCurve3?x.closed:!1;N=x.computeFrenetFrames(f,Me),C=new X,I=new X,P=new X}m||(w=0,g=0,y=0,S=0);const T=o.extractPoints(u);let R=T.shape;const j=T.holes;if(!bs.isClockWise(R)){R=R.reverse();for(let Me=0,Be=j.length;Me<Be;Me++){const Ie=j[Me];bs.isClockWise(Ie)&&(j[Me]=Ie.reverse())}}function k(Me){const Ie=10000000000000001e-36;let Ye=Me[0];for(let Q=1;Q<=Me.length;Q++){const vt=Q%Me.length,et=Me[vt],Ct=et.x-Ye.x,Ge=et.y-Ye.y,J=Ct*Ct+Ge*Ge,L=Math.max(Math.abs(et.x),Math.abs(et.y),Math.abs(Ye.x),Math.abs(Ye.y)),q=Ie*L*L;if(J<=q){Me.splice(vt,1),Q--;continue}Ye=et}}k(R),j.forEach(k);const Z=j.length,te=R;for(let Me=0;Me<Z;Me++){const Be=j[Me];R=R.concat(Be)}function K(Me,Be,Ie){return Be||It("ExtrudeGeometry: vec does not exist"),Me.clone().addScaledVector(Be,Ie)}const $=R.length;function U(Me,Be,Ie){let Ye,Q,vt;const et=Me.x-Be.x,Ct=Me.y-Be.y,Ge=Ie.x-Me.x,J=Ie.y-Me.y,L=et*et+Ct*Ct,q=et*J-Ct*Ge;if(Math.abs(q)>Number.EPSILON){const pe=Math.sqrt(L),ve=Math.sqrt(Ge*Ge+J*J),ge=Be.x-Ct/pe,st=Be.y+et/pe,Ke=Ie.x-J/ve,dt=Ie.y+Ge/ve,_t=((Ke-ge)*J-(dt-st)*Ge)/(et*J-Ct*Ge);Ye=ge+et*_t-Me.x,Q=st+Ct*_t-Me.y;const Fe=Ye*Ye+Q*Q;if(Fe<=2)return new Te(Ye,Q);vt=Math.sqrt(Fe/2)}else{let pe=!1;et>Number.EPSILON?Ge>Number.EPSILON&&(pe=!0):et<-Number.EPSILON?Ge<-Number.EPSILON&&(pe=!0):Math.sign(Ct)===Math.sign(J)&&(pe=!0),pe?(Ye=-Ct,Q=et,vt=Math.sqrt(L)):(Ye=et,Q=Ct,vt=Math.sqrt(L/2))}return new Te(Ye/vt,Q/vt)}const H=[];for(let Me=0,Be=te.length,Ie=Be-1,Ye=Me+1;Me<Be;Me++,Ie++,Ye++)Ie===Be&&(Ie=0),Ye===Be&&(Ye=0),H[Me]=U(te[Me],te[Ie],te[Ye]);const W=[];let Y,G=H.concat();for(let Me=0,Be=Z;Me<Be;Me++){const Ie=j[Me];Y=[];for(let Ye=0,Q=Ie.length,vt=Q-1,et=Ye+1;Ye<Q;Ye++,vt++,et++)vt===Q&&(vt=0),et===Q&&(et=0),Y[Ye]=U(Ie[Ye],Ie[vt],Ie[et]);W.push(Y),G=G.concat(Y)}let de;if(w===0)de=bs.triangulateShape(te,j);else{const Me=[],Be=[];for(let Ie=0;Ie<w;Ie++){const Ye=Ie/w,Q=g*Math.cos(Ye*Math.PI/2),vt=y*Math.sin(Ye*Math.PI/2)+S;for(let et=0,Ct=te.length;et<Ct;et++){const Ge=K(te[et],H[et],vt);yt(Ge.x,Ge.y,-Q),Ye===0&&Me.push(Ge)}for(let et=0,Ct=Z;et<Ct;et++){const Ge=j[et];Y=W[et];const J=[];for(let L=0,q=Ge.length;L<q;L++){const pe=K(Ge[L],Y[L],vt);yt(pe.x,pe.y,-Q),Ye===0&&J.push(pe)}Ye===0&&Be.push(J)}}de=bs.triangulateShape(Me,Be)}const Ce=de.length,be=y+S;for(let Me=0;Me<$;Me++){const Be=m?K(R[Me],G[Me],be):R[Me];M?(I.copy(N.normals[0]).multiplyScalar(Be.x),C.copy(N.binormals[0]).multiplyScalar(Be.y),P.copy(b[0]).add(I).add(C),yt(P.x,P.y,P.z)):yt(Be.x,Be.y,0)}for(let Me=1;Me<=f;Me++)for(let Be=0;Be<$;Be++){const Ie=m?K(R[Be],G[Be],be):R[Be];M?(I.copy(N.normals[Me]).multiplyScalar(Ie.x),C.copy(N.binormals[Me]).multiplyScalar(Ie.y),P.copy(b[Me]).add(I).add(C),yt(P.x,P.y,P.z)):yt(Ie.x,Ie.y,p/f*Me)}for(let Me=w-1;Me>=0;Me--){const Be=Me/w,Ie=g*Math.cos(Be*Math.PI/2),Ye=y*Math.sin(Be*Math.PI/2)+S;for(let Q=0,vt=te.length;Q<vt;Q++){const et=K(te[Q],H[Q],Ye);yt(et.x,et.y,p+Ie)}for(let Q=0,vt=j.length;Q<vt;Q++){const et=j[Q];Y=W[Q];for(let Ct=0,Ge=et.length;Ct<Ge;Ct++){const J=K(et[Ct],Y[Ct],Ye);M?yt(J.x,J.y+b[f-1].y,b[f-1].x+Ie):yt(J.x,J.y,p+Ie)}}}se(),_e();function se(){const Me=i.length/3;if(m){let Be=0,Ie=$*Be;for(let Ye=0;Ye<Ce;Ye++){const Q=de[Ye];qe(Q[2]+Ie,Q[1]+Ie,Q[0]+Ie)}Be=f+w*2,Ie=$*Be;for(let Ye=0;Ye<Ce;Ye++){const Q=de[Ye];qe(Q[0]+Ie,Q[1]+Ie,Q[2]+Ie)}}else{for(let Be=0;Be<Ce;Be++){const Ie=de[Be];qe(Ie[2],Ie[1],Ie[0])}for(let Be=0;Be<Ce;Be++){const Ie=de[Be];qe(Ie[0]+$*f,Ie[1]+$*f,Ie[2]+$*f)}}r.addGroup(Me,i.length/3-Me,0)}function _e(){const Me=i.length/3;let Be=0;Le(te,Be),Be+=te.length;for(let Ie=0,Ye=j.length;Ie<Ye;Ie++){const Q=j[Ie];Le(Q,Be),Be+=Q.length}r.addGroup(Me,i.length/3-Me,1)}function Le(Me,Be){let Ie=Me.length;for(;--Ie>=0;){const Ye=Ie;let Q=Ie-1;Q<0&&(Q=Me.length-1);for(let vt=0,et=f+w*2;vt<et;vt++){const Ct=$*vt,Ge=$*(vt+1),J=Be+Ye+Ct,L=Be+Q+Ct,q=Be+Q+Ge,pe=Be+Ye+Ge;lt(J,L,q,pe)}}}function yt(Me,Be,Ie){c.push(Me),c.push(Be),c.push(Ie)}function qe(Me,Be,Ie){kt(Me),kt(Be),kt(Ie);const Ye=i.length/3,Q=_.generateTopUV(r,i,Ye-3,Ye-2,Ye-1);it(Q[0]),it(Q[1]),it(Q[2])}function lt(Me,Be,Ie,Ye){kt(Me),kt(Be),kt(Ye),kt(Be),kt(Ie),kt(Ye);const Q=i.length/3,vt=_.generateSideWallUV(r,i,Q-6,Q-3,Q-2,Q-1);it(vt[0]),it(vt[1]),it(vt[3]),it(vt[1]),it(vt[2]),it(vt[3])}function kt(Me){i.push(c[Me*3+0]),i.push(c[Me*3+1]),i.push(c[Me*3+2])}function it(Me){s.push(Me.x),s.push(Me.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return kU(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];r.push(o)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new M0[i.type]().fromJSON(i)),new Mx(r,e.options)}}const FU={generateTopUV:function(n,e,t,r,i){const s=e[t*3],a=e[t*3+1],o=e[r*3],c=e[r*3+1],u=e[i*3],f=e[i*3+1];return[new Te(s,a),new Te(o,c),new Te(u,f)]},generateSideWallUV:function(n,e,t,r,i,s){const a=e[t*3],o=e[t*3+1],c=e[t*3+2],u=e[r*3],f=e[r*3+1],p=e[r*3+2],m=e[i*3],g=e[i*3+1],y=e[i*3+2],S=e[s*3],w=e[s*3+1],x=e[s*3+2];return Math.abs(o-f)<Math.abs(a-u)?[new Te(a,1-c),new Te(u,1-p),new Te(m,1-y),new Te(S,1-x)]:[new Te(o,1-c),new Te(f,1-p),new Te(g,1-y),new Te(w,1-x)]}};function kU(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Nf extends zo{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Nf(e.radius,e.detail)}}class Cx extends jt{constructor(e=[new Te(0,-.5),new Te(.5,0),new Te(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Ft(i,0,Math.PI*2);const s=[],a=[],o=[],c=[],u=[],f=1/t,p=new X,m=new Te,g=new X,y=new X,S=new X;let w=0,x=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:w=e[_+1].x-e[_].x,x=e[_+1].y-e[_].y,g.x=x*1,g.y=-w,g.z=x*0,S.copy(g),g.normalize(),c.push(g.x,g.y,g.z);break;case e.length-1:c.push(S.x,S.y,S.z);break;default:w=e[_+1].x-e[_].x,x=e[_+1].y-e[_].y,g.x=x*1,g.y=-w,g.z=x*0,y.copy(g),g.x+=S.x,g.y+=S.y,g.z+=S.z,g.normalize(),c.push(g.x,g.y,g.z),S.copy(y)}for(let _=0;_<=t;_++){const b=r+_*f*i,M=Math.sin(b),N=Math.cos(b);for(let C=0;C<=e.length-1;C++){p.x=e[C].x*M,p.y=e[C].y,p.z=e[C].x*N,a.push(p.x,p.y,p.z),m.x=_/t,m.y=C/(e.length-1),o.push(m.x,m.y);const I=c[3*C+0]*M,P=c[3*C+1],T=c[3*C+0]*N;u.push(I,P,T)}}for(let _=0;_<t;_++)for(let b=0;b<e.length-1;b++){const M=b+_*e.length,N=M,C=M+e.length,I=M+e.length+1,P=M+1;s.push(N,C,P),s.push(I,P,C)}this.setIndex(s),this.setAttribute("position",new wt(a,3)),this.setAttribute("uv",new wt(o,2)),this.setAttribute("normal",new wt(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cx(e.points,e.segments,e.phiStart,e.phiLength)}}class Rf extends zo{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Rf(e.radius,e.detail)}}class Ho extends jt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(r),c=Math.floor(i),u=o+1,f=c+1,p=e/o,m=t/c,g=[],y=[],S=[],w=[];for(let x=0;x<f;x++){const _=x*m-a;for(let b=0;b<u;b++){const M=b*p-s;y.push(M,-_,0),S.push(0,0,1),w.push(b/o),w.push(1-x/c)}}for(let x=0;x<c;x++)for(let _=0;_<o;_++){const b=_+u*x,M=_+u*(x+1),N=_+1+u*(x+1),C=_+1+u*x;g.push(b,M,C),g.push(M,N,C)}this.setIndex(g),this.setAttribute("position",new wt(y,3)),this.setAttribute("normal",new wt(S,3)),this.setAttribute("uv",new wt(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ho(e.width,e.height,e.widthSegments,e.heightSegments)}}class Ex extends jt{constructor(e=.5,t=1,r=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:a},r=Math.max(3,r),i=Math.max(1,i);const o=[],c=[],u=[],f=[];let p=e;const m=(t-e)/i,g=new X,y=new Te;for(let S=0;S<=i;S++){for(let w=0;w<=r;w++){const x=s+w/r*a;g.x=p*Math.cos(x),g.y=p*Math.sin(x),c.push(g.x,g.y,g.z),u.push(0,0,1),y.x=(g.x/t+1)/2,y.y=(g.y/t+1)/2,f.push(y.x,y.y)}p+=m}for(let S=0;S<i;S++){const w=S*(r+1);for(let x=0;x<r;x++){const _=x+w,b=_,M=_+r+1,N=_+r+2,C=_+1;o.push(b,M,C),o.push(M,N,C)}}this.setIndex(o),this.setAttribute("position",new wt(c,3)),this.setAttribute("normal",new wt(u,3)),this.setAttribute("uv",new wt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ex(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Tx extends jt{constructor(e=new kl([new Te(0,.5),new Te(-.5,-.5),new Te(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],a=[];let o=0,c=0;if(Array.isArray(e)===!1)u(e);else for(let f=0;f<e.length;f++)u(e[f]),this.addGroup(o,c,f),o+=c,c=0;this.setIndex(r),this.setAttribute("position",new wt(i,3)),this.setAttribute("normal",new wt(s,3)),this.setAttribute("uv",new wt(a,2));function u(f){const p=i.length/3,m=f.extractPoints(t);let g=m.shape;const y=m.holes;bs.isClockWise(g)===!1&&(g=g.reverse());for(let w=0,x=y.length;w<x;w++){const _=y[w];bs.isClockWise(_)===!0&&(y[w]=_.reverse())}const S=bs.triangulateShape(g,y);for(let w=0,x=y.length;w<x;w++){const _=y[w];g=g.concat(_)}for(let w=0,x=g.length;w<x;w++){const _=g[w];i.push(_.x,_.y,0),s.push(0,0,1),a.push(_.x,_.y)}for(let w=0,x=S.length;w<x;w++){const _=S[w],b=_[0]+p,M=_[1]+p,N=_[2]+p;r.push(b,M,N),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return jU(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];r.push(a)}return new Tx(r,e.curveSegments)}}function jU(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class If extends jt{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const c=Math.min(a+o,Math.PI);let u=0;const f=[],p=new X,m=new X,g=[],y=[],S=[],w=[];for(let x=0;x<=r;x++){const _=[],b=x/r;let M=0;x===0&&a===0?M=.5/t:x===r&&c===Math.PI&&(M=-.5/t);for(let N=0;N<=t;N++){const C=N/t;p.x=-e*Math.cos(i+C*s)*Math.sin(a+b*o),p.y=e*Math.cos(a+b*o),p.z=e*Math.sin(i+C*s)*Math.sin(a+b*o),y.push(p.x,p.y,p.z),m.copy(p).normalize(),S.push(m.x,m.y,m.z),w.push(C+M,1-b),_.push(u++)}f.push(_)}for(let x=0;x<r;x++)for(let _=0;_<t;_++){const b=f[x][_+1],M=f[x][_],N=f[x+1][_],C=f[x+1][_+1];(x!==0||a>0)&&g.push(b,M,C),(x!==r-1||c<Math.PI)&&g.push(M,N,C)}this.setIndex(g),this.setAttribute("position",new wt(y,3)),this.setAttribute("normal",new wt(S,3)),this.setAttribute("uv",new wt(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new If(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Nx extends zo{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Nx(e.radius,e.detail)}}class Rx extends jt{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],o=[],c=[],u=[],f=new X,p=new X,m=new X;for(let g=0;g<=r;g++)for(let y=0;y<=i;y++){const S=y/i*s,w=g/r*Math.PI*2;p.x=(e+t*Math.cos(w))*Math.cos(S),p.y=(e+t*Math.cos(w))*Math.sin(S),p.z=t*Math.sin(w),o.push(p.x,p.y,p.z),f.x=e*Math.cos(S),f.y=e*Math.sin(S),m.subVectors(p,f).normalize(),c.push(m.x,m.y,m.z),u.push(y/i),u.push(g/r)}for(let g=1;g<=r;g++)for(let y=1;y<=i;y++){const S=(i+1)*g+y-1,w=(i+1)*(g-1)+y-1,x=(i+1)*(g-1)+y,_=(i+1)*g+y;a.push(S,w,_),a.push(w,x,_)}this.setIndex(a),this.setAttribute("position",new wt(o,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rx(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Ix extends jt{constructor(e=1,t=.4,r=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:a},r=Math.floor(r),i=Math.floor(i);const o=[],c=[],u=[],f=[],p=new X,m=new X,g=new X,y=new X,S=new X,w=new X,x=new X;for(let b=0;b<=r;++b){const M=b/r*s*Math.PI*2;_(M,s,a,e,g),_(M+.01,s,a,e,y),w.subVectors(y,g),x.addVectors(y,g),S.crossVectors(w,x),x.crossVectors(S,w),S.normalize(),x.normalize();for(let N=0;N<=i;++N){const C=N/i*Math.PI*2,I=-t*Math.cos(C),P=t*Math.sin(C);p.x=g.x+(I*x.x+P*S.x),p.y=g.y+(I*x.y+P*S.y),p.z=g.z+(I*x.z+P*S.z),c.push(p.x,p.y,p.z),m.subVectors(p,g).normalize(),u.push(m.x,m.y,m.z),f.push(b/r),f.push(N/i)}}for(let b=1;b<=r;b++)for(let M=1;M<=i;M++){const N=(i+1)*(b-1)+(M-1),C=(i+1)*b+(M-1),I=(i+1)*b+M,P=(i+1)*(b-1)+M;o.push(N,C,P),o.push(C,I,P)}this.setIndex(o),this.setAttribute("position",new wt(c,3)),this.setAttribute("normal",new wt(u,3)),this.setAttribute("uv",new wt(f,2));function _(b,M,N,C,I){const P=Math.cos(b),T=Math.sin(b),R=N/M*b,j=Math.cos(R);I.x=C*(2+j)*.5*P,I.y=C*(2+j)*T*.5,I.z=C*Math.sin(R)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ix(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Px extends jt{constructor(e=new Rw(new X(-1,-1,0),new X(-1,1,0),new X(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new X,c=new X,u=new Te;let f=new X;const p=[],m=[],g=[],y=[];S(),this.setIndex(y),this.setAttribute("position",new wt(p,3)),this.setAttribute("normal",new wt(m,3)),this.setAttribute("uv",new wt(g,2));function S(){for(let b=0;b<t;b++)w(b);w(s===!1?t:0),_(),x()}function w(b){f=e.getPointAt(b/t,f);const M=a.normals[b],N=a.binormals[b];for(let C=0;C<=i;C++){const I=C/i*Math.PI*2,P=Math.sin(I),T=-Math.cos(I);c.x=T*M.x+P*N.x,c.y=T*M.y+P*N.y,c.z=T*M.z+P*N.z,c.normalize(),m.push(c.x,c.y,c.z),o.x=f.x+r*c.x,o.y=f.y+r*c.y,o.z=f.z+r*c.z,p.push(o.x,o.y,o.z)}}function x(){for(let b=1;b<=t;b++)for(let M=1;M<=i;M++){const N=(i+1)*(b-1)+(M-1),C=(i+1)*b+(M-1),I=(i+1)*b+M,P=(i+1)*(b-1)+M;y.push(N,C,P),y.push(C,I,P)}}function _(){for(let b=0;b<=t;b++)for(let M=0;M<=i;M++)u.x=b/t,u.y=M/i,g.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Px(new M0[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class yR extends jt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new X,s=new X;if(e.index!==null){const a=e.attributes.position,o=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:o.count,materialIndex:0}]);for(let u=0,f=c.length;u<f;++u){const p=c[u],m=p.start,g=p.count;for(let y=m,S=m+g;y<S;y+=3)for(let w=0;w<3;w++){const x=o.getX(y+w),_=o.getX(y+(w+1)%3);i.fromBufferAttribute(a,x),s.fromBufferAttribute(a,_),nE(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,c=a.count/3;o<c;o++)for(let u=0;u<3;u++){const f=3*o+u,p=3*o+(u+1)%3;i.fromBufferAttribute(a,f),s.fromBufferAttribute(a,p),nE(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new wt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function nE(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var rE=Object.freeze({__proto__:null,BoxGeometry:ic,CapsuleGeometry:bx,CircleGeometry:wx,ConeGeometry:Tf,CylinderGeometry:Ef,DodecahedronGeometry:Sx,EdgesGeometry:lR,ExtrudeGeometry:Mx,IcosahedronGeometry:Nf,LatheGeometry:Cx,OctahedronGeometry:Rf,PlaneGeometry:Ho,PolyhedronGeometry:zo,RingGeometry:Ex,ShapeGeometry:Tx,SphereGeometry:If,TetrahedronGeometry:Nx,TorusGeometry:Rx,TorusKnotGeometry:Ix,TubeGeometry:Px,WireframeGeometry:yR});class vR extends ar{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ut(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Pw extends Hr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Pf extends ar{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Oo,this.normalScale=new Te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ki,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class as extends Pf{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Te(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ft(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ut(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class _R extends ar{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ut(16777215),this.specular=new ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Oo,this.normalScale=new Te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ki,this.combine=yf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bR extends ar{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Oo,this.normalScale=new Te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class wR extends ar{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Oo,this.normalScale=new Te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class SR extends ar{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Oo,this.normalScale=new Te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ki,this.combine=yf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bw extends ar{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=z3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Lw extends ar{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class AR extends ar{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Oo,this.normalScale=new Te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class MR extends Gr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Nl(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function CR(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function U1(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,a=0;a!==r;++s){const o=t[s]*e;for(let c=0;c!==e;++c)i[a++]=n[o+c]}return i}function Dw(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let a=s[r];if(a!==void 0)if(Array.isArray(a))do a=s[r],a!==void 0&&(e.push(s.time),t.push(...a)),s=n[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[r],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do a=s[r],a!==void 0&&(e.push(s.time),t.push(a)),s=n[i++];while(s!==void 0)}function UU(n,e,t,r,i=30){const s=n.clone();s.name=e;const a=[];for(let c=0;c<s.tracks.length;++c){const u=s.tracks[c],f=u.getValueSize(),p=[],m=[];for(let g=0;g<u.times.length;++g){const y=u.times[g]*i;if(!(y<t||y>=r)){p.push(u.times[g]);for(let S=0;S<f;++S)m.push(u.values[g*f+S])}}p.length!==0&&(u.times=Nl(p,u.times.constructor),u.values=Nl(m,u.values.constructor),a.push(u))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s}function OU(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let a=0;a<i;++a){const o=t.tracks[a],c=o.ValueTypeName;if(c==="bool"||c==="string")continue;const u=n.tracks.find(function(x){return x.name===o.name&&x.ValueTypeName===c});if(u===void 0)continue;let f=0;const p=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);let m=0;const g=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=g/3);const y=o.times.length-1;let S;if(s<=o.times[0]){const x=f,_=p-f;S=o.values.slice(x,_)}else if(s>=o.times[y]){const x=y*p+f,_=x+p-f;S=o.values.slice(x,_)}else{const x=o.createInterpolant(),_=f,b=p-f;x.evaluate(s),S=x.resultBuffer.slice(_,b)}c==="quaternion"&&new vr().fromArray(S).normalize().conjugate().toArray(S);const w=u.times.length;for(let x=0;x<w;++x){const _=x*g+m;if(c==="quaternion")vr.multiplyQuaternionsFlat(u.values,_,S,0,u.values,_);else{const b=g-m*2;for(let M=0;M<b;++M)u.values[_+M]-=S[M]}}}return n.blendMode=hw,n}class zU{static convertArray(e,t){return Nl(e,t)}static isTypedArray(e){return Z3(e)}static getKeyframeOrder(e){return CR(e)}static sortedArray(e,t,r){return U1(e,t,r)}static flattenJSON(e,t,r,i){Dw(e,t,r,i)}static subclip(e,t,r,i,s=30){return UU(e,t,r,i,s)}static makeClipAdditive(e,t=0,r=e,i=30){return OU(e,t,r,i)}}class id{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let a;n:{r:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(s=i,i=t[++r],e<i)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(r=2,s=o);for(let c=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===c)break;if(i=s,s=t[--r-1],e>=s)break t}a=r,r=0;break n}break e}for(;r<a;){const o=r+a>>>1;e<t[o]?a=o:r=o+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=r[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ER extends id{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Cl,endingEnd:Cl}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,a=e+1,o=i[s],c=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case El:s=e,o=2*t-r;break;case Kh:s=i.length-2,o=t+i[s]-i[s+1];break;default:s=e,o=r}if(c===void 0)switch(this.getSettings_().endingEnd){case El:a=e,c=2*r-t;break;case Kh:a=1,c=r+i[1]-i[0];break;default:a=e-1,c=t}const u=(r-t)*.5,f=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(c-r),this._offsetPrev=s*f,this._offsetNext=a*f}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,u=c-o,f=this._offsetPrev,p=this._offsetNext,m=this._weightPrev,g=this._weightNext,y=(r-t)/(i-t),S=y*y,w=S*y,x=-m*w+2*m*S-m*y,_=(1+m)*w+(-1.5-2*m)*S+(-.5+m)*y+1,b=(-1-g)*w+(1.5+g)*S+.5*y,M=g*w-g*S;for(let N=0;N!==o;++N)s[N]=x*a[f+N]+_*a[u+N]+b*a[c+N]+M*a[p+N];return s}}class Fw extends id{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,u=c-o,f=(r-t)/(i-t),p=1-f;for(let m=0;m!==o;++m)s[m]=a[u+m]*p+a[c+m]*f;return s}}class TR extends id{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class os{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Nl(t,this.TimeBufferType),this.values=Nl(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Nl(e.times,Array),values:Nl(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new TR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Fw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ER(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ku:t=this.InterpolantFactoryMethodDiscrete;break;case ju:t=this.InterpolantFactoryMethodLinear;break;case $m:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return ct("KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ku;case this.InterpolantFactoryMethodLinear:return ju;case this.InterpolantFactoryMethodSmooth:return $m}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,a=i-1;for(;s!==i&&r[s]<e;)++s;for(;a!==-1&&r[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=r.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(It("KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(It("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const c=r[o];if(typeof c=="number"&&isNaN(c)){It("KeyframeTrack: Time is not a valid number.",this,o,c),e=!1;break}if(a!==null&&a>c){It("KeyframeTrack: Out of order keys.",this,o,c,a),e=!1;break}a=c}if(i!==void 0&&Z3(i))for(let o=0,c=i.length;o!==c;++o){const u=i[o];if(isNaN(u)){It("KeyframeTrack: Value is not a valid number.",this,o,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===$m,s=e.length-1;let a=1;for(let o=1;o<s;++o){let c=!1;const u=e[o],f=e[o+1];if(u!==f&&(o!==1||u!==e[0]))if(i)c=!0;else{const p=o*r,m=p-r,g=p+r;for(let y=0;y!==r;++y){const S=t[p+y];if(S!==t[m+y]||S!==t[g+y]){c=!0;break}}}if(c){if(o!==a){e[a]=e[o];const p=o*r,m=a*r;for(let g=0;g!==r;++g)t[m+g]=t[p+g]}++a}}if(s>0){e[a]=e[s];for(let o=s*r,c=a*r,u=0;u!==r;++u)t[c+u]=t[o+u];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}os.prototype.ValueTypeName="";os.prototype.TimeBufferType=Float32Array;os.prototype.ValueBufferType=Float32Array;os.prototype.DefaultInterpolation=ju;class sc extends os{constructor(e,t,r){super(e,t,r)}}sc.prototype.ValueTypeName="bool";sc.prototype.ValueBufferType=Array;sc.prototype.DefaultInterpolation=ku;sc.prototype.InterpolantFactoryMethodLinear=void 0;sc.prototype.InterpolantFactoryMethodSmooth=void 0;class kw extends os{constructor(e,t,r,i){super(e,t,r,i)}}kw.prototype.ValueTypeName="color";class Zl extends os{constructor(e,t,r,i){super(e,t,r,i)}}Zl.prototype.ValueTypeName="number";class NR extends id{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=(r-t)/(i-t);let u=e*o;for(let f=u+o;u!==f;u+=4)vr.slerpFlat(s,0,a,u-o,a,u,c);return s}}class ql extends os{constructor(e,t,r,i){super(e,t,r,i)}InterpolantFactoryMethodLinear(e){return new NR(this.times,this.values,this.getValueSize(),e)}}ql.prototype.ValueTypeName="quaternion";ql.prototype.InterpolantFactoryMethodSmooth=void 0;class ac extends os{constructor(e,t,r){super(e,t,r)}}ac.prototype.ValueTypeName="string";ac.prototype.ValueBufferType=Array;ac.prototype.DefaultInterpolation=ku;ac.prototype.InterpolantFactoryMethodLinear=void 0;ac.prototype.InterpolantFactoryMethodSmooth=void 0;class Ql extends os{constructor(e,t,r,i){super(e,t,r,i)}}Ql.prototype.ValueTypeName="vector";class Wu{constructor(e="",t=-1,r=[],i=cx){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Pi(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,o=r.length;a!==o;++a)t.push(GU(r[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,a=r.length;s!==a;++s)t.push(os.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,a=[];for(let o=0;o<s;o++){let c=[],u=[];c.push((o+s-1)%s,o,(o+1)%s),u.push(0,1,0);const f=CR(c);c=U1(c,1,f),u=U1(u,1,f),!i&&c[0]===0&&(c.push(s),u.push(u[0])),a.push(new Zl(".morphTargetInfluences["+t[o].name+"]",c,u).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,c=e.length;o<c;o++){const u=e[o],f=u.name.match(s);if(f&&f.length>1){const p=f[1];let m=i[p];m||(i[p]=m=[]),m.push(u)}}const a=[];for(const o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,r));return a}static parseAnimation(e,t){if(ct("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return It("AnimationClip: No animation in JSONLoader data."),null;const r=function(p,m,g,y,S){if(g.length!==0){const w=[],x=[];Dw(g,w,x,y),w.length!==0&&S.push(new p(m,w,x))}},i=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let c=e.length||-1;const u=e.hierarchy||[];for(let p=0;p<u.length;p++){const m=u[p].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const g={};let y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let S=0;S<m[y].morphTargets.length;S++)g[m[y].morphTargets[S]]=-1;for(const S in g){const w=[],x=[];for(let _=0;_!==m[y].morphTargets.length;++_){const b=m[y];w.push(b.time),x.push(b.morphTarget===S?1:0)}i.push(new Zl(".morphTargetInfluence["+S+"]",w,x))}c=g.length*a}else{const g=".bones["+t[p].name+"]";r(Ql,g+".position",m,"pos",i),r(ql,g+".quaternion",m,"rot",i),r(Ql,g+".scale",m,"scl",i)}}return i.length===0?null:new this(s,c,i,o)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let r=0;r<this.tracks.length;r++)e.push(this.tracks[r].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function HU(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Zl;case"vector":case"vector2":case"vector3":case"vector4":return Ql;case"color":return kw;case"quaternion":return ql;case"bool":case"boolean":return sc;case"string":return ac}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function GU(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=HU(n.type);if(n.times===void 0){const t=[],r=[];Dw(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Ks={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Bx{constructor(e,t,r){const i=this;let s=!1,a=0,o=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this._abortController=null,this.itemStart=function(f){o++,s===!1&&i.onStart!==void 0&&i.onStart(f,a,o),s=!0},this.itemEnd=function(f){a++,i.onProgress!==void 0&&i.onProgress(f,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(f){i.onError!==void 0&&i.onError(f)},this.resolveURL=function(f){return c?c(f):f},this.setURLModifier=function(f){return c=f,this},this.addHandler=function(f,p){return u.push(f,p),this},this.removeHandler=function(f){const p=u.indexOf(f);return p!==-1&&u.splice(p,2),this},this.getHandler=function(f){for(let p=0,m=u.length;p<m;p+=2){const g=u[p],y=u[p+1];if(g.global&&(g.lastIndex=0),g.test(f))return y}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const cu=new Bx;let Mr=class{constructor(e){this.manager=e!==void 0?e:cu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}};Mr.DEFAULT_MATERIAL_NAME="__DEFAULT";const fa={};class VU extends Error{constructor(e,t){super(e),this.response=t}}class Sr extends Mr{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Ks.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(fa[e]!==void 0){fa[e].push({onLoad:t,onProgress:r,onError:i});return}fa[e]=[],fa[e].push({onLoad:t,onProgress:r,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),o=this.mimeType,c=this.responseType;fetch(a).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&ct("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const f=fa[e],p=u.body.getReader(),m=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),g=m?parseInt(m):0,y=g!==0;let S=0;const w=new ReadableStream({start(x){_();function _(){p.read().then(({done:b,value:M})=>{if(b)x.close();else{S+=M.byteLength;const N=new ProgressEvent("progress",{lengthComputable:y,loaded:S,total:g});for(let C=0,I=f.length;C<I;C++){const P=f[C];P.onProgress&&P.onProgress(N)}x.enqueue(M),_()}},b=>{x.error(b)})}}});return new Response(w)}else throw new VU(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(c){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(f=>new DOMParser().parseFromString(f,o));case"json":return u.json();default:if(o==="")return u.text();{const p=/charset="?([^;"\s]*)"?/i.exec(o),m=p&&p[1]?p[1].toLowerCase():void 0,g=new TextDecoder(m);return u.arrayBuffer().then(y=>g.decode(y))}}}).then(u=>{Ks.add(`file:${e}`,u);const f=fa[e];delete fa[e];for(let p=0,m=f.length;p<m;p++){const g=f[p];g.onLoad&&g.onLoad(u)}}).catch(u=>{const f=fa[e];if(f===void 0)throw this.manager.itemError(e),u;delete fa[e];for(let p=0,m=f.length;p<m;p++){const g=f[p];g.onError&&g.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class WU extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Sr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(c){i?i(c):It(c),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=Wu.parse(e[r]);t.push(i)}return t}}class XU extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=this,a=[],o=new _x,c=new Sr(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let u=0;function f(p){c.load(e[p],function(m){const g=s.parse(m,!0);a[p]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},u+=1,u===6&&(g.mipmapCount===1&&(o.minFilter=en),o.image=a,o.format=g.format,o.needsUpdate=!0,t&&t(o))},r,i)}if(Array.isArray(e))for(let p=0,m=e.length;p<m;++p)f(p);else c.load(e,function(p){const m=s.parse(p,!0);if(m.isCubemap){const g=m.mipmaps.length/m.mipmapCount;for(let y=0;y<g;y++){a[y]={mipmaps:[]};for(let S=0;S<m.mipmapCount;S++)a[y].mipmaps.push(m.mipmaps[y*m.mipmapCount+S]),a[y].format=m.format,a[y].width=m.width,a[y].height=m.height}o.image=a}else o.image.width=m.width,o.image.height=m.height,o.mipmaps=m.mipmaps;m.mipmapCount===1&&(o.minFilter=en),o.format=m.format,o.needsUpdate=!0,t&&t(o)},r,i);return o}}const Oc=new WeakMap;class rf extends Mr{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Ks.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let p=Oc.get(a);p===void 0&&(p=[],Oc.set(a,p)),p.push({onLoad:t,onError:i})}return a}const o=Qh("img");function c(){f(),t&&t(this);const p=Oc.get(this)||[];for(let m=0;m<p.length;m++){const g=p[m];g.onLoad&&g.onLoad(this)}Oc.delete(this),s.manager.itemEnd(e)}function u(p){f(),i&&i(p),Ks.remove(`image:${e}`);const m=Oc.get(this)||[];for(let g=0;g<m.length;g++){const y=m[g];y.onError&&y.onError(p)}Oc.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){o.removeEventListener("load",c,!1),o.removeEventListener("error",u,!1)}return o.addEventListener("load",c,!1),o.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),Ks.add(`image:${e}`,o),s.manager.itemStart(e),o.src=e,o}}class RR extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=new Sf;s.colorSpace=qr;const a=new rf(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function c(u){a.load(e[u],function(f){s.images[u]=f,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let u=0;u<e.length;++u)c(u);return s}}class jw extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new rs,o=new Sr(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(c){let u;try{u=s.parse(c)}catch(f){if(i!==void 0)i(f);else{f(f);return}}u.image!==void 0?a.image=u.image:u.data!==void 0&&(a.image.width=u.width,a.image.height=u.height,a.image.data=u.data),a.wrapS=u.wrapS!==void 0?u.wrapS:Pn,a.wrapT=u.wrapT!==void 0?u.wrapT:Pn,a.magFilter=u.magFilter!==void 0?u.magFilter:en,a.minFilter=u.minFilter!==void 0?u.minFilter:en,a.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(a.colorSpace=u.colorSpace),u.flipY!==void 0&&(a.flipY=u.flipY),u.format!==void 0&&(a.format=u.format),u.type!==void 0&&(a.type=u.type),u.mipmaps!==void 0&&(a.mipmaps=u.mipmaps,a.minFilter=es),u.mipmapCount===1&&(a.minFilter=en),u.generateMipmaps!==void 0&&(a.generateMipmaps=u.generateMipmaps),a.needsUpdate=!0,t&&t(a,u)},r,i),a}}class IR extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=new pn,a=new rf(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class Go extends sn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ut(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class PR extends Go{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ut(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const Qv=new Dt,iE=new X,sE=new X;class Uw{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Te(512,512),this.mapType=gr,this.map=null,this.mapPass=null,this.matrix=new Dt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rd,this._frameExtents=new Te(1,1),this._viewportCount=1,this._viewports=[new yn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;iE.setFromMatrixPosition(e.matrixWorld),t.position.copy(iE),sE.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(sE),t.updateMatrixWorld(),Qv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Qv,t.coordinateSystem,t.reversedDepth),t.reversedDepth?r.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Qv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class JU extends Uw{constructor(){super(new Cn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,r=zu*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Ow extends Go{constructor(e,t,r=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.distance=r,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new JU}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class YU extends Uw{constructor(){super(new Cn(90,1,.5,500)),this.isPointLightShadow=!0}}class zw extends Go{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new YU}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Bi extends wf{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+t,c=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,a=s+u*this.view.width,o-=f*this.view.offsetY,c=o-f*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class KU extends Uw{constructor(){super(new Bi(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Hw extends Go{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.shadow=new KU}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class BR extends Go{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class LR extends Go{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Gw{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new X)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],1.092548*(r*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(r*s)),t.addScaledVector(a[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*r),t.addScaledVector(a[4],2*.429043*r*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*r*s),t.addScaledVector(a[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class DR extends Go{constructor(e=new Gw,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Lx extends Mr{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,a=new Sr(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(c){i?i(c):It(c),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&ct("MaterialLoader: Undefined texture",s),t[s]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new ut().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(i.allowOverride=e.allowOverride),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=r(a.value);break;case"c":i.uniforms[s].value=new ut().setHex(a.value);break;case"v2":i.uniforms[s].value=new Te().fromArray(a.value);break;case"v3":i.uniforms[s].value=new X().fromArray(a.value);break;case"v4":i.uniforms[s].value=new yn().fromArray(a.value);break;case"m3":i.uniforms[s].value=new Vt().fromArray(a.value);break;case"m4":i.uniforms[s].value=new Dt().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Te().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Te().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Lx.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:vR,SpriteMaterial:_w,RawShaderMaterial:Pw,ShaderMaterial:Hr,PointsMaterial:vx,MeshPhysicalMaterial:as,MeshStandardMaterial:Pf,MeshPhongMaterial:_R,MeshToonMaterial:bR,MeshNormalMaterial:wR,MeshLambertMaterial:SR,MeshDepthMaterial:Bw,MeshDistanceMaterial:Lw,MeshBasicMaterial:pi,MeshMatcapMaterial:AR,LineDashedMaterial:MR,LineBasicMaterial:Gr,Material:ar};return new t[e]}}class Mo{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class FR extends jt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class kR extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Sr(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(c){i?i(c):It(c),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(g,y){if(t[y]!==void 0)return t[y];const w=g.interleavedBuffers[y],x=s(g,w.buffer),_=lu(w.type,x),b=new Mf(_,w.stride);return b.uuid=w.uuid,t[y]=b,b}function s(g,y){if(r[y]!==void 0)return r[y];const w=g.arrayBuffers[y],x=new Uint32Array(w).buffer;return r[y]=x,x}const a=e.isInstancedBufferGeometry?new FR:new jt,o=e.data.index;if(o!==void 0){const g=lu(o.type,o.array);a.setIndex(new ln(g,1))}const c=e.data.attributes;for(const g in c){const y=c[g];let S;if(y.isInterleavedBufferAttribute){const w=i(e.data,y.data);S=new Bo(w,y.itemSize,y.offset,y.normalized)}else{const w=lu(y.type,y.array),x=y.isInstancedBufferAttribute?Yl:ln;S=new x(w,y.itemSize,y.normalized)}y.name!==void 0&&(S.name=y.name),y.usage!==void 0&&S.setUsage(y.usage),a.setAttribute(g,S)}const u=e.data.morphAttributes;if(u)for(const g in u){const y=u[g],S=[];for(let w=0,x=y.length;w<x;w++){const _=y[w];let b;if(_.isInterleavedBufferAttribute){const M=i(e.data,_.data);b=new Bo(M,_.itemSize,_.offset,_.normalized)}else{const M=lu(_.type,_.array);b=new ln(M,_.itemSize,_.normalized)}_.name!==void 0&&(b.name=_.name),S.push(b)}a.morphAttributes[g]=S}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let g=0,y=p.length;g!==y;++g){const S=p[g];a.addGroup(S.start,S.count,S.materialIndex)}const m=e.data.boundingSphere;return m!==void 0&&(a.boundingSphere=new sr().fromJSON(m)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class ZU extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=this,a=this.path===""?Mo.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new Sr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){let u=null;try{u=JSON.parse(c)}catch(p){i!==void 0&&i(p),p("ObjectLoader: Can't parse "+e+".",p.message);return}const f=u.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),It("ObjectLoader: Can't load "+e);return}s.parse(u,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?Mo.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Sr(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),o=JSON.parse(a),c=o.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(o)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(u)}),o=this.parseTextures(e.textures,a),c=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,s,c,o,r),f=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,f),this.bindLightTargets(u),t!==void 0){let p=!1;for(const m in a)if(a[m].data instanceof HTMLImageElement){p=!0;break}p===!1&&t(u)}return u}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,i,o,a,t),u=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,u),this.bindLightTargets(c),c}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new kl().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new Cf().fromJSON(e[s],i);r[o.uuid]=o}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new kR;for(let s=0,a=e.length;s<a;s++){let o;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(c);break;default:c.type in rE?o=rE[c.type].fromJSON(c,t):ct(`ObjectLoader: Unsupported geometry type "${c.type}"`)}o.uuid=c.uuid,c.name!==void 0&&(o.name=c.name),c.userData!==void 0&&(o.userData=c.userData),r[c.uuid]=o}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new Lx;s.setTextures(t);for(let a=0,o=e.length;a<o;a++){const c=e[a];r[c.uuid]===void 0&&(r[c.uuid]=s.parse(c)),i[c.uuid]=r[c.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=Wu.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function a(c){return r.manager.itemStart(c),s.load(c,function(){r.manager.itemEnd(c)},void 0,function(){r.manager.itemError(c),r.manager.itemEnd(c)})}function o(c){if(typeof c=="string"){const u=c,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:r.resourcePath+u;return a(f)}else return c.data?{data:lu(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new Bx(t);s=new rf(c),s.setCrossOrigin(this.crossOrigin);for(let u=0,f=e.length;u<f;u++){const p=e[u],m=p.url;if(Array.isArray(m)){const g=[];for(let y=0,S=m.length;y<S;y++){const w=m[y],x=o(w);x!==null&&(x instanceof HTMLImageElement?g.push(x):g.push(new rs(x.data,x.width,x.height)))}i[p.uuid]=new fo(g)}else{const g=o(p.url);i[p.uuid]=new fo(g)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(a){if(typeof a=="string"){const o=a,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await i.loadAsync(c)}else return a.data?{data:lu(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new rf(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const c=e[a],u=c.url;if(Array.isArray(u)){const f=[];for(let p=0,m=u.length;p<m;p++){const g=u[p],y=await s(g);y!==null&&(y instanceof HTMLImageElement?f.push(y):f.push(new rs(y.data,y.width,y.height)))}r[c.uuid]=new fo(f)}else{const f=await s(c.url);r[c.uuid]=new fo(f)}}}return r}parseTextures(e,t){function r(s,a){return typeof s=="number"?s:(ct("ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&ct('ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&ct("ObjectLoader: Undefined image",o.image);const c=t[o.image],u=c.data;let f;Array.isArray(u)?(f=new Sf,u.length===6&&(f.needsUpdate=!0)):(u&&u.data?f=new rs:f=new pn,u&&(f.needsUpdate=!0)),f.source=c,f.uuid=o.uuid,o.name!==void 0&&(f.name=o.name),o.mapping!==void 0&&(f.mapping=r(o.mapping,qU)),o.channel!==void 0&&(f.channel=o.channel),o.offset!==void 0&&f.offset.fromArray(o.offset),o.repeat!==void 0&&f.repeat.fromArray(o.repeat),o.center!==void 0&&f.center.fromArray(o.center),o.rotation!==void 0&&(f.rotation=o.rotation),o.wrap!==void 0&&(f.wrapS=r(o.wrap[0],aE),f.wrapT=r(o.wrap[1],aE)),o.format!==void 0&&(f.format=o.format),o.internalFormat!==void 0&&(f.internalFormat=o.internalFormat),o.type!==void 0&&(f.type=o.type),o.colorSpace!==void 0&&(f.colorSpace=o.colorSpace),o.minFilter!==void 0&&(f.minFilter=r(o.minFilter,oE)),o.magFilter!==void 0&&(f.magFilter=r(o.magFilter,oE)),o.anisotropy!==void 0&&(f.anisotropy=o.anisotropy),o.flipY!==void 0&&(f.flipY=o.flipY),o.generateMipmaps!==void 0&&(f.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(f.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(f.compareFunction=o.compareFunction),o.userData!==void 0&&(f.userData=o.userData),i[o.uuid]=f}return i}parseObject(e,t,r,i,s){let a;function o(m){return t[m]===void 0&&ct("ObjectLoader: Undefined geometry",m),t[m]}function c(m){if(m!==void 0){if(Array.isArray(m)){const g=[];for(let y=0,S=m.length;y<S;y++){const w=m[y];r[w]===void 0&&ct("ObjectLoader: Undefined material",w),g.push(r[w])}return g}return r[m]===void 0&&ct("ObjectLoader: Undefined material",m),r[m]}}function u(m){return i[m]===void 0&&ct("ObjectLoader: Undefined texture",m),i[m]}let f,p;switch(e.type){case"Scene":a=new Af,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new ut(e.background):a.background=u(e.background)),e.environment!==void 0&&(a.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new gx(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new mx(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Cn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Bi(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new BR(e.color,e.intensity);break;case"DirectionalLight":a=new Hw(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new zw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new LR(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Ow(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new PR(e.color,e.groundColor,e.intensity);break;case"LightProbe":const m=new Gw().fromArray(e.sh);a=new DR(m,e.intensity);break;case"SkinnedMesh":f=o(e.geometry),p=c(e.material),a=new bw(f,p),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":f=o(e.geometry),p=c(e.material),a=new Tn(f,p);break;case"InstancedMesh":f=o(e.geometry),p=c(e.material);const g=e.count,y=e.instanceMatrix,S=e.instanceColor;a=new ww(f,p,g),a.instanceMatrix=new Yl(new Float32Array(y.array),16),S!==void 0&&(a.instanceColor=new Yl(new Float32Array(S.array),S.itemSize));break;case"BatchedMesh":f=o(e.geometry),p=c(e.material),a=new sR(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,p),a.geometry=f,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(w=>{let x=null,_=null;return w.boundingBox!==void 0&&(x=new ir().fromJSON(w.boundingBox)),w.boundingSphere!==void 0&&(_=new sr().fromJSON(w.boundingSphere)),{...w,boundingBox:x,boundingSphere:_}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=u(e.matricesTexture.uuid),a._indirectTexture=u(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=u(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new sr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(a.boundingBox=new ir().fromJSON(e.boundingBox));break;case"LOD":a=new iR;break;case"Line":a=new Ra(o(e.geometry),c(e.material));break;case"LineLoop":a=new Sw(o(e.geometry),c(e.material));break;case"LineSegments":a=new Ts(o(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new Aw(o(e.geometry),c(e.material));break;case"Sprite":a=new rR(c(e.material));break;case"Group":a=new wa;break;case"Bone":a=new xx;break;default:a=new sn}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let g=0;g<m.length;g++)a.add(this.parseObject(m[g],t,r,i,s))}if(e.animations!==void 0){const m=e.animations;for(let g=0;g<m.length;g++){const y=m[g];a.animations.push(s[y])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const m=e.levels;for(let g=0;g<m.length;g++){const y=m[g],S=a.getObjectByProperty("uuid",y.object);S!==void 0&&a.addLevel(S,y.distance,y.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?ct("ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=t.target,i=e.getObjectByProperty("uuid",r);i!==void 0?t.target=i:t.target=new sn}})}}const qU={UVMapping:No,CubeReflectionMapping:Cs,CubeRefractionMapping:Ro,EquirectangularReflectionMapping:Bu,EquirectangularRefractionMapping:Yh,CubeUVReflectionMapping:nd},aE={RepeatWrapping:Io,ClampToEdgeWrapping:Pn,MirroredRepeatWrapping:Lu},oE={NearestFilter:Un,NearestMipmapNearestFilter:nx,NearestMipmapLinearFilter:Ml,LinearFilter:en,LinearMipmapNearestFilter:yu,LinearMipmapLinearFilter:es},$v=new WeakMap;class jR extends Mr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&ct("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&ct("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Ks.get(`image-bitmap:${e}`);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(u=>{if($v.has(a)===!0)i&&i($v.get(a)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(u),s.manager.itemEnd(e),u});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,o.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const c=fetch(e,o).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return Ks.add(`image-bitmap:${e}`,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){i&&i(u),$v.set(c,u),Ks.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});Ks.add(`image-bitmap:${e}`,c),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let Mm;class Vw{static getContext(){return Mm===void 0&&(Mm=new(window.AudioContext||window.webkitAudioContext)),Mm}static setContext(e){Mm=e}}class QU extends Mr{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Sr(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{const u=c.slice(0);Vw.getContext().decodeAudioData(u,function(p){t(p)}).catch(o)}catch(u){o(u)}},r,i);function o(c){i?i(c):It(c),s.manager.itemError(e)}}}const lE=new Dt,cE=new Dt,al=new Dt;class $U{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Cn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Cn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,al.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,a=t.near*Math.tan(Dl*t.fov*.5)/t.zoom;let o,c;cE.elements[12]=-i,lE.elements[12]=i,o=-a*t.aspect+s,c=a*t.aspect+s,al.elements[0]=2*t.near/(c-o),al.elements[8]=(c+o)/(c-o),this.cameraL.projectionMatrix.copy(al),o=-a*t.aspect-s,c=a*t.aspect-s,al.elements[0]=2*t.near/(c-o),al.elements[8]=(c+o)/(c-o),this.cameraR.projectionMatrix.copy(al)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cE),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(lE)}}class UR extends Cn{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class Ww{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const ol=new X,e_=new vr,eO=new X,ll=new X,cl=new X;class tO extends sn{constructor(){super(),this.type="AudioListener",this.context=Vw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Ww}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ol,e_,eO),ll.set(0,0,-1).applyQuaternion(e_),cl.set(0,1,0).applyQuaternion(e_),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(ol.x,r),t.positionY.linearRampToValueAtTime(ol.y,r),t.positionZ.linearRampToValueAtTime(ol.z,r),t.forwardX.linearRampToValueAtTime(ll.x,r),t.forwardY.linearRampToValueAtTime(ll.y,r),t.forwardZ.linearRampToValueAtTime(ll.z,r),t.upX.linearRampToValueAtTime(cl.x,r),t.upY.linearRampToValueAtTime(cl.y,r),t.upZ.linearRampToValueAtTime(cl.z,r)}else t.setPosition(ol.x,ol.y,ol.z),t.setOrientation(ll.x,ll.y,ll.z,cl.x,cl.y,cl.z)}}class OR extends sn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){ct("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){ct("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){ct("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){ct("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){ct("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(ct("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){ct("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(ct("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const ul=new X,uE=new vr,nO=new X,dl=new X;class rO extends OR{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ul,uE,nO),dl.set(0,0,1).applyQuaternion(uE);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(ul.x,r),t.positionY.linearRampToValueAtTime(ul.y,r),t.positionZ.linearRampToValueAtTime(ul.z,r),t.orientationX.linearRampToValueAtTime(dl.x,r),t.orientationY.linearRampToValueAtTime(dl.y,r),t.orientationZ.linearRampToValueAtTime(dl.z,r)}else t.setPosition(ul.x,ul.y,ul.z),t.setOrientation(dl.x,dl.y,dl.z)}}class iO{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class zR{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)r[s+o]=r[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(r,s,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(r,i,c,1-s,t)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let c=t,u=t+t;c!==u;++c)if(r[c]!==r[c+t]){o.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,a=i;s!==a;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[r+a]}_slerp(e,t,r,i){vr.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const a=this._workIndex*s;vr.multiplyQuaternionsFlat(e,a,e,t,e,r),vr.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,r,i,s){const a=1-i;for(let o=0;o!==s;++o){const c=t+o;e[c]=e[c]*a+e[r+o]*i}}_lerpAdditive(e,t,r,i,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[r+a]*i}}}const Xw="\\[\\]\\.:\\/",sO=new RegExp("["+Xw+"]","g"),Jw="[^"+Xw+"]",aO="[^"+Xw.replace("\\.","")+"]",oO=/((?:WC+[\/:])*)/.source.replace("WC",Jw),lO=/(WCOD+)?/.source.replace("WCOD",aO),cO=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Jw),uO=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Jw),dO=new RegExp("^"+oO+lO+cO+uO+"$"),hO=["material","materials","bones","map"];class fO{constructor(e,t,r){const i=r||an.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class an{constructor(e,t,r){this.path=t,this.parsedPath=r||an.parseTrackName(t),this.node=an.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new an.Composite(e,t,r):new an(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(sO,"")}static parseTrackName(e){const t=dO.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);hO.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const c=r(o.children);if(c)return c}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=an.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){ct("PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){It("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){It("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){It("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===u){u=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){It("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){It("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){It("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){It("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const a=e[i];if(a===void 0){const u=t.nodeName;It("PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){It("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){It("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}an.Composite=fO;an.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};an.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};an.prototype.GetterByBindingType=[an.prototype._getValue_direct,an.prototype._getValue_array,an.prototype._getValue_arrayElement,an.prototype._getValue_toArray];an.prototype.SetterByBindingTypeAndVersioning=[[an.prototype._setValue_direct,an.prototype._setValue_direct_setNeedsUpdate,an.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[an.prototype._setValue_array,an.prototype._setValue_array_setNeedsUpdate,an.prototype._setValue_array_setMatrixWorldNeedsUpdate],[an.prototype._setValue_arrayElement,an.prototype._setValue_arrayElement_setNeedsUpdate,an.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[an.prototype._setValue_fromArray,an.prototype._setValue_fromArray_setNeedsUpdate,an.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class pO{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Pi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let o,c=e.length,u=this.nCachedObjects_;for(let f=0,p=arguments.length;f!==p;++f){const m=arguments[f],g=m.uuid;let y=t[g];if(y===void 0){y=c++,t[g]=y,e.push(m);for(let S=0,w=a;S!==w;++S)s[S].push(new an(m,r[S],i[S]))}else if(y<u){o=e[y];const S=--u,w=e[S];t[w.uuid]=y,e[y]=w,t[g]=S,e[S]=m;for(let x=0,_=a;x!==_;++x){const b=s[x],M=b[S];let N=b[y];b[y]=M,N===void 0&&(N=new an(m,r[x],i[x])),b[S]=N}}else e[y]!==o&&It("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const c=arguments[a],u=c.uuid,f=t[u];if(f!==void 0&&f>=s){const p=s++,m=e[p];t[m.uuid]=f,e[f]=m,t[u]=p,e[p]=c;for(let g=0,y=i;g!==y;++g){const S=r[g],w=S[p],x=S[f];S[f]=w,S[p]=x}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,c=arguments.length;o!==c;++o){const u=arguments[o],f=u.uuid,p=t[f];if(p!==void 0)if(delete t[f],p<s){const m=--s,g=e[m],y=--a,S=e[y];t[g.uuid]=p,e[p]=g,t[S.uuid]=m,e[m]=S,e.pop();for(let w=0,x=i;w!==x;++w){const _=r[w],b=_[m],M=_[y];_[p]=b,_[m]=M,_.pop()}}else{const m=--a,g=e[m];m>0&&(t[g.uuid]=p),e[p]=g,e.pop();for(let y=0,S=i;y!==S;++y){const w=r[y];w[p]=w[m],w.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,o=this._parsedPaths,c=this._objects,u=c.length,f=this.nCachedObjects_,p=new Array(u);i=s.length,r[e]=i,a.push(e),o.push(t),s.push(p);for(let m=f,g=c.length;m!==g;++m){const y=c[m];p[m]=new an(y,e,t)}return p}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,c=a[o],u=e[o];t[u]=r,a[r]=c,a.pop(),s[r]=s[o],s.pop(),i[r]=i[o],i.pop()}}}class HR{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,a=s.length,o=new Array(a),c={endingStart:Cl,endingEnd:Cl};for(let u=0;u!==a;++u){const f=s[u].createInterpolant(null);o[u]=f,f.settings=c}this._interpolantSettings=c,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=j3,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r=!1){if(e.fadeOut(t),this.fadeIn(t),r===!0){const i=this._clip.duration,s=e._clip.duration,a=s/i,o=i/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,r=!1){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const c=o.parameterPositions,u=o.sampleValues;return c[0]=s,c[1]=s+r,u[0]=e/a,u[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*r;c<0||r===0?t=0:(this._startTime=null,t=r*c)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const c=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case hw:for(let f=0,p=c.length;f!==p;++f)c[f].evaluate(a),u[f].accumulateAdditive(o);break;case cx:default:for(let f=0,p=c.length;f!==p;++f)c[f].evaluate(a),u[f].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const a=r===U3;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(r===k3){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const o=Math.floor(i/t);i-=t*o,s+=Math.abs(o);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=El,i.endingEnd=El):(e?i.endingStart=this.zeroSlopeAtStart?El:Cl:i.endingStart=Kh,t?i.endingEnd=this.zeroSlopeAtEnd?El:Cl:i.endingEnd=Kh)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,c=a.sampleValues;return o[0]=s,c[0]=t,o[1]=s+e,c[1]=r,this}}const mO=new Float32Array(1);class gO extends ta{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,o=e._interpolants,c=r.uuid,u=this._bindingsByRootAndName;let f=u[c];f===void 0&&(f={},u[c]=f);for(let p=0;p!==s;++p){const m=i[p],g=m.name;let y=f[g];if(y!==void 0)++y.referenceCount,a[p]=y;else{if(y=a[p],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,c,g));continue}const S=t&&t._propertyBindings[p].binding.parsedPath;y=new zR(an.create(r,g,S),m.ValueTypeName,m.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,c,g),a[p]=y}o[p].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],c=o.knownActions,u=c[c.length-1],f=e._byClipCacheIndex;u._byClipCacheIndex=f,c[f]=u,c.pop(),e._byClipCacheIndex=null;const p=o.actionByRoot,m=(e._localRoot||this._root).uuid;delete p[m],c.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,a=this._bindingsByRootAndName,o=a[i],c=t[t.length-1],u=e._cacheIndex;c._cacheIndex=u,t[u]=c,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new Fw(new Float32Array(2),new Float32Array(2),1,mO),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?Wu.findByName(i,e):e;const o=a!==null?a.uuid:e,c=this._actionsByClip[o];let u=null;if(r===void 0&&(a!==null?r=a.blendMode:r=cx),c!==void 0){const p=c.actionByRoot[s];if(p!==void 0&&p.blendMode===r)return p;u=c.knownActions[0],a===null&&(a=u._clip)}if(a===null)return null;const f=new HR(this,a,t,r);return this._bindAction(f,u),this._addInactiveAction(f,o,s),f}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?Wu.findByName(r,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let u=0;u!==r;++u)t[u]._update(i,e,s,a);const o=this._bindings,c=this._nActiveBindings;for(let u=0;u!==c;++u)o[u].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const a=s.knownActions;for(let o=0,c=a.length;o!==c;++o){const u=a[o];this._deactivateAction(u);const f=u._cacheIndex,p=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,p._cacheIndex=f,t[f]=p,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const a in r){const o=r[a].actionByRoot,c=o[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class xO extends gw{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isRenderTarget3D=!0,this.depth=r,this.texture=new fx(null,e,t,r),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class Yw{constructor(e){this.value=e}clone(){return new Yw(this.value.clone===void 0?this.value:this.value.clone())}}let yO=0;class vO extends ta{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:yO++}),this.name="",this.usage=qh,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class _O extends Mf{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class bO{constructor(e,t,r,i,s,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.normalized=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const dE=new Dt;class Kw{constructor(e,t,r=0,i=1/0){this.ray=new rc(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new Fl,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):It("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return dE.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(dE),this}intersectObject(e,t=!0,r=[]){return O1(e,this,r,t),r.sort(hE),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)O1(e[i],this,r,t);return r.sort(hE),r}}function hE(n,e){return n.distance-e.distance}function O1(n,e,t,r){let i=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(i=!1),i===!0&&r===!0){const s=n.children;for(let a=0,o=s.length;a<o;a++)O1(s[a],e,t,!0)}}class wO{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=SO.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function SO(){this._document.hidden===!1&&this.reset()}class z1{constructor(e=1,t=0,r=0){this.radius=e,this.phi=t,this.theta=r}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Ft(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Ft(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class AO{constructor(e=1,t=0,r=0){this.radius=e,this.theta=t,this.y=r}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}class Zw{constructor(e,t,r,i){Zw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,r,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let r=0;r<4;r++)this.elements[r]=e[r+t];return this}set(e,t,r,i){const s=this.elements;return s[0]=e,s[2]=t,s[1]=r,s[3]=i,this}}const fE=new Te;class MO{constructor(e=new Te(1/0,1/0),t=new Te(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=fE.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fE).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const pE=new X,Cm=new X,zc=new X,Hc=new X,t_=new X,CO=new X,EO=new X;class TO{constructor(e=new X,t=new X){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){pE.subVectors(e,this.start),Cm.subVectors(this.end,this.start);const r=Cm.dot(Cm);let s=Cm.dot(pE)/r;return t&&(s=Ft(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}distanceSqToLine3(e,t=CO,r=EO){const i=10000000000000001e-32;let s,a;const o=this.start,c=e.start,u=this.end,f=e.end;zc.subVectors(u,o),Hc.subVectors(f,c),t_.subVectors(o,c);const p=zc.dot(zc),m=Hc.dot(Hc),g=Hc.dot(t_);if(p<=i&&m<=i)return t.copy(o),r.copy(c),t.sub(r),t.dot(t);if(p<=i)s=0,a=g/m,a=Ft(a,0,1);else{const y=zc.dot(t_);if(m<=i)a=0,s=Ft(-y/p,0,1);else{const S=zc.dot(Hc),w=p*m-S*S;w!==0?s=Ft((S*g-y*m)/w,0,1):s=0,a=(S*s+g)/m,a<0?(a=0,s=Ft(-y/p,0,1)):a>1&&(a=1,s=Ft((S-y)/p,0,1))}}return t.copy(o).add(zc.multiplyScalar(s)),r.copy(c).add(Hc.multiplyScalar(a)),t.sub(r),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const mE=new X;class NO extends sn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new jt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,c=32;a<c;a++,o++){const u=a/c*Math.PI*2,f=o/c*Math.PI*2;i.push(Math.cos(u),Math.sin(u),1,Math.cos(f),Math.sin(f),1)}r.setAttribute("position",new wt(i,3));const s=new Gr({fog:!1,toneMapped:!1});this.cone=new Ts(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),mE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(mE),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Qa=new X,Em=new Dt,n_=new Dt;class RO extends Ts{constructor(e){const t=GR(e),r=new jt,i=[],s=[];for(let u=0;u<t.length;u++){const f=t[u];f.parent&&f.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}r.setAttribute("position",new wt(i,3)),r.setAttribute("color",new wt(s,3));const a=new Gr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const o=new ut(255),c=new ut(65280);this.setColors(o,c)}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");n_.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(Em.multiplyMatrices(n_,o.matrixWorld),Qa.setFromMatrixPosition(Em),i.setXYZ(a,Qa.x,Qa.y,Qa.z),Em.multiplyMatrices(n_,o.parent.matrixWorld),Qa.setFromMatrixPosition(Em),i.setXYZ(a+1,Qa.x,Qa.y,Qa.z),a+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const i=this.geometry.getAttribute("color");for(let s=0;s<i.count;s+=2)i.setXYZ(s,e.r,e.g,e.b),i.setXYZ(s+1,t.r,t.g,t.b);return i.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function GR(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push(...GR(n.children[t]));return e}class IO extends Tn{constructor(e,t,r){const i=new If(t,4,2),s=new pi({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const PO=new X,gE=new ut,xE=new ut;class BO extends sn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new Rf(t);i.rotateY(Math.PI*.5),this.material=new pi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new ln(a,3)),this.add(new Tn(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");gE.copy(this.light.color),xE.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?gE:xE;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(PO.setFromMatrixPosition(this.light.matrixWorld).negate())}}class LO extends Ts{constructor(e=10,t=10,r=4473924,i=8947848){r=new ut(r),i=new ut(i);const s=t/2,a=e/t,o=e/2,c=[],u=[];for(let m=0,g=0,y=-o;m<=t;m++,y+=a){c.push(-o,0,y,o,0,y),c.push(y,0,-o,y,0,o);const S=m===s?r:i;S.toArray(u,g),g+=3,S.toArray(u,g),g+=3,S.toArray(u,g),g+=3,S.toArray(u,g),g+=3}const f=new jt;f.setAttribute("position",new wt(c,3)),f.setAttribute("color",new wt(u,3));const p=new Gr({vertexColors:!0,toneMapped:!1});super(f,p),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class DO extends Ts{constructor(e=10,t=16,r=8,i=64,s=4473924,a=8947848){s=new ut(s),a=new ut(a);const o=[],c=[];if(t>1)for(let p=0;p<t;p++){const m=p/t*(Math.PI*2),g=Math.sin(m)*e,y=Math.cos(m)*e;o.push(0,0,0),o.push(g,0,y);const S=p&1?s:a;c.push(S.r,S.g,S.b),c.push(S.r,S.g,S.b)}for(let p=0;p<r;p++){const m=p&1?s:a,g=e-e/r*p;for(let y=0;y<i;y++){let S=y/i*(Math.PI*2),w=Math.sin(S)*g,x=Math.cos(S)*g;o.push(w,0,x),c.push(m.r,m.g,m.b),S=(y+1)/i*(Math.PI*2),w=Math.sin(S)*g,x=Math.cos(S)*g,o.push(w,0,x),c.push(m.r,m.g,m.b)}}const u=new jt;u.setAttribute("position",new wt(o,3)),u.setAttribute("color",new wt(c,3));const f=new Gr({vertexColors:!0,toneMapped:!1});super(u,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const yE=new X,Tm=new X,vE=new X;class FO extends sn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new jt;i.setAttribute("position",new wt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Gr({fog:!1,toneMapped:!1});this.lightPlane=new Ra(i,s),this.add(this.lightPlane),i=new jt,i.setAttribute("position",new wt([0,0,0,0,0,1],3)),this.targetLine=new Ra(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),yE.setFromMatrixPosition(this.light.matrixWorld),Tm.setFromMatrixPosition(this.light.target.matrixWorld),vE.subVectors(Tm,yE),this.lightPlane.lookAt(Tm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Tm),this.targetLine.scale.z=vE.length()}}const Nm=new X,kn=new wf;class kO extends Ts{constructor(e){const t=new jt,r=new Gr({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(y,S){c(y),c(S)}function c(y){i.push(0,0,0),s.push(0,0,0),a[y]===void 0&&(a[y]=[]),a[y].push(i.length/3-1)}t.setAttribute("position",new wt(i,3)),t.setAttribute("color",new wt(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const u=new ut(16755200),f=new ut(16711680),p=new ut(43775),m=new ut(16777215),g=new ut(3355443);this.setColors(u,f,p,m,g)}setColors(e,t,r,i,s){const o=this.geometry.getAttribute("color");return o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,r.r,r.g,r.b),o.setXYZ(33,r.r,r.g,r.b),o.setXYZ(34,r.r,r.g,r.b),o.setXYZ(35,r.r,r.g,r.b),o.setXYZ(36,r.r,r.g,r.b),o.setXYZ(37,r.r,r.g,r.b),o.setXYZ(38,i.r,i.g,i.b),o.setXYZ(39,i.r,i.g,i.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;let s,a;if(kn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,a=0;else if(this.camera.coordinateSystem===Ri)s=-1,a=1;else if(this.camera.coordinateSystem===Uu)s=0,a=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);Wn("c",t,e,kn,0,0,s),Wn("t",t,e,kn,0,0,a),Wn("n1",t,e,kn,-r,-i,s),Wn("n2",t,e,kn,r,-i,s),Wn("n3",t,e,kn,-r,i,s),Wn("n4",t,e,kn,r,i,s),Wn("f1",t,e,kn,-r,-i,a),Wn("f2",t,e,kn,r,-i,a),Wn("f3",t,e,kn,-r,i,a),Wn("f4",t,e,kn,r,i,a),Wn("u1",t,e,kn,r*.7,i*1.1,s),Wn("u2",t,e,kn,-r*.7,i*1.1,s),Wn("u3",t,e,kn,0,i*2,s),Wn("cf1",t,e,kn,-r,0,a),Wn("cf2",t,e,kn,r,0,a),Wn("cf3",t,e,kn,0,-i,a),Wn("cf4",t,e,kn,0,i,a),Wn("cn1",t,e,kn,-r,0,s),Wn("cn2",t,e,kn,r,0,s),Wn("cn3",t,e,kn,0,-i,s),Wn("cn4",t,e,kn,0,i,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Wn(n,e,t,r,i,s,a){Nm.set(i,s,a).unproject(r);const o=e[n];if(o!==void 0){const c=t.getAttribute("position");for(let u=0,f=o.length;u<f;u++)c.setXYZ(o[u],Nm.x,Nm.y,Nm.z)}}const Rm=new ir;class jO extends Ts{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new jt;s.setIndex(new ln(r,1)),s.setAttribute("position",new ln(i,3)),super(s,new Gr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Rm.setFromObject(this.object),Rm.isEmpty())return;const e=Rm.min,t=Rm.max,r=this.geometry.attributes.position,i=r.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class UO extends Ts{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new jt;s.setIndex(new ln(r,1)),s.setAttribute("position",new wt(i,3)),super(s,new Gr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class OO extends Ra{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new jt;a.setAttribute("position",new wt(s,3)),a.computeBoundingSphere(),super(a,new Gr({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new jt;c.setAttribute("position",new wt(o,3)),c.computeBoundingSphere(),this.add(new Tn(c,new pi({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _E=new X;let Im,r_;class zO extends sn{constructor(e=new X(0,0,1),t=new X(0,0,0),r=1,i=16776960,s=r*.2,a=s*.2){super(),this.type="ArrowHelper",Im===void 0&&(Im=new jt,Im.setAttribute("position",new wt([0,0,0,0,1,0],3)),r_=new Tf(.5,1,5,1),r_.translate(0,-.5,0)),this.position.copy(t),this.line=new Ra(Im,new Gr({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Tn(r_,new pi({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{_E.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(_E,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class HO extends Ts{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new jt;i.setAttribute("position",new wt(t,3)),i.setAttribute("color",new wt(r,3));const s=new Gr({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new ut,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class GO{constructor(){this.type="ShapePath",this.color=new ut,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new C0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,a){return this.currentPath.bezierCurveTo(e,t,r,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(x){const _=[];for(let b=0,M=x.length;b<M;b++){const N=x[b],C=new kl;C.curves=N.curves,_.push(C)}return _}function r(x,_){const b=_.length;let M=!1;for(let N=b-1,C=0;C<b;N=C++){let I=_[N],P=_[C],T=P.x-I.x,R=P.y-I.y;if(Math.abs(R)>Number.EPSILON){if(R<0&&(I=_[C],T=-T,P=_[N],R=-R),x.y<I.y||x.y>P.y)continue;if(x.y===I.y){if(x.x===I.x)return!0}else{const j=R*(x.x-I.x)-T*(x.y-I.y);if(j===0)return!0;if(j<0)continue;M=!M}}else{if(x.y!==I.y)continue;if(P.x<=x.x&&x.x<=I.x||I.x<=x.x&&x.x<=P.x)return!0}}return M}const i=bs.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,c;const u=[];if(s.length===1)return o=s[0],c=new kl,c.curves=o.curves,u.push(c),u;let f=!i(s[0].getPoints());f=e?!f:f;const p=[],m=[];let g=[],y=0,S;m[y]=void 0,g[y]=[];for(let x=0,_=s.length;x<_;x++)o=s[x],S=o.getPoints(),a=i(S),a=e?!a:a,a?(!f&&m[y]&&y++,m[y]={s:new kl,p:S},m[y].s.curves=o.curves,f&&y++,g[y]=[]):g[y].push({h:o,p:S[0]});if(!m[0])return t(s);if(m.length>1){let x=!1,_=0;for(let b=0,M=m.length;b<M;b++)p[b]=[];for(let b=0,M=m.length;b<M;b++){const N=g[b];for(let C=0;C<N.length;C++){const I=N[C];let P=!0;for(let T=0;T<m.length;T++)r(I.p,m[T].p)&&(b!==T&&_++,P?(P=!1,p[T].push(I)):x=!0);P&&p[b].push(I)}}_>0&&x===!1&&(g=p)}let w;for(let x=0,_=m.length;x<_;x++){c=m[x].s,u.push(c),w=g[x];for(let b=0,M=w.length;b<M;b++)c.holes.push(w[b].h)}return u}}class VO extends ta{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){ct("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function WO(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function XO(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function JO(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function H1(n,e,t,r){const i=YO(r);switch(t){case uw:return n*e;case _f:return n*e/i.components*i.byteLength;case bf:return n*e/i.components*i.byteLength;case Jl:return n*e*2/i.components*i.byteLength;case ox:return n*e*2/i.components*i.byteLength;case dw:return n*e*3/i.components*i.byteLength;case Yn:return n*e*4/i.components*i.byteLength;case lx:return n*e*4/i.components*i.byteLength;case yh:case vh:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case _h:case bh:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Wg:case Jg:return Math.max(n,16)*Math.max(e,8)/4;case Vg:case Xg:return Math.max(n,8)*Math.max(e,8)/2;case Yg:case Kg:case qg:case Qg:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Zg:case $g:case e0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case t0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case n0:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case r0:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case i0:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case s0:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case a0:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case o0:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case l0:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case c0:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case u0:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case d0:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case h0:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case f0:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case p0:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case m0:case g0:case x0:return Math.ceil(n/4)*Math.ceil(e/4)*16;case y0:case v0:return Math.ceil(n/4)*Math.ceil(e/4)*8;case _0:case b0:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function YO(n){switch(n){case gr:case rx:return{byteLength:1,components:1};case Du:case ix:case On:return{byteLength:2,components:1};case sx:case ax:return{byteLength:2,components:4};case Fi:case vf:case En:return{byteLength:4,components:1};case lw:case cw:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}class KO{static contain(e,t){return WO(e,t)}static cover(e,t){return XO(e,t)}static fill(e){return JO(e)}static getByteLength(e,t,r,i){return H1(e,t,r,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:td}}));typeof window<"u"&&(window.__THREE__?ct("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=td);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function VR(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function ZO(n){const e=new WeakMap;function t(o,c){const u=o.array,f=o.usage,p=u.byteLength,m=n.createBuffer();n.bindBuffer(c,m),n.bufferData(c,u,f),o.onUploadCallback();let g;if(u instanceof Float32Array)g=n.FLOAT;else if(typeof Float16Array<"u"&&u instanceof Float16Array)g=n.HALF_FLOAT;else if(u instanceof Uint16Array)o.isFloat16BufferAttribute?g=n.HALF_FLOAT:g=n.UNSIGNED_SHORT;else if(u instanceof Int16Array)g=n.SHORT;else if(u instanceof Uint32Array)g=n.UNSIGNED_INT;else if(u instanceof Int32Array)g=n.INT;else if(u instanceof Int8Array)g=n.BYTE;else if(u instanceof Uint8Array)g=n.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)g=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:m,type:g,bytesPerElement:u.BYTES_PER_ELEMENT,version:o.version,size:p}}function r(o,c,u){const f=c.array,p=c.updateRanges;if(n.bindBuffer(u,o),p.length===0)n.bufferSubData(u,0,f);else{p.sort((g,y)=>g.start-y.start);let m=0;for(let g=1;g<p.length;g++){const y=p[m],S=p[g];S.start<=y.start+y.count+1?y.count=Math.max(y.count,S.start+S.count-y.start):(++m,p[m]=S)}p.length=m+1;for(let g=0,y=p.length;g<y;g++){const S=p[g];n.bufferSubData(u,S.start*f.BYTES_PER_ELEMENT,f,S.start,S.count)}c.clearUpdateRanges()}c.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const c=e.get(o);c&&(n.deleteBuffer(c.buffer),e.delete(o))}function a(o,c){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const f=e.get(o);(!f||f.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const u=e.get(o);if(u===void 0)e.set(o,t(o,c));else if(u.version<o.version){if(u.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(u.buffer,o,c),u.version=o.version}}return{get:i,remove:s,update:a}}var qO=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,QO=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,$O=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,e5=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,t5=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,n5=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,r5=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,i5=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,s5=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,a5=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,o5=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,l5=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,c5=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,u5=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,d5=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,h5=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,f5=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,p5=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,m5=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,g5=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,x5=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,y5=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,v5=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,_5=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,b5=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,w5=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,S5=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,A5=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,M5=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,C5=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,E5="gl_FragColor = linearToOutputTexel( gl_FragColor );",T5=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,N5=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,R5=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,I5=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,P5=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,B5=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,L5=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,D5=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,F5=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,k5=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,j5=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,U5=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,O5=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,z5=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,H5=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,G5=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,V5=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,W5=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,X5=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,J5=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Y5=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,K5=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Z5=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,q5=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Q5=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,$5=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ez=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,tz=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nz=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,rz=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,iz=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,sz=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,az=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,oz=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,lz=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,cz=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,uz=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,dz=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,hz=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,fz=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,pz=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,mz=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,xz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yz=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,vz=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,_z=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,bz=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,wz=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Sz=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Az=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Mz=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Cz=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Ez=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Tz=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Nz=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Rz=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Iz=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Pz=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,Bz=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Lz=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Dz=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Fz=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,kz=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,jz=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Uz=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Oz=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,zz=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Hz=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Gz=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Vz=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Wz=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Xz=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Jz=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Yz=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Kz=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Zz=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,qz=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Qz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,$z=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,e6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,t6=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,n6=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,r6=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,i6=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,s6=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,a6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,o6=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,l6=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,c6=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,u6=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,d6=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,h6=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,f6=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,p6=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,m6=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,g6=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,x6=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,y6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,v6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_6=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,b6=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,w6=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,S6=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A6=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,M6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,C6=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,E6=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,T6=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,N6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Xt={alphahash_fragment:qO,alphahash_pars_fragment:QO,alphamap_fragment:$O,alphamap_pars_fragment:e5,alphatest_fragment:t5,alphatest_pars_fragment:n5,aomap_fragment:r5,aomap_pars_fragment:i5,batching_pars_vertex:s5,batching_vertex:a5,begin_vertex:o5,beginnormal_vertex:l5,bsdfs:c5,iridescence_fragment:u5,bumpmap_pars_fragment:d5,clipping_planes_fragment:h5,clipping_planes_pars_fragment:f5,clipping_planes_pars_vertex:p5,clipping_planes_vertex:m5,color_fragment:g5,color_pars_fragment:x5,color_pars_vertex:y5,color_vertex:v5,common:_5,cube_uv_reflection_fragment:b5,defaultnormal_vertex:w5,displacementmap_pars_vertex:S5,displacementmap_vertex:A5,emissivemap_fragment:M5,emissivemap_pars_fragment:C5,colorspace_fragment:E5,colorspace_pars_fragment:T5,envmap_fragment:N5,envmap_common_pars_fragment:R5,envmap_pars_fragment:I5,envmap_pars_vertex:P5,envmap_physical_pars_fragment:G5,envmap_vertex:B5,fog_vertex:L5,fog_pars_vertex:D5,fog_fragment:F5,fog_pars_fragment:k5,gradientmap_pars_fragment:j5,lightmap_pars_fragment:U5,lights_lambert_fragment:O5,lights_lambert_pars_fragment:z5,lights_pars_begin:H5,lights_toon_fragment:V5,lights_toon_pars_fragment:W5,lights_phong_fragment:X5,lights_phong_pars_fragment:J5,lights_physical_fragment:Y5,lights_physical_pars_fragment:K5,lights_fragment_begin:Z5,lights_fragment_maps:q5,lights_fragment_end:Q5,logdepthbuf_fragment:$5,logdepthbuf_pars_fragment:ez,logdepthbuf_pars_vertex:tz,logdepthbuf_vertex:nz,map_fragment:rz,map_pars_fragment:iz,map_particle_fragment:sz,map_particle_pars_fragment:az,metalnessmap_fragment:oz,metalnessmap_pars_fragment:lz,morphinstance_vertex:cz,morphcolor_vertex:uz,morphnormal_vertex:dz,morphtarget_pars_vertex:hz,morphtarget_vertex:fz,normal_fragment_begin:pz,normal_fragment_maps:mz,normal_pars_fragment:gz,normal_pars_vertex:xz,normal_vertex:yz,normalmap_pars_fragment:vz,clearcoat_normal_fragment_begin:_z,clearcoat_normal_fragment_maps:bz,clearcoat_pars_fragment:wz,iridescence_pars_fragment:Sz,opaque_fragment:Az,packing:Mz,premultiplied_alpha_fragment:Cz,project_vertex:Ez,dithering_fragment:Tz,dithering_pars_fragment:Nz,roughnessmap_fragment:Rz,roughnessmap_pars_fragment:Iz,shadowmap_pars_fragment:Pz,shadowmap_pars_vertex:Bz,shadowmap_vertex:Lz,shadowmask_pars_fragment:Dz,skinbase_vertex:Fz,skinning_pars_vertex:kz,skinning_vertex:jz,skinnormal_vertex:Uz,specularmap_fragment:Oz,specularmap_pars_fragment:zz,tonemapping_fragment:Hz,tonemapping_pars_fragment:Gz,transmission_fragment:Vz,transmission_pars_fragment:Wz,uv_pars_fragment:Xz,uv_pars_vertex:Jz,uv_vertex:Yz,worldpos_vertex:Kz,background_vert:Zz,background_frag:qz,backgroundCube_vert:Qz,backgroundCube_frag:$z,cube_vert:e6,cube_frag:t6,depth_vert:n6,depth_frag:r6,distance_vert:i6,distance_frag:s6,equirect_vert:a6,equirect_frag:o6,linedashed_vert:l6,linedashed_frag:c6,meshbasic_vert:u6,meshbasic_frag:d6,meshlambert_vert:h6,meshlambert_frag:f6,meshmatcap_vert:p6,meshmatcap_frag:m6,meshnormal_vert:g6,meshnormal_frag:x6,meshphong_vert:y6,meshphong_frag:v6,meshphysical_vert:_6,meshphysical_frag:b6,meshtoon_vert:w6,meshtoon_frag:S6,points_vert:A6,points_frag:M6,shadow_vert:C6,shadow_frag:E6,sprite_vert:T6,sprite_frag:N6},ft={common:{diffuse:{value:new ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vt},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vt}},envmap:{envMap:{value:null},envMapRotation:{value:new Vt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vt},normalScale:{value:new Te(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0},uvTransform:{value:new Vt}},sprite:{diffuse:{value:new ut(16777215)},opacity:{value:1},center:{value:new Te(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vt},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0}}},_s={basic:{uniforms:Yr([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.fog]),vertexShader:Xt.meshbasic_vert,fragmentShader:Xt.meshbasic_frag},lambert:{uniforms:Yr([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new ut(0)}}]),vertexShader:Xt.meshlambert_vert,fragmentShader:Xt.meshlambert_frag},phong:{uniforms:Yr([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new ut(0)},specular:{value:new ut(1118481)},shininess:{value:30}}]),vertexShader:Xt.meshphong_vert,fragmentShader:Xt.meshphong_frag},standard:{uniforms:Yr([ft.common,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.roughnessmap,ft.metalnessmap,ft.fog,ft.lights,{emissive:{value:new ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag},toon:{uniforms:Yr([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.gradientmap,ft.fog,ft.lights,{emissive:{value:new ut(0)}}]),vertexShader:Xt.meshtoon_vert,fragmentShader:Xt.meshtoon_frag},matcap:{uniforms:Yr([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,{matcap:{value:null}}]),vertexShader:Xt.meshmatcap_vert,fragmentShader:Xt.meshmatcap_frag},points:{uniforms:Yr([ft.points,ft.fog]),vertexShader:Xt.points_vert,fragmentShader:Xt.points_frag},dashed:{uniforms:Yr([ft.common,ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Xt.linedashed_vert,fragmentShader:Xt.linedashed_frag},depth:{uniforms:Yr([ft.common,ft.displacementmap]),vertexShader:Xt.depth_vert,fragmentShader:Xt.depth_frag},normal:{uniforms:Yr([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,{opacity:{value:1}}]),vertexShader:Xt.meshnormal_vert,fragmentShader:Xt.meshnormal_frag},sprite:{uniforms:Yr([ft.sprite,ft.fog]),vertexShader:Xt.sprite_vert,fragmentShader:Xt.sprite_frag},background:{uniforms:{uvTransform:{value:new Vt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Xt.background_vert,fragmentShader:Xt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Vt}},vertexShader:Xt.backgroundCube_vert,fragmentShader:Xt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Xt.cube_vert,fragmentShader:Xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Xt.equirect_vert,fragmentShader:Xt.equirect_frag},distance:{uniforms:Yr([ft.common,ft.displacementmap,{referencePosition:{value:new X},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Xt.distance_vert,fragmentShader:Xt.distance_frag},shadow:{uniforms:Yr([ft.lights,ft.fog,{color:{value:new ut(0)},opacity:{value:1}}]),vertexShader:Xt.shadow_vert,fragmentShader:Xt.shadow_frag}};_s.physical={uniforms:Yr([_s.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vt},clearcoatNormalScale:{value:new Te(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vt},sheen:{value:0},sheenColor:{value:new ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vt},transmissionSamplerSize:{value:new Te},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vt},attenuationDistance:{value:0},attenuationColor:{value:new ut(0)},specularColor:{value:new ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vt},anisotropyVector:{value:new Te},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vt}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag};const Pm={r:0,b:0,g:0},hl=new ki,R6=new Dt;function I6(n,e,t,r,i,s,a){const o=new ut(0);let c=s===!0?0:1,u,f,p=null,m=0,g=null;function y(b){let M=b.isScene===!0?b.background:null;return M&&M.isTexture&&(M=(b.backgroundBlurriness>0?t:e).get(M)),M}function S(b){let M=!1;const N=y(b);N===null?x(o,c):N&&N.isColor&&(x(N,1),M=!0);const C=n.xr.getEnvironmentBlendMode();C==="additive"?r.buffers.color.setClear(0,0,0,1,a):C==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||M)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function w(b,M){const N=y(M);N&&(N.isCubeTexture||N.mapping===nd)?(f===void 0&&(f=new Tn(new ic(1,1,1),new Hr({name:"BackgroundCubeMaterial",uniforms:Hu(_s.backgroundCube.uniforms),vertexShader:_s.backgroundCube.vertexShader,fragmentShader:_s.backgroundCube.fragmentShader,side:Ur,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(C,I,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(f)),hl.copy(M.backgroundRotation),hl.x*=-1,hl.y*=-1,hl.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&(hl.y*=-1,hl.z*=-1),f.material.uniforms.envMap.value=N,f.material.uniforms.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=M.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(R6.makeRotationFromEuler(hl)),f.material.toneMapped=nn.getTransfer(N.colorSpace)!==fn,(p!==N||m!==N.version||g!==n.toneMapping)&&(f.material.needsUpdate=!0,p=N,m=N.version,g=n.toneMapping),f.layers.enableAll(),b.unshift(f,f.geometry,f.material,0,0,null)):N&&N.isTexture&&(u===void 0&&(u=new Tn(new Ho(2,2),new Hr({name:"BackgroundMaterial",uniforms:Hu(_s.background.uniforms),vertexShader:_s.background.vertexShader,fragmentShader:_s.background.fragmentShader,side:Qs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=N,u.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,u.material.toneMapped=nn.getTransfer(N.colorSpace)!==fn,N.matrixAutoUpdate===!0&&N.updateMatrix(),u.material.uniforms.uvTransform.value.copy(N.matrix),(p!==N||m!==N.version||g!==n.toneMapping)&&(u.material.needsUpdate=!0,p=N,m=N.version,g=n.toneMapping),u.layers.enableAll(),b.unshift(u,u.geometry,u.material,0,0,null))}function x(b,M){b.getRGB(Pm,eR(n)),r.buffers.color.setClear(Pm.r,Pm.g,Pm.b,M,a)}function _(){f!==void 0&&(f.geometry.dispose(),f.material.dispose(),f=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return o},setClearColor:function(b,M=1){o.set(b),c=M,x(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(b){c=b,x(o,c)},render:S,addToRenderList:w,dispose:_}}function P6(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=m(null);let s=i,a=!1;function o(R,j,O,k,Z){let te=!1;const K=p(k,O,j);s!==K&&(s=K,u(s.object)),te=g(R,k,O,Z),te&&y(R,k,O,Z),Z!==null&&e.update(Z,n.ELEMENT_ARRAY_BUFFER),(te||a)&&(a=!1,M(R,j,O,k),Z!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(Z).buffer))}function c(){return n.createVertexArray()}function u(R){return n.bindVertexArray(R)}function f(R){return n.deleteVertexArray(R)}function p(R,j,O){const k=O.wireframe===!0;let Z=r[R.id];Z===void 0&&(Z={},r[R.id]=Z);let te=Z[j.id];te===void 0&&(te={},Z[j.id]=te);let K=te[k];return K===void 0&&(K=m(c()),te[k]=K),K}function m(R){const j=[],O=[],k=[];for(let Z=0;Z<t;Z++)j[Z]=0,O[Z]=0,k[Z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:O,attributeDivisors:k,object:R,attributes:{},index:null}}function g(R,j,O,k){const Z=s.attributes,te=j.attributes;let K=0;const $=O.getAttributes();for(const U in $)if($[U].location>=0){const W=Z[U];let Y=te[U];if(Y===void 0&&(U==="instanceMatrix"&&R.instanceMatrix&&(Y=R.instanceMatrix),U==="instanceColor"&&R.instanceColor&&(Y=R.instanceColor)),W===void 0||W.attribute!==Y||Y&&W.data!==Y.data)return!0;K++}return s.attributesNum!==K||s.index!==k}function y(R,j,O,k){const Z={},te=j.attributes;let K=0;const $=O.getAttributes();for(const U in $)if($[U].location>=0){let W=te[U];W===void 0&&(U==="instanceMatrix"&&R.instanceMatrix&&(W=R.instanceMatrix),U==="instanceColor"&&R.instanceColor&&(W=R.instanceColor));const Y={};Y.attribute=W,W&&W.data&&(Y.data=W.data),Z[U]=Y,K++}s.attributes=Z,s.attributesNum=K,s.index=k}function S(){const R=s.newAttributes;for(let j=0,O=R.length;j<O;j++)R[j]=0}function w(R){x(R,0)}function x(R,j){const O=s.newAttributes,k=s.enabledAttributes,Z=s.attributeDivisors;O[R]=1,k[R]===0&&(n.enableVertexAttribArray(R),k[R]=1),Z[R]!==j&&(n.vertexAttribDivisor(R,j),Z[R]=j)}function _(){const R=s.newAttributes,j=s.enabledAttributes;for(let O=0,k=j.length;O<k;O++)j[O]!==R[O]&&(n.disableVertexAttribArray(O),j[O]=0)}function b(R,j,O,k,Z,te,K){K===!0?n.vertexAttribIPointer(R,j,O,Z,te):n.vertexAttribPointer(R,j,O,k,Z,te)}function M(R,j,O,k){S();const Z=k.attributes,te=O.getAttributes(),K=j.defaultAttributeValues;for(const $ in te){const U=te[$];if(U.location>=0){let H=Z[$];if(H===void 0&&($==="instanceMatrix"&&R.instanceMatrix&&(H=R.instanceMatrix),$==="instanceColor"&&R.instanceColor&&(H=R.instanceColor)),H!==void 0){const W=H.normalized,Y=H.itemSize,G=e.get(H);if(G===void 0)continue;const de=G.buffer,Ce=G.type,be=G.bytesPerElement,se=Ce===n.INT||Ce===n.UNSIGNED_INT||H.gpuType===vf;if(H.isInterleavedBufferAttribute){const _e=H.data,Le=_e.stride,yt=H.offset;if(_e.isInstancedInterleavedBuffer){for(let qe=0;qe<U.locationSize;qe++)x(U.location+qe,_e.meshPerAttribute);R.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let qe=0;qe<U.locationSize;qe++)w(U.location+qe);n.bindBuffer(n.ARRAY_BUFFER,de);for(let qe=0;qe<U.locationSize;qe++)b(U.location+qe,Y/U.locationSize,Ce,W,Le*be,(yt+Y/U.locationSize*qe)*be,se)}else{if(H.isInstancedBufferAttribute){for(let _e=0;_e<U.locationSize;_e++)x(U.location+_e,H.meshPerAttribute);R.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=H.meshPerAttribute*H.count)}else for(let _e=0;_e<U.locationSize;_e++)w(U.location+_e);n.bindBuffer(n.ARRAY_BUFFER,de);for(let _e=0;_e<U.locationSize;_e++)b(U.location+_e,Y/U.locationSize,Ce,W,Y*be,Y/U.locationSize*_e*be,se)}}else if(K!==void 0){const W=K[$];if(W!==void 0)switch(W.length){case 2:n.vertexAttrib2fv(U.location,W);break;case 3:n.vertexAttrib3fv(U.location,W);break;case 4:n.vertexAttrib4fv(U.location,W);break;default:n.vertexAttrib1fv(U.location,W)}}}}_()}function N(){P();for(const R in r){const j=r[R];for(const O in j){const k=j[O];for(const Z in k)f(k[Z].object),delete k[Z];delete j[O]}delete r[R]}}function C(R){if(r[R.id]===void 0)return;const j=r[R.id];for(const O in j){const k=j[O];for(const Z in k)f(k[Z].object),delete k[Z];delete j[O]}delete r[R.id]}function I(R){for(const j in r){const O=r[j];if(O[R.id]===void 0)continue;const k=O[R.id];for(const Z in k)f(k[Z].object),delete k[Z];delete O[R.id]}}function P(){T(),a=!0,s!==i&&(s=i,u(s.object))}function T(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:P,resetDefaultState:T,dispose:N,releaseStatesOfGeometry:C,releaseStatesOfProgram:I,initAttributes:S,enableAttribute:w,disableUnusedAttributes:_}}function B6(n,e,t){let r;function i(u){r=u}function s(u,f){n.drawArrays(r,u,f),t.update(f,r,1)}function a(u,f,p){p!==0&&(n.drawArraysInstanced(r,u,f,p),t.update(f,r,p))}function o(u,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,u,0,f,0,p);let g=0;for(let y=0;y<p;y++)g+=f[y];t.update(g,r,1)}function c(u,f,p,m){if(p===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<u.length;y++)a(u[y],f[y],m[y]);else{g.multiDrawArraysInstancedWEBGL(r,u,0,f,0,m,0,p);let y=0;for(let S=0;S<p;S++)y+=f[S]*m[S];t.update(y,r,1)}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=c}function L6(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(I){return!(I!==Yn&&r.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(I){const P=I===On&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==gr&&r.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==En&&!P)}function c(I){if(I==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const f=c(u);f!==u&&(ct("WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);const p=t.logarithmicDepthBuffer===!0,m=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),g=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_TEXTURE_SIZE),w=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),x=n.getParameter(n.MAX_VERTEX_ATTRIBS),_=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),b=n.getParameter(n.MAX_VARYING_VECTORS),M=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),N=n.getParameter(n.MAX_SAMPLES),C=n.getParameter(n.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:o,precision:u,logarithmicDepthBuffer:p,reversedDepthBuffer:m,maxTextures:g,maxVertexTextures:y,maxTextureSize:S,maxCubemapSize:w,maxAttributes:x,maxVertexUniforms:_,maxVaryings:b,maxFragmentUniforms:M,maxSamples:N,samples:C}}function D6(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new Xs,o=new Vt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(p,m){const g=p.length!==0||m||r!==0||i;return i=m,r=p.length,g},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(p,m){t=f(p,m,0)},this.setState=function(p,m,g){const y=p.clippingPlanes,S=p.clipIntersection,w=p.clipShadows,x=n.get(p);if(!i||y===null||y.length===0||s&&!w)s?f(null):u();else{const _=s?0:r,b=_*4;let M=x.clippingState||null;c.value=M,M=f(y,m,b,g);for(let N=0;N!==b;++N)M[N]=t[N];x.clippingState=M,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=_}};function u(){c.value!==t&&(c.value=t,c.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function f(p,m,g,y){const S=p!==null?p.length:0;let w=null;if(S!==0){if(w=c.value,y!==!0||w===null){const x=g+S*4,_=m.matrixWorldInverse;o.getNormalMatrix(_),(w===null||w.length<x)&&(w=new Float32Array(x));for(let b=0,M=g;b!==S;++b,M+=4)a.copy(p[b]).applyMatrix4(_,o),a.normal.toArray(w,M),w[M+3]=a.constant}c.value=w,c.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,w}}function F6(n){let e=new WeakMap;function t(a,o){return o===Bu?a.mapping=Cs:o===Yh&&(a.mapping=Ro),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===Bu||o===Yh)if(e.has(a)){const c=e.get(a).texture;return t(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const u=new px(c.height);return u.fromEquirectangularTexture(n,a),e.set(a,u),a.addEventListener("dispose",i),t(u.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const c=e.get(o);c!==void 0&&(e.delete(o),c.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const po=4,bE=[.125,.215,.35,.446,.526,.582],_l=20,k6=256,Wd=new Bi,wE=new ut;let i_=null,s_=0,a_=0,o_=!1;const j6=new X;class G1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,r=.1,i=100,s={}){const{size:a=256,position:o=j6}=s;i_=this._renderer.getRenderTarget(),s_=this._renderer.getActiveCubeFace(),a_=this._renderer.getActiveMipmapLevel(),o_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,r,i,c,o),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=ME(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=AE(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(i_,s_,a_),this._renderer.xr.enabled=o_,e.scissorTest=!1,Gc(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Cs||e.mapping===Ro?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),i_=this._renderer.getRenderTarget(),s_=this._renderer.getActiveCubeFace(),a_=this._renderer.getActiveMipmapLevel(),o_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:en,minFilter:en,generateMipmaps:!1,type:On,format:Yn,colorSpace:ea,depthBuffer:!1},i=SE(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=SE(e,t,r);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=U6(s)),this._blurMaterial=z6(s,e,t),this._ggxMaterial=O6(s,e,t)}return i}_compileMaterial(e){const t=new Tn(new jt,e);this._renderer.compile(t,Wd)}_sceneToCubeUV(e,t,r,i,s){const c=new Cn(90,1,t,r),u=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],p=this._renderer,m=p.autoClear,g=p.toneMapping;p.getClearColor(wE),p.toneMapping=ns,p.autoClear=!1,p.state.buffers.depth.getReversed()&&(p.setRenderTarget(i),p.clearDepth(),p.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Tn(new ic,new pi({name:"PMREM.Background",side:Ur,depthWrite:!1,depthTest:!1})));const S=this._backgroundBox,w=S.material;let x=!1;const _=e.background;_?_.isColor&&(w.color.copy(_),e.background=null,x=!0):(w.color.copy(wE),x=!0);for(let b=0;b<6;b++){const M=b%3;M===0?(c.up.set(0,u[b],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x+f[b],s.y,s.z)):M===1?(c.up.set(0,0,u[b]),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y+f[b],s.z)):(c.up.set(0,u[b],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y,s.z+f[b]));const N=this._cubeSize;Gc(i,M*N,b>2?N:0,N,N),p.setRenderTarget(i),x&&p.render(S,c),p.render(e,c)}p.toneMapping=g,p.autoClear=m,e.background=_}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Cs||e.mapping===Ro;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=ME()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=AE());const s=i?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const c=this._cubeSize;Gc(t,0,0,3*c,2*c),r.setRenderTarget(t),r.render(a,Wd)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let s=1;s<i;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=r}_applyGGXFilter(e,t,r){const i=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[r];o.material=a;const c=a.uniforms,u=r/(this._lodMeshes.length-1),f=t/(this._lodMeshes.length-1),p=Math.sqrt(u*u-f*f),m=0+u*1.25,g=p*m,{_lodMax:y}=this,S=this._sizeLods[r],w=3*S*(r>y-po?r-y+po:0),x=4*(this._cubeSize-S);c.envMap.value=e.texture,c.roughness.value=g,c.mipInt.value=y-t,Gc(s,w,x,3*S,2*S),i.setRenderTarget(s),i.render(o,Wd),c.envMap.value=s.texture,c.roughness.value=0,c.mipInt.value=y-r,Gc(e,w,x,3*S,2*S),i.setRenderTarget(e),i.render(o,Wd)}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,o){const c=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&It("blur direction must be either latitudinal or longitudinal!");const f=3,p=this._lodMeshes[i];p.material=u;const m=u.uniforms,g=this._sizeLods[r]-1,y=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*_l-1),S=s/y,w=isFinite(s)?1+Math.floor(f*S):_l;w>_l&&ct(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${_l}`);const x=[];let _=0;for(let I=0;I<_l;++I){const P=I/S,T=Math.exp(-P*P/2);x.push(T),I===0?_+=T:I<w&&(_+=2*T)}for(let I=0;I<x.length;I++)x[I]=x[I]/_;m.envMap.value=e.texture,m.samples.value=w,m.weights.value=x,m.latitudinal.value=a==="latitudinal",o&&(m.poleAxis.value=o);const{_lodMax:b}=this;m.dTheta.value=y,m.mipInt.value=b-r;const M=this._sizeLods[i],N=3*M*(i>b-po?i-b+po:0),C=4*(this._cubeSize-M);Gc(t,N,C,3*M,2*M),c.setRenderTarget(t),c.render(p,Wd)}}function U6(n){const e=[],t=[],r=[];let i=n;const s=n-po+1+bE.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);e.push(o);let c=1/o;a>n-po?c=bE[a-n+po-1]:a===0&&(c=0),t.push(c);const u=1/(o-2),f=-u,p=1+u,m=[f,f,p,f,p,p,f,f,p,p,f,p],g=6,y=6,S=3,w=2,x=1,_=new Float32Array(S*y*g),b=new Float32Array(w*y*g),M=new Float32Array(x*y*g);for(let C=0;C<g;C++){const I=C%3*2/3-1,P=C>2?0:-1,T=[I,P,0,I+2/3,P,0,I+2/3,P+1,0,I,P,0,I+2/3,P+1,0,I,P+1,0];_.set(T,S*y*C),b.set(m,w*y*C);const R=[C,C,C,C,C,C];M.set(R,x*y*C)}const N=new jt;N.setAttribute("position",new ln(_,S)),N.setAttribute("uv",new ln(b,w)),N.setAttribute("faceIndex",new ln(M,x)),r.push(new Tn(N,null)),i>po&&i--}return{lodMeshes:r,sizeLods:e,sigmas:t}}function SE(n,e,t){const r=new ei(n,e,t);return r.texture.mapping=nd,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Gc(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function O6(n,e,t){return new Hr({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:k6,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Dx(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:As,depthTest:!1,depthWrite:!1})}function z6(n,e,t){const r=new Float32Array(_l),i=new X(0,1,0);return new Hr({name:"SphericalGaussianBlur",defines:{n:_l,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Dx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:As,depthTest:!1,depthWrite:!1})}function AE(){return new Hr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Dx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:As,depthTest:!1,depthWrite:!1})}function ME(){return new Hr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Dx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:As,depthTest:!1,depthWrite:!1})}function Dx(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function H6(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const c=o.mapping,u=c===Bu||c===Yh,f=c===Cs||c===Ro;if(u||f){let p=e.get(o);const m=p!==void 0?p.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==m)return t===null&&(t=new G1(n)),p=u?t.fromEquirectangular(o,p):t.fromCubemap(o,p),p.texture.pmremVersion=o.pmremVersion,e.set(o,p),p.texture;if(p!==void 0)return p.texture;{const g=o.image;return u&&g&&g.height>0||f&&g&&i(g)?(t===null&&(t=new G1(n)),p=u?t.fromEquirectangular(o):t.fromCubemap(o),p.texture.pmremVersion=o.pmremVersion,e.set(o,p),o.addEventListener("dispose",s),p.texture):null}}}return o}function i(o){let c=0;const u=6;for(let f=0;f<u;f++)o[f]!==void 0&&c++;return c===u}function s(o){const c=o.target;c.removeEventListener("dispose",s);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function G6(n){const e={};function t(r){if(e[r]!==void 0)return e[r];const i=n.getExtension(r);return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&Ou("WebGLRenderer: "+r+" extension not supported."),i}}}function V6(n,e,t,r){const i={},s=new WeakMap;function a(p){const m=p.target;m.index!==null&&e.remove(m.index);for(const y in m.attributes)e.remove(m.attributes[y]);m.removeEventListener("dispose",a),delete i[m.id];const g=s.get(m);g&&(e.remove(g),s.delete(m)),r.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function o(p,m){return i[m.id]===!0||(m.addEventListener("dispose",a),i[m.id]=!0,t.memory.geometries++),m}function c(p){const m=p.attributes;for(const g in m)e.update(m[g],n.ARRAY_BUFFER)}function u(p){const m=[],g=p.index,y=p.attributes.position;let S=0;if(g!==null){const _=g.array;S=g.version;for(let b=0,M=_.length;b<M;b+=3){const N=_[b+0],C=_[b+1],I=_[b+2];m.push(N,C,C,I,I,N)}}else if(y!==void 0){const _=y.array;S=y.version;for(let b=0,M=_.length/3-1;b<M;b+=3){const N=b+0,C=b+1,I=b+2;m.push(N,C,C,I,I,N)}}else return;const w=new(K3(m)?yw:xw)(m,1);w.version=S;const x=s.get(p);x&&e.remove(x),s.set(p,w)}function f(p){const m=s.get(p);if(m){const g=p.index;g!==null&&m.version<g.version&&u(p)}else u(p);return s.get(p)}return{get:o,update:c,getWireframeAttribute:f}}function W6(n,e,t){let r;function i(m){r=m}let s,a;function o(m){s=m.type,a=m.bytesPerElement}function c(m,g){n.drawElements(r,g,s,m*a),t.update(g,r,1)}function u(m,g,y){y!==0&&(n.drawElementsInstanced(r,g,s,m*a,y),t.update(g,r,y))}function f(m,g,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,g,0,s,m,0,y);let w=0;for(let x=0;x<y;x++)w+=g[x];t.update(w,r,1)}function p(m,g,y,S){if(y===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let x=0;x<m.length;x++)u(m[x]/a,g[x],S[x]);else{w.multiDrawElementsInstancedWEBGL(r,g,0,s,m,0,S,0,y);let x=0;for(let _=0;_<y;_++)x+=g[_]*S[_];t.update(x,r,1)}}this.setMode=i,this.setIndex=o,this.render=c,this.renderInstances=u,this.renderMultiDraw=f,this.renderMultiDrawInstances=p}function X6(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:It("WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function J6(n,e,t){const r=new WeakMap,i=new yn;function s(a,o,c){const u=a.morphTargetInfluences,f=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,p=f!==void 0?f.length:0;let m=r.get(o);if(m===void 0||m.count!==p){let R=function(){P.dispose(),r.delete(o),o.removeEventListener("dispose",R)};var g=R;m!==void 0&&m.texture.dispose();const y=o.morphAttributes.position!==void 0,S=o.morphAttributes.normal!==void 0,w=o.morphAttributes.color!==void 0,x=o.morphAttributes.position||[],_=o.morphAttributes.normal||[],b=o.morphAttributes.color||[];let M=0;y===!0&&(M=1),S===!0&&(M=2),w===!0&&(M=3);let N=o.attributes.position.count*M,C=1;N>e.maxTextureSize&&(C=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const I=new Float32Array(N*C*4*p),P=new hx(I,N,C,p);P.type=En,P.needsUpdate=!0;const T=M*4;for(let j=0;j<p;j++){const O=x[j],k=_[j],Z=b[j],te=N*C*4*j;for(let K=0;K<O.count;K++){const $=K*T;y===!0&&(i.fromBufferAttribute(O,K),I[te+$+0]=i.x,I[te+$+1]=i.y,I[te+$+2]=i.z,I[te+$+3]=0),S===!0&&(i.fromBufferAttribute(k,K),I[te+$+4]=i.x,I[te+$+5]=i.y,I[te+$+6]=i.z,I[te+$+7]=0),w===!0&&(i.fromBufferAttribute(Z,K),I[te+$+8]=i.x,I[te+$+9]=i.y,I[te+$+10]=i.z,I[te+$+11]=Z.itemSize===4?i.w:1)}}m={count:p,texture:P,size:new Te(N,C)},r.set(o,m),o.addEventListener("dispose",R)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let y=0;for(let w=0;w<u.length;w++)y+=u[w];const S=o.morphTargetsRelative?1:1-y;c.getUniforms().setValue(n,"morphTargetBaseInfluence",S),c.getUniforms().setValue(n,"morphTargetInfluences",u)}c.getUniforms().setValue(n,"morphTargetsTexture",m.texture,t),c.getUniforms().setValue(n,"morphTargetsTextureSize",m.size)}return{update:s}}function Y6(n,e,t,r){let i=new WeakMap;function s(c){const u=r.render.frame,f=c.geometry,p=e.get(c,f);if(i.get(p)!==u&&(e.update(p),i.set(p,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",o)===!1&&c.addEventListener("dispose",o),i.get(c)!==u&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,n.ARRAY_BUFFER),i.set(c,u))),c.isSkinnedMesh){const m=c.skeleton;i.get(m)!==u&&(m.update(),i.set(m,u))}return p}function a(){i=new WeakMap}function o(c){const u=c.target;u.removeEventListener("dispose",o),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:a}}const K6={[nw]:"LINEAR_TONE_MAPPING",[rw]:"REINHARD_TONE_MAPPING",[iw]:"CINEON_TONE_MAPPING",[tx]:"ACES_FILMIC_TONE_MAPPING",[aw]:"AGX_TONE_MAPPING",[ow]:"NEUTRAL_TONE_MAPPING",[sw]:"CUSTOM_TONE_MAPPING"};function Z6(n,e,t,r,i){const s=new ei(e,t,{type:n,depthBuffer:r,stencilBuffer:i}),a=new ei(e,t,{type:On,depthBuffer:!1,stencilBuffer:!1}),o=new jt;o.setAttribute("position",new wt([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new wt([0,2,0,0,2,0],2));const c=new Pw({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),u=new Tn(o,c),f=new Bi(-1,1,1,-1,0,1);let p=null,m=null,g=!1,y,S=null,w=[],x=!1;this.setSize=function(_,b){s.setSize(_,b),a.setSize(_,b);for(let M=0;M<w.length;M++){const N=w[M];N.setSize&&N.setSize(_,b)}},this.setEffects=function(_){w=_,x=w.length>0&&w[0].isRenderPass===!0;const b=s.width,M=s.height;for(let N=0;N<w.length;N++){const C=w[N];C.setSize&&C.setSize(b,M)}},this.begin=function(_,b){if(g||_.toneMapping===ns&&w.length===0)return!1;if(S=b,b!==null){const M=b.width,N=b.height;(s.width!==M||s.height!==N)&&this.setSize(M,N)}return x===!1&&_.setRenderTarget(s),y=_.toneMapping,_.toneMapping=ns,!0},this.hasRenderPass=function(){return x},this.end=function(_,b){_.toneMapping=y,g=!0;let M=s,N=a;for(let C=0;C<w.length;C++){const I=w[C];if(I.enabled!==!1&&(I.render(_,N,M,b),I.needsSwap!==!1)){const P=M;M=N,N=P}}if(p!==_.outputColorSpace||m!==_.toneMapping){p=_.outputColorSpace,m=_.toneMapping,c.defines={},nn.getTransfer(p)===fn&&(c.defines.SRGB_TRANSFER="");const C=K6[m];C&&(c.defines[C]=""),c.needsUpdate=!0}c.uniforms.tDiffuse.value=M.texture,_.setRenderTarget(S),_.render(u,f),S=null,g=!1},this.isCompositing=function(){return g},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),c.dispose()}}const WR=new pn,V1=new Gu(1,1),XR=new hx,JR=new fx,YR=new Sf,CE=[],EE=[],TE=new Float32Array(16),NE=new Float32Array(9),RE=new Float32Array(4);function sd(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=CE[i];if(s===void 0&&(s=new Float32Array(i),CE[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function or(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function lr(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function Fx(n,e){let t=EE[e];t===void 0&&(t=new Int32Array(e),EE[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function q6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Q6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(or(t,e))return;n.uniform2fv(this.addr,e),lr(t,e)}}function $6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(or(t,e))return;n.uniform3fv(this.addr,e),lr(t,e)}}function eH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(or(t,e))return;n.uniform4fv(this.addr,e),lr(t,e)}}function tH(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(or(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),lr(t,e)}else{if(or(t,r))return;RE.set(r),n.uniformMatrix2fv(this.addr,!1,RE),lr(t,r)}}function nH(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(or(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),lr(t,e)}else{if(or(t,r))return;NE.set(r),n.uniformMatrix3fv(this.addr,!1,NE),lr(t,r)}}function rH(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(or(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),lr(t,e)}else{if(or(t,r))return;TE.set(r),n.uniformMatrix4fv(this.addr,!1,TE),lr(t,r)}}function iH(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function sH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(or(t,e))return;n.uniform2iv(this.addr,e),lr(t,e)}}function aH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(or(t,e))return;n.uniform3iv(this.addr,e),lr(t,e)}}function oH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(or(t,e))return;n.uniform4iv(this.addr,e),lr(t,e)}}function lH(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function cH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(or(t,e))return;n.uniform2uiv(this.addr,e),lr(t,e)}}function uH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(or(t,e))return;n.uniform3uiv(this.addr,e),lr(t,e)}}function dH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(or(t,e))return;n.uniform4uiv(this.addr,e),lr(t,e)}}function hH(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(V1.compareFunction=t.isReversedDepthBuffer()?dx:ux,s=V1):s=WR,t.setTexture2D(e||s,i)}function fH(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||JR,i)}function pH(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||YR,i)}function mH(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||XR,i)}function gH(n){switch(n){case 5126:return q6;case 35664:return Q6;case 35665:return $6;case 35666:return eH;case 35674:return tH;case 35675:return nH;case 35676:return rH;case 5124:case 35670:return iH;case 35667:case 35671:return sH;case 35668:case 35672:return aH;case 35669:case 35673:return oH;case 5125:return lH;case 36294:return cH;case 36295:return uH;case 36296:return dH;case 35678:case 36198:case 36298:case 36306:case 35682:return hH;case 35679:case 36299:case 36307:return fH;case 35680:case 36300:case 36308:case 36293:return pH;case 36289:case 36303:case 36311:case 36292:return mH}}function xH(n,e){n.uniform1fv(this.addr,e)}function yH(n,e){const t=sd(e,this.size,2);n.uniform2fv(this.addr,t)}function vH(n,e){const t=sd(e,this.size,3);n.uniform3fv(this.addr,t)}function _H(n,e){const t=sd(e,this.size,4);n.uniform4fv(this.addr,t)}function bH(n,e){const t=sd(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function wH(n,e){const t=sd(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function SH(n,e){const t=sd(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function AH(n,e){n.uniform1iv(this.addr,e)}function MH(n,e){n.uniform2iv(this.addr,e)}function CH(n,e){n.uniform3iv(this.addr,e)}function EH(n,e){n.uniform4iv(this.addr,e)}function TH(n,e){n.uniform1uiv(this.addr,e)}function NH(n,e){n.uniform2uiv(this.addr,e)}function RH(n,e){n.uniform3uiv(this.addr,e)}function IH(n,e){n.uniform4uiv(this.addr,e)}function PH(n,e,t){const r=this.cache,i=e.length,s=Fx(t,i);or(r,s)||(n.uniform1iv(this.addr,s),lr(r,s));let a;this.type===n.SAMPLER_2D_SHADOW?a=V1:a=WR;for(let o=0;o!==i;++o)t.setTexture2D(e[o]||a,s[o])}function BH(n,e,t){const r=this.cache,i=e.length,s=Fx(t,i);or(r,s)||(n.uniform1iv(this.addr,s),lr(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||JR,s[a])}function LH(n,e,t){const r=this.cache,i=e.length,s=Fx(t,i);or(r,s)||(n.uniform1iv(this.addr,s),lr(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||YR,s[a])}function DH(n,e,t){const r=this.cache,i=e.length,s=Fx(t,i);or(r,s)||(n.uniform1iv(this.addr,s),lr(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||XR,s[a])}function FH(n){switch(n){case 5126:return xH;case 35664:return yH;case 35665:return vH;case 35666:return _H;case 35674:return bH;case 35675:return wH;case 35676:return SH;case 5124:case 35670:return AH;case 35667:case 35671:return MH;case 35668:case 35672:return CH;case 35669:case 35673:return EH;case 5125:return TH;case 36294:return NH;case 36295:return RH;case 36296:return IH;case 35678:case 36198:case 36298:case 36306:case 35682:return PH;case 35679:case 36299:case 36307:return BH;case 35680:case 36300:case 36308:case 36293:return LH;case 36289:case 36303:case 36311:case 36292:return DH}}class kH{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=gH(t.type)}}class jH{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=FH(t.type)}}class UH{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],r)}}}const l_=/(\w+)(\])?(\[|\.)?/g;function IE(n,e){n.seq.push(e),n.map[e.id]=e}function OH(n,e,t){const r=n.name,i=r.length;for(l_.lastIndex=0;;){const s=l_.exec(r),a=l_.lastIndex;let o=s[1];const c=s[2]==="]",u=s[3];if(c&&(o=o|0),u===void 0||u==="["&&a+2===i){IE(t,u===void 0?new kH(o,n,e):new jH(o,n,e));break}else{let p=t.map[o];p===void 0&&(p=new UH(o),IE(t,p)),t=p}}}class tg{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<r;++a){const o=e.getActiveUniform(t,a),c=e.getUniformLocation(t,o.name);OH(o,c,this)}const i=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?i.push(a):s.push(a);i.length>0&&(this.seq=i.concat(s))}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],c=r[o.id];c.needsUpdate!==!1&&o.setValue(e,c.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function PE(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const zH=37297;let HH=0;function GH(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return r.join(`
`)}const BE=new Vt;function VH(n){nn._getMatrix(BE,nn.workingColorSpace,n);const e=`mat3( ${BE.elements.map(t=>t.toFixed(4))} )`;switch(nn.getTransfer(n)){case Zh:return[e,"LinearTransferOETF"];case fn:return[e,"sRGBTransferOETF"];default:return ct("WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function LE(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),s=(n.getShaderInfoLog(e)||"").trim();if(r&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+GH(n.getShaderSource(e),o)}else return s}function WH(n,e){const t=VH(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const XH={[nw]:"Linear",[rw]:"Reinhard",[iw]:"Cineon",[tx]:"ACESFilmic",[aw]:"AgX",[ow]:"Neutral",[sw]:"Custom"};function JH(n,e){const t=XH[e];return t===void 0?(ct("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Bm=new X;function YH(){nn.getLuminanceCoefficients(Bm);const n=Bm.x.toFixed(4),e=Bm.y.toFixed(4),t=Bm.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function KH(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(oh).join(`
`)}function ZH(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function qH(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function oh(n){return n!==""}function DE(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function FE(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const QH=/^[ \t]*#include +<([\w\d./]+)>/gm;function W1(n){return n.replace(QH,eG)}const $H=new Map;function eG(n,e){let t=Xt[e];if(t===void 0){const r=$H.get(e);if(r!==void 0)t=Xt[r],ct('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return W1(t)}const tG=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function kE(n){return n.replace(tG,nG)}function nG(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function jE(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const rG={[xu]:"SHADOWMAP_TYPE_PCF",[Al]:"SHADOWMAP_TYPE_VSM"};function iG(n){return rG[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const sG={[Cs]:"ENVMAP_TYPE_CUBE",[Ro]:"ENVMAP_TYPE_CUBE",[nd]:"ENVMAP_TYPE_CUBE_UV"};function aG(n){return n.envMap===!1?"ENVMAP_TYPE_CUBE":sG[n.envMapMode]||"ENVMAP_TYPE_CUBE"}const oG={[Ro]:"ENVMAP_MODE_REFRACTION"};function lG(n){return n.envMap===!1?"ENVMAP_MODE_REFLECTION":oG[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}const cG={[yf]:"ENVMAP_BLENDING_MULTIPLY",[L3]:"ENVMAP_BLENDING_MIX",[D3]:"ENVMAP_BLENDING_ADD"};function uG(n){return n.envMap===!1?"ENVMAP_BLENDING_NONE":cG[n.combine]||"ENVMAP_BLENDING_NONE"}function dG(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function hG(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const c=iG(t),u=aG(t),f=lG(t),p=uG(t),m=dG(t),g=KH(t),y=ZH(s),S=i.createProgram();let w,x,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(oh).join(`
`),w.length>0&&(w+=`
`),x=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(oh).join(`
`),x.length>0&&(x+=`
`)):(w=[jE(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(oh).join(`
`),x=[jE(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",t.envMap?"#define "+p:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ns?"#define TONE_MAPPING":"",t.toneMapping!==ns?Xt.tonemapping_pars_fragment:"",t.toneMapping!==ns?JH("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Xt.colorspace_pars_fragment,WH("linearToOutputTexel",t.outputColorSpace),YH(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(oh).join(`
`)),a=W1(a),a=DE(a,t),a=FE(a,t),o=W1(o),o=DE(o,t),o=FE(o,t),a=kE(a),o=kE(o),t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,w=[g,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,x=["#define varying in",t.glslVersion===D1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===D1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);const b=_+w+a,M=_+x+o,N=PE(i,i.VERTEX_SHADER,b),C=PE(i,i.FRAGMENT_SHADER,M);i.attachShader(S,N),i.attachShader(S,C),t.index0AttributeName!==void 0?i.bindAttribLocation(S,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(S,0,"position"),i.linkProgram(S);function I(j){if(n.debug.checkShaderErrors){const O=i.getProgramInfoLog(S)||"",k=i.getShaderInfoLog(N)||"",Z=i.getShaderInfoLog(C)||"",te=O.trim(),K=k.trim(),$=Z.trim();let U=!0,H=!0;if(i.getProgramParameter(S,i.LINK_STATUS)===!1)if(U=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,S,N,C);else{const W=LE(i,N,"vertex"),Y=LE(i,C,"fragment");It("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(S,i.VALIDATE_STATUS)+`

Material Name: `+j.name+`
Material Type: `+j.type+`

Program Info Log: `+te+`
`+W+`
`+Y)}else te!==""?ct("WebGLProgram: Program Info Log:",te):(K===""||$==="")&&(H=!1);H&&(j.diagnostics={runnable:U,programLog:te,vertexShader:{log:K,prefix:w},fragmentShader:{log:$,prefix:x}})}i.deleteShader(N),i.deleteShader(C),P=new tg(i,S),T=qH(i,S)}let P;this.getUniforms=function(){return P===void 0&&I(this),P};let T;this.getAttributes=function(){return T===void 0&&I(this),T};let R=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return R===!1&&(R=i.getProgramParameter(S,zH)),R},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(S),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=HH++,this.cacheKey=e,this.usedTimes=1,this.program=S,this.vertexShader=N,this.fragmentShader=C,this}let fG=0;class pG{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new mG(e),t.set(e,r)),r}}class mG{constructor(e){this.id=fG++,this.code=e,this.usedTimes=0}}function gG(n,e,t,r,i,s,a){const o=new Fl,c=new pG,u=new Set,f=[],p=new Map,m=i.logarithmicDepthBuffer;let g=i.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function S(T){return u.add(T),T===0?"uv":`uv${T}`}function w(T,R,j,O,k){const Z=O.fog,te=k.geometry,K=T.isMeshStandardMaterial?O.environment:null,$=(T.isMeshStandardMaterial?t:e).get(T.envMap||K),U=$&&$.mapping===nd?$.image.height:null,H=y[T.type];T.precision!==null&&(g=i.getMaxPrecision(T.precision),g!==T.precision&&ct("WebGLProgram.getParameters:",T.precision,"not supported, using",g,"instead."));const W=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,Y=W!==void 0?W.length:0;let G=0;te.morphAttributes.position!==void 0&&(G=1),te.morphAttributes.normal!==void 0&&(G=2),te.morphAttributes.color!==void 0&&(G=3);let de,Ce,be,se;if(H){const Jt=_s[H];de=Jt.vertexShader,Ce=Jt.fragmentShader}else de=T.vertexShader,Ce=T.fragmentShader,c.update(T),be=c.getVertexShaderID(T),se=c.getFragmentShaderID(T);const _e=n.getRenderTarget(),Le=n.state.buffers.depth.getReversed(),yt=k.isInstancedMesh===!0,qe=k.isBatchedMesh===!0,lt=!!T.map,kt=!!T.matcap,it=!!$,Me=!!T.aoMap,Be=!!T.lightMap,Ie=!!T.bumpMap,Ye=!!T.normalMap,Q=!!T.displacementMap,vt=!!T.emissiveMap,et=!!T.metalnessMap,Ct=!!T.roughnessMap,Ge=T.anisotropy>0,J=T.clearcoat>0,L=T.dispersion>0,q=T.iridescence>0,pe=T.sheen>0,ve=T.transmission>0,ge=Ge&&!!T.anisotropyMap,st=J&&!!T.clearcoatMap,Ke=J&&!!T.clearcoatNormalMap,dt=J&&!!T.clearcoatRoughnessMap,_t=q&&!!T.iridescenceMap,Fe=q&&!!T.iridescenceThicknessMap,He=pe&&!!T.sheenColorMap,xt=pe&&!!T.sheenRoughnessMap,re=!!T.specularMap,fe=!!T.specularColorMap,ke=!!T.specularIntensityMap,ie=ve&&!!T.transmissionMap,me=ve&&!!T.thicknessMap,je=!!T.gradientMap,at=!!T.alphaMap,ze=T.alphaTest>0,Re=!!T.alphaHash,Ve=!!T.extensions;let Tt=ns;T.toneMapped&&(_e===null||_e.isXRRenderTarget===!0)&&(Tt=n.toneMapping);const Qt={shaderID:H,shaderType:T.type,shaderName:T.name,vertexShader:de,fragmentShader:Ce,defines:T.defines,customVertexShaderID:be,customFragmentShaderID:se,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:g,batching:qe,batchingColor:qe&&k._colorsTexture!==null,instancing:yt,instancingColor:yt&&k.instanceColor!==null,instancingMorph:yt&&k.morphTexture!==null,outputColorSpace:_e===null?n.outputColorSpace:_e.isXRRenderTarget===!0?_e.texture.colorSpace:ea,alphaToCoverage:!!T.alphaToCoverage,map:lt,matcap:kt,envMap:it,envMapMode:it&&$.mapping,envMapCubeUVHeight:U,aoMap:Me,lightMap:Be,bumpMap:Ie,normalMap:Ye,displacementMap:Q,emissiveMap:vt,normalMapObjectSpace:Ye&&T.normalMapType===H3,normalMapTangentSpace:Ye&&T.normalMapType===Oo,metalnessMap:et,roughnessMap:Ct,anisotropy:Ge,anisotropyMap:ge,clearcoat:J,clearcoatMap:st,clearcoatNormalMap:Ke,clearcoatRoughnessMap:dt,dispersion:L,iridescence:q,iridescenceMap:_t,iridescenceThicknessMap:Fe,sheen:pe,sheenColorMap:He,sheenRoughnessMap:xt,specularMap:re,specularColorMap:fe,specularIntensityMap:ke,transmission:ve,transmissionMap:ie,thicknessMap:me,gradientMap:je,opaque:T.transparent===!1&&T.blending===Ll&&T.alphaToCoverage===!1,alphaMap:at,alphaTest:ze,alphaHash:Re,combine:T.combine,mapUv:lt&&S(T.map.channel),aoMapUv:Me&&S(T.aoMap.channel),lightMapUv:Be&&S(T.lightMap.channel),bumpMapUv:Ie&&S(T.bumpMap.channel),normalMapUv:Ye&&S(T.normalMap.channel),displacementMapUv:Q&&S(T.displacementMap.channel),emissiveMapUv:vt&&S(T.emissiveMap.channel),metalnessMapUv:et&&S(T.metalnessMap.channel),roughnessMapUv:Ct&&S(T.roughnessMap.channel),anisotropyMapUv:ge&&S(T.anisotropyMap.channel),clearcoatMapUv:st&&S(T.clearcoatMap.channel),clearcoatNormalMapUv:Ke&&S(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:dt&&S(T.clearcoatRoughnessMap.channel),iridescenceMapUv:_t&&S(T.iridescenceMap.channel),iridescenceThicknessMapUv:Fe&&S(T.iridescenceThicknessMap.channel),sheenColorMapUv:He&&S(T.sheenColorMap.channel),sheenRoughnessMapUv:xt&&S(T.sheenRoughnessMap.channel),specularMapUv:re&&S(T.specularMap.channel),specularColorMapUv:fe&&S(T.specularColorMap.channel),specularIntensityMapUv:ke&&S(T.specularIntensityMap.channel),transmissionMapUv:ie&&S(T.transmissionMap.channel),thicknessMapUv:me&&S(T.thicknessMap.channel),alphaMapUv:at&&S(T.alphaMap.channel),vertexTangents:!!te.attributes.tangent&&(Ye||Ge),vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,pointsUvs:k.isPoints===!0&&!!te.attributes.uv&&(lt||at),fog:!!Z,useFog:T.fog===!0,fogExp2:!!Z&&Z.isFogExp2,flatShading:T.flatShading===!0&&T.wireframe===!1,sizeAttenuation:T.sizeAttenuation===!0,logarithmicDepthBuffer:m,reversedDepthBuffer:Le,skinning:k.isSkinnedMesh===!0,morphTargets:te.morphAttributes.position!==void 0,morphNormals:te.morphAttributes.normal!==void 0,morphColors:te.morphAttributes.color!==void 0,morphTargetsCount:Y,morphTextureStride:G,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numSpotLightMaps:R.spotLightMap.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numSpotLightShadowsWithMaps:R.numSpotLightShadowsWithMaps,numLightProbes:R.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&j.length>0,shadowMapType:n.shadowMap.type,toneMapping:Tt,decodeVideoTexture:lt&&T.map.isVideoTexture===!0&&nn.getTransfer(T.map.colorSpace)===fn,decodeVideoTextureEmissive:vt&&T.emissiveMap.isVideoTexture===!0&&nn.getTransfer(T.emissiveMap.colorSpace)===fn,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===Ti,flipSided:T.side===Ur,useDepthPacking:T.depthPacking>=0,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionClipCullDistance:Ve&&T.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ve&&T.extensions.multiDraw===!0||qe)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:T.customProgramCacheKey()};return Qt.vertexUv1s=u.has(1),Qt.vertexUv2s=u.has(2),Qt.vertexUv3s=u.has(3),u.clear(),Qt}function x(T){const R=[];if(T.shaderID?R.push(T.shaderID):(R.push(T.customVertexShaderID),R.push(T.customFragmentShaderID)),T.defines!==void 0)for(const j in T.defines)R.push(j),R.push(T.defines[j]);return T.isRawShaderMaterial===!1&&(_(R,T),b(R,T),R.push(n.outputColorSpace)),R.push(T.customProgramCacheKey),R.join()}function _(T,R){T.push(R.precision),T.push(R.outputColorSpace),T.push(R.envMapMode),T.push(R.envMapCubeUVHeight),T.push(R.mapUv),T.push(R.alphaMapUv),T.push(R.lightMapUv),T.push(R.aoMapUv),T.push(R.bumpMapUv),T.push(R.normalMapUv),T.push(R.displacementMapUv),T.push(R.emissiveMapUv),T.push(R.metalnessMapUv),T.push(R.roughnessMapUv),T.push(R.anisotropyMapUv),T.push(R.clearcoatMapUv),T.push(R.clearcoatNormalMapUv),T.push(R.clearcoatRoughnessMapUv),T.push(R.iridescenceMapUv),T.push(R.iridescenceThicknessMapUv),T.push(R.sheenColorMapUv),T.push(R.sheenRoughnessMapUv),T.push(R.specularMapUv),T.push(R.specularColorMapUv),T.push(R.specularIntensityMapUv),T.push(R.transmissionMapUv),T.push(R.thicknessMapUv),T.push(R.combine),T.push(R.fogExp2),T.push(R.sizeAttenuation),T.push(R.morphTargetsCount),T.push(R.morphAttributeCount),T.push(R.numDirLights),T.push(R.numPointLights),T.push(R.numSpotLights),T.push(R.numSpotLightMaps),T.push(R.numHemiLights),T.push(R.numRectAreaLights),T.push(R.numDirLightShadows),T.push(R.numPointLightShadows),T.push(R.numSpotLightShadows),T.push(R.numSpotLightShadowsWithMaps),T.push(R.numLightProbes),T.push(R.shadowMapType),T.push(R.toneMapping),T.push(R.numClippingPlanes),T.push(R.numClipIntersection),T.push(R.depthPacking)}function b(T,R){o.disableAll(),R.instancing&&o.enable(0),R.instancingColor&&o.enable(1),R.instancingMorph&&o.enable(2),R.matcap&&o.enable(3),R.envMap&&o.enable(4),R.normalMapObjectSpace&&o.enable(5),R.normalMapTangentSpace&&o.enable(6),R.clearcoat&&o.enable(7),R.iridescence&&o.enable(8),R.alphaTest&&o.enable(9),R.vertexColors&&o.enable(10),R.vertexAlphas&&o.enable(11),R.vertexUv1s&&o.enable(12),R.vertexUv2s&&o.enable(13),R.vertexUv3s&&o.enable(14),R.vertexTangents&&o.enable(15),R.anisotropy&&o.enable(16),R.alphaHash&&o.enable(17),R.batching&&o.enable(18),R.dispersion&&o.enable(19),R.batchingColor&&o.enable(20),R.gradientMap&&o.enable(21),T.push(o.mask),o.disableAll(),R.fog&&o.enable(0),R.useFog&&o.enable(1),R.flatShading&&o.enable(2),R.logarithmicDepthBuffer&&o.enable(3),R.reversedDepthBuffer&&o.enable(4),R.skinning&&o.enable(5),R.morphTargets&&o.enable(6),R.morphNormals&&o.enable(7),R.morphColors&&o.enable(8),R.premultipliedAlpha&&o.enable(9),R.shadowMapEnabled&&o.enable(10),R.doubleSided&&o.enable(11),R.flipSided&&o.enable(12),R.useDepthPacking&&o.enable(13),R.dithering&&o.enable(14),R.transmission&&o.enable(15),R.sheen&&o.enable(16),R.opaque&&o.enable(17),R.pointsUvs&&o.enable(18),R.decodeVideoTexture&&o.enable(19),R.decodeVideoTextureEmissive&&o.enable(20),R.alphaToCoverage&&o.enable(21),T.push(o.mask)}function M(T){const R=y[T.type];let j;if(R){const O=_s[R];j=vw.clone(O.uniforms)}else j=T.uniforms;return j}function N(T,R){let j=p.get(R);return j!==void 0?++j.usedTimes:(j=new hG(n,R,T,s),f.push(j),p.set(R,j)),j}function C(T){if(--T.usedTimes===0){const R=f.indexOf(T);f[R]=f[f.length-1],f.pop(),p.delete(T.cacheKey),T.destroy()}}function I(T){c.remove(T)}function P(){c.dispose()}return{getParameters:w,getProgramCacheKey:x,getUniforms:M,acquireProgram:N,releaseProgram:C,releaseShaderCache:I,programs:f,dispose:P}}function xG(){let n=new WeakMap;function e(a){return n.has(a)}function t(a){let o=n.get(a);return o===void 0&&(o={},n.set(a,o)),o}function r(a){n.delete(a)}function i(a,o,c){n.get(a)[o]=c}function s(){n=new WeakMap}return{has:e,get:t,remove:r,update:i,dispose:s}}function yG(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function UE(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function OE(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(p,m,g,y,S,w){let x=n[e];return x===void 0?(x={id:p.id,object:p,geometry:m,material:g,groupOrder:y,renderOrder:p.renderOrder,z:S,group:w},n[e]=x):(x.id=p.id,x.object=p,x.geometry=m,x.material=g,x.groupOrder=y,x.renderOrder=p.renderOrder,x.z=S,x.group=w),e++,x}function o(p,m,g,y,S,w){const x=a(p,m,g,y,S,w);g.transmission>0?r.push(x):g.transparent===!0?i.push(x):t.push(x)}function c(p,m,g,y,S,w){const x=a(p,m,g,y,S,w);g.transmission>0?r.unshift(x):g.transparent===!0?i.unshift(x):t.unshift(x)}function u(p,m){t.length>1&&t.sort(p||yG),r.length>1&&r.sort(m||UE),i.length>1&&i.sort(m||UE)}function f(){for(let p=e,m=n.length;p<m;p++){const g=n[p];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:o,unshift:c,finish:f,sort:u}}function vG(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new OE,n.set(r,[a])):i>=s.length?(a=new OE,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function _G(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new X,color:new ut};break;case"SpotLight":t={position:new X,direction:new X,color:new ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new X,color:new ut,distance:0,decay:0};break;case"HemisphereLight":t={direction:new X,skyColor:new ut,groundColor:new ut};break;case"RectAreaLight":t={color:new ut,position:new X,halfWidth:new X,halfHeight:new X};break}return n[e.id]=t,t}}}function bG(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Te};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Te};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Te,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let wG=0;function SG(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function AG(n){const e=new _G,t=bG(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new X);const i=new X,s=new Dt,a=new Dt;function o(u){let f=0,p=0,m=0;for(let T=0;T<9;T++)r.probe[T].set(0,0,0);let g=0,y=0,S=0,w=0,x=0,_=0,b=0,M=0,N=0,C=0,I=0;u.sort(SG);for(let T=0,R=u.length;T<R;T++){const j=u[T],O=j.color,k=j.intensity,Z=j.distance;let te=null;if(j.shadow&&j.shadow.map&&(j.shadow.map.texture.format===Jl?te=j.shadow.map.texture:te=j.shadow.map.depthTexture||j.shadow.map.texture),j.isAmbientLight)f+=O.r*k,p+=O.g*k,m+=O.b*k;else if(j.isLightProbe){for(let K=0;K<9;K++)r.probe[K].addScaledVector(j.sh.coefficients[K],k);I++}else if(j.isDirectionalLight){const K=e.get(j);if(K.color.copy(j.color).multiplyScalar(j.intensity),j.castShadow){const $=j.shadow,U=t.get(j);U.shadowIntensity=$.intensity,U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,r.directionalShadow[g]=U,r.directionalShadowMap[g]=te,r.directionalShadowMatrix[g]=j.shadow.matrix,_++}r.directional[g]=K,g++}else if(j.isSpotLight){const K=e.get(j);K.position.setFromMatrixPosition(j.matrixWorld),K.color.copy(O).multiplyScalar(k),K.distance=Z,K.coneCos=Math.cos(j.angle),K.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),K.decay=j.decay,r.spot[S]=K;const $=j.shadow;if(j.map&&(r.spotLightMap[N]=j.map,N++,$.updateMatrices(j),j.castShadow&&C++),r.spotLightMatrix[S]=$.matrix,j.castShadow){const U=t.get(j);U.shadowIntensity=$.intensity,U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,r.spotShadow[S]=U,r.spotShadowMap[S]=te,M++}S++}else if(j.isRectAreaLight){const K=e.get(j);K.color.copy(O).multiplyScalar(k),K.halfWidth.set(j.width*.5,0,0),K.halfHeight.set(0,j.height*.5,0),r.rectArea[w]=K,w++}else if(j.isPointLight){const K=e.get(j);if(K.color.copy(j.color).multiplyScalar(j.intensity),K.distance=j.distance,K.decay=j.decay,j.castShadow){const $=j.shadow,U=t.get(j);U.shadowIntensity=$.intensity,U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,U.shadowCameraNear=$.camera.near,U.shadowCameraFar=$.camera.far,r.pointShadow[y]=U,r.pointShadowMap[y]=te,r.pointShadowMatrix[y]=j.shadow.matrix,b++}r.point[y]=K,y++}else if(j.isHemisphereLight){const K=e.get(j);K.skyColor.copy(j.color).multiplyScalar(k),K.groundColor.copy(j.groundColor).multiplyScalar(k),r.hemi[x]=K,x++}}w>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ft.LTC_FLOAT_1,r.rectAreaLTC2=ft.LTC_FLOAT_2):(r.rectAreaLTC1=ft.LTC_HALF_1,r.rectAreaLTC2=ft.LTC_HALF_2)),r.ambient[0]=f,r.ambient[1]=p,r.ambient[2]=m;const P=r.hash;(P.directionalLength!==g||P.pointLength!==y||P.spotLength!==S||P.rectAreaLength!==w||P.hemiLength!==x||P.numDirectionalShadows!==_||P.numPointShadows!==b||P.numSpotShadows!==M||P.numSpotMaps!==N||P.numLightProbes!==I)&&(r.directional.length=g,r.spot.length=S,r.rectArea.length=w,r.point.length=y,r.hemi.length=x,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=M+N-C,r.spotLightMap.length=N,r.numSpotLightShadowsWithMaps=C,r.numLightProbes=I,P.directionalLength=g,P.pointLength=y,P.spotLength=S,P.rectAreaLength=w,P.hemiLength=x,P.numDirectionalShadows=_,P.numPointShadows=b,P.numSpotShadows=M,P.numSpotMaps=N,P.numLightProbes=I,r.version=wG++)}function c(u,f){let p=0,m=0,g=0,y=0,S=0;const w=f.matrixWorldInverse;for(let x=0,_=u.length;x<_;x++){const b=u[x];if(b.isDirectionalLight){const M=r.directional[p];M.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(i),M.direction.transformDirection(w),p++}else if(b.isSpotLight){const M=r.spot[g];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(w),M.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(i),M.direction.transformDirection(w),g++}else if(b.isRectAreaLight){const M=r.rectArea[y];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(w),a.identity(),s.copy(b.matrixWorld),s.premultiply(w),a.extractRotation(s),M.halfWidth.set(b.width*.5,0,0),M.halfHeight.set(0,b.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),y++}else if(b.isPointLight){const M=r.point[m];M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(w),m++}else if(b.isHemisphereLight){const M=r.hemi[S];M.direction.setFromMatrixPosition(b.matrixWorld),M.direction.transformDirection(w),S++}}}return{setup:o,setupView:c,state:r}}function zE(n){const e=new AG(n),t=[],r=[];function i(f){u.camera=f,t.length=0,r.length=0}function s(f){t.push(f)}function a(f){r.push(f)}function o(){e.setup(t)}function c(f){e.setupView(t,f)}const u={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:u,setupLights:o,setupLightsView:c,pushLight:s,pushShadow:a}}function MG(n){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let o;return a===void 0?(o=new zE(n),e.set(i,[o])):s>=a.length?(o=new zE(n),a.push(o)):o=a[s],o}function r(){e=new WeakMap}return{get:t,dispose:r}}const CG=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,EG=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,TG=[new X(1,0,0),new X(-1,0,0),new X(0,1,0),new X(0,-1,0),new X(0,0,1),new X(0,0,-1)],NG=[new X(0,-1,0),new X(0,-1,0),new X(0,0,1),new X(0,0,-1),new X(0,-1,0),new X(0,-1,0)],HE=new Dt,Xd=new X,c_=new X;function RG(n,e,t){let r=new rd;const i=new Te,s=new Te,a=new yn,o=new Bw,c=new Lw,u={},f=t.maxTextureSize,p={[Qs]:Ur,[Ur]:Qs,[Ti]:Ti},m=new Hr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Te},radius:{value:4}},vertexShader:CG,fragmentShader:EG}),g=m.clone();g.defines.HORIZONTAL_PASS=1;const y=new jt;y.setAttribute("position",new ln(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const S=new Tn(y,m),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=xu;let x=this.type;this.render=function(C,I,P){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||C.length===0)return;C.type===xh&&(ct("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),C.type=xu);const T=n.getRenderTarget(),R=n.getActiveCubeFace(),j=n.getActiveMipmapLevel(),O=n.state;O.setBlending(As),O.buffers.depth.getReversed()===!0?O.buffers.color.setClear(0,0,0,0):O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);const k=x!==this.type;k&&I.traverse(function(Z){Z.material&&(Array.isArray(Z.material)?Z.material.forEach(te=>te.needsUpdate=!0):Z.material.needsUpdate=!0)});for(let Z=0,te=C.length;Z<te;Z++){const K=C[Z],$=K.shadow;if($===void 0){ct("WebGLShadowMap:",K,"has no shadow.");continue}if($.autoUpdate===!1&&$.needsUpdate===!1)continue;i.copy($.mapSize);const U=$.getFrameExtents();if(i.multiply(U),s.copy($.mapSize),(i.x>f||i.y>f)&&(i.x>f&&(s.x=Math.floor(f/U.x),i.x=s.x*U.x,$.mapSize.x=s.x),i.y>f&&(s.y=Math.floor(f/U.y),i.y=s.y*U.y,$.mapSize.y=s.y)),$.map===null||k===!0){if($.map!==null&&($.map.depthTexture!==null&&($.map.depthTexture.dispose(),$.map.depthTexture=null),$.map.dispose()),this.type===Al){if(K.isPointLight){ct("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}$.map=new ei(i.x,i.y,{format:Jl,type:On,minFilter:en,magFilter:en,generateMipmaps:!1}),$.map.texture.name=K.name+".shadowMap",$.map.depthTexture=new Gu(i.x,i.y,En),$.map.depthTexture.name=K.name+".shadowMapDepth",$.map.depthTexture.format=$s,$.map.depthTexture.compareFunction=null,$.map.depthTexture.minFilter=Un,$.map.depthTexture.magFilter=Un}else{K.isPointLight?($.map=new px(i.x),$.map.depthTexture=new oR(i.x,Fi)):($.map=new ei(i.x,i.y),$.map.depthTexture=new Gu(i.x,i.y,Fi)),$.map.depthTexture.name=K.name+".shadowMap",$.map.depthTexture.format=$s;const W=n.state.buffers.depth.getReversed();this.type===xu?($.map.depthTexture.compareFunction=W?dx:ux,$.map.depthTexture.minFilter=en,$.map.depthTexture.magFilter=en):($.map.depthTexture.compareFunction=null,$.map.depthTexture.minFilter=Un,$.map.depthTexture.magFilter=Un)}$.camera.updateProjectionMatrix()}const H=$.map.isWebGLCubeRenderTarget?6:1;for(let W=0;W<H;W++){if($.map.isWebGLCubeRenderTarget)n.setRenderTarget($.map,W),n.clear();else{W===0&&(n.setRenderTarget($.map),n.clear());const Y=$.getViewport(W);a.set(s.x*Y.x,s.y*Y.y,s.x*Y.z,s.y*Y.w),O.viewport(a)}if(K.isPointLight){const Y=$.camera,G=$.matrix,de=K.distance||Y.far;de!==Y.far&&(Y.far=de,Y.updateProjectionMatrix()),Xd.setFromMatrixPosition(K.matrixWorld),Y.position.copy(Xd),c_.copy(Y.position),c_.add(TG[W]),Y.up.copy(NG[W]),Y.lookAt(c_),Y.updateMatrixWorld(),G.makeTranslation(-Xd.x,-Xd.y,-Xd.z),HE.multiplyMatrices(Y.projectionMatrix,Y.matrixWorldInverse),$._frustum.setFromProjectionMatrix(HE,Y.coordinateSystem,Y.reversedDepth)}else $.updateMatrices(K);r=$.getFrustum(),M(I,P,$.camera,K,this.type)}$.isPointLightShadow!==!0&&this.type===Al&&_($,P),$.needsUpdate=!1}x=this.type,w.needsUpdate=!1,n.setRenderTarget(T,R,j)};function _(C,I){const P=e.update(S);m.defines.VSM_SAMPLES!==C.blurSamples&&(m.defines.VSM_SAMPLES=C.blurSamples,g.defines.VSM_SAMPLES=C.blurSamples,m.needsUpdate=!0,g.needsUpdate=!0),C.mapPass===null&&(C.mapPass=new ei(i.x,i.y,{format:Jl,type:On})),m.uniforms.shadow_pass.value=C.map.depthTexture,m.uniforms.resolution.value=C.mapSize,m.uniforms.radius.value=C.radius,n.setRenderTarget(C.mapPass),n.clear(),n.renderBufferDirect(I,null,P,m,S,null),g.uniforms.shadow_pass.value=C.mapPass.texture,g.uniforms.resolution.value=C.mapSize,g.uniforms.radius.value=C.radius,n.setRenderTarget(C.map),n.clear(),n.renderBufferDirect(I,null,P,g,S,null)}function b(C,I,P,T){let R=null;const j=P.isPointLight===!0?C.customDistanceMaterial:C.customDepthMaterial;if(j!==void 0)R=j;else if(R=P.isPointLight===!0?c:o,n.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const O=R.uuid,k=I.uuid;let Z=u[O];Z===void 0&&(Z={},u[O]=Z);let te=Z[k];te===void 0&&(te=R.clone(),Z[k]=te,I.addEventListener("dispose",N)),R=te}if(R.visible=I.visible,R.wireframe=I.wireframe,T===Al?R.side=I.shadowSide!==null?I.shadowSide:I.side:R.side=I.shadowSide!==null?I.shadowSide:p[I.side],R.alphaMap=I.alphaMap,R.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,R.map=I.map,R.clipShadows=I.clipShadows,R.clippingPlanes=I.clippingPlanes,R.clipIntersection=I.clipIntersection,R.displacementMap=I.displacementMap,R.displacementScale=I.displacementScale,R.displacementBias=I.displacementBias,R.wireframeLinewidth=I.wireframeLinewidth,R.linewidth=I.linewidth,P.isPointLight===!0&&R.isMeshDistanceMaterial===!0){const O=n.properties.get(R);O.light=P}return R}function M(C,I,P,T,R){if(C.visible===!1)return;if(C.layers.test(I.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&R===Al)&&(!C.frustumCulled||r.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,C.matrixWorld);const k=e.update(C),Z=C.material;if(Array.isArray(Z)){const te=k.groups;for(let K=0,$=te.length;K<$;K++){const U=te[K],H=Z[U.materialIndex];if(H&&H.visible){const W=b(C,H,T,R);C.onBeforeShadow(n,C,I,P,k,W,U),n.renderBufferDirect(P,null,k,W,C,U),C.onAfterShadow(n,C,I,P,k,W,U)}}}else if(Z.visible){const te=b(C,Z,T,R);C.onBeforeShadow(n,C,I,P,k,te,null),n.renderBufferDirect(P,null,k,te,C,null),C.onAfterShadow(n,C,I,P,k,te,null)}}const O=C.children;for(let k=0,Z=O.length;k<Z;k++)M(O[k],I,P,T,R)}function N(C){C.target.removeEventListener("dispose",N);for(const P in u){const T=u[P],R=C.target.uuid;R in T&&(T[R].dispose(),delete T[R])}}}const IG={[kg]:jg,[Ug]:Hg,[Og]:Gg,[Xl]:zg,[jg]:kg,[Hg]:Ug,[Gg]:Og,[zg]:Xl};function PG(n,e){function t(){let ie=!1;const me=new yn;let je=null;const at=new yn(0,0,0,0);return{setMask:function(ze){je!==ze&&!ie&&(n.colorMask(ze,ze,ze,ze),je=ze)},setLocked:function(ze){ie=ze},setClear:function(ze,Re,Ve,Tt,Qt){Qt===!0&&(ze*=Tt,Re*=Tt,Ve*=Tt),me.set(ze,Re,Ve,Tt),at.equals(me)===!1&&(n.clearColor(ze,Re,Ve,Tt),at.copy(me))},reset:function(){ie=!1,je=null,at.set(-1,0,0,0)}}}function r(){let ie=!1,me=!1,je=null,at=null,ze=null;return{setReversed:function(Re){if(me!==Re){const Ve=e.get("EXT_clip_control");Re?Ve.clipControlEXT(Ve.LOWER_LEFT_EXT,Ve.ZERO_TO_ONE_EXT):Ve.clipControlEXT(Ve.LOWER_LEFT_EXT,Ve.NEGATIVE_ONE_TO_ONE_EXT),me=Re;const Tt=ze;ze=null,this.setClear(Tt)}},getReversed:function(){return me},setTest:function(Re){Re?_e(n.DEPTH_TEST):Le(n.DEPTH_TEST)},setMask:function(Re){je!==Re&&!ie&&(n.depthMask(Re),je=Re)},setFunc:function(Re){if(me&&(Re=IG[Re]),at!==Re){switch(Re){case kg:n.depthFunc(n.NEVER);break;case jg:n.depthFunc(n.ALWAYS);break;case Ug:n.depthFunc(n.LESS);break;case Xl:n.depthFunc(n.LEQUAL);break;case Og:n.depthFunc(n.EQUAL);break;case zg:n.depthFunc(n.GEQUAL);break;case Hg:n.depthFunc(n.GREATER);break;case Gg:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}at=Re}},setLocked:function(Re){ie=Re},setClear:function(Re){ze!==Re&&(me&&(Re=1-Re),n.clearDepth(Re),ze=Re)},reset:function(){ie=!1,je=null,at=null,ze=null,me=!1}}}function i(){let ie=!1,me=null,je=null,at=null,ze=null,Re=null,Ve=null,Tt=null,Qt=null;return{setTest:function(Jt){ie||(Jt?_e(n.STENCIL_TEST):Le(n.STENCIL_TEST))},setMask:function(Jt){me!==Jt&&!ie&&(n.stencilMask(Jt),me=Jt)},setFunc:function(Jt,Gn,cr){(je!==Jt||at!==Gn||ze!==cr)&&(n.stencilFunc(Jt,Gn,cr),je=Jt,at=Gn,ze=cr)},setOp:function(Jt,Gn,cr){(Re!==Jt||Ve!==Gn||Tt!==cr)&&(n.stencilOp(Jt,Gn,cr),Re=Jt,Ve=Gn,Tt=cr)},setLocked:function(Jt){ie=Jt},setClear:function(Jt){Qt!==Jt&&(n.clearStencil(Jt),Qt=Jt)},reset:function(){ie=!1,me=null,je=null,at=null,ze=null,Re=null,Ve=null,Tt=null,Qt=null}}}const s=new t,a=new r,o=new i,c=new WeakMap,u=new WeakMap;let f={},p={},m=new WeakMap,g=[],y=null,S=!1,w=null,x=null,_=null,b=null,M=null,N=null,C=null,I=new ut(0,0,0),P=0,T=!1,R=null,j=null,O=null,k=null,Z=null;const te=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let K=!1,$=0;const U=n.getParameter(n.VERSION);U.indexOf("WebGL")!==-1?($=parseFloat(/^WebGL (\d)/.exec(U)[1]),K=$>=1):U.indexOf("OpenGL ES")!==-1&&($=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),K=$>=2);let H=null,W={};const Y=n.getParameter(n.SCISSOR_BOX),G=n.getParameter(n.VIEWPORT),de=new yn().fromArray(Y),Ce=new yn().fromArray(G);function be(ie,me,je,at){const ze=new Uint8Array(4),Re=n.createTexture();n.bindTexture(ie,Re),n.texParameteri(ie,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ie,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ve=0;Ve<je;Ve++)ie===n.TEXTURE_3D||ie===n.TEXTURE_2D_ARRAY?n.texImage3D(me,0,n.RGBA,1,1,at,0,n.RGBA,n.UNSIGNED_BYTE,ze):n.texImage2D(me+Ve,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ze);return Re}const se={};se[n.TEXTURE_2D]=be(n.TEXTURE_2D,n.TEXTURE_2D,1),se[n.TEXTURE_CUBE_MAP]=be(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),se[n.TEXTURE_2D_ARRAY]=be(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),se[n.TEXTURE_3D]=be(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),_e(n.DEPTH_TEST),a.setFunc(Xl),Ie(!1),Ye(T1),_e(n.CULL_FACE),Me(As);function _e(ie){f[ie]!==!0&&(n.enable(ie),f[ie]=!0)}function Le(ie){f[ie]!==!1&&(n.disable(ie),f[ie]=!1)}function yt(ie,me){return p[ie]!==me?(n.bindFramebuffer(ie,me),p[ie]=me,ie===n.DRAW_FRAMEBUFFER&&(p[n.FRAMEBUFFER]=me),ie===n.FRAMEBUFFER&&(p[n.DRAW_FRAMEBUFFER]=me),!0):!1}function qe(ie,me){let je=g,at=!1;if(ie){je=m.get(me),je===void 0&&(je=[],m.set(me,je));const ze=ie.textures;if(je.length!==ze.length||je[0]!==n.COLOR_ATTACHMENT0){for(let Re=0,Ve=ze.length;Re<Ve;Re++)je[Re]=n.COLOR_ATTACHMENT0+Re;je.length=ze.length,at=!0}}else je[0]!==n.BACK&&(je[0]=n.BACK,at=!0);at&&n.drawBuffers(je)}function lt(ie){return y!==ie?(n.useProgram(ie),y=ie,!0):!1}const kt={[oo]:n.FUNC_ADD,[x3]:n.FUNC_SUBTRACT,[y3]:n.FUNC_REVERSE_SUBTRACT};kt[v3]=n.MIN,kt[_3]=n.MAX;const it={[b3]:n.ZERO,[w3]:n.ONE,[S3]:n.SRC_COLOR,[Dg]:n.SRC_ALPHA,[N3]:n.SRC_ALPHA_SATURATE,[E3]:n.DST_COLOR,[M3]:n.DST_ALPHA,[A3]:n.ONE_MINUS_SRC_COLOR,[Fg]:n.ONE_MINUS_SRC_ALPHA,[T3]:n.ONE_MINUS_DST_COLOR,[C3]:n.ONE_MINUS_DST_ALPHA,[R3]:n.CONSTANT_COLOR,[I3]:n.ONE_MINUS_CONSTANT_COLOR,[P3]:n.CONSTANT_ALPHA,[B3]:n.ONE_MINUS_CONSTANT_ALPHA};function Me(ie,me,je,at,ze,Re,Ve,Tt,Qt,Jt){if(ie===As){S===!0&&(Le(n.BLEND),S=!1);return}if(S===!1&&(_e(n.BLEND),S=!0),ie!==g3){if(ie!==w||Jt!==T){if((x!==oo||M!==oo)&&(n.blendEquation(n.FUNC_ADD),x=oo,M=oo),Jt)switch(ie){case Ll:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case N1:n.blendFunc(n.ONE,n.ONE);break;case R1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case I1:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:It("WebGLState: Invalid blending: ",ie);break}else switch(ie){case Ll:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case N1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case R1:It("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case I1:It("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:It("WebGLState: Invalid blending: ",ie);break}_=null,b=null,N=null,C=null,I.set(0,0,0),P=0,w=ie,T=Jt}return}ze=ze||me,Re=Re||je,Ve=Ve||at,(me!==x||ze!==M)&&(n.blendEquationSeparate(kt[me],kt[ze]),x=me,M=ze),(je!==_||at!==b||Re!==N||Ve!==C)&&(n.blendFuncSeparate(it[je],it[at],it[Re],it[Ve]),_=je,b=at,N=Re,C=Ve),(Tt.equals(I)===!1||Qt!==P)&&(n.blendColor(Tt.r,Tt.g,Tt.b,Qt),I.copy(Tt),P=Qt),w=ie,T=!1}function Be(ie,me){ie.side===Ti?Le(n.CULL_FACE):_e(n.CULL_FACE);let je=ie.side===Ur;me&&(je=!je),Ie(je),ie.blending===Ll&&ie.transparent===!1?Me(As):Me(ie.blending,ie.blendEquation,ie.blendSrc,ie.blendDst,ie.blendEquationAlpha,ie.blendSrcAlpha,ie.blendDstAlpha,ie.blendColor,ie.blendAlpha,ie.premultipliedAlpha),a.setFunc(ie.depthFunc),a.setTest(ie.depthTest),a.setMask(ie.depthWrite),s.setMask(ie.colorWrite);const at=ie.stencilWrite;o.setTest(at),at&&(o.setMask(ie.stencilWriteMask),o.setFunc(ie.stencilFunc,ie.stencilRef,ie.stencilFuncMask),o.setOp(ie.stencilFail,ie.stencilZFail,ie.stencilZPass)),vt(ie.polygonOffset,ie.polygonOffsetFactor,ie.polygonOffsetUnits),ie.alphaToCoverage===!0?_e(n.SAMPLE_ALPHA_TO_COVERAGE):Le(n.SAMPLE_ALPHA_TO_COVERAGE)}function Ie(ie){R!==ie&&(ie?n.frontFace(n.CW):n.frontFace(n.CCW),R=ie)}function Ye(ie){ie!==f3?(_e(n.CULL_FACE),ie!==j&&(ie===T1?n.cullFace(n.BACK):ie===p3?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Le(n.CULL_FACE),j=ie}function Q(ie){ie!==O&&(K&&n.lineWidth(ie),O=ie)}function vt(ie,me,je){ie?(_e(n.POLYGON_OFFSET_FILL),(k!==me||Z!==je)&&(n.polygonOffset(me,je),k=me,Z=je)):Le(n.POLYGON_OFFSET_FILL)}function et(ie){ie?_e(n.SCISSOR_TEST):Le(n.SCISSOR_TEST)}function Ct(ie){ie===void 0&&(ie=n.TEXTURE0+te-1),H!==ie&&(n.activeTexture(ie),H=ie)}function Ge(ie,me,je){je===void 0&&(H===null?je=n.TEXTURE0+te-1:je=H);let at=W[je];at===void 0&&(at={type:void 0,texture:void 0},W[je]=at),(at.type!==ie||at.texture!==me)&&(H!==je&&(n.activeTexture(je),H=je),n.bindTexture(ie,me||se[ie]),at.type=ie,at.texture=me)}function J(){const ie=W[H];ie!==void 0&&ie.type!==void 0&&(n.bindTexture(ie.type,null),ie.type=void 0,ie.texture=void 0)}function L(){try{n.compressedTexImage2D(...arguments)}catch(ie){It("WebGLState:",ie)}}function q(){try{n.compressedTexImage3D(...arguments)}catch(ie){It("WebGLState:",ie)}}function pe(){try{n.texSubImage2D(...arguments)}catch(ie){It("WebGLState:",ie)}}function ve(){try{n.texSubImage3D(...arguments)}catch(ie){It("WebGLState:",ie)}}function ge(){try{n.compressedTexSubImage2D(...arguments)}catch(ie){It("WebGLState:",ie)}}function st(){try{n.compressedTexSubImage3D(...arguments)}catch(ie){It("WebGLState:",ie)}}function Ke(){try{n.texStorage2D(...arguments)}catch(ie){It("WebGLState:",ie)}}function dt(){try{n.texStorage3D(...arguments)}catch(ie){It("WebGLState:",ie)}}function _t(){try{n.texImage2D(...arguments)}catch(ie){It("WebGLState:",ie)}}function Fe(){try{n.texImage3D(...arguments)}catch(ie){It("WebGLState:",ie)}}function He(ie){de.equals(ie)===!1&&(n.scissor(ie.x,ie.y,ie.z,ie.w),de.copy(ie))}function xt(ie){Ce.equals(ie)===!1&&(n.viewport(ie.x,ie.y,ie.z,ie.w),Ce.copy(ie))}function re(ie,me){let je=u.get(me);je===void 0&&(je=new WeakMap,u.set(me,je));let at=je.get(ie);at===void 0&&(at=n.getUniformBlockIndex(me,ie.name),je.set(ie,at))}function fe(ie,me){const at=u.get(me).get(ie);c.get(me)!==at&&(n.uniformBlockBinding(me,at,ie.__bindingPointIndex),c.set(me,at))}function ke(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),a.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),f={},H=null,W={},p={},m=new WeakMap,g=[],y=null,S=!1,w=null,x=null,_=null,b=null,M=null,N=null,C=null,I=new ut(0,0,0),P=0,T=!1,R=null,j=null,O=null,k=null,Z=null,de.set(0,0,n.canvas.width,n.canvas.height),Ce.set(0,0,n.canvas.width,n.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:_e,disable:Le,bindFramebuffer:yt,drawBuffers:qe,useProgram:lt,setBlending:Me,setMaterial:Be,setFlipSided:Ie,setCullFace:Ye,setLineWidth:Q,setPolygonOffset:vt,setScissorTest:et,activeTexture:Ct,bindTexture:Ge,unbindTexture:J,compressedTexImage2D:L,compressedTexImage3D:q,texImage2D:_t,texImage3D:Fe,updateUBOMapping:re,uniformBlockBinding:fe,texStorage2D:Ke,texStorage3D:dt,texSubImage2D:pe,texSubImage3D:ve,compressedTexSubImage2D:ge,compressedTexSubImage3D:st,scissor:He,viewport:xt,reset:ke}}function BG(n,e,t,r,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Te,f=new WeakMap;let p;const m=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(J,L){return g?new OffscreenCanvas(J,L):Qh("canvas")}function S(J,L,q){let pe=1;const ve=Ge(J);if((ve.width>q||ve.height>q)&&(pe=q/Math.max(ve.width,ve.height)),pe<1)if(typeof HTMLImageElement<"u"&&J instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&J instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&J instanceof ImageBitmap||typeof VideoFrame<"u"&&J instanceof VideoFrame){const ge=Math.floor(pe*ve.width),st=Math.floor(pe*ve.height);p===void 0&&(p=y(ge,st));const Ke=L?y(ge,st):p;return Ke.width=ge,Ke.height=st,Ke.getContext("2d").drawImage(J,0,0,ge,st),ct("WebGLRenderer: Texture has been resized from ("+ve.width+"x"+ve.height+") to ("+ge+"x"+st+")."),Ke}else return"data"in J&&ct("WebGLRenderer: Image in DataTexture is too big ("+ve.width+"x"+ve.height+")."),J;return J}function w(J){return J.generateMipmaps}function x(J){n.generateMipmap(J)}function _(J){return J.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:J.isWebGL3DRenderTarget?n.TEXTURE_3D:J.isWebGLArrayRenderTarget||J.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function b(J,L,q,pe,ve=!1){if(J!==null){if(n[J]!==void 0)return n[J];ct("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+J+"'")}let ge=L;if(L===n.RED&&(q===n.FLOAT&&(ge=n.R32F),q===n.HALF_FLOAT&&(ge=n.R16F),q===n.UNSIGNED_BYTE&&(ge=n.R8)),L===n.RED_INTEGER&&(q===n.UNSIGNED_BYTE&&(ge=n.R8UI),q===n.UNSIGNED_SHORT&&(ge=n.R16UI),q===n.UNSIGNED_INT&&(ge=n.R32UI),q===n.BYTE&&(ge=n.R8I),q===n.SHORT&&(ge=n.R16I),q===n.INT&&(ge=n.R32I)),L===n.RG&&(q===n.FLOAT&&(ge=n.RG32F),q===n.HALF_FLOAT&&(ge=n.RG16F),q===n.UNSIGNED_BYTE&&(ge=n.RG8)),L===n.RG_INTEGER&&(q===n.UNSIGNED_BYTE&&(ge=n.RG8UI),q===n.UNSIGNED_SHORT&&(ge=n.RG16UI),q===n.UNSIGNED_INT&&(ge=n.RG32UI),q===n.BYTE&&(ge=n.RG8I),q===n.SHORT&&(ge=n.RG16I),q===n.INT&&(ge=n.RG32I)),L===n.RGB_INTEGER&&(q===n.UNSIGNED_BYTE&&(ge=n.RGB8UI),q===n.UNSIGNED_SHORT&&(ge=n.RGB16UI),q===n.UNSIGNED_INT&&(ge=n.RGB32UI),q===n.BYTE&&(ge=n.RGB8I),q===n.SHORT&&(ge=n.RGB16I),q===n.INT&&(ge=n.RGB32I)),L===n.RGBA_INTEGER&&(q===n.UNSIGNED_BYTE&&(ge=n.RGBA8UI),q===n.UNSIGNED_SHORT&&(ge=n.RGBA16UI),q===n.UNSIGNED_INT&&(ge=n.RGBA32UI),q===n.BYTE&&(ge=n.RGBA8I),q===n.SHORT&&(ge=n.RGBA16I),q===n.INT&&(ge=n.RGBA32I)),L===n.RGB&&(q===n.UNSIGNED_INT_5_9_9_9_REV&&(ge=n.RGB9_E5),q===n.UNSIGNED_INT_10F_11F_11F_REV&&(ge=n.R11F_G11F_B10F)),L===n.RGBA){const st=ve?Zh:nn.getTransfer(pe);q===n.FLOAT&&(ge=n.RGBA32F),q===n.HALF_FLOAT&&(ge=n.RGBA16F),q===n.UNSIGNED_BYTE&&(ge=st===fn?n.SRGB8_ALPHA8:n.RGBA8),q===n.UNSIGNED_SHORT_4_4_4_4&&(ge=n.RGBA4),q===n.UNSIGNED_SHORT_5_5_5_1&&(ge=n.RGB5_A1)}return(ge===n.R16F||ge===n.R32F||ge===n.RG16F||ge===n.RG32F||ge===n.RGBA16F||ge===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ge}function M(J,L){let q;return J?L===null||L===Fi||L===Fu?q=n.DEPTH24_STENCIL8:L===En?q=n.DEPTH32F_STENCIL8:L===Du&&(q=n.DEPTH24_STENCIL8,ct("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):L===null||L===Fi||L===Fu?q=n.DEPTH_COMPONENT24:L===En?q=n.DEPTH_COMPONENT32F:L===Du&&(q=n.DEPTH_COMPONENT16),q}function N(J,L){return w(J)===!0||J.isFramebufferTexture&&J.minFilter!==Un&&J.minFilter!==en?Math.log2(Math.max(L.width,L.height))+1:J.mipmaps!==void 0&&J.mipmaps.length>0?J.mipmaps.length:J.isCompressedTexture&&Array.isArray(J.image)?L.mipmaps.length:1}function C(J){const L=J.target;L.removeEventListener("dispose",C),P(L),L.isVideoTexture&&f.delete(L)}function I(J){const L=J.target;L.removeEventListener("dispose",I),R(L)}function P(J){const L=r.get(J);if(L.__webglInit===void 0)return;const q=J.source,pe=m.get(q);if(pe){const ve=pe[L.__cacheKey];ve.usedTimes--,ve.usedTimes===0&&T(J),Object.keys(pe).length===0&&m.delete(q)}r.remove(J)}function T(J){const L=r.get(J);n.deleteTexture(L.__webglTexture);const q=J.source,pe=m.get(q);delete pe[L.__cacheKey],a.memory.textures--}function R(J){const L=r.get(J);if(J.depthTexture&&(J.depthTexture.dispose(),r.remove(J.depthTexture)),J.isWebGLCubeRenderTarget)for(let pe=0;pe<6;pe++){if(Array.isArray(L.__webglFramebuffer[pe]))for(let ve=0;ve<L.__webglFramebuffer[pe].length;ve++)n.deleteFramebuffer(L.__webglFramebuffer[pe][ve]);else n.deleteFramebuffer(L.__webglFramebuffer[pe]);L.__webglDepthbuffer&&n.deleteRenderbuffer(L.__webglDepthbuffer[pe])}else{if(Array.isArray(L.__webglFramebuffer))for(let pe=0;pe<L.__webglFramebuffer.length;pe++)n.deleteFramebuffer(L.__webglFramebuffer[pe]);else n.deleteFramebuffer(L.__webglFramebuffer);if(L.__webglDepthbuffer&&n.deleteRenderbuffer(L.__webglDepthbuffer),L.__webglMultisampledFramebuffer&&n.deleteFramebuffer(L.__webglMultisampledFramebuffer),L.__webglColorRenderbuffer)for(let pe=0;pe<L.__webglColorRenderbuffer.length;pe++)L.__webglColorRenderbuffer[pe]&&n.deleteRenderbuffer(L.__webglColorRenderbuffer[pe]);L.__webglDepthRenderbuffer&&n.deleteRenderbuffer(L.__webglDepthRenderbuffer)}const q=J.textures;for(let pe=0,ve=q.length;pe<ve;pe++){const ge=r.get(q[pe]);ge.__webglTexture&&(n.deleteTexture(ge.__webglTexture),a.memory.textures--),r.remove(q[pe])}r.remove(J)}let j=0;function O(){j=0}function k(){const J=j;return J>=i.maxTextures&&ct("WebGLTextures: Trying to use "+J+" texture units while this GPU supports only "+i.maxTextures),j+=1,J}function Z(J){const L=[];return L.push(J.wrapS),L.push(J.wrapT),L.push(J.wrapR||0),L.push(J.magFilter),L.push(J.minFilter),L.push(J.anisotropy),L.push(J.internalFormat),L.push(J.format),L.push(J.type),L.push(J.generateMipmaps),L.push(J.premultiplyAlpha),L.push(J.flipY),L.push(J.unpackAlignment),L.push(J.colorSpace),L.join()}function te(J,L){const q=r.get(J);if(J.isVideoTexture&&et(J),J.isRenderTargetTexture===!1&&J.isExternalTexture!==!0&&J.version>0&&q.__version!==J.version){const pe=J.image;if(pe===null)ct("WebGLRenderer: Texture marked for update but no image data found.");else if(pe.complete===!1)ct("WebGLRenderer: Texture marked for update but image is incomplete");else{se(q,J,L);return}}else J.isExternalTexture&&(q.__webglTexture=J.sourceTexture?J.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,q.__webglTexture,n.TEXTURE0+L)}function K(J,L){const q=r.get(J);if(J.isRenderTargetTexture===!1&&J.version>0&&q.__version!==J.version){se(q,J,L);return}else J.isExternalTexture&&(q.__webglTexture=J.sourceTexture?J.sourceTexture:null);t.bindTexture(n.TEXTURE_2D_ARRAY,q.__webglTexture,n.TEXTURE0+L)}function $(J,L){const q=r.get(J);if(J.isRenderTargetTexture===!1&&J.version>0&&q.__version!==J.version){se(q,J,L);return}t.bindTexture(n.TEXTURE_3D,q.__webglTexture,n.TEXTURE0+L)}function U(J,L){const q=r.get(J);if(J.isCubeDepthTexture!==!0&&J.version>0&&q.__version!==J.version){_e(q,J,L);return}t.bindTexture(n.TEXTURE_CUBE_MAP,q.__webglTexture,n.TEXTURE0+L)}const H={[Io]:n.REPEAT,[Pn]:n.CLAMP_TO_EDGE,[Lu]:n.MIRRORED_REPEAT},W={[Un]:n.NEAREST,[nx]:n.NEAREST_MIPMAP_NEAREST,[Ml]:n.NEAREST_MIPMAP_LINEAR,[en]:n.LINEAR,[yu]:n.LINEAR_MIPMAP_NEAREST,[es]:n.LINEAR_MIPMAP_LINEAR},Y={[G3]:n.NEVER,[Y3]:n.ALWAYS,[V3]:n.LESS,[ux]:n.LEQUAL,[W3]:n.EQUAL,[dx]:n.GEQUAL,[X3]:n.GREATER,[J3]:n.NOTEQUAL};function G(J,L){if(L.type===En&&e.has("OES_texture_float_linear")===!1&&(L.magFilter===en||L.magFilter===yu||L.magFilter===Ml||L.magFilter===es||L.minFilter===en||L.minFilter===yu||L.minFilter===Ml||L.minFilter===es)&&ct("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(J,n.TEXTURE_WRAP_S,H[L.wrapS]),n.texParameteri(J,n.TEXTURE_WRAP_T,H[L.wrapT]),(J===n.TEXTURE_3D||J===n.TEXTURE_2D_ARRAY)&&n.texParameteri(J,n.TEXTURE_WRAP_R,H[L.wrapR]),n.texParameteri(J,n.TEXTURE_MAG_FILTER,W[L.magFilter]),n.texParameteri(J,n.TEXTURE_MIN_FILTER,W[L.minFilter]),L.compareFunction&&(n.texParameteri(J,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(J,n.TEXTURE_COMPARE_FUNC,Y[L.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(L.magFilter===Un||L.minFilter!==Ml&&L.minFilter!==es||L.type===En&&e.has("OES_texture_float_linear")===!1)return;if(L.anisotropy>1||r.get(L).__currentAnisotropy){const q=e.get("EXT_texture_filter_anisotropic");n.texParameterf(J,q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,i.getMaxAnisotropy())),r.get(L).__currentAnisotropy=L.anisotropy}}}function de(J,L){let q=!1;J.__webglInit===void 0&&(J.__webglInit=!0,L.addEventListener("dispose",C));const pe=L.source;let ve=m.get(pe);ve===void 0&&(ve={},m.set(pe,ve));const ge=Z(L);if(ge!==J.__cacheKey){ve[ge]===void 0&&(ve[ge]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,q=!0),ve[ge].usedTimes++;const st=ve[J.__cacheKey];st!==void 0&&(ve[J.__cacheKey].usedTimes--,st.usedTimes===0&&T(L)),J.__cacheKey=ge,J.__webglTexture=ve[ge].texture}return q}function Ce(J,L,q){return Math.floor(Math.floor(J/q)/L)}function be(J,L,q,pe){const ge=J.updateRanges;if(ge.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,L.width,L.height,q,pe,L.data);else{ge.sort((Fe,He)=>Fe.start-He.start);let st=0;for(let Fe=1;Fe<ge.length;Fe++){const He=ge[st],xt=ge[Fe],re=He.start+He.count,fe=Ce(xt.start,L.width,4),ke=Ce(He.start,L.width,4);xt.start<=re+1&&fe===ke&&Ce(xt.start+xt.count-1,L.width,4)===fe?He.count=Math.max(He.count,xt.start+xt.count-He.start):(++st,ge[st]=xt)}ge.length=st+1;const Ke=n.getParameter(n.UNPACK_ROW_LENGTH),dt=n.getParameter(n.UNPACK_SKIP_PIXELS),_t=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,L.width);for(let Fe=0,He=ge.length;Fe<He;Fe++){const xt=ge[Fe],re=Math.floor(xt.start/4),fe=Math.ceil(xt.count/4),ke=re%L.width,ie=Math.floor(re/L.width),me=fe,je=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,ke),n.pixelStorei(n.UNPACK_SKIP_ROWS,ie),t.texSubImage2D(n.TEXTURE_2D,0,ke,ie,me,je,q,pe,L.data)}J.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,Ke),n.pixelStorei(n.UNPACK_SKIP_PIXELS,dt),n.pixelStorei(n.UNPACK_SKIP_ROWS,_t)}}function se(J,L,q){let pe=n.TEXTURE_2D;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(pe=n.TEXTURE_2D_ARRAY),L.isData3DTexture&&(pe=n.TEXTURE_3D);const ve=de(J,L),ge=L.source;t.bindTexture(pe,J.__webglTexture,n.TEXTURE0+q);const st=r.get(ge);if(ge.version!==st.__version||ve===!0){t.activeTexture(n.TEXTURE0+q);const Ke=nn.getPrimaries(nn.workingColorSpace),dt=L.colorSpace===ya?null:nn.getPrimaries(L.colorSpace),_t=L.colorSpace===ya||Ke===dt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,L.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,L.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,_t);let Fe=S(L.image,!1,i.maxTextureSize);Fe=Ct(L,Fe);const He=s.convert(L.format,L.colorSpace),xt=s.convert(L.type);let re=b(L.internalFormat,He,xt,L.colorSpace,L.isVideoTexture);G(pe,L);let fe;const ke=L.mipmaps,ie=L.isVideoTexture!==!0,me=st.__version===void 0||ve===!0,je=ge.dataReady,at=N(L,Fe);if(L.isDepthTexture)re=M(L.format===ho,L.type),me&&(ie?t.texStorage2D(n.TEXTURE_2D,1,re,Fe.width,Fe.height):t.texImage2D(n.TEXTURE_2D,0,re,Fe.width,Fe.height,0,He,xt,null));else if(L.isDataTexture)if(ke.length>0){ie&&me&&t.texStorage2D(n.TEXTURE_2D,at,re,ke[0].width,ke[0].height);for(let ze=0,Re=ke.length;ze<Re;ze++)fe=ke[ze],ie?je&&t.texSubImage2D(n.TEXTURE_2D,ze,0,0,fe.width,fe.height,He,xt,fe.data):t.texImage2D(n.TEXTURE_2D,ze,re,fe.width,fe.height,0,He,xt,fe.data);L.generateMipmaps=!1}else ie?(me&&t.texStorage2D(n.TEXTURE_2D,at,re,Fe.width,Fe.height),je&&be(L,Fe,He,xt)):t.texImage2D(n.TEXTURE_2D,0,re,Fe.width,Fe.height,0,He,xt,Fe.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){ie&&me&&t.texStorage3D(n.TEXTURE_2D_ARRAY,at,re,ke[0].width,ke[0].height,Fe.depth);for(let ze=0,Re=ke.length;ze<Re;ze++)if(fe=ke[ze],L.format!==Yn)if(He!==null)if(ie){if(je)if(L.layerUpdates.size>0){const Ve=H1(fe.width,fe.height,L.format,L.type);for(const Tt of L.layerUpdates){const Qt=fe.data.subarray(Tt*Ve/fe.data.BYTES_PER_ELEMENT,(Tt+1)*Ve/fe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ze,0,0,Tt,fe.width,fe.height,1,He,Qt)}L.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ze,0,0,0,fe.width,fe.height,Fe.depth,He,fe.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ze,re,fe.width,fe.height,Fe.depth,0,fe.data,0,0);else ct("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ie?je&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,ze,0,0,0,fe.width,fe.height,Fe.depth,He,xt,fe.data):t.texImage3D(n.TEXTURE_2D_ARRAY,ze,re,fe.width,fe.height,Fe.depth,0,He,xt,fe.data)}else{ie&&me&&t.texStorage2D(n.TEXTURE_2D,at,re,ke[0].width,ke[0].height);for(let ze=0,Re=ke.length;ze<Re;ze++)fe=ke[ze],L.format!==Yn?He!==null?ie?je&&t.compressedTexSubImage2D(n.TEXTURE_2D,ze,0,0,fe.width,fe.height,He,fe.data):t.compressedTexImage2D(n.TEXTURE_2D,ze,re,fe.width,fe.height,0,fe.data):ct("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ie?je&&t.texSubImage2D(n.TEXTURE_2D,ze,0,0,fe.width,fe.height,He,xt,fe.data):t.texImage2D(n.TEXTURE_2D,ze,re,fe.width,fe.height,0,He,xt,fe.data)}else if(L.isDataArrayTexture)if(ie){if(me&&t.texStorage3D(n.TEXTURE_2D_ARRAY,at,re,Fe.width,Fe.height,Fe.depth),je)if(L.layerUpdates.size>0){const ze=H1(Fe.width,Fe.height,L.format,L.type);for(const Re of L.layerUpdates){const Ve=Fe.data.subarray(Re*ze/Fe.data.BYTES_PER_ELEMENT,(Re+1)*ze/Fe.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Re,Fe.width,Fe.height,1,He,xt,Ve)}L.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Fe.width,Fe.height,Fe.depth,He,xt,Fe.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,re,Fe.width,Fe.height,Fe.depth,0,He,xt,Fe.data);else if(L.isData3DTexture)ie?(me&&t.texStorage3D(n.TEXTURE_3D,at,re,Fe.width,Fe.height,Fe.depth),je&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Fe.width,Fe.height,Fe.depth,He,xt,Fe.data)):t.texImage3D(n.TEXTURE_3D,0,re,Fe.width,Fe.height,Fe.depth,0,He,xt,Fe.data);else if(L.isFramebufferTexture){if(me)if(ie)t.texStorage2D(n.TEXTURE_2D,at,re,Fe.width,Fe.height);else{let ze=Fe.width,Re=Fe.height;for(let Ve=0;Ve<at;Ve++)t.texImage2D(n.TEXTURE_2D,Ve,re,ze,Re,0,He,xt,null),ze>>=1,Re>>=1}}else if(ke.length>0){if(ie&&me){const ze=Ge(ke[0]);t.texStorage2D(n.TEXTURE_2D,at,re,ze.width,ze.height)}for(let ze=0,Re=ke.length;ze<Re;ze++)fe=ke[ze],ie?je&&t.texSubImage2D(n.TEXTURE_2D,ze,0,0,He,xt,fe):t.texImage2D(n.TEXTURE_2D,ze,re,He,xt,fe);L.generateMipmaps=!1}else if(ie){if(me){const ze=Ge(Fe);t.texStorage2D(n.TEXTURE_2D,at,re,ze.width,ze.height)}je&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,He,xt,Fe)}else t.texImage2D(n.TEXTURE_2D,0,re,He,xt,Fe);w(L)&&x(pe),st.__version=ge.version,L.onUpdate&&L.onUpdate(L)}J.__version=L.version}function _e(J,L,q){if(L.image.length!==6)return;const pe=de(J,L),ve=L.source;t.bindTexture(n.TEXTURE_CUBE_MAP,J.__webglTexture,n.TEXTURE0+q);const ge=r.get(ve);if(ve.version!==ge.__version||pe===!0){t.activeTexture(n.TEXTURE0+q);const st=nn.getPrimaries(nn.workingColorSpace),Ke=L.colorSpace===ya?null:nn.getPrimaries(L.colorSpace),dt=L.colorSpace===ya||st===Ke?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,L.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,L.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,dt);const _t=L.isCompressedTexture||L.image[0].isCompressedTexture,Fe=L.image[0]&&L.image[0].isDataTexture,He=[];for(let Re=0;Re<6;Re++)!_t&&!Fe?He[Re]=S(L.image[Re],!0,i.maxCubemapSize):He[Re]=Fe?L.image[Re].image:L.image[Re],He[Re]=Ct(L,He[Re]);const xt=He[0],re=s.convert(L.format,L.colorSpace),fe=s.convert(L.type),ke=b(L.internalFormat,re,fe,L.colorSpace),ie=L.isVideoTexture!==!0,me=ge.__version===void 0||pe===!0,je=ve.dataReady;let at=N(L,xt);G(n.TEXTURE_CUBE_MAP,L);let ze;if(_t){ie&&me&&t.texStorage2D(n.TEXTURE_CUBE_MAP,at,ke,xt.width,xt.height);for(let Re=0;Re<6;Re++){ze=He[Re].mipmaps;for(let Ve=0;Ve<ze.length;Ve++){const Tt=ze[Ve];L.format!==Yn?re!==null?ie?je&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve,0,0,Tt.width,Tt.height,re,Tt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve,ke,Tt.width,Tt.height,0,Tt.data):ct("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ie?je&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve,0,0,Tt.width,Tt.height,re,fe,Tt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve,ke,Tt.width,Tt.height,0,re,fe,Tt.data)}}}else{if(ze=L.mipmaps,ie&&me){ze.length>0&&at++;const Re=Ge(He[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,at,ke,Re.width,Re.height)}for(let Re=0;Re<6;Re++)if(Fe){ie?je&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,0,0,He[Re].width,He[Re].height,re,fe,He[Re].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,ke,He[Re].width,He[Re].height,0,re,fe,He[Re].data);for(let Ve=0;Ve<ze.length;Ve++){const Qt=ze[Ve].image[Re].image;ie?je&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve+1,0,0,Qt.width,Qt.height,re,fe,Qt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve+1,ke,Qt.width,Qt.height,0,re,fe,Qt.data)}}else{ie?je&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,0,0,re,fe,He[Re]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,ke,re,fe,He[Re]);for(let Ve=0;Ve<ze.length;Ve++){const Tt=ze[Ve];ie?je&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve+1,0,0,re,fe,Tt.image[Re]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Ve+1,ke,re,fe,Tt.image[Re])}}}w(L)&&x(n.TEXTURE_CUBE_MAP),ge.__version=ve.version,L.onUpdate&&L.onUpdate(L)}J.__version=L.version}function Le(J,L,q,pe,ve,ge){const st=s.convert(q.format,q.colorSpace),Ke=s.convert(q.type),dt=b(q.internalFormat,st,Ke,q.colorSpace),_t=r.get(L),Fe=r.get(q);if(Fe.__renderTarget=L,!_t.__hasExternalTextures){const He=Math.max(1,L.width>>ge),xt=Math.max(1,L.height>>ge);ve===n.TEXTURE_3D||ve===n.TEXTURE_2D_ARRAY?t.texImage3D(ve,ge,dt,He,xt,L.depth,0,st,Ke,null):t.texImage2D(ve,ge,dt,He,xt,0,st,Ke,null)}t.bindFramebuffer(n.FRAMEBUFFER,J),vt(L)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,pe,ve,Fe.__webglTexture,0,Q(L)):(ve===n.TEXTURE_2D||ve>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ve<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,pe,ve,Fe.__webglTexture,ge),t.bindFramebuffer(n.FRAMEBUFFER,null)}function yt(J,L,q){if(n.bindRenderbuffer(n.RENDERBUFFER,J),L.depthBuffer){const pe=L.depthTexture,ve=pe&&pe.isDepthTexture?pe.type:null,ge=M(L.stencilBuffer,ve),st=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;vt(L)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Q(L),ge,L.width,L.height):q?n.renderbufferStorageMultisample(n.RENDERBUFFER,Q(L),ge,L.width,L.height):n.renderbufferStorage(n.RENDERBUFFER,ge,L.width,L.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,st,n.RENDERBUFFER,J)}else{const pe=L.textures;for(let ve=0;ve<pe.length;ve++){const ge=pe[ve],st=s.convert(ge.format,ge.colorSpace),Ke=s.convert(ge.type),dt=b(ge.internalFormat,st,Ke,ge.colorSpace);vt(L)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Q(L),dt,L.width,L.height):q?n.renderbufferStorageMultisample(n.RENDERBUFFER,Q(L),dt,L.width,L.height):n.renderbufferStorage(n.RENDERBUFFER,dt,L.width,L.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function qe(J,L,q){const pe=L.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(n.FRAMEBUFFER,J),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ve=r.get(L.depthTexture);if(ve.__renderTarget=L,(!ve.__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),pe){if(ve.__webglInit===void 0&&(ve.__webglInit=!0,L.depthTexture.addEventListener("dispose",C)),ve.__webglTexture===void 0){ve.__webglTexture=n.createTexture(),t.bindTexture(n.TEXTURE_CUBE_MAP,ve.__webglTexture),G(n.TEXTURE_CUBE_MAP,L.depthTexture);const _t=s.convert(L.depthTexture.format),Fe=s.convert(L.depthTexture.type);let He;L.depthTexture.format===$s?He=n.DEPTH_COMPONENT24:L.depthTexture.format===ho&&(He=n.DEPTH24_STENCIL8);for(let xt=0;xt<6;xt++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+xt,0,He,L.width,L.height,0,_t,Fe,null)}}else te(L.depthTexture,0);const ge=ve.__webglTexture,st=Q(L),Ke=pe?n.TEXTURE_CUBE_MAP_POSITIVE_X+q:n.TEXTURE_2D,dt=L.depthTexture.format===ho?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(L.depthTexture.format===$s)vt(L)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,dt,Ke,ge,0,st):n.framebufferTexture2D(n.FRAMEBUFFER,dt,Ke,ge,0);else if(L.depthTexture.format===ho)vt(L)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,dt,Ke,ge,0,st):n.framebufferTexture2D(n.FRAMEBUFFER,dt,Ke,ge,0);else throw new Error("Unknown depthTexture format")}function lt(J){const L=r.get(J),q=J.isWebGLCubeRenderTarget===!0;if(L.__boundDepthTexture!==J.depthTexture){const pe=J.depthTexture;if(L.__depthDisposeCallback&&L.__depthDisposeCallback(),pe){const ve=()=>{delete L.__boundDepthTexture,delete L.__depthDisposeCallback,pe.removeEventListener("dispose",ve)};pe.addEventListener("dispose",ve),L.__depthDisposeCallback=ve}L.__boundDepthTexture=pe}if(J.depthTexture&&!L.__autoAllocateDepthBuffer)if(q)for(let pe=0;pe<6;pe++)qe(L.__webglFramebuffer[pe],J,pe);else{const pe=J.texture.mipmaps;pe&&pe.length>0?qe(L.__webglFramebuffer[0],J,0):qe(L.__webglFramebuffer,J,0)}else if(q){L.__webglDepthbuffer=[];for(let pe=0;pe<6;pe++)if(t.bindFramebuffer(n.FRAMEBUFFER,L.__webglFramebuffer[pe]),L.__webglDepthbuffer[pe]===void 0)L.__webglDepthbuffer[pe]=n.createRenderbuffer(),yt(L.__webglDepthbuffer[pe],J,!1);else{const ve=J.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ge=L.__webglDepthbuffer[pe];n.bindRenderbuffer(n.RENDERBUFFER,ge),n.framebufferRenderbuffer(n.FRAMEBUFFER,ve,n.RENDERBUFFER,ge)}}else{const pe=J.texture.mipmaps;if(pe&&pe.length>0?t.bindFramebuffer(n.FRAMEBUFFER,L.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,L.__webglFramebuffer),L.__webglDepthbuffer===void 0)L.__webglDepthbuffer=n.createRenderbuffer(),yt(L.__webglDepthbuffer,J,!1);else{const ve=J.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ge=L.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ge),n.framebufferRenderbuffer(n.FRAMEBUFFER,ve,n.RENDERBUFFER,ge)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function kt(J,L,q){const pe=r.get(J);L!==void 0&&Le(pe.__webglFramebuffer,J,J.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),q!==void 0&&lt(J)}function it(J){const L=J.texture,q=r.get(J),pe=r.get(L);J.addEventListener("dispose",I);const ve=J.textures,ge=J.isWebGLCubeRenderTarget===!0,st=ve.length>1;if(st||(pe.__webglTexture===void 0&&(pe.__webglTexture=n.createTexture()),pe.__version=L.version,a.memory.textures++),ge){q.__webglFramebuffer=[];for(let Ke=0;Ke<6;Ke++)if(L.mipmaps&&L.mipmaps.length>0){q.__webglFramebuffer[Ke]=[];for(let dt=0;dt<L.mipmaps.length;dt++)q.__webglFramebuffer[Ke][dt]=n.createFramebuffer()}else q.__webglFramebuffer[Ke]=n.createFramebuffer()}else{if(L.mipmaps&&L.mipmaps.length>0){q.__webglFramebuffer=[];for(let Ke=0;Ke<L.mipmaps.length;Ke++)q.__webglFramebuffer[Ke]=n.createFramebuffer()}else q.__webglFramebuffer=n.createFramebuffer();if(st)for(let Ke=0,dt=ve.length;Ke<dt;Ke++){const _t=r.get(ve[Ke]);_t.__webglTexture===void 0&&(_t.__webglTexture=n.createTexture(),a.memory.textures++)}if(J.samples>0&&vt(J)===!1){q.__webglMultisampledFramebuffer=n.createFramebuffer(),q.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,q.__webglMultisampledFramebuffer);for(let Ke=0;Ke<ve.length;Ke++){const dt=ve[Ke];q.__webglColorRenderbuffer[Ke]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,q.__webglColorRenderbuffer[Ke]);const _t=s.convert(dt.format,dt.colorSpace),Fe=s.convert(dt.type),He=b(dt.internalFormat,_t,Fe,dt.colorSpace,J.isXRRenderTarget===!0),xt=Q(J);n.renderbufferStorageMultisample(n.RENDERBUFFER,xt,He,J.width,J.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ke,n.RENDERBUFFER,q.__webglColorRenderbuffer[Ke])}n.bindRenderbuffer(n.RENDERBUFFER,null),J.depthBuffer&&(q.__webglDepthRenderbuffer=n.createRenderbuffer(),yt(q.__webglDepthRenderbuffer,J,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ge){t.bindTexture(n.TEXTURE_CUBE_MAP,pe.__webglTexture),G(n.TEXTURE_CUBE_MAP,L);for(let Ke=0;Ke<6;Ke++)if(L.mipmaps&&L.mipmaps.length>0)for(let dt=0;dt<L.mipmaps.length;dt++)Le(q.__webglFramebuffer[Ke][dt],J,L,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,dt);else Le(q.__webglFramebuffer[Ke],J,L,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0);w(L)&&x(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(st){for(let Ke=0,dt=ve.length;Ke<dt;Ke++){const _t=ve[Ke],Fe=r.get(_t);let He=n.TEXTURE_2D;(J.isWebGL3DRenderTarget||J.isWebGLArrayRenderTarget)&&(He=J.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(He,Fe.__webglTexture),G(He,_t),Le(q.__webglFramebuffer,J,_t,n.COLOR_ATTACHMENT0+Ke,He,0),w(_t)&&x(He)}t.unbindTexture()}else{let Ke=n.TEXTURE_2D;if((J.isWebGL3DRenderTarget||J.isWebGLArrayRenderTarget)&&(Ke=J.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ke,pe.__webglTexture),G(Ke,L),L.mipmaps&&L.mipmaps.length>0)for(let dt=0;dt<L.mipmaps.length;dt++)Le(q.__webglFramebuffer[dt],J,L,n.COLOR_ATTACHMENT0,Ke,dt);else Le(q.__webglFramebuffer,J,L,n.COLOR_ATTACHMENT0,Ke,0);w(L)&&x(Ke),t.unbindTexture()}J.depthBuffer&&lt(J)}function Me(J){const L=J.textures;for(let q=0,pe=L.length;q<pe;q++){const ve=L[q];if(w(ve)){const ge=_(J),st=r.get(ve).__webglTexture;t.bindTexture(ge,st),x(ge),t.unbindTexture()}}}const Be=[],Ie=[];function Ye(J){if(J.samples>0){if(vt(J)===!1){const L=J.textures,q=J.width,pe=J.height;let ve=n.COLOR_BUFFER_BIT;const ge=J.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,st=r.get(J),Ke=L.length>1;if(Ke)for(let _t=0;_t<L.length;_t++)t.bindFramebuffer(n.FRAMEBUFFER,st.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+_t,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,st.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+_t,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,st.__webglMultisampledFramebuffer);const dt=J.texture.mipmaps;dt&&dt.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,st.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,st.__webglFramebuffer);for(let _t=0;_t<L.length;_t++){if(J.resolveDepthBuffer&&(J.depthBuffer&&(ve|=n.DEPTH_BUFFER_BIT),J.stencilBuffer&&J.resolveStencilBuffer&&(ve|=n.STENCIL_BUFFER_BIT)),Ke){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,st.__webglColorRenderbuffer[_t]);const Fe=r.get(L[_t]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Fe,0)}n.blitFramebuffer(0,0,q,pe,0,0,q,pe,ve,n.NEAREST),c===!0&&(Be.length=0,Ie.length=0,Be.push(n.COLOR_ATTACHMENT0+_t),J.depthBuffer&&J.resolveDepthBuffer===!1&&(Be.push(ge),Ie.push(ge),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Ie)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Be))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ke)for(let _t=0;_t<L.length;_t++){t.bindFramebuffer(n.FRAMEBUFFER,st.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+_t,n.RENDERBUFFER,st.__webglColorRenderbuffer[_t]);const Fe=r.get(L[_t]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,st.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+_t,n.TEXTURE_2D,Fe,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,st.__webglMultisampledFramebuffer)}else if(J.depthBuffer&&J.resolveDepthBuffer===!1&&c){const L=J.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[L])}}}function Q(J){return Math.min(i.maxSamples,J.samples)}function vt(J){const L=r.get(J);return J.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function et(J){const L=a.render.frame;f.get(J)!==L&&(f.set(J,L),J.update())}function Ct(J,L){const q=J.colorSpace,pe=J.format,ve=J.type;return J.isCompressedTexture===!0||J.isVideoTexture===!0||q!==ea&&q!==ya&&(nn.getTransfer(q)===fn?(pe!==Yn||ve!==gr)&&ct("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):It("WebGLTextures: Unsupported texture color space:",q)),L}function Ge(J){return typeof HTMLImageElement<"u"&&J instanceof HTMLImageElement?(u.width=J.naturalWidth||J.width,u.height=J.naturalHeight||J.height):typeof VideoFrame<"u"&&J instanceof VideoFrame?(u.width=J.displayWidth,u.height=J.displayHeight):(u.width=J.width,u.height=J.height),u}this.allocateTextureUnit=k,this.resetTextureUnits=O,this.setTexture2D=te,this.setTexture2DArray=K,this.setTexture3D=$,this.setTextureCube=U,this.rebindTextures=kt,this.setupRenderTarget=it,this.updateRenderTargetMipmap=Me,this.updateMultisampleRenderTarget=Ye,this.setupDepthRenderbuffer=lt,this.setupFrameBufferTexture=Le,this.useMultisampledRTT=vt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function KR(n,e){function t(r,i=ya){let s;const a=nn.getTransfer(i);if(r===gr)return n.UNSIGNED_BYTE;if(r===sx)return n.UNSIGNED_SHORT_4_4_4_4;if(r===ax)return n.UNSIGNED_SHORT_5_5_5_1;if(r===lw)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===cw)return n.UNSIGNED_INT_10F_11F_11F_REV;if(r===rx)return n.BYTE;if(r===ix)return n.SHORT;if(r===Du)return n.UNSIGNED_SHORT;if(r===vf)return n.INT;if(r===Fi)return n.UNSIGNED_INT;if(r===En)return n.FLOAT;if(r===On)return n.HALF_FLOAT;if(r===uw)return n.ALPHA;if(r===dw)return n.RGB;if(r===Yn)return n.RGBA;if(r===$s)return n.DEPTH_COMPONENT;if(r===ho)return n.DEPTH_STENCIL;if(r===_f)return n.RED;if(r===bf)return n.RED_INTEGER;if(r===Jl)return n.RG;if(r===ox)return n.RG_INTEGER;if(r===lx)return n.RGBA_INTEGER;if(r===yh||r===vh||r===_h||r===bh)if(a===fn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===yh)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===vh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===_h)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===bh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===yh)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===vh)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===_h)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===bh)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===Vg||r===Wg||r===Xg||r===Jg)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===Vg)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Wg)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Xg)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Jg)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===Yg||r===Kg||r===Zg||r===qg||r===Qg||r===$g||r===e0)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===Yg||r===Kg)return a===fn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===Zg)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(r===qg)return s.COMPRESSED_R11_EAC;if(r===Qg)return s.COMPRESSED_SIGNED_R11_EAC;if(r===$g)return s.COMPRESSED_RG11_EAC;if(r===e0)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(r===t0||r===n0||r===r0||r===i0||r===s0||r===a0||r===o0||r===l0||r===c0||r===u0||r===d0||r===h0||r===f0||r===p0)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===t0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===n0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===r0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===i0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===s0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===a0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===o0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===l0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===c0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===u0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===d0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===h0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===f0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===p0)return a===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===m0||r===g0||r===x0)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===m0)return a===fn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===g0)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===x0)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===y0||r===v0||r===_0||r===b0)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===y0)return s.COMPRESSED_RED_RGTC1_EXT;if(r===v0)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===_0)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===b0)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===Fu?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}const LG=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,DG=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class FG{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const r=new Mw(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Hr({vertexShader:LG,fragmentShader:DG,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Tn(new Ho(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class kG extends ta{constructor(e,t){super();const r=this;let i=null,s=1,a=null,o="local-floor",c=1,u=null,f=null,p=null,m=null,g=null,y=null;const S=typeof XRWebGLBinding<"u",w=new FG,x={},_=t.getContextAttributes();let b=null,M=null;const N=[],C=[],I=new Te;let P=null;const T=new Cn;T.viewport=new yn;const R=new Cn;R.viewport=new yn;const j=[T,R],O=new UR;let k=null,Z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let _e=N[se];return _e===void 0&&(_e=new eg,N[se]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(se){let _e=N[se];return _e===void 0&&(_e=new eg,N[se]=_e),_e.getGripSpace()},this.getHand=function(se){let _e=N[se];return _e===void 0&&(_e=new eg,N[se]=_e),_e.getHandSpace()};function te(se){const _e=C.indexOf(se.inputSource);if(_e===-1)return;const Le=N[_e];Le!==void 0&&(Le.update(se.inputSource,se.frame,u||a),Le.dispatchEvent({type:se.type,data:se.inputSource}))}function K(){i.removeEventListener("select",te),i.removeEventListener("selectstart",te),i.removeEventListener("selectend",te),i.removeEventListener("squeeze",te),i.removeEventListener("squeezestart",te),i.removeEventListener("squeezeend",te),i.removeEventListener("end",K),i.removeEventListener("inputsourceschange",$);for(let se=0;se<N.length;se++){const _e=C[se];_e!==null&&(C[se]=null,N[se].disconnect(_e))}k=null,Z=null,w.reset();for(const se in x)delete x[se];e.setRenderTarget(b),g=null,m=null,p=null,i=null,M=null,be.stop(),r.isPresenting=!1,e.setPixelRatio(P),e.setSize(I.width,I.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(se){s=se,r.isPresenting===!0&&ct("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){o=se,r.isPresenting===!0&&ct("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(se){u=se},this.getBaseLayer=function(){return m!==null?m:g},this.getBinding=function(){return p===null&&S&&(p=new XRWebGLBinding(i,t)),p},this.getFrame=function(){return y},this.getSession=function(){return i},this.setSession=async function(se){if(i=se,i!==null){if(b=e.getRenderTarget(),i.addEventListener("select",te),i.addEventListener("selectstart",te),i.addEventListener("selectend",te),i.addEventListener("squeeze",te),i.addEventListener("squeezestart",te),i.addEventListener("squeezeend",te),i.addEventListener("end",K),i.addEventListener("inputsourceschange",$),_.xrCompatible!==!0&&await t.makeXRCompatible(),P=e.getPixelRatio(),e.getSize(I),S&&"createProjectionLayer"in XRWebGLBinding.prototype){let Le=null,yt=null,qe=null;_.depth&&(qe=_.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Le=_.stencil?ho:$s,yt=_.stencil?Fu:Fi);const lt={colorFormat:t.RGBA8,depthFormat:qe,scaleFactor:s};p=this.getBinding(),m=p.createProjectionLayer(lt),i.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),M=new ei(m.textureWidth,m.textureHeight,{format:Yn,type:gr,depthTexture:new Gu(m.textureWidth,m.textureHeight,yt,void 0,void 0,void 0,void 0,void 0,void 0,Le),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}else{const Le={antialias:_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};g=new XRWebGLLayer(i,t,Le),i.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),M=new ei(g.framebufferWidth,g.framebufferHeight,{format:Yn,type:gr,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil,resolveDepthBuffer:g.ignoreDepthValues===!1,resolveStencilBuffer:g.ignoreDepthValues===!1})}M.isXRRenderTarget=!0,this.setFoveation(c),u=null,a=await i.requestReferenceSpace(o),be.setContext(i),be.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return w.getDepthTexture()};function $(se){for(let _e=0;_e<se.removed.length;_e++){const Le=se.removed[_e],yt=C.indexOf(Le);yt>=0&&(C[yt]=null,N[yt].disconnect(Le))}for(let _e=0;_e<se.added.length;_e++){const Le=se.added[_e];let yt=C.indexOf(Le);if(yt===-1){for(let lt=0;lt<N.length;lt++)if(lt>=C.length){C.push(Le),yt=lt;break}else if(C[lt]===null){C[lt]=Le,yt=lt;break}if(yt===-1)break}const qe=N[yt];qe&&qe.connect(Le)}}const U=new X,H=new X;function W(se,_e,Le){U.setFromMatrixPosition(_e.matrixWorld),H.setFromMatrixPosition(Le.matrixWorld);const yt=U.distanceTo(H),qe=_e.projectionMatrix.elements,lt=Le.projectionMatrix.elements,kt=qe[14]/(qe[10]-1),it=qe[14]/(qe[10]+1),Me=(qe[9]+1)/qe[5],Be=(qe[9]-1)/qe[5],Ie=(qe[8]-1)/qe[0],Ye=(lt[8]+1)/lt[0],Q=kt*Ie,vt=kt*Ye,et=yt/(-Ie+Ye),Ct=et*-Ie;if(_e.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(Ct),se.translateZ(et),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert(),qe[10]===-1)se.projectionMatrix.copy(_e.projectionMatrix),se.projectionMatrixInverse.copy(_e.projectionMatrixInverse);else{const Ge=kt+et,J=it+et,L=Q-Ct,q=vt+(yt-Ct),pe=Me*it/J*Ge,ve=Be*it/J*Ge;se.projectionMatrix.makePerspective(L,q,pe,ve,Ge,J),se.projectionMatrixInverse.copy(se.projectionMatrix).invert()}}function Y(se,_e){_e===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(_e.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}this.updateCamera=function(se){if(i===null)return;let _e=se.near,Le=se.far;w.texture!==null&&(w.depthNear>0&&(_e=w.depthNear),w.depthFar>0&&(Le=w.depthFar)),O.near=R.near=T.near=_e,O.far=R.far=T.far=Le,(k!==O.near||Z!==O.far)&&(i.updateRenderState({depthNear:O.near,depthFar:O.far}),k=O.near,Z=O.far),O.layers.mask=se.layers.mask|6,T.layers.mask=O.layers.mask&3,R.layers.mask=O.layers.mask&5;const yt=se.parent,qe=O.cameras;Y(O,yt);for(let lt=0;lt<qe.length;lt++)Y(qe[lt],yt);qe.length===2?W(O,T,R):O.projectionMatrix.copy(T.projectionMatrix),G(se,O,yt)};function G(se,_e,Le){Le===null?se.matrix.copy(_e.matrixWorld):(se.matrix.copy(Le.matrixWorld),se.matrix.invert(),se.matrix.multiply(_e.matrixWorld)),se.matrix.decompose(se.position,se.quaternion,se.scale),se.updateMatrixWorld(!0),se.projectionMatrix.copy(_e.projectionMatrix),se.projectionMatrixInverse.copy(_e.projectionMatrixInverse),se.isPerspectiveCamera&&(se.fov=zu*2*Math.atan(1/se.projectionMatrix.elements[5]),se.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(m===null&&g===null))return c},this.setFoveation=function(se){c=se,m!==null&&(m.fixedFoveation=se),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=se)},this.hasDepthSensing=function(){return w.texture!==null},this.getDepthSensingMesh=function(){return w.getMesh(O)},this.getCameraTexture=function(se){return x[se]};let de=null;function Ce(se,_e){if(f=_e.getViewerPose(u||a),y=_e,f!==null){const Le=f.views;g!==null&&(e.setRenderTargetFramebuffer(M,g.framebuffer),e.setRenderTarget(M));let yt=!1;Le.length!==O.cameras.length&&(O.cameras.length=0,yt=!0);for(let it=0;it<Le.length;it++){const Me=Le[it];let Be=null;if(g!==null)Be=g.getViewport(Me);else{const Ye=p.getViewSubImage(m,Me);Be=Ye.viewport,it===0&&(e.setRenderTargetTextures(M,Ye.colorTexture,Ye.depthStencilTexture),e.setRenderTarget(M))}let Ie=j[it];Ie===void 0&&(Ie=new Cn,Ie.layers.enable(it),Ie.viewport=new yn,j[it]=Ie),Ie.matrix.fromArray(Me.transform.matrix),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.projectionMatrix.fromArray(Me.projectionMatrix),Ie.projectionMatrixInverse.copy(Ie.projectionMatrix).invert(),Ie.viewport.set(Be.x,Be.y,Be.width,Be.height),it===0&&(O.matrix.copy(Ie.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),yt===!0&&O.cameras.push(Ie)}const qe=i.enabledFeatures;if(qe&&qe.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&S){p=r.getBinding();const it=p.getDepthInformation(Le[0]);it&&it.isValid&&it.texture&&w.init(it,i.renderState)}if(qe&&qe.includes("camera-access")&&S){e.state.unbindTexture(),p=r.getBinding();for(let it=0;it<Le.length;it++){const Me=Le[it].camera;if(Me){let Be=x[Me];Be||(Be=new Mw,x[Me]=Be);const Ie=p.getCameraImage(Me);Be.sourceTexture=Ie}}}}for(let Le=0;Le<N.length;Le++){const yt=C[Le],qe=N[Le];yt!==null&&qe!==void 0&&qe.update(yt,_e,u||a)}de&&de(se,_e),_e.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:_e}),y=null}const be=new VR;be.setAnimationLoop(Ce),this.setAnimationLoop=function(se){de=se},this.dispose=function(){}}}const fl=new ki,jG=new Dt;function UG(n,e){function t(w,x){w.matrixAutoUpdate===!0&&w.updateMatrix(),x.value.copy(w.matrix)}function r(w,x){x.color.getRGB(w.fogColor.value,eR(n)),x.isFog?(w.fogNear.value=x.near,w.fogFar.value=x.far):x.isFogExp2&&(w.fogDensity.value=x.density)}function i(w,x,_,b,M){x.isMeshBasicMaterial||x.isMeshLambertMaterial?s(w,x):x.isMeshToonMaterial?(s(w,x),p(w,x)):x.isMeshPhongMaterial?(s(w,x),f(w,x)):x.isMeshStandardMaterial?(s(w,x),m(w,x),x.isMeshPhysicalMaterial&&g(w,x,M)):x.isMeshMatcapMaterial?(s(w,x),y(w,x)):x.isMeshDepthMaterial?s(w,x):x.isMeshDistanceMaterial?(s(w,x),S(w,x)):x.isMeshNormalMaterial?s(w,x):x.isLineBasicMaterial?(a(w,x),x.isLineDashedMaterial&&o(w,x)):x.isPointsMaterial?c(w,x,_,b):x.isSpriteMaterial?u(w,x):x.isShadowMaterial?(w.color.value.copy(x.color),w.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function s(w,x){w.opacity.value=x.opacity,x.color&&w.diffuse.value.copy(x.color),x.emissive&&w.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(w.map.value=x.map,t(x.map,w.mapTransform)),x.alphaMap&&(w.alphaMap.value=x.alphaMap,t(x.alphaMap,w.alphaMapTransform)),x.bumpMap&&(w.bumpMap.value=x.bumpMap,t(x.bumpMap,w.bumpMapTransform),w.bumpScale.value=x.bumpScale,x.side===Ur&&(w.bumpScale.value*=-1)),x.normalMap&&(w.normalMap.value=x.normalMap,t(x.normalMap,w.normalMapTransform),w.normalScale.value.copy(x.normalScale),x.side===Ur&&w.normalScale.value.negate()),x.displacementMap&&(w.displacementMap.value=x.displacementMap,t(x.displacementMap,w.displacementMapTransform),w.displacementScale.value=x.displacementScale,w.displacementBias.value=x.displacementBias),x.emissiveMap&&(w.emissiveMap.value=x.emissiveMap,t(x.emissiveMap,w.emissiveMapTransform)),x.specularMap&&(w.specularMap.value=x.specularMap,t(x.specularMap,w.specularMapTransform)),x.alphaTest>0&&(w.alphaTest.value=x.alphaTest);const _=e.get(x),b=_.envMap,M=_.envMapRotation;b&&(w.envMap.value=b,fl.copy(M),fl.x*=-1,fl.y*=-1,fl.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(fl.y*=-1,fl.z*=-1),w.envMapRotation.value.setFromMatrix4(jG.makeRotationFromEuler(fl)),w.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=x.reflectivity,w.ior.value=x.ior,w.refractionRatio.value=x.refractionRatio),x.lightMap&&(w.lightMap.value=x.lightMap,w.lightMapIntensity.value=x.lightMapIntensity,t(x.lightMap,w.lightMapTransform)),x.aoMap&&(w.aoMap.value=x.aoMap,w.aoMapIntensity.value=x.aoMapIntensity,t(x.aoMap,w.aoMapTransform))}function a(w,x){w.diffuse.value.copy(x.color),w.opacity.value=x.opacity,x.map&&(w.map.value=x.map,t(x.map,w.mapTransform))}function o(w,x){w.dashSize.value=x.dashSize,w.totalSize.value=x.dashSize+x.gapSize,w.scale.value=x.scale}function c(w,x,_,b){w.diffuse.value.copy(x.color),w.opacity.value=x.opacity,w.size.value=x.size*_,w.scale.value=b*.5,x.map&&(w.map.value=x.map,t(x.map,w.uvTransform)),x.alphaMap&&(w.alphaMap.value=x.alphaMap,t(x.alphaMap,w.alphaMapTransform)),x.alphaTest>0&&(w.alphaTest.value=x.alphaTest)}function u(w,x){w.diffuse.value.copy(x.color),w.opacity.value=x.opacity,w.rotation.value=x.rotation,x.map&&(w.map.value=x.map,t(x.map,w.mapTransform)),x.alphaMap&&(w.alphaMap.value=x.alphaMap,t(x.alphaMap,w.alphaMapTransform)),x.alphaTest>0&&(w.alphaTest.value=x.alphaTest)}function f(w,x){w.specular.value.copy(x.specular),w.shininess.value=Math.max(x.shininess,1e-4)}function p(w,x){x.gradientMap&&(w.gradientMap.value=x.gradientMap)}function m(w,x){w.metalness.value=x.metalness,x.metalnessMap&&(w.metalnessMap.value=x.metalnessMap,t(x.metalnessMap,w.metalnessMapTransform)),w.roughness.value=x.roughness,x.roughnessMap&&(w.roughnessMap.value=x.roughnessMap,t(x.roughnessMap,w.roughnessMapTransform)),x.envMap&&(w.envMapIntensity.value=x.envMapIntensity)}function g(w,x,_){w.ior.value=x.ior,x.sheen>0&&(w.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),w.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(w.sheenColorMap.value=x.sheenColorMap,t(x.sheenColorMap,w.sheenColorMapTransform)),x.sheenRoughnessMap&&(w.sheenRoughnessMap.value=x.sheenRoughnessMap,t(x.sheenRoughnessMap,w.sheenRoughnessMapTransform))),x.clearcoat>0&&(w.clearcoat.value=x.clearcoat,w.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(w.clearcoatMap.value=x.clearcoatMap,t(x.clearcoatMap,w.clearcoatMapTransform)),x.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap,t(x.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),x.clearcoatNormalMap&&(w.clearcoatNormalMap.value=x.clearcoatNormalMap,t(x.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),x.side===Ur&&w.clearcoatNormalScale.value.negate())),x.dispersion>0&&(w.dispersion.value=x.dispersion),x.iridescence>0&&(w.iridescence.value=x.iridescence,w.iridescenceIOR.value=x.iridescenceIOR,w.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(w.iridescenceMap.value=x.iridescenceMap,t(x.iridescenceMap,w.iridescenceMapTransform)),x.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=x.iridescenceThicknessMap,t(x.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),x.transmission>0&&(w.transmission.value=x.transmission,w.transmissionSamplerMap.value=_.texture,w.transmissionSamplerSize.value.set(_.width,_.height),x.transmissionMap&&(w.transmissionMap.value=x.transmissionMap,t(x.transmissionMap,w.transmissionMapTransform)),w.thickness.value=x.thickness,x.thicknessMap&&(w.thicknessMap.value=x.thicknessMap,t(x.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=x.attenuationDistance,w.attenuationColor.value.copy(x.attenuationColor)),x.anisotropy>0&&(w.anisotropyVector.value.set(x.anisotropy*Math.cos(x.anisotropyRotation),x.anisotropy*Math.sin(x.anisotropyRotation)),x.anisotropyMap&&(w.anisotropyMap.value=x.anisotropyMap,t(x.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=x.specularIntensity,w.specularColor.value.copy(x.specularColor),x.specularColorMap&&(w.specularColorMap.value=x.specularColorMap,t(x.specularColorMap,w.specularColorMapTransform)),x.specularIntensityMap&&(w.specularIntensityMap.value=x.specularIntensityMap,t(x.specularIntensityMap,w.specularIntensityMapTransform))}function y(w,x){x.matcap&&(w.matcap.value=x.matcap)}function S(w,x){const _=e.get(x).light;w.referencePosition.value.setFromMatrixPosition(_.matrixWorld),w.nearDistance.value=_.shadow.camera.near,w.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function OG(n,e,t,r){let i={},s={},a=[];const o=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function c(_,b){const M=b.program;r.uniformBlockBinding(_,M)}function u(_,b){let M=i[_.id];M===void 0&&(y(_),M=f(_),i[_.id]=M,_.addEventListener("dispose",w));const N=b.program;r.updateUBOMapping(_,N);const C=e.render.frame;s[_.id]!==C&&(m(_),s[_.id]=C)}function f(_){const b=p();_.__bindingPointIndex=b;const M=n.createBuffer(),N=_.__size,C=_.usage;return n.bindBuffer(n.UNIFORM_BUFFER,M),n.bufferData(n.UNIFORM_BUFFER,N,C),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,b,M),M}function p(){for(let _=0;_<o;_++)if(a.indexOf(_)===-1)return a.push(_),_;return It("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(_){const b=i[_.id],M=_.uniforms,N=_.__cache;n.bindBuffer(n.UNIFORM_BUFFER,b);for(let C=0,I=M.length;C<I;C++){const P=Array.isArray(M[C])?M[C]:[M[C]];for(let T=0,R=P.length;T<R;T++){const j=P[T];if(g(j,C,T,N)===!0){const O=j.__offset,k=Array.isArray(j.value)?j.value:[j.value];let Z=0;for(let te=0;te<k.length;te++){const K=k[te],$=S(K);typeof K=="number"||typeof K=="boolean"?(j.__data[0]=K,n.bufferSubData(n.UNIFORM_BUFFER,O+Z,j.__data)):K.isMatrix3?(j.__data[0]=K.elements[0],j.__data[1]=K.elements[1],j.__data[2]=K.elements[2],j.__data[3]=0,j.__data[4]=K.elements[3],j.__data[5]=K.elements[4],j.__data[6]=K.elements[5],j.__data[7]=0,j.__data[8]=K.elements[6],j.__data[9]=K.elements[7],j.__data[10]=K.elements[8],j.__data[11]=0):(K.toArray(j.__data,Z),Z+=$.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,O,j.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function g(_,b,M,N){const C=_.value,I=b+"_"+M;if(N[I]===void 0)return typeof C=="number"||typeof C=="boolean"?N[I]=C:N[I]=C.clone(),!0;{const P=N[I];if(typeof C=="number"||typeof C=="boolean"){if(P!==C)return N[I]=C,!0}else if(P.equals(C)===!1)return P.copy(C),!0}return!1}function y(_){const b=_.uniforms;let M=0;const N=16;for(let I=0,P=b.length;I<P;I++){const T=Array.isArray(b[I])?b[I]:[b[I]];for(let R=0,j=T.length;R<j;R++){const O=T[R],k=Array.isArray(O.value)?O.value:[O.value];for(let Z=0,te=k.length;Z<te;Z++){const K=k[Z],$=S(K),U=M%N,H=U%$.boundary,W=U+H;M+=H,W!==0&&N-W<$.storage&&(M+=N-W),O.__data=new Float32Array($.storage/Float32Array.BYTES_PER_ELEMENT),O.__offset=M,M+=$.storage}}}const C=M%N;return C>0&&(M+=N-C),_.__size=M,_.__cache={},this}function S(_){const b={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(b.boundary=4,b.storage=4):_.isVector2?(b.boundary=8,b.storage=8):_.isVector3||_.isColor?(b.boundary=16,b.storage=12):_.isVector4?(b.boundary=16,b.storage=16):_.isMatrix3?(b.boundary=48,b.storage=48):_.isMatrix4?(b.boundary=64,b.storage=64):_.isTexture?ct("WebGLRenderer: Texture samplers can not be part of an uniforms group."):ct("WebGLRenderer: Unsupported uniform value type.",_),b}function w(_){const b=_.target;b.removeEventListener("dispose",w);const M=a.indexOf(b.__bindingPointIndex);a.splice(M,1),n.deleteBuffer(i[b.id]),delete i[b.id],delete s[b.id]}function x(){for(const _ in i)n.deleteBuffer(i[_]);a=[],i={},s={}}return{bind:c,update:u,dispose:x}}const zG=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Gs=null;function HG(){return Gs===null&&(Gs=new rs(zG,16,16,Jl,On),Gs.name="DFG_LUT",Gs.minFilter=en,Gs.magFilter=en,Gs.wrapS=Pn,Gs.wrapT=Pn,Gs.generateMipmaps=!1,Gs.needsUpdate=!0),Gs}class qw{constructor(e={}){const{canvas:t=q3(),context:r=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:u=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:p=!1,reversedDepthBuffer:m=!1,outputBufferType:g=gr}=e;this.isWebGLRenderer=!0;let y;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");y=r.getContextAttributes().alpha}else y=a;const S=g,w=new Set([lx,ox,bf]),x=new Set([gr,Fi,Du,Fu,sx,ax]),_=new Uint32Array(4),b=new Int32Array(4);let M=null,N=null;const C=[],I=[];let P=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ns,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const T=this;let R=!1;this._outputColorSpace=qr;let j=0,O=0,k=null,Z=-1,te=null;const K=new yn,$=new yn;let U=null;const H=new ut(0);let W=0,Y=t.width,G=t.height,de=1,Ce=null,be=null;const se=new yn(0,0,Y,G),_e=new yn(0,0,Y,G);let Le=!1;const yt=new rd;let qe=!1,lt=!1;const kt=new Dt,it=new X,Me=new yn,Be={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ie=!1;function Ye(){return k===null?de:1}let Q=r;function vt(z,ne){return t.getContext(z,ne)}try{const z={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:f,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${td}`),t.addEventListener("webglcontextlost",Tt,!1),t.addEventListener("webglcontextrestored",Qt,!1),t.addEventListener("webglcontextcreationerror",Jt,!1),Q===null){const ne="webgl2";if(Q=vt(ne,z),Q===null)throw vt(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(z){throw It("WebGLRenderer: "+z.message),z}let et,Ct,Ge,J,L,q,pe,ve,ge,st,Ke,dt,_t,Fe,He,xt,re,fe,ke,ie,me,je,at,ze;function Re(){et=new G6(Q),et.init(),je=new KR(Q,et),Ct=new L6(Q,et,e,je),Ge=new PG(Q,et),Ct.reversedDepthBuffer&&m&&Ge.buffers.depth.setReversed(!0),J=new X6(Q),L=new xG,q=new BG(Q,et,Ge,L,Ct,je,J),pe=new F6(T),ve=new H6(T),ge=new ZO(Q),at=new P6(Q,ge),st=new V6(Q,ge,J,at),Ke=new Y6(Q,st,ge,J),ke=new J6(Q,Ct,q),xt=new D6(L),dt=new gG(T,pe,ve,et,Ct,at,xt),_t=new UG(T,L),Fe=new vG,He=new MG(et),fe=new I6(T,pe,ve,Ge,Ke,y,c),re=new RG(T,Ke,Ct),ze=new OG(Q,J,Ct,Ge),ie=new B6(Q,et,J),me=new W6(Q,et,J),J.programs=dt.programs,T.capabilities=Ct,T.extensions=et,T.properties=L,T.renderLists=Fe,T.shadowMap=re,T.state=Ge,T.info=J}Re(),S!==gr&&(P=new Z6(S,t.width,t.height,i,s));const Ve=new kG(T,Q);this.xr=Ve,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){const z=et.get("WEBGL_lose_context");z&&z.loseContext()},this.forceContextRestore=function(){const z=et.get("WEBGL_lose_context");z&&z.restoreContext()},this.getPixelRatio=function(){return de},this.setPixelRatio=function(z){z!==void 0&&(de=z,this.setSize(Y,G,!1))},this.getSize=function(z){return z.set(Y,G)},this.setSize=function(z,ne,le=!0){if(Ve.isPresenting){ct("WebGLRenderer: Can't change size while VR device is presenting.");return}Y=z,G=ne,t.width=Math.floor(z*de),t.height=Math.floor(ne*de),le===!0&&(t.style.width=z+"px",t.style.height=ne+"px"),P!==null&&P.setSize(t.width,t.height),this.setViewport(0,0,z,ne)},this.getDrawingBufferSize=function(z){return z.set(Y*de,G*de).floor()},this.setDrawingBufferSize=function(z,ne,le){Y=z,G=ne,de=le,t.width=Math.floor(z*le),t.height=Math.floor(ne*le),this.setViewport(0,0,z,ne)},this.setEffects=function(z){if(S===gr){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(z){for(let ne=0;ne<z.length;ne++)if(z[ne].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}P.setEffects(z||[])},this.getCurrentViewport=function(z){return z.copy(K)},this.getViewport=function(z){return z.copy(se)},this.setViewport=function(z,ne,le,ce){z.isVector4?se.set(z.x,z.y,z.z,z.w):se.set(z,ne,le,ce),Ge.viewport(K.copy(se).multiplyScalar(de).round())},this.getScissor=function(z){return z.copy(_e)},this.setScissor=function(z,ne,le,ce){z.isVector4?_e.set(z.x,z.y,z.z,z.w):_e.set(z,ne,le,ce),Ge.scissor($.copy(_e).multiplyScalar(de).round())},this.getScissorTest=function(){return Le},this.setScissorTest=function(z){Ge.setScissorTest(Le=z)},this.setOpaqueSort=function(z){Ce=z},this.setTransparentSort=function(z){be=z},this.getClearColor=function(z){return z.copy(fe.getClearColor())},this.setClearColor=function(){fe.setClearColor(...arguments)},this.getClearAlpha=function(){return fe.getClearAlpha()},this.setClearAlpha=function(){fe.setClearAlpha(...arguments)},this.clear=function(z=!0,ne=!0,le=!0){let ce=0;if(z){let oe=!1;if(k!==null){const Pe=k.texture.format;oe=w.has(Pe)}if(oe){const Pe=k.texture.type,Ue=x.has(Pe),Ne=fe.getClearColor(),De=fe.getClearAlpha(),We=Ne.r,ht=Ne.g,Xe=Ne.b;Ue?(_[0]=We,_[1]=ht,_[2]=Xe,_[3]=De,Q.clearBufferuiv(Q.COLOR,0,_)):(b[0]=We,b[1]=ht,b[2]=Xe,b[3]=De,Q.clearBufferiv(Q.COLOR,0,b))}else ce|=Q.COLOR_BUFFER_BIT}ne&&(ce|=Q.DEPTH_BUFFER_BIT),le&&(ce|=Q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Q.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Tt,!1),t.removeEventListener("webglcontextrestored",Qt,!1),t.removeEventListener("webglcontextcreationerror",Jt,!1),fe.dispose(),Fe.dispose(),He.dispose(),L.dispose(),pe.dispose(),ve.dispose(),Ke.dispose(),at.dispose(),ze.dispose(),dt.dispose(),Ve.dispose(),Ve.removeEventListener("sessionstart",Rs),Ve.removeEventListener("sessionend",ri),Ut.stop()};function Tt(z){z.preventDefault(),$h("WebGLRenderer: Context Lost."),R=!0}function Qt(){$h("WebGLRenderer: Context Restored."),R=!1;const z=J.autoReset,ne=re.enabled,le=re.autoUpdate,ce=re.needsUpdate,oe=re.type;Re(),J.autoReset=z,re.enabled=ne,re.autoUpdate=le,re.needsUpdate=ce,re.type=oe}function Jt(z){It("WebGLRenderer: A WebGL context could not be created. Reason: ",z.statusMessage)}function Gn(z){const ne=z.target;ne.removeEventListener("dispose",Gn),cr(ne)}function cr(z){ad(z),L.remove(z)}function ad(z){const ne=L.get(z).programs;ne!==void 0&&(ne.forEach(function(le){dt.releaseProgram(le)}),z.isShaderMaterial&&dt.releaseShaderCache(z))}this.renderBufferDirect=function(z,ne,le,ce,oe,Pe){ne===null&&(ne=Be);const Ue=oe.isMesh&&oe.matrixWorld.determinant()<0,Ne=Ze(z,ne,le,ce,oe);Ge.setMaterial(ce,Ue);let De=le.index,We=1;if(ce.wireframe===!0){if(De=st.getWireframeAttribute(le),De===void 0)return;We=2}const ht=le.drawRange,Xe=le.attributes.position;let St=ht.start*We,Ot=(ht.start+ht.count)*We;Pe!==null&&(St=Math.max(St,Pe.start*We),Ot=Math.min(Ot,(Pe.start+Pe.count)*We)),De!==null?(St=Math.max(St,0),Ot=Math.min(Ot,De.count)):Xe!=null&&(St=Math.max(St,0),Ot=Math.min(Ot,Xe.count));const zt=Ot-St;if(zt<0||zt===1/0)return;at.setup(oe,ce,Ne,le,De);let Yt,Nt=ie;if(De!==null&&(Yt=ge.get(De),Nt=me,Nt.setIndex(Yt)),oe.isMesh)ce.wireframe===!0?(Ge.setLineWidth(ce.wireframeLinewidth*Ye()),Nt.setMode(Q.LINES)):Nt.setMode(Q.TRIANGLES);else if(oe.isLine){let mt=ce.linewidth;mt===void 0&&(mt=1),Ge.setLineWidth(mt*Ye()),oe.isLineSegments?Nt.setMode(Q.LINES):oe.isLineLoop?Nt.setMode(Q.LINE_LOOP):Nt.setMode(Q.LINE_STRIP)}else oe.isPoints?Nt.setMode(Q.POINTS):oe.isSprite&&Nt.setMode(Q.TRIANGLES);if(oe.isBatchedMesh)if(oe._multiDrawInstances!==null)Ou("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Nt.renderMultiDrawInstances(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount,oe._multiDrawInstances);else if(et.get("WEBGL_multi_draw"))Nt.renderMultiDraw(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount);else{const mt=oe._multiDrawStarts,Et=oe._multiDrawCounts,At=oe._multiDrawCount,qt=De?ge.get(De).bytesPerElement:1,Cr=L.get(ce).currentProgram.getUniforms();for(let mn=0;mn<At;mn++)Cr.setValue(Q,"_gl_DrawID",mn),Nt.render(mt[mn]/qt,Et[mn])}else if(oe.isInstancedMesh)Nt.renderInstances(St,zt,oe.count);else if(le.isInstancedBufferGeometry){const mt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,Et=Math.min(le.instanceCount,mt);Nt.renderInstances(St,zt,Et)}else Nt.render(St,zt)};function lc(z,ne,le){z.transparent===!0&&z.side===Ti&&z.forceSinglePass===!1?(z.side=Ur,z.needsUpdate=!0,xe(z,ne,le),z.side=Qs,z.needsUpdate=!0,xe(z,ne,le),z.side=Ti):xe(z,ne,le)}this.compile=function(z,ne,le=null){le===null&&(le=z),N=He.get(le),N.init(ne),I.push(N),le.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ne.layers)&&(N.pushLight(oe),oe.castShadow&&N.pushShadow(oe))}),z!==le&&z.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ne.layers)&&(N.pushLight(oe),oe.castShadow&&N.pushShadow(oe))}),N.setupLights();const ce=new Set;return z.traverse(function(oe){if(!(oe.isMesh||oe.isPoints||oe.isLine||oe.isSprite))return;const Pe=oe.material;if(Pe)if(Array.isArray(Pe))for(let Ue=0;Ue<Pe.length;Ue++){const Ne=Pe[Ue];lc(Ne,le,oe),ce.add(Ne)}else lc(Pe,le,oe),ce.add(Pe)}),N=I.pop(),ce},this.compileAsync=function(z,ne,le=null){const ce=this.compile(z,ne,le);return new Promise(oe=>{function Pe(){if(ce.forEach(function(Ue){L.get(Ue).currentProgram.isReady()&&ce.delete(Ue)}),ce.size===0){oe(z);return}setTimeout(Pe,10)}et.get("KHR_parallel_shader_compile")!==null?Pe():setTimeout(Pe,10)})};let ls=null;function Vo(z){ls&&ls(z)}function Rs(){Ut.stop()}function ri(){Ut.start()}const Ut=new VR;Ut.setAnimationLoop(Vo),typeof self<"u"&&Ut.setContext(self),this.setAnimationLoop=function(z){ls=z,Ve.setAnimationLoop(z),z===null?Ut.stop():Ut.start()},Ve.addEventListener("sessionstart",Rs),Ve.addEventListener("sessionend",ri),this.render=function(z,ne){if(ne!==void 0&&ne.isCamera!==!0){It("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(R===!0)return;const le=Ve.enabled===!0&&Ve.isPresenting===!0,ce=P!==null&&(k===null||le)&&P.begin(T,k);if(z.matrixWorldAutoUpdate===!0&&z.updateMatrixWorld(),ne.parent===null&&ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Ve.enabled===!0&&Ve.isPresenting===!0&&(P===null||P.isCompositing()===!1)&&(Ve.cameraAutoUpdate===!0&&Ve.updateCamera(ne),ne=Ve.getCamera()),z.isScene===!0&&z.onBeforeRender(T,z,ne,k),N=He.get(z,I.length),N.init(ne),I.push(N),kt.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),yt.setFromProjectionMatrix(kt,Ri,ne.reversedDepth),lt=this.localClippingEnabled,qe=xt.init(this.clippingPlanes,lt),M=Fe.get(z,C.length),M.init(),C.push(M),Ve.enabled===!0&&Ve.isPresenting===!0){const Ue=T.xr.getDepthSensingMesh();Ue!==null&&Da(Ue,ne,-1/0,T.sortObjects)}Da(z,ne,0,T.sortObjects),M.finish(),T.sortObjects===!0&&M.sort(Ce,be),Ie=Ve.enabled===!1||Ve.isPresenting===!1||Ve.hasDepthSensing()===!1,Ie&&fe.addToRenderList(M,z),this.info.render.frame++,qe===!0&&xt.beginShadows();const oe=N.state.shadowsArray;if(re.render(oe,z,ne),qe===!0&&xt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ce&&P.hasRenderPass())===!1){const Ue=M.opaque,Ne=M.transmissive;if(N.setupLights(),ne.isArrayCamera){const De=ne.cameras;if(Ne.length>0)for(let We=0,ht=De.length;We<ht;We++){const Xe=De[We];D(Ue,Ne,z,Xe)}Ie&&fe.render(z);for(let We=0,ht=De.length;We<ht;We++){const Xe=De[We];cc(M,z,Xe,Xe.viewport)}}else Ne.length>0&&D(Ue,Ne,z,ne),Ie&&fe.render(z),cc(M,z,ne)}k!==null&&O===0&&(q.updateMultisampleRenderTarget(k),q.updateRenderTargetMipmap(k)),ce&&P.end(T),z.isScene===!0&&z.onAfterRender(T,z,ne),at.resetDefaultState(),Z=-1,te=null,I.pop(),I.length>0?(N=I[I.length-1],qe===!0&&xt.setGlobalState(T.clippingPlanes,N.state.camera)):N=null,C.pop(),C.length>0?M=C[C.length-1]:M=null};function Da(z,ne,le,ce){if(z.visible===!1)return;if(z.layers.test(ne.layers)){if(z.isGroup)le=z.renderOrder;else if(z.isLOD)z.autoUpdate===!0&&z.update(ne);else if(z.isLight)N.pushLight(z),z.castShadow&&N.pushShadow(z);else if(z.isSprite){if(!z.frustumCulled||yt.intersectsSprite(z)){ce&&Me.setFromMatrixPosition(z.matrixWorld).applyMatrix4(kt);const Ue=Ke.update(z),Ne=z.material;Ne.visible&&M.push(z,Ue,Ne,le,Me.z,null)}}else if((z.isMesh||z.isLine||z.isPoints)&&(!z.frustumCulled||yt.intersectsObject(z))){const Ue=Ke.update(z),Ne=z.material;if(ce&&(z.boundingSphere!==void 0?(z.boundingSphere===null&&z.computeBoundingSphere(),Me.copy(z.boundingSphere.center)):(Ue.boundingSphere===null&&Ue.computeBoundingSphere(),Me.copy(Ue.boundingSphere.center)),Me.applyMatrix4(z.matrixWorld).applyMatrix4(kt)),Array.isArray(Ne)){const De=Ue.groups;for(let We=0,ht=De.length;We<ht;We++){const Xe=De[We],St=Ne[Xe.materialIndex];St&&St.visible&&M.push(z,Ue,St,le,Me.z,Xe)}}else Ne.visible&&M.push(z,Ue,Ne,le,Me.z,null)}}const Pe=z.children;for(let Ue=0,Ne=Pe.length;Ue<Ne;Ue++)Da(Pe[Ue],ne,le,ce)}function cc(z,ne,le,ce){const{opaque:oe,transmissive:Pe,transparent:Ue}=z;N.setupLightsView(le),qe===!0&&xt.setGlobalState(T.clippingPlanes,le),ce&&Ge.viewport(K.copy(ce)),oe.length>0&&V(oe,ne,le),Pe.length>0&&V(Pe,ne,le),Ue.length>0&&V(Ue,ne,le),Ge.buffers.depth.setTest(!0),Ge.buffers.depth.setMask(!0),Ge.buffers.color.setMask(!0),Ge.setPolygonOffset(!1)}function D(z,ne,le,ce){if((le.isScene===!0?le.overrideMaterial:null)!==null)return;if(N.state.transmissionRenderTarget[ce.id]===void 0){const St=et.has("EXT_color_buffer_half_float")||et.has("EXT_color_buffer_float");N.state.transmissionRenderTarget[ce.id]=new ei(1,1,{generateMipmaps:!0,type:St?On:gr,minFilter:es,samples:Ct.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:nn.workingColorSpace})}const Pe=N.state.transmissionRenderTarget[ce.id],Ue=ce.viewport||K;Pe.setSize(Ue.z*T.transmissionResolutionScale,Ue.w*T.transmissionResolutionScale);const Ne=T.getRenderTarget(),De=T.getActiveCubeFace(),We=T.getActiveMipmapLevel();T.setRenderTarget(Pe),T.getClearColor(H),W=T.getClearAlpha(),W<1&&T.setClearColor(16777215,.5),T.clear(),Ie&&fe.render(le);const ht=T.toneMapping;T.toneMapping=ns;const Xe=ce.viewport;if(ce.viewport!==void 0&&(ce.viewport=void 0),N.setupLightsView(ce),qe===!0&&xt.setGlobalState(T.clippingPlanes,ce),V(z,le,ce),q.updateMultisampleRenderTarget(Pe),q.updateRenderTargetMipmap(Pe),et.has("WEBGL_multisampled_render_to_texture")===!1){let St=!1;for(let Ot=0,zt=ne.length;Ot<zt;Ot++){const Yt=ne[Ot],{object:Nt,geometry:mt,material:Et,group:At}=Yt;if(Et.side===Ti&&Nt.layers.test(ce.layers)){const qt=Et.side;Et.side=Ur,Et.needsUpdate=!0,ae(Nt,le,ce,mt,Et,At),Et.side=qt,Et.needsUpdate=!0,St=!0}}St===!0&&(q.updateMultisampleRenderTarget(Pe),q.updateRenderTargetMipmap(Pe))}T.setRenderTarget(Ne,De,We),T.setClearColor(H,W),Xe!==void 0&&(ce.viewport=Xe),T.toneMapping=ht}function V(z,ne,le){const ce=ne.isScene===!0?ne.overrideMaterial:null;for(let oe=0,Pe=z.length;oe<Pe;oe++){const Ue=z[oe],{object:Ne,geometry:De,group:We}=Ue;let ht=Ue.material;ht.allowOverride===!0&&ce!==null&&(ht=ce),Ne.layers.test(le.layers)&&ae(Ne,ne,le,De,ht,We)}}function ae(z,ne,le,ce,oe,Pe){z.onBeforeRender(T,ne,le,ce,oe,Pe),z.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,z.matrixWorld),z.normalMatrix.getNormalMatrix(z.modelViewMatrix),oe.onBeforeRender(T,ne,le,ce,z,Pe),oe.transparent===!0&&oe.side===Ti&&oe.forceSinglePass===!1?(oe.side=Ur,oe.needsUpdate=!0,T.renderBufferDirect(le,ne,ce,oe,z,Pe),oe.side=Qs,oe.needsUpdate=!0,T.renderBufferDirect(le,ne,ce,oe,z,Pe),oe.side=Ti):T.renderBufferDirect(le,ne,ce,oe,z,Pe),z.onAfterRender(T,ne,le,ce,oe,Pe)}function xe(z,ne,le){ne.isScene!==!0&&(ne=Be);const ce=L.get(z),oe=N.state.lights,Pe=N.state.shadowsArray,Ue=oe.state.version,Ne=dt.getParameters(z,oe.state,Pe,ne,le),De=dt.getProgramCacheKey(Ne);let We=ce.programs;ce.environment=z.isMeshStandardMaterial?ne.environment:null,ce.fog=ne.fog,ce.envMap=(z.isMeshStandardMaterial?ve:pe).get(z.envMap||ce.environment),ce.envMapRotation=ce.environment!==null&&z.envMap===null?ne.environmentRotation:z.envMapRotation,We===void 0&&(z.addEventListener("dispose",Gn),We=new Map,ce.programs=We);let ht=We.get(De);if(ht!==void 0){if(ce.currentProgram===ht&&ce.lightsStateVersion===Ue)return Ae(z,Ne),ht}else Ne.uniforms=dt.getUniforms(z),z.onBeforeCompile(Ne,T),ht=dt.acquireProgram(Ne,De),We.set(De,ht),ce.uniforms=Ne.uniforms;const Xe=ce.uniforms;return(!z.isShaderMaterial&&!z.isRawShaderMaterial||z.clipping===!0)&&(Xe.clippingPlanes=xt.uniform),Ae(z,Ne),ce.needsLights=nt(z),ce.lightsStateVersion=Ue,ce.needsLights&&(Xe.ambientLightColor.value=oe.state.ambient,Xe.lightProbe.value=oe.state.probe,Xe.directionalLights.value=oe.state.directional,Xe.directionalLightShadows.value=oe.state.directionalShadow,Xe.spotLights.value=oe.state.spot,Xe.spotLightShadows.value=oe.state.spotShadow,Xe.rectAreaLights.value=oe.state.rectArea,Xe.ltc_1.value=oe.state.rectAreaLTC1,Xe.ltc_2.value=oe.state.rectAreaLTC2,Xe.pointLights.value=oe.state.point,Xe.pointLightShadows.value=oe.state.pointShadow,Xe.hemisphereLights.value=oe.state.hemi,Xe.directionalShadowMap.value=oe.state.directionalShadowMap,Xe.directionalShadowMatrix.value=oe.state.directionalShadowMatrix,Xe.spotShadowMap.value=oe.state.spotShadowMap,Xe.spotLightMatrix.value=oe.state.spotLightMatrix,Xe.spotLightMap.value=oe.state.spotLightMap,Xe.pointShadowMap.value=oe.state.pointShadowMap,Xe.pointShadowMatrix.value=oe.state.pointShadowMatrix),ce.currentProgram=ht,ce.uniformsList=null,ht}function Se(z){if(z.uniformsList===null){const ne=z.currentProgram.getUniforms();z.uniformsList=tg.seqWithValue(ne.seq,z.uniforms)}return z.uniformsList}function Ae(z,ne){const le=L.get(z);le.outputColorSpace=ne.outputColorSpace,le.batching=ne.batching,le.batchingColor=ne.batchingColor,le.instancing=ne.instancing,le.instancingColor=ne.instancingColor,le.instancingMorph=ne.instancingMorph,le.skinning=ne.skinning,le.morphTargets=ne.morphTargets,le.morphNormals=ne.morphNormals,le.morphColors=ne.morphColors,le.morphTargetsCount=ne.morphTargetsCount,le.numClippingPlanes=ne.numClippingPlanes,le.numIntersection=ne.numClipIntersection,le.vertexAlphas=ne.vertexAlphas,le.vertexTangents=ne.vertexTangents,le.toneMapping=ne.toneMapping}function Ze(z,ne,le,ce,oe){ne.isScene!==!0&&(ne=Be),q.resetTextureUnits();const Pe=ne.fog,Ue=ce.isMeshStandardMaterial?ne.environment:null,Ne=k===null?T.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:ea,De=(ce.isMeshStandardMaterial?ve:pe).get(ce.envMap||Ue),We=ce.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,ht=!!le.attributes.tangent&&(!!ce.normalMap||ce.anisotropy>0),Xe=!!le.morphAttributes.position,St=!!le.morphAttributes.normal,Ot=!!le.morphAttributes.color;let zt=ns;ce.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(zt=T.toneMapping);const Yt=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,Nt=Yt!==void 0?Yt.length:0,mt=L.get(ce),Et=N.state.lights;if(qe===!0&&(lt===!0||z!==te)){const Kn=z===te&&ce.id===Z;xt.setState(ce,z,Kn)}let At=!1;ce.version===mt.__version?(mt.needsLights&&mt.lightsStateVersion!==Et.state.version||mt.outputColorSpace!==Ne||oe.isBatchedMesh&&mt.batching===!1||!oe.isBatchedMesh&&mt.batching===!0||oe.isBatchedMesh&&mt.batchingColor===!0&&oe.colorTexture===null||oe.isBatchedMesh&&mt.batchingColor===!1&&oe.colorTexture!==null||oe.isInstancedMesh&&mt.instancing===!1||!oe.isInstancedMesh&&mt.instancing===!0||oe.isSkinnedMesh&&mt.skinning===!1||!oe.isSkinnedMesh&&mt.skinning===!0||oe.isInstancedMesh&&mt.instancingColor===!0&&oe.instanceColor===null||oe.isInstancedMesh&&mt.instancingColor===!1&&oe.instanceColor!==null||oe.isInstancedMesh&&mt.instancingMorph===!0&&oe.morphTexture===null||oe.isInstancedMesh&&mt.instancingMorph===!1&&oe.morphTexture!==null||mt.envMap!==De||ce.fog===!0&&mt.fog!==Pe||mt.numClippingPlanes!==void 0&&(mt.numClippingPlanes!==xt.numPlanes||mt.numIntersection!==xt.numIntersection)||mt.vertexAlphas!==We||mt.vertexTangents!==ht||mt.morphTargets!==Xe||mt.morphNormals!==St||mt.morphColors!==Ot||mt.toneMapping!==zt||mt.morphTargetsCount!==Nt)&&(At=!0):(At=!0,mt.__version=ce.version);let qt=mt.currentProgram;At===!0&&(qt=xe(ce,ne,oe));let Cr=!1,mn=!1,Er=!1;const hn=qt.getUniforms(),er=mt.uniforms;if(Ge.useProgram(qt.program)&&(Cr=!0,mn=!0,Er=!0),ce.id!==Z&&(Z=ce.id,mn=!0),Cr||te!==z){Ge.buffers.depth.getReversed()&&z.reversedDepth!==!0&&(z._reversedDepth=!0,z.updateProjectionMatrix()),hn.setValue(Q,"projectionMatrix",z.projectionMatrix),hn.setValue(Q,"viewMatrix",z.matrixWorldInverse);const Tr=hn.map.cameraPosition;Tr!==void 0&&Tr.setValue(Q,it.setFromMatrixPosition(z.matrixWorld)),Ct.logarithmicDepthBuffer&&hn.setValue(Q,"logDepthBufFC",2/(Math.log(z.far+1)/Math.LN2)),(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial)&&hn.setValue(Q,"isOrthographic",z.isOrthographicCamera===!0),te!==z&&(te=z,mn=!0,Er=!0)}if(mt.needsLights&&(Et.state.directionalShadowMap.length>0&&hn.setValue(Q,"directionalShadowMap",Et.state.directionalShadowMap,q),Et.state.spotShadowMap.length>0&&hn.setValue(Q,"spotShadowMap",Et.state.spotShadowMap,q),Et.state.pointShadowMap.length>0&&hn.setValue(Q,"pointShadowMap",Et.state.pointShadowMap,q)),oe.isSkinnedMesh){hn.setOptional(Q,oe,"bindMatrix"),hn.setOptional(Q,oe,"bindMatrixInverse");const Kn=oe.skeleton;Kn&&(Kn.boneTexture===null&&Kn.computeBoneTexture(),hn.setValue(Q,"boneTexture",Kn.boneTexture,q))}oe.isBatchedMesh&&(hn.setOptional(Q,oe,"batchingTexture"),hn.setValue(Q,"batchingTexture",oe._matricesTexture,q),hn.setOptional(Q,oe,"batchingIdTexture"),hn.setValue(Q,"batchingIdTexture",oe._indirectTexture,q),hn.setOptional(Q,oe,"batchingColorTexture"),oe._colorsTexture!==null&&hn.setValue(Q,"batchingColorTexture",oe._colorsTexture,q));const ur=le.morphAttributes;if((ur.position!==void 0||ur.normal!==void 0||ur.color!==void 0)&&ke.update(oe,le,qt),(mn||mt.receiveShadow!==oe.receiveShadow)&&(mt.receiveShadow=oe.receiveShadow,hn.setValue(Q,"receiveShadow",oe.receiveShadow)),ce.isMeshGouraudMaterial&&ce.envMap!==null&&(er.envMap.value=De,er.flipEnvMap.value=De.isCubeTexture&&De.isRenderTargetTexture===!1?-1:1),ce.isMeshStandardMaterial&&ce.envMap===null&&ne.environment!==null&&(er.envMapIntensity.value=ne.environmentIntensity),er.dfgLUT!==void 0&&(er.dfgLUT.value=HG()),mn&&(hn.setValue(Q,"toneMappingExposure",T.toneMappingExposure),mt.needsLights&&Oe(er,Er),Pe&&ce.fog===!0&&_t.refreshFogUniforms(er,Pe),_t.refreshMaterialUniforms(er,ce,de,G,N.state.transmissionRenderTarget[z.id]),tg.upload(Q,Se(mt),er,q)),ce.isShaderMaterial&&ce.uniformsNeedUpdate===!0&&(tg.upload(Q,Se(mt),er,q),ce.uniformsNeedUpdate=!1),ce.isSpriteMaterial&&hn.setValue(Q,"center",oe.center),hn.setValue(Q,"modelViewMatrix",oe.modelViewMatrix),hn.setValue(Q,"normalMatrix",oe.normalMatrix),hn.setValue(Q,"modelMatrix",oe.matrixWorld),ce.isShaderMaterial||ce.isRawShaderMaterial){const Kn=ce.uniformsGroups;for(let Tr=0,od=Kn.length;Tr<od;Tr++){const cs=Kn[Tr];ze.update(cs,qt),ze.bind(cs,qt)}}return qt}function Oe(z,ne){z.ambientLightColor.needsUpdate=ne,z.lightProbe.needsUpdate=ne,z.directionalLights.needsUpdate=ne,z.directionalLightShadows.needsUpdate=ne,z.pointLights.needsUpdate=ne,z.pointLightShadows.needsUpdate=ne,z.spotLights.needsUpdate=ne,z.spotLightShadows.needsUpdate=ne,z.rectAreaLights.needsUpdate=ne,z.hemisphereLights.needsUpdate=ne}function nt(z){return z.isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&z.lights===!0}this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(z,ne,le){const ce=L.get(z);ce.__autoAllocateDepthBuffer=z.resolveDepthBuffer===!1,ce.__autoAllocateDepthBuffer===!1&&(ce.__useRenderToTexture=!1),L.get(z.texture).__webglTexture=ne,L.get(z.depthTexture).__webglTexture=ce.__autoAllocateDepthBuffer?void 0:le,ce.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(z,ne){const le=L.get(z);le.__webglFramebuffer=ne,le.__useDefaultFramebuffer=ne===void 0};const tt=Q.createFramebuffer();this.setRenderTarget=function(z,ne=0,le=0){k=z,j=ne,O=le;let ce=null,oe=!1,Pe=!1;if(z){const Ne=L.get(z);if(Ne.__useDefaultFramebuffer!==void 0){Ge.bindFramebuffer(Q.FRAMEBUFFER,Ne.__webglFramebuffer),K.copy(z.viewport),$.copy(z.scissor),U=z.scissorTest,Ge.viewport(K),Ge.scissor($),Ge.setScissorTest(U),Z=-1;return}else if(Ne.__webglFramebuffer===void 0)q.setupRenderTarget(z);else if(Ne.__hasExternalTextures)q.rebindTextures(z,L.get(z.texture).__webglTexture,L.get(z.depthTexture).__webglTexture);else if(z.depthBuffer){const ht=z.depthTexture;if(Ne.__boundDepthTexture!==ht){if(ht!==null&&L.has(ht)&&(z.width!==ht.image.width||z.height!==ht.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");q.setupDepthRenderbuffer(z)}}const De=z.texture;(De.isData3DTexture||De.isDataArrayTexture||De.isCompressedArrayTexture)&&(Pe=!0);const We=L.get(z).__webglFramebuffer;z.isWebGLCubeRenderTarget?(Array.isArray(We[ne])?ce=We[ne][le]:ce=We[ne],oe=!0):z.samples>0&&q.useMultisampledRTT(z)===!1?ce=L.get(z).__webglMultisampledFramebuffer:Array.isArray(We)?ce=We[le]:ce=We,K.copy(z.viewport),$.copy(z.scissor),U=z.scissorTest}else K.copy(se).multiplyScalar(de).floor(),$.copy(_e).multiplyScalar(de).floor(),U=Le;if(le!==0&&(ce=tt),Ge.bindFramebuffer(Q.FRAMEBUFFER,ce)&&Ge.drawBuffers(z,ce),Ge.viewport(K),Ge.scissor($),Ge.setScissorTest(U),oe){const Ne=L.get(z.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+ne,Ne.__webglTexture,le)}else if(Pe){const Ne=ne;for(let De=0;De<z.textures.length;De++){const We=L.get(z.textures[De]);Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0+De,We.__webglTexture,le,Ne)}}else if(z!==null&&le!==0){const Ne=L.get(z.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Ne.__webglTexture,le)}Z=-1},this.readRenderTargetPixels=function(z,ne,le,ce,oe,Pe,Ue,Ne=0){if(!(z&&z.isWebGLRenderTarget)){It("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let De=L.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&Ue!==void 0&&(De=De[Ue]),De){Ge.bindFramebuffer(Q.FRAMEBUFFER,De);try{const We=z.textures[Ne],ht=We.format,Xe=We.type;if(!Ct.textureFormatReadable(ht)){It("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ct.textureTypeReadable(Xe)){It("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ne>=0&&ne<=z.width-ce&&le>=0&&le<=z.height-oe&&(z.textures.length>1&&Q.readBuffer(Q.COLOR_ATTACHMENT0+Ne),Q.readPixels(ne,le,ce,oe,je.convert(ht),je.convert(Xe),Pe))}finally{const We=k!==null?L.get(k).__webglFramebuffer:null;Ge.bindFramebuffer(Q.FRAMEBUFFER,We)}}},this.readRenderTargetPixelsAsync=async function(z,ne,le,ce,oe,Pe,Ue,Ne=0){if(!(z&&z.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let De=L.get(z).__webglFramebuffer;if(z.isWebGLCubeRenderTarget&&Ue!==void 0&&(De=De[Ue]),De)if(ne>=0&&ne<=z.width-ce&&le>=0&&le<=z.height-oe){Ge.bindFramebuffer(Q.FRAMEBUFFER,De);const We=z.textures[Ne],ht=We.format,Xe=We.type;if(!Ct.textureFormatReadable(ht))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ct.textureTypeReadable(Xe))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const St=Q.createBuffer();Q.bindBuffer(Q.PIXEL_PACK_BUFFER,St),Q.bufferData(Q.PIXEL_PACK_BUFFER,Pe.byteLength,Q.STREAM_READ),z.textures.length>1&&Q.readBuffer(Q.COLOR_ATTACHMENT0+Ne),Q.readPixels(ne,le,ce,oe,je.convert(ht),je.convert(Xe),0);const Ot=k!==null?L.get(k).__webglFramebuffer:null;Ge.bindFramebuffer(Q.FRAMEBUFFER,Ot);const zt=Q.fenceSync(Q.SYNC_GPU_COMMANDS_COMPLETE,0);return Q.flush(),await rj(Q,zt,4),Q.bindBuffer(Q.PIXEL_PACK_BUFFER,St),Q.getBufferSubData(Q.PIXEL_PACK_BUFFER,0,Pe),Q.deleteBuffer(St),Q.deleteSync(zt),Pe}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(z,ne=null,le=0){const ce=Math.pow(2,-le),oe=Math.floor(z.image.width*ce),Pe=Math.floor(z.image.height*ce),Ue=ne!==null?ne.x:0,Ne=ne!==null?ne.y:0;q.setTexture2D(z,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,le,0,0,Ue,Ne,oe,Pe),Ge.unbindTexture()};const rt=Q.createFramebuffer(),Qe=Q.createFramebuffer();this.copyTextureToTexture=function(z,ne,le=null,ce=null,oe=0,Pe=null){Pe===null&&(oe!==0?(Ou("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Pe=oe,oe=0):Pe=0);let Ue,Ne,De,We,ht,Xe,St,Ot,zt;const Yt=z.isCompressedTexture?z.mipmaps[Pe]:z.image;if(le!==null)Ue=le.max.x-le.min.x,Ne=le.max.y-le.min.y,De=le.isBox3?le.max.z-le.min.z:1,We=le.min.x,ht=le.min.y,Xe=le.isBox3?le.min.z:0;else{const ur=Math.pow(2,-oe);Ue=Math.floor(Yt.width*ur),Ne=Math.floor(Yt.height*ur),z.isDataArrayTexture?De=Yt.depth:z.isData3DTexture?De=Math.floor(Yt.depth*ur):De=1,We=0,ht=0,Xe=0}ce!==null?(St=ce.x,Ot=ce.y,zt=ce.z):(St=0,Ot=0,zt=0);const Nt=je.convert(ne.format),mt=je.convert(ne.type);let Et;ne.isData3DTexture?(q.setTexture3D(ne,0),Et=Q.TEXTURE_3D):ne.isDataArrayTexture||ne.isCompressedArrayTexture?(q.setTexture2DArray(ne,0),Et=Q.TEXTURE_2D_ARRAY):(q.setTexture2D(ne,0),Et=Q.TEXTURE_2D),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,ne.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,ne.unpackAlignment);const At=Q.getParameter(Q.UNPACK_ROW_LENGTH),qt=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),Cr=Q.getParameter(Q.UNPACK_SKIP_PIXELS),mn=Q.getParameter(Q.UNPACK_SKIP_ROWS),Er=Q.getParameter(Q.UNPACK_SKIP_IMAGES);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,Yt.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,Yt.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,We),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,ht),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,Xe);const hn=z.isDataArrayTexture||z.isData3DTexture,er=ne.isDataArrayTexture||ne.isData3DTexture;if(z.isDepthTexture){const ur=L.get(z),Kn=L.get(ne),Tr=L.get(ur.__renderTarget),od=L.get(Kn.__renderTarget);Ge.bindFramebuffer(Q.READ_FRAMEBUFFER,Tr.__webglFramebuffer),Ge.bindFramebuffer(Q.DRAW_FRAMEBUFFER,od.__webglFramebuffer);for(let cs=0;cs<De;cs++)hn&&(Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,L.get(z).__webglTexture,oe,Xe+cs),Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,L.get(ne).__webglTexture,Pe,zt+cs)),Q.blitFramebuffer(We,ht,Ue,Ne,St,Ot,Ue,Ne,Q.DEPTH_BUFFER_BIT,Q.NEAREST);Ge.bindFramebuffer(Q.READ_FRAMEBUFFER,null),Ge.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else if(oe!==0||z.isRenderTargetTexture||L.has(z)){const ur=L.get(z),Kn=L.get(ne);Ge.bindFramebuffer(Q.READ_FRAMEBUFFER,rt),Ge.bindFramebuffer(Q.DRAW_FRAMEBUFFER,Qe);for(let Tr=0;Tr<De;Tr++)hn?Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,ur.__webglTexture,oe,Xe+Tr):Q.framebufferTexture2D(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,ur.__webglTexture,oe),er?Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Kn.__webglTexture,Pe,zt+Tr):Q.framebufferTexture2D(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Kn.__webglTexture,Pe),oe!==0?Q.blitFramebuffer(We,ht,Ue,Ne,St,Ot,Ue,Ne,Q.COLOR_BUFFER_BIT,Q.NEAREST):er?Q.copyTexSubImage3D(Et,Pe,St,Ot,zt+Tr,We,ht,Ue,Ne):Q.copyTexSubImage2D(Et,Pe,St,Ot,We,ht,Ue,Ne);Ge.bindFramebuffer(Q.READ_FRAMEBUFFER,null),Ge.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else er?z.isDataTexture||z.isData3DTexture?Q.texSubImage3D(Et,Pe,St,Ot,zt,Ue,Ne,De,Nt,mt,Yt.data):ne.isCompressedArrayTexture?Q.compressedTexSubImage3D(Et,Pe,St,Ot,zt,Ue,Ne,De,Nt,Yt.data):Q.texSubImage3D(Et,Pe,St,Ot,zt,Ue,Ne,De,Nt,mt,Yt):z.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,Pe,St,Ot,Ue,Ne,Nt,mt,Yt.data):z.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,Pe,St,Ot,Yt.width,Yt.height,Nt,Yt.data):Q.texSubImage2D(Q.TEXTURE_2D,Pe,St,Ot,Ue,Ne,Nt,mt,Yt);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,At),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,qt),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,Cr),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,mn),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,Er),Pe===0&&ne.generateMipmaps&&Q.generateMipmap(Et),Ge.unbindTexture()},this.initRenderTarget=function(z){L.get(z).__webglFramebuffer===void 0&&q.setupRenderTarget(z)},this.initTexture=function(z){z.isCubeTexture?q.setTextureCube(z,0):z.isData3DTexture?q.setTexture3D(z,0):z.isDataArrayTexture||z.isCompressedArrayTexture?q.setTexture2DArray(z,0):q.setTexture2D(z,0),Ge.unbindTexture()},this.resetState=function(){j=0,O=0,k=null,Ge.reset(),at.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ri}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=nn._getDrawingBufferColorSpace(e),t.unpackColorSpace=nn._getUnpackColorSpace()}}const GG=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:tx,AddEquation:oo,AddOperation:D3,AdditiveAnimationBlendMode:hw,AdditiveBlending:N1,AgXToneMapping:aw,AlphaFormat:uw,AlwaysCompare:Y3,AlwaysDepth:jg,AlwaysStencilFunc:L1,AmbientLight:BR,AnimationAction:HR,AnimationClip:Wu,AnimationLoader:WU,AnimationMixer:gO,AnimationObjectGroup:pO,AnimationUtils:zU,ArcCurve:cR,ArrayCamera:UR,ArrowHelper:zO,AttachedBindMode:P1,Audio:OR,AudioAnalyser:iO,AudioContext:Vw,AudioListener:tO,AudioLoader:QU,AxesHelper:HO,BackSide:Ur,BasicDepthPacking:z3,BasicShadowMap:m3,BatchedMesh:sR,Bone:xx,BooleanKeyframeTrack:sc,Box2:MO,Box3:ir,Box3Helper:UO,BoxGeometry:ic,BoxHelper:jO,BufferAttribute:ln,BufferGeometry:jt,BufferGeometryLoader:kR,ByteType:rx,Cache:Ks,Camera:wf,CameraHelper:kO,CanvasTexture:uU,CapsuleGeometry:bx,CatmullRomCurve3:uR,CineonToneMapping:iw,CircleGeometry:wx,ClampToEdgeWrapping:Pn,Clock:Ww,Color:ut,ColorKeyframeTrack:kw,ColorManagement:nn,CompressedArrayTexture:lU,CompressedCubeTexture:cU,CompressedTexture:_x,CompressedTextureLoader:XU,ConeGeometry:Tf,ConstantAlphaFactor:P3,ConstantColorFactor:R3,Controls:VO,CubeCamera:tR,CubeDepthTexture:oR,CubeReflectionMapping:Cs,CubeRefractionMapping:Ro,CubeTexture:Sf,CubeTextureLoader:RR,CubeUVReflectionMapping:nd,CubicBezierCurve:Ew,CubicBezierCurve3:dR,CubicInterpolant:ER,CullFaceBack:T1,CullFaceFront:p3,CullFaceFrontBack:x4,CullFaceNone:f3,Curve:Ns,CurvePath:fR,CustomBlending:g3,CustomToneMapping:sw,CylinderGeometry:Ef,Cylindrical:AO,Data3DTexture:fx,DataArrayTexture:hx,DataTexture:rs,DataTextureLoader:jw,DataUtils:Tl,DecrementStencilOp:I4,DecrementWrapStencilOp:B4,DefaultLoadingManager:cu,DepthFormat:$s,DepthStencilFormat:ho,DepthTexture:Gu,DetachedBindMode:F3,DirectionalLight:Hw,DirectionalLightHelper:FO,DiscreteInterpolant:TR,DodecahedronGeometry:Sx,DoubleSide:Ti,DstAlphaFactor:M3,DstColorFactor:E3,DynamicCopyUsage:Y4,DynamicDrawUsage:H4,DynamicReadUsage:W4,EdgesGeometry:lR,EllipseCurve:Ax,EqualCompare:W3,EqualDepth:Og,EqualStencilFunc:k4,EquirectangularReflectionMapping:Bu,EquirectangularRefractionMapping:Yh,Euler:ki,EventDispatcher:ta,ExternalTexture:Mw,ExtrudeGeometry:Mx,FileLoader:Sr,Float16BufferAttribute:Oj,Float32BufferAttribute:wt,FloatType:En,Fog:gx,FogExp2:mx,FramebufferTexture:oU,FrontSide:Qs,Frustum:rd,FrustumArray:yx,GLBufferAttribute:bO,GLSL1:Z4,GLSL3:D1,GreaterCompare:X3,GreaterDepth:Hg,GreaterEqualCompare:dx,GreaterEqualDepth:zg,GreaterEqualStencilFunc:z4,GreaterStencilFunc:U4,GridHelper:LO,Group:wa,HalfFloatType:On,HemisphereLight:PR,HemisphereLightHelper:BO,IcosahedronGeometry:Nf,ImageBitmapLoader:jR,ImageLoader:rf,ImageUtils:Q3,IncrementStencilOp:R4,IncrementWrapStencilOp:P4,InstancedBufferAttribute:Yl,InstancedBufferGeometry:FR,InstancedInterleavedBuffer:_O,InstancedMesh:ww,Int16BufferAttribute:jj,Int32BufferAttribute:Uj,Int8BufferAttribute:Dj,IntType:vf,InterleavedBuffer:Mf,InterleavedBufferAttribute:Bo,Interpolant:id,InterpolateDiscrete:ku,InterpolateLinear:ju,InterpolateSmooth:$m,InterpolationSamplingMode:$4,InterpolationSamplingType:Q4,InvertStencilOp:L4,KeepStencilOp:vl,KeyframeTrack:os,LOD:iR,LatheGeometry:Cx,Layers:Fl,LessCompare:V3,LessDepth:Ug,LessEqualCompare:ux,LessEqualDepth:Xl,LessEqualStencilFunc:j4,LessStencilFunc:F4,Light:Go,LightProbe:DR,Line:Ra,Line3:TO,LineBasicMaterial:Gr,LineCurve:Tw,LineCurve3:hR,LineDashedMaterial:MR,LineLoop:Sw,LineSegments:Ts,LinearFilter:en,LinearInterpolant:Fw,LinearMipMapLinearFilter:B1,LinearMipMapNearestFilter:_4,LinearMipmapLinearFilter:es,LinearMipmapNearestFilter:yu,LinearSRGBColorSpace:ea,LinearToneMapping:nw,LinearTransfer:Zh,Loader:Mr,LoaderUtils:Mo,LoadingManager:Bx,LoopOnce:k3,LoopPingPong:U3,LoopRepeat:j3,MOUSE:xl,Material:ar,MaterialLoader:Lx,MathUtils:mw,Matrix2:Zw,Matrix3:Vt,Matrix4:Dt,MaxEquation:_3,Mesh:Tn,MeshBasicMaterial:pi,MeshDepthMaterial:Bw,MeshDistanceMaterial:Lw,MeshLambertMaterial:SR,MeshMatcapMaterial:AR,MeshNormalMaterial:wR,MeshPhongMaterial:_R,MeshPhysicalMaterial:as,MeshStandardMaterial:Pf,MeshToonMaterial:bR,MinEquation:v3,MirroredRepeatWrapping:Lu,MixOperation:L3,MultiplyBlending:I1,MultiplyOperation:yf,NearestFilter:Un,NearestMipMapLinearFilter:v4,NearestMipMapNearestFilter:y4,NearestMipmapLinearFilter:Ml,NearestMipmapNearestFilter:nx,NeutralToneMapping:ow,NeverCompare:G3,NeverDepth:kg,NeverStencilFunc:D4,NoBlending:As,NoColorSpace:ya,NoNormalPacking:M4,NoToneMapping:ns,NormalAnimationBlendMode:cx,NormalBlending:Ll,NormalGAPacking:E4,NormalRGPacking:C4,NotEqualCompare:J3,NotEqualDepth:Gg,NotEqualStencilFunc:O4,NumberKeyframeTrack:Zl,Object3D:sn,ObjectLoader:ZU,ObjectSpaceNormalMap:H3,OctahedronGeometry:Rf,OneFactor:w3,OneMinusConstantAlphaFactor:B3,OneMinusConstantColorFactor:I3,OneMinusDstAlphaFactor:C3,OneMinusDstColorFactor:T3,OneMinusSrcAlphaFactor:Fg,OneMinusSrcColorFactor:A3,OrthographicCamera:Bi,PCFShadowMap:xu,PCFSoftShadowMap:xh,PMREMGenerator:G1,Path:C0,PerspectiveCamera:Cn,Plane:Xs,PlaneGeometry:Ho,PlaneHelper:OO,PointLight:zw,PointLightHelper:IO,Points:Aw,PointsMaterial:vx,PolarGridHelper:DO,PolyhedronGeometry:zo,PositionalAudio:rO,PropertyBinding:an,PropertyMixer:zR,QuadraticBezierCurve:Nw,QuadraticBezierCurve3:Rw,Quaternion:vr,QuaternionKeyframeTrack:ql,QuaternionLinearInterpolant:NR,R11_EAC_Format:qg,RED_GREEN_RGTC2_Format:_0,RED_RGTC1_Format:y0,REVISION:td,RG11_EAC_Format:$g,RGBADepthPacking:w4,RGBAFormat:Yn,RGBAIntegerFormat:lx,RGBA_ASTC_10x10_Format:h0,RGBA_ASTC_10x5_Format:c0,RGBA_ASTC_10x6_Format:u0,RGBA_ASTC_10x8_Format:d0,RGBA_ASTC_12x10_Format:f0,RGBA_ASTC_12x12_Format:p0,RGBA_ASTC_4x4_Format:t0,RGBA_ASTC_5x4_Format:n0,RGBA_ASTC_5x5_Format:r0,RGBA_ASTC_6x5_Format:i0,RGBA_ASTC_6x6_Format:s0,RGBA_ASTC_8x5_Format:a0,RGBA_ASTC_8x6_Format:o0,RGBA_ASTC_8x8_Format:l0,RGBA_BPTC_Format:m0,RGBA_ETC2_EAC_Format:Zg,RGBA_PVRTC_2BPPV1_Format:Jg,RGBA_PVRTC_4BPPV1_Format:Xg,RGBA_S3TC_DXT1_Format:vh,RGBA_S3TC_DXT3_Format:_h,RGBA_S3TC_DXT5_Format:bh,RGBDepthPacking:S4,RGBFormat:dw,RGBIntegerFormat:b4,RGB_BPTC_SIGNED_Format:g0,RGB_BPTC_UNSIGNED_Format:x0,RGB_ETC1_Format:Yg,RGB_ETC2_Format:Kg,RGB_PVRTC_2BPPV1_Format:Wg,RGB_PVRTC_4BPPV1_Format:Vg,RGB_S3TC_DXT1_Format:yh,RGDepthPacking:A4,RGFormat:Jl,RGIntegerFormat:ox,RawShaderMaterial:Pw,Ray:rc,Raycaster:Kw,RectAreaLight:LR,RedFormat:_f,RedIntegerFormat:bf,ReinhardToneMapping:rw,RenderTarget:gw,RenderTarget3D:xO,RepeatWrapping:Io,ReplaceStencilOp:N4,ReverseSubtractEquation:y3,RingGeometry:Ex,SIGNED_R11_EAC_Format:Qg,SIGNED_RED_GREEN_RGTC2_Format:b0,SIGNED_RED_RGTC1_Format:v0,SIGNED_RG11_EAC_Format:e0,SRGBColorSpace:qr,SRGBTransfer:fn,Scene:Af,ShaderChunk:Xt,ShaderLib:_s,ShaderMaterial:Hr,ShadowMaterial:vR,Shape:kl,ShapeGeometry:Tx,ShapePath:GO,ShapeUtils:bs,ShortType:ix,Skeleton:Cf,SkeletonHelper:RO,SkinnedMesh:bw,Source:fo,Sphere:sr,SphereGeometry:If,Spherical:z1,SphericalHarmonics3:Gw,SplineCurve:Iw,SpotLight:Ow,SpotLightHelper:NO,Sprite:rR,SpriteMaterial:_w,SrcAlphaFactor:Dg,SrcAlphaSaturateFactor:N3,SrcColorFactor:S3,StaticCopyUsage:J4,StaticDrawUsage:qh,StaticReadUsage:V4,StereoCamera:$U,StreamCopyUsage:K4,StreamDrawUsage:G4,StreamReadUsage:X4,StringKeyframeTrack:ac,SubtractEquation:x3,SubtractiveBlending:R1,TOUCH:yl,TangentSpaceNormalMap:Oo,TetrahedronGeometry:Nx,Texture:pn,TextureLoader:IR,TextureUtils:KO,Timer:wO,TimestampQuery:q4,TorusGeometry:Rx,TorusKnotGeometry:Ix,Triangle:hi,TriangleFanDrawMode:w0,TriangleStripDrawMode:fw,TrianglesDrawMode:O3,TubeGeometry:Px,UVMapping:No,Uint16BufferAttribute:xw,Uint32BufferAttribute:yw,Uint8BufferAttribute:Fj,Uint8ClampedBufferAttribute:kj,Uniform:Yw,UniformsGroup:vO,UniformsLib:ft,UniformsUtils:vw,UnsignedByteType:gr,UnsignedInt101111Type:cw,UnsignedInt248Type:Fu,UnsignedInt5999Type:lw,UnsignedIntType:Fi,UnsignedShort4444Type:sx,UnsignedShort5551Type:ax,UnsignedShortType:Du,VSMShadowMap:Al,Vector2:Te,Vector3:X,Vector4:yn,VectorKeyframeTrack:Ql,VideoFrameTexture:aU,VideoTexture:aR,WebGL3DRenderTarget:Aj,WebGLArrayRenderTarget:Sj,WebGLCoordinateSystem:Ri,WebGLCubeRenderTarget:px,WebGLRenderTarget:ei,WebGLRenderer:qw,WebGLUtils:KR,WebGPUCoordinateSystem:Uu,WebXRController:eg,WireframeGeometry:yR,WrapAroundEnding:Kh,ZeroCurvatureEnding:Cl,ZeroFactor:b3,ZeroSlopeEnding:El,ZeroStencilOp:T4,createCanvasElement:q3,error:It,getConsoleFunction:nj,log:$h,setConsoleFunction:tj,warn:ct,warnOnce:Ou},Symbol.toStringTag,{value:"Module"}));var ZR={exports:{}},oc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */oc.ConcurrentRoot=1;oc.ContinuousEventPriority=4;oc.DefaultEventPriority=16;oc.DiscreteEventPriority=1;oc.IdleEventPriority=536870912;oc.LegacyRoot=0;ZR.exports=oc;var uu=ZR.exports;function VG(n){let e;const t=new Set,r=(u,f)=>{const p=typeof u=="function"?u(e):u;if(p!==e){const m=e;e=f?p:Object.assign({},e,p),t.forEach(g=>g(e,m))}},i=()=>e,s=(u,f=i,p=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let m=f(e);function g(){const y=f(e);if(!p(m,y)){const S=m;u(m=y,S)}}return t.add(g),()=>t.delete(g)},c={setState:r,getState:i,subscribe:(u,f,p)=>f||p?s(u,f,p):(t.add(u),()=>t.delete(u)),destroy:()=>t.clear()};return e=n(r,i,c),c}const WG=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),GE=WG?F.useEffect:F.useLayoutEffect;function qR(n){const e=typeof n=="function"?VG(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=F.useReducer(w=>w+1,0),a=e.getState(),o=F.useRef(a),c=F.useRef(r),u=F.useRef(i),f=F.useRef(!1),p=F.useRef();p.current===void 0&&(p.current=r(a));let m,g=!1;(o.current!==a||c.current!==r||u.current!==i||f.current)&&(m=r(a),g=!i(p.current,m)),GE(()=>{g&&(p.current=m),o.current=a,c.current=r,u.current=i,f.current=!1});const y=F.useRef(a);GE(()=>{const w=()=>{try{const _=e.getState(),b=c.current(_);u.current(p.current,b)||(o.current=_,p.current=b,s())}catch{f.current=!0,s()}},x=e.subscribe(w);return e.getState()!==y.current&&w(),x},[]);const S=g?m:p.current;return F.useDebugValue(S),S};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}const XG=n=>typeof n=="object"&&typeof n.then=="function",Rl=[];function QR(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function $R(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of Rl)if(QR(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=Rl.indexOf(i);s!==-1&&Rl.splice(s,1)},promise:(XG(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(Rl.push(i),!t)throw i.promise}const JG=(n,e,t)=>$R(n,e,!1,t),YG=(n,e,t)=>void $R(n,e,!0,t),KG=n=>{if(n===void 0||n.length===0)Rl.splice(0,Rl.length);else{const e=Rl.find(t=>QR(n,t.keys,t.equal));e&&e.remove()}};var eI={exports:{}},u_={exports:{}},d_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VE;function ZG(){return VE||(VE=1,function(n){function e(U,H){var W=U.length;U.push(H);e:for(;0<W;){var Y=W-1>>>1,G=U[Y];if(0<i(G,H))U[Y]=H,U[W]=G,W=Y;else break e}}function t(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],W=U.pop();if(W!==H){U[0]=W;e:for(var Y=0,G=U.length,de=G>>>1;Y<de;){var Ce=2*(Y+1)-1,be=U[Ce],se=Ce+1,_e=U[se];if(0>i(be,W))se<G&&0>i(_e,be)?(U[Y]=_e,U[se]=W,Y=se):(U[Y]=be,U[Ce]=W,Y=Ce);else if(se<G&&0>i(_e,W))U[Y]=_e,U[se]=W,Y=se;else break e}}return H}function i(U,H){var W=U.sortIndex-H.sortIndex;return W!==0?W:U.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],f=1,p=null,m=3,g=!1,y=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(U){for(var H=t(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=U)r(u),H.sortIndex=H.expirationTime,e(c,H);else break;H=t(u)}}function M(U){if(S=!1,b(U),!y)if(t(c)!==null)y=!0,K(N);else{var H=t(u);H!==null&&$(M,H.startTime-U)}}function N(U,H){y=!1,S&&(S=!1,x(P),P=-1),g=!0;var W=m;try{for(b(H),p=t(c);p!==null&&(!(p.expirationTime>H)||U&&!j());){var Y=p.callback;if(typeof Y=="function"){p.callback=null,m=p.priorityLevel;var G=Y(p.expirationTime<=H);H=n.unstable_now(),typeof G=="function"?p.callback=G:p===t(c)&&r(c),b(H)}else r(c);p=t(c)}if(p!==null)var de=!0;else{var Ce=t(u);Ce!==null&&$(M,Ce.startTime-H),de=!1}return de}finally{p=null,m=W,g=!1}}var C=!1,I=null,P=-1,T=5,R=-1;function j(){return!(n.unstable_now()-R<T)}function O(){if(I!==null){var U=n.unstable_now();R=U;var H=!0;try{H=I(!0,U)}finally{H?k():(C=!1,I=null)}}else C=!1}var k;if(typeof _=="function")k=function(){_(O)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,te=Z.port2;Z.port1.onmessage=O,k=function(){te.postMessage(null)}}else k=function(){w(O,0)};function K(U){I=U,C||(C=!0,k())}function $(U,H){P=w(function(){U(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,K(N))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(U){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var W=m;m=H;try{return U()}finally{m=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var W=m;m=U;try{return H()}finally{m=W}},n.unstable_scheduleCallback=function(U,H,W){var Y=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Y+W:Y):W=Y,U){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=W+G,U={id:f++,callback:H,priorityLevel:U,startTime:W,expirationTime:G,sortIndex:-1},W>Y?(U.sortIndex=W,e(u,U),t(c)===null&&U===t(u)&&(S?(x(P),P=-1):S=!0,$(M,W-Y))):(U.sortIndex=G,e(c,U),y||g||(y=!0,K(N))),U},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(U){var H=m;return function(){var W=m;m=H;try{return U.apply(this,arguments)}finally{m=W}}}}(d_)),d_}var WE;function qG(){return WE||(WE=1,u_.exports=ZG()),u_.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QG=function(e){var t={},r=F,i=qG(),s=Object.assign;function a(d){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+d,v=1;v<arguments.length;v++)h+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),u=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),M=Symbol.for("react.offscreen"),N=Symbol.iterator;function C(d){return d===null||typeof d!="object"?null:(d=N&&d[N]||d["@@iterator"],typeof d=="function"?d:null)}function I(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case f:return"Fragment";case u:return"Portal";case m:return"Profiler";case p:return"StrictMode";case w:return"Suspense";case x:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case y:return(d.displayName||"Context")+".Consumer";case g:return(d._context.displayName||"Context")+".Provider";case S:var h=d.render;return d=d.displayName,d||(d=h.displayName||h.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case _:return h=d.displayName||null,h!==null?h:I(d.type)||"Memo";case b:h=d._payload,d=d._init;try{return I(d(h))}catch{}}return null}function P(d){var h=d.type;switch(d.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=h.render,d=d.displayName||d.name||"",h.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(h);case 8:return h===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function T(d){var h=d,v=d;if(d.alternate)for(;h.return;)h=h.return;else{d=h;do h=d,h.flags&4098&&(v=h.return),d=h.return;while(d)}return h.tag===3?v:null}function R(d){if(T(d)!==d)throw Error(a(188))}function j(d){var h=d.alternate;if(!h){if(h=T(d),h===null)throw Error(a(188));return h!==d?null:d}for(var v=d,A=h;;){var E=v.return;if(E===null)break;var B=E.alternate;if(B===null){if(A=E.return,A!==null){v=A;continue}break}if(E.child===B.child){for(B=E.child;B;){if(B===v)return R(E),d;if(B===A)return R(E),h;B=B.sibling}throw Error(a(188))}if(v.return!==A.return)v=E,A=B;else{for(var ee=!1,ue=E.child;ue;){if(ue===v){ee=!0,v=E,A=B;break}if(ue===A){ee=!0,A=E,v=B;break}ue=ue.sibling}if(!ee){for(ue=B.child;ue;){if(ue===v){ee=!0,v=B,A=E;break}if(ue===A){ee=!0,A=B,v=E;break}ue=ue.sibling}if(!ee)throw Error(a(189))}}if(v.alternate!==A)throw Error(a(190))}if(v.tag!==3)throw Error(a(188));return v.stateNode.current===v?d:h}function O(d){return d=j(d),d!==null?k(d):null}function k(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var h=k(d);if(h!==null)return h;d=d.sibling}return null}function Z(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){if(d.tag!==4){var h=Z(d);if(h!==null)return h}d=d.sibling}return null}var te=Array.isArray,K=e.getPublicInstance,$=e.getRootHostContext,U=e.getChildHostContext,H=e.prepareForCommit,W=e.resetAfterCommit,Y=e.createInstance,G=e.appendInitialChild,de=e.finalizeInitialChildren,Ce=e.prepareUpdate,be=e.shouldSetTextContent,se=e.createTextInstance,_e=e.scheduleTimeout,Le=e.cancelTimeout,yt=e.noTimeout,qe=e.isPrimaryRenderer,lt=e.supportsMutation,kt=e.supportsPersistence,it=e.supportsHydration,Me=e.getInstanceFromNode,Be=e.preparePortalMount,Ie=e.getCurrentEventPriority,Ye=e.detachDeletedInstance,Q=e.supportsMicrotasks,vt=e.scheduleMicrotask,et=e.supportsTestSelectors,Ct=e.findFiberRoot,Ge=e.getBoundingRect,J=e.getTextContent,L=e.isHiddenSubtree,q=e.matchAccessibilityRole,pe=e.setFocusIfFocusable,ve=e.setupIntersectionObserver,ge=e.appendChild,st=e.appendChildToContainer,Ke=e.commitTextUpdate,dt=e.commitMount,_t=e.commitUpdate,Fe=e.insertBefore,He=e.insertInContainerBefore,xt=e.removeChild,re=e.removeChildFromContainer,fe=e.resetTextContent,ke=e.hideInstance,ie=e.hideTextInstance,me=e.unhideInstance,je=e.unhideTextInstance,at=e.clearContainer,ze=e.cloneInstance,Re=e.createContainerChildSet,Ve=e.appendChildToContainerChildSet,Tt=e.finalizeContainerChildren,Qt=e.replaceContainerChildren,Jt=e.cloneHiddenInstance,Gn=e.cloneHiddenTextInstance,cr=e.canHydrateInstance,ad=e.canHydrateTextInstance,lc=e.canHydrateSuspenseInstance,ls=e.isSuspenseInstancePending,Vo=e.isSuspenseInstanceFallback,Rs=e.registerSuspenseInstanceRetry,ri=e.getNextHydratableSibling,Ut=e.getFirstHydratableChild,Da=e.getFirstHydratableChildWithinContainer,cc=e.getFirstHydratableChildWithinSuspenseInstance,D=e.hydrateInstance,V=e.hydrateTextInstance,ae=e.hydrateSuspenseInstance,xe=e.getNextHydratableInstanceAfterSuspenseInstance,Se=e.commitHydratedContainer,Ae=e.commitHydratedSuspenseInstance,Ze=e.clearSuspenseBoundary,Oe=e.clearSuspenseBoundaryFromContainer,nt=e.shouldDeleteUnhydratedTailInstances,tt=e.didNotMatchHydratedContainerTextInstance,rt=e.didNotMatchHydratedTextInstance,Qe;function z(d){if(Qe===void 0)try{throw Error()}catch(v){var h=v.stack.trim().match(/\n( *(at )?)/);Qe=h&&h[1]||""}return`
`+Qe+d}var ne=!1;function le(d,h){if(!d||ne)return"";ne=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch($e){var A=$e}Reflect.construct(d,[],h)}else{try{h.call()}catch($e){A=$e}d.call(h.prototype)}else{try{throw Error()}catch($e){A=$e}d()}}catch($e){if($e&&A&&typeof $e.stack=="string"){for(var E=$e.stack.split(`
`),B=A.stack.split(`
`),ee=E.length-1,ue=B.length-1;1<=ee&&0<=ue&&E[ee]!==B[ue];)ue--;for(;1<=ee&&0<=ue;ee--,ue--)if(E[ee]!==B[ue]){if(ee!==1||ue!==1)do if(ee--,ue--,0>ue||E[ee]!==B[ue]){var Ee=`
`+E[ee].replace(" at new "," at ");return d.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",d.displayName)),Ee}while(1<=ee&&0<=ue);break}}}finally{ne=!1,Error.prepareStackTrace=v}return(d=d?d.displayName||d.name:"")?z(d):""}var ce=Object.prototype.hasOwnProperty,oe=[],Pe=-1;function Ue(d){return{current:d}}function Ne(d){0>Pe||(d.current=oe[Pe],oe[Pe]=null,Pe--)}function De(d,h){Pe++,oe[Pe]=d.current,d.current=h}var We={},ht=Ue(We),Xe=Ue(!1),St=We;function Ot(d,h){var v=d.type.contextTypes;if(!v)return We;var A=d.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===h)return A.__reactInternalMemoizedMaskedChildContext;var E={},B;for(B in v)E[B]=h[B];return A&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=h,d.__reactInternalMemoizedMaskedChildContext=E),E}function zt(d){return d=d.childContextTypes,d!=null}function Yt(){Ne(Xe),Ne(ht)}function Nt(d,h,v){if(ht.current!==We)throw Error(a(168));De(ht,h),De(Xe,v)}function mt(d,h,v){var A=d.stateNode;if(h=h.childContextTypes,typeof A.getChildContext!="function")return v;A=A.getChildContext();for(var E in A)if(!(E in h))throw Error(a(108,P(d)||"Unknown",E));return s({},v,A)}function Et(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||We,St=ht.current,De(ht,d),De(Xe,Xe.current),!0}function At(d,h,v){var A=d.stateNode;if(!A)throw Error(a(169));v?(d=mt(d,h,St),A.__reactInternalMemoizedMergedChildContext=d,Ne(Xe),Ne(ht),De(ht,d)):Ne(Xe),De(Xe,v)}var qt=Math.clz32?Math.clz32:Er,Cr=Math.log,mn=Math.LN2;function Er(d){return d>>>=0,d===0?32:31-(Cr(d)/mn|0)|0}var hn=64,er=4194304;function ur(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function Kn(d,h){var v=d.pendingLanes;if(v===0)return 0;var A=0,E=d.suspendedLanes,B=d.pingedLanes,ee=v&268435455;if(ee!==0){var ue=ee&~E;ue!==0?A=ur(ue):(B&=ee,B!==0&&(A=ur(B)))}else ee=v&~E,ee!==0?A=ur(ee):B!==0&&(A=ur(B));if(A===0)return 0;if(h!==0&&h!==A&&!(h&E)&&(E=A&-A,B=h&-h,E>=B||E===16&&(B&4194240)!==0))return h;if(A&4&&(A|=v&16),h=d.entangledLanes,h!==0)for(d=d.entanglements,h&=A;0<h;)v=31-qt(h),E=1<<v,A|=d[v],h&=~E;return A}function Tr(d,h){switch(d){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function od(d,h){for(var v=d.suspendedLanes,A=d.pingedLanes,E=d.expirationTimes,B=d.pendingLanes;0<B;){var ee=31-qt(B),ue=1<<ee,Ee=E[ee];Ee===-1?(!(ue&v)||ue&A)&&(E[ee]=Tr(ue,h)):Ee<=h&&(d.expiredLanes|=ue),B&=~ue}}function cs(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Ux(d){for(var h=[],v=0;31>v;v++)h.push(d);return h}function ld(d,h,v){d.pendingLanes|=h,h!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,h=31-qt(h),d[h]=v}function jI(d,h){var v=d.pendingLanes&~h;d.pendingLanes=h,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=h,d.mutableReadLanes&=h,d.entangledLanes&=h,h=d.entanglements;var A=d.eventTimes;for(d=d.expirationTimes;0<v;){var E=31-qt(v),B=1<<E;h[E]=0,A[E]=-1,d[E]=-1,v&=~B}}function Ox(d,h){var v=d.entangledLanes|=h;for(d=d.entanglements;v;){var A=31-qt(v),E=1<<A;E&h|d[A]&h&&(d[A]|=h),v&=~E}}var cn=0;function fS(d){return d&=-d,1<d?4<d?d&268435455?16:536870912:4:1}var zx=i.unstable_scheduleCallback,pS=i.unstable_cancelCallback,UI=i.unstable_shouldYield,OI=i.unstable_requestPaint,dr=i.unstable_now,Hx=i.unstable_ImmediatePriority,zI=i.unstable_UserBlockingPriority,Gx=i.unstable_NormalPriority,HI=i.unstable_IdlePriority,kf=null,Is=null;function GI(d){if(Is&&typeof Is.onCommitFiberRoot=="function")try{Is.onCommitFiberRoot(kf,d,void 0,(d.current.flags&128)===128)}catch{}}function VI(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var Ps=typeof Object.is=="function"?Object.is:VI,na=null,jf=!1,Vx=!1;function mS(d){na===null?na=[d]:na.push(d)}function WI(d){jf=!0,mS(d)}function Bs(){if(!Vx&&na!==null){Vx=!0;var d=0,h=cn;try{var v=na;for(cn=1;d<v.length;d++){var A=v[d];do A=A(!0);while(A!==null)}na=null,jf=!1}catch(E){throw na!==null&&(na=na.slice(d+1)),zx(Hx,Bs),E}finally{cn=h,Vx=!1}}return null}var XI=o.ReactCurrentBatchConfig;function Uf(d,h){if(Ps(d,h))return!0;if(typeof d!="object"||d===null||typeof h!="object"||h===null)return!1;var v=Object.keys(d),A=Object.keys(h);if(v.length!==A.length)return!1;for(A=0;A<v.length;A++){var E=v[A];if(!ce.call(h,E)||!Ps(d[E],h[E]))return!1}return!0}function JI(d){switch(d.tag){case 5:return z(d.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return d=le(d.type,!1),d;case 11:return d=le(d.type.render,!1),d;case 1:return d=le(d.type,!0),d;default:return""}}function us(d,h){if(d&&d.defaultProps){h=s({},h),d=d.defaultProps;for(var v in d)h[v]===void 0&&(h[v]=d[v]);return h}return h}var Of=Ue(null),zf=null,uc=null,Wx=null;function Xx(){Wx=uc=zf=null}function gS(d,h,v){qe?(De(Of,h._currentValue),h._currentValue=v):(De(Of,h._currentValue2),h._currentValue2=v)}function Jx(d){var h=Of.current;Ne(Of),qe?d._currentValue=h:d._currentValue2=h}function Yx(d,h,v){for(;d!==null;){var A=d.alternate;if((d.childLanes&h)!==h?(d.childLanes|=h,A!==null&&(A.childLanes|=h)):A!==null&&(A.childLanes&h)!==h&&(A.childLanes|=h),d===v)break;d=d.return}}function dc(d,h){zf=d,Wx=uc=null,d=d.dependencies,d!==null&&d.firstContext!==null&&(d.lanes&h&&(wi=!0),d.firstContext=null)}function Oi(d){var h=qe?d._currentValue:d._currentValue2;if(Wx!==d)if(d={context:d,memoizedValue:h,next:null},uc===null){if(zf===null)throw Error(a(308));uc=d,zf.dependencies={lanes:0,firstContext:d}}else uc=uc.next=d;return h}var Ls=null,Fa=!1;function Kx(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xS(d,h){d=d.updateQueue,h.updateQueue===d&&(h.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function ra(d,h){return{eventTime:d,lane:h,tag:0,payload:null,callback:null,next:null}}function ka(d,h){var v=d.updateQueue;v!==null&&(v=v.shared,Zn!==null&&d.mode&1&&!(Zt&2)?(d=v.interleaved,d===null?(h.next=h,Ls===null?Ls=[v]:Ls.push(v)):(h.next=d.next,d.next=h),v.interleaved=h):(d=v.pending,d===null?h.next=h:(h.next=d.next,d.next=h),v.pending=h))}function Hf(d,h,v){if(h=h.updateQueue,h!==null&&(h=h.shared,(v&4194240)!==0)){var A=h.lanes;A&=d.pendingLanes,v|=A,h.lanes=v,Ox(d,v)}}function yS(d,h){var v=d.updateQueue,A=d.alternate;if(A!==null&&(A=A.updateQueue,v===A)){var E=null,B=null;if(v=v.firstBaseUpdate,v!==null){do{var ee={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};B===null?E=B=ee:B=B.next=ee,v=v.next}while(v!==null);B===null?E=B=h:B=B.next=h}else E=B=h;v={baseState:A.baseState,firstBaseUpdate:E,lastBaseUpdate:B,shared:A.shared,effects:A.effects},d.updateQueue=v;return}d=v.lastBaseUpdate,d===null?v.firstBaseUpdate=h:d.next=h,v.lastBaseUpdate=h}function Gf(d,h,v,A){var E=d.updateQueue;Fa=!1;var B=E.firstBaseUpdate,ee=E.lastBaseUpdate,ue=E.shared.pending;if(ue!==null){E.shared.pending=null;var Ee=ue,$e=Ee.next;Ee.next=null,ee===null?B=$e:ee.next=$e,ee=Ee;var Mt=d.alternate;Mt!==null&&(Mt=Mt.updateQueue,ue=Mt.lastBaseUpdate,ue!==ee&&(ue===null?Mt.firstBaseUpdate=$e:ue.next=$e,Mt.lastBaseUpdate=Ee))}if(B!==null){var Ht=E.baseState;ee=0,Mt=$e=Ee=null,ue=B;do{var Bt=ue.lane,xn=ue.eventTime;if((A&Bt)===Bt){Mt!==null&&(Mt=Mt.next={eventTime:xn,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Pt=d,Pr=ue;switch(Bt=h,xn=v,Pr.tag){case 1:if(Pt=Pr.payload,typeof Pt=="function"){Ht=Pt.call(xn,Ht,Bt);break e}Ht=Pt;break e;case 3:Pt.flags=Pt.flags&-65537|128;case 0:if(Pt=Pr.payload,Bt=typeof Pt=="function"?Pt.call(xn,Ht,Bt):Pt,Bt==null)break e;Ht=s({},Ht,Bt);break e;case 2:Fa=!0}}ue.callback!==null&&ue.lane!==0&&(d.flags|=64,Bt=E.effects,Bt===null?E.effects=[ue]:Bt.push(ue))}else xn={eventTime:xn,lane:Bt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Mt===null?($e=Mt=xn,Ee=Ht):Mt=Mt.next=xn,ee|=Bt;if(ue=ue.next,ue===null){if(ue=E.shared.pending,ue===null)break;Bt=ue,ue=Bt.next,Bt.next=null,E.lastBaseUpdate=Bt,E.shared.pending=null}}while(!0);if(Mt===null&&(Ee=Ht),E.baseState=Ee,E.firstBaseUpdate=$e,E.lastBaseUpdate=Mt,h=E.shared.interleaved,h!==null){E=h;do ee|=E.lane,E=E.next;while(E!==h)}else B===null&&(E.shared.lanes=0);_c|=ee,d.lanes=ee,d.memoizedState=Ht}}function vS(d,h,v){if(d=h.effects,h.effects=null,d!==null)for(h=0;h<d.length;h++){var A=d[h],E=A.callback;if(E!==null){if(A.callback=null,A=v,typeof E!="function")throw Error(a(191,E));E.call(A)}}}var _S=new r.Component().refs;function Zx(d,h,v,A){h=d.memoizedState,v=v(A,h),v=v==null?h:s({},h,v),d.memoizedState=v,d.lanes===0&&(d.updateQueue.baseState=v)}var Vf={isMounted:function(d){return(d=d._reactInternals)?T(d)===d:!1},enqueueSetState:function(d,h,v){d=d._reactInternals;var A=Wr(),E=Oa(d),B=ra(A,E);B.payload=h,v!=null&&(B.callback=v),ka(d,B),h=Wi(d,E,A),h!==null&&Hf(h,d,E)},enqueueReplaceState:function(d,h,v){d=d._reactInternals;var A=Wr(),E=Oa(d),B=ra(A,E);B.tag=1,B.payload=h,v!=null&&(B.callback=v),ka(d,B),h=Wi(d,E,A),h!==null&&Hf(h,d,E)},enqueueForceUpdate:function(d,h){d=d._reactInternals;var v=Wr(),A=Oa(d),E=ra(v,A);E.tag=2,h!=null&&(E.callback=h),ka(d,E),h=Wi(d,A,v),h!==null&&Hf(h,d,A)}};function bS(d,h,v,A,E,B,ee){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(A,B,ee):h.prototype&&h.prototype.isPureReactComponent?!Uf(v,A)||!Uf(E,B):!0}function wS(d,h,v){var A=!1,E=We,B=h.contextType;return typeof B=="object"&&B!==null?B=Oi(B):(E=zt(h)?St:ht.current,A=h.contextTypes,B=(A=A!=null)?Ot(d,E):We),h=new h(v,B),d.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Vf,d.stateNode=h,h._reactInternals=d,A&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=E,d.__reactInternalMemoizedMaskedChildContext=B),h}function SS(d,h,v,A){d=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(v,A),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(v,A),h.state!==d&&Vf.enqueueReplaceState(h,h.state,null)}function qx(d,h,v,A){var E=d.stateNode;E.props=v,E.state=d.memoizedState,E.refs=_S,Kx(d);var B=h.contextType;typeof B=="object"&&B!==null?E.context=Oi(B):(B=zt(h)?St:ht.current,E.context=Ot(d,B)),E.state=d.memoizedState,B=h.getDerivedStateFromProps,typeof B=="function"&&(Zx(d,h,B,v),E.state=d.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(h=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),h!==E.state&&Vf.enqueueReplaceState(E,E.state,null),Gf(d,v,E,A),E.state=d.memoizedState),typeof E.componentDidMount=="function"&&(d.flags|=4194308)}var hc=[],fc=0,Wf=null,Xf=0,zi=[],Hi=0,Wo=null,ia=1,sa="";function Xo(d,h){hc[fc++]=Xf,hc[fc++]=Wf,Wf=d,Xf=h}function AS(d,h,v){zi[Hi++]=ia,zi[Hi++]=sa,zi[Hi++]=Wo,Wo=d;var A=ia;d=sa;var E=32-qt(A)-1;A&=~(1<<E),v+=1;var B=32-qt(h)+E;if(30<B){var ee=E-E%5;B=(A&(1<<ee)-1).toString(32),A>>=ee,E-=ee,ia=1<<32-qt(h)+E|v<<E|A,sa=B+d}else ia=1<<B|v<<E|A,sa=d}function Qx(d){d.return!==null&&(Xo(d,1),AS(d,1,0))}function $x(d){for(;d===Wf;)Wf=hc[--fc],hc[fc]=null,Xf=hc[--fc],hc[fc]=null;for(;d===Wo;)Wo=zi[--Hi],zi[Hi]=null,sa=zi[--Hi],zi[Hi]=null,ia=zi[--Hi],zi[Hi]=null}var _i=null,bi=null,An=!1,cd=!1,ds=null;function MS(d,h){var v=Xi(5,null,null,0);v.elementType="DELETED",v.stateNode=h,v.return=d,h=d.deletions,h===null?(d.deletions=[v],d.flags|=16):h.push(v)}function CS(d,h){switch(d.tag){case 5:return h=cr(h,d.type,d.pendingProps),h!==null?(d.stateNode=h,_i=d,bi=Ut(h),!0):!1;case 6:return h=ad(h,d.pendingProps),h!==null?(d.stateNode=h,_i=d,bi=null,!0):!1;case 13:if(h=lc(h),h!==null){var v=Wo!==null?{id:ia,overflow:sa}:null;return d.memoizedState={dehydrated:h,treeContext:v,retryLane:1073741824},v=Xi(18,null,null,0),v.stateNode=h,v.return=d,d.child=v,_i=d,bi=null,!0}return!1;default:return!1}}function ey(d){return(d.mode&1)!==0&&(d.flags&128)===0}function ty(d){if(An){var h=bi;if(h){var v=h;if(!CS(d,h)){if(ey(d))throw Error(a(418));h=ri(v);var A=_i;h&&CS(d,h)?MS(A,v):(d.flags=d.flags&-4097|2,An=!1,_i=d)}}else{if(ey(d))throw Error(a(418));d.flags=d.flags&-4097|2,An=!1,_i=d}}}function ES(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;_i=d}function ud(d){if(!it||d!==_i)return!1;if(!An)return ES(d),An=!0,!1;if(d.tag!==3&&(d.tag!==5||nt(d.type)&&!be(d.type,d.memoizedProps))){var h=bi;if(h){if(ey(d)){for(d=bi;d;)d=ri(d);throw Error(a(418))}for(;h;)MS(d,h),h=ri(h)}}if(ES(d),d.tag===13){if(!it)throw Error(a(316));if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(a(317));bi=xe(d)}else bi=_i?ri(d.stateNode):null;return!0}function pc(){it&&(bi=_i=null,cd=An=!1)}function ny(d){ds===null?ds=[d]:ds.push(d)}function dd(d,h,v){if(d=v.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(a(309));var A=v.stateNode}if(!A)throw Error(a(147,d));var E=A,B=""+d;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===B?h.ref:(h=function(ee){var ue=E.refs;ue===_S&&(ue=E.refs={}),ee===null?delete ue[B]:ue[B]=ee},h._stringRef=B,h)}if(typeof d!="string")throw Error(a(284));if(!v._owner)throw Error(a(290,d))}return d}function Jf(d,h){throw d=Object.prototype.toString.call(h),Error(a(31,d==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":d))}function TS(d){var h=d._init;return h(d._payload)}function NS(d){function h(ye,he){if(d){var we=ye.deletions;we===null?(ye.deletions=[he],ye.flags|=16):we.push(he)}}function v(ye,he){if(!d)return null;for(;he!==null;)h(ye,he),he=he.sibling;return null}function A(ye,he){for(ye=new Map;he!==null;)he.key!==null?ye.set(he.key,he):ye.set(he.index,he),he=he.sibling;return ye}function E(ye,he){return ye=Ha(ye,he),ye.index=0,ye.sibling=null,ye}function B(ye,he,we){return ye.index=we,d?(we=ye.alternate,we!==null?(we=we.index,we<he?(ye.flags|=2,he):we):(ye.flags|=2,he)):(ye.flags|=1048576,he)}function ee(ye){return d&&ye.alternate===null&&(ye.flags|=2),ye}function ue(ye,he,we,gt){return he===null||he.tag!==6?(he=Uy(we,ye.mode,gt),he.return=ye,he):(he=E(he,we),he.return=ye,he)}function Ee(ye,he,we,gt){var Rt=we.type;return Rt===f?Mt(ye,he,we.props.children,gt,we.key):he!==null&&(he.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===b&&TS(Rt)===he.type)?(gt=E(he,we.props),gt.ref=dd(ye,he,we),gt.return=ye,gt):(gt=Ap(we.type,we.key,we.props,null,ye.mode,gt),gt.ref=dd(ye,he,we),gt.return=ye,gt)}function $e(ye,he,we,gt){return he===null||he.tag!==4||he.stateNode.containerInfo!==we.containerInfo||he.stateNode.implementation!==we.implementation?(he=Oy(we,ye.mode,gt),he.return=ye,he):(he=E(he,we.children||[]),he.return=ye,he)}function Mt(ye,he,we,gt,Rt){return he===null||he.tag!==7?(he=$o(we,ye.mode,gt,Rt),he.return=ye,he):(he=E(he,we),he.return=ye,he)}function Ht(ye,he,we){if(typeof he=="string"&&he!==""||typeof he=="number")return he=Uy(""+he,ye.mode,we),he.return=ye,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case c:return we=Ap(he.type,he.key,he.props,null,ye.mode,we),we.ref=dd(ye,null,he),we.return=ye,we;case u:return he=Oy(he,ye.mode,we),he.return=ye,he;case b:var gt=he._init;return Ht(ye,gt(he._payload),we)}if(te(he)||C(he))return he=$o(he,ye.mode,we,null),he.return=ye,he;Jf(ye,he)}return null}function Bt(ye,he,we,gt){var Rt=he!==null?he.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return Rt!==null?null:ue(ye,he,""+we,gt);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case c:return we.key===Rt?Ee(ye,he,we,gt):null;case u:return we.key===Rt?$e(ye,he,we,gt):null;case b:return Rt=we._init,Bt(ye,he,Rt(we._payload),gt)}if(te(we)||C(we))return Rt!==null?null:Mt(ye,he,we,gt,null);Jf(ye,we)}return null}function xn(ye,he,we,gt,Rt){if(typeof gt=="string"&&gt!==""||typeof gt=="number")return ye=ye.get(we)||null,ue(he,ye,""+gt,Rt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case c:return ye=ye.get(gt.key===null?we:gt.key)||null,Ee(he,ye,gt,Rt);case u:return ye=ye.get(gt.key===null?we:gt.key)||null,$e(he,ye,gt,Rt);case b:var Kt=gt._init;return xn(ye,he,we,Kt(gt._payload),Rt)}if(te(gt)||C(gt))return ye=ye.get(we)||null,Mt(he,ye,gt,Rt,null);Jf(he,gt)}return null}function Pt(ye,he,we,gt){for(var Rt=null,Kt=null,Gt=he,un=he=0,fr=null;Gt!==null&&un<we.length;un++){Gt.index>un?(fr=Gt,Gt=null):fr=Gt.sibling;var dn=Bt(ye,Gt,we[un],gt);if(dn===null){Gt===null&&(Gt=fr);break}d&&Gt&&dn.alternate===null&&h(ye,Gt),he=B(dn,he,un),Kt===null?Rt=dn:Kt.sibling=dn,Kt=dn,Gt=fr}if(un===we.length)return v(ye,Gt),An&&Xo(ye,un),Rt;if(Gt===null){for(;un<we.length;un++)Gt=Ht(ye,we[un],gt),Gt!==null&&(he=B(Gt,he,un),Kt===null?Rt=Gt:Kt.sibling=Gt,Kt=Gt);return An&&Xo(ye,un),Rt}for(Gt=A(ye,Gt);un<we.length;un++)fr=xn(Gt,ye,un,we[un],gt),fr!==null&&(d&&fr.alternate!==null&&Gt.delete(fr.key===null?un:fr.key),he=B(fr,he,un),Kt===null?Rt=fr:Kt.sibling=fr,Kt=fr);return d&&Gt.forEach(function(Ga){return h(ye,Ga)}),An&&Xo(ye,un),Rt}function Pr(ye,he,we,gt){var Rt=C(we);if(typeof Rt!="function")throw Error(a(150));if(we=Rt.call(we),we==null)throw Error(a(151));for(var Kt=Rt=null,Gt=he,un=he=0,fr=null,dn=we.next();Gt!==null&&!dn.done;un++,dn=we.next()){Gt.index>un?(fr=Gt,Gt=null):fr=Gt.sibling;var Ga=Bt(ye,Gt,dn.value,gt);if(Ga===null){Gt===null&&(Gt=fr);break}d&&Gt&&Ga.alternate===null&&h(ye,Gt),he=B(Ga,he,un),Kt===null?Rt=Ga:Kt.sibling=Ga,Kt=Ga,Gt=fr}if(dn.done)return v(ye,Gt),An&&Xo(ye,un),Rt;if(Gt===null){for(;!dn.done;un++,dn=we.next())dn=Ht(ye,dn.value,gt),dn!==null&&(he=B(dn,he,un),Kt===null?Rt=dn:Kt.sibling=dn,Kt=dn);return An&&Xo(ye,un),Rt}for(Gt=A(ye,Gt);!dn.done;un++,dn=we.next())dn=xn(Gt,ye,un,dn.value,gt),dn!==null&&(d&&dn.alternate!==null&&Gt.delete(dn.key===null?un:dn.key),he=B(dn,he,un),Kt===null?Rt=dn:Kt.sibling=dn,Kt=dn);return d&&Gt.forEach(function(SP){return h(ye,SP)}),An&&Xo(ye,un),Rt}function Ji(ye,he,we,gt){if(typeof we=="object"&&we!==null&&we.type===f&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case c:e:{for(var Rt=we.key,Kt=he;Kt!==null;){if(Kt.key===Rt){if(Rt=we.type,Rt===f){if(Kt.tag===7){v(ye,Kt.sibling),he=E(Kt,we.props.children),he.return=ye,ye=he;break e}}else if(Kt.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===b&&TS(Rt)===Kt.type){v(ye,Kt.sibling),he=E(Kt,we.props),he.ref=dd(ye,Kt,we),he.return=ye,ye=he;break e}v(ye,Kt);break}else h(ye,Kt);Kt=Kt.sibling}we.type===f?(he=$o(we.props.children,ye.mode,gt,we.key),he.return=ye,ye=he):(gt=Ap(we.type,we.key,we.props,null,ye.mode,gt),gt.ref=dd(ye,he,we),gt.return=ye,ye=gt)}return ee(ye);case u:e:{for(Kt=we.key;he!==null;){if(he.key===Kt)if(he.tag===4&&he.stateNode.containerInfo===we.containerInfo&&he.stateNode.implementation===we.implementation){v(ye,he.sibling),he=E(he,we.children||[]),he.return=ye,ye=he;break e}else{v(ye,he);break}else h(ye,he);he=he.sibling}he=Oy(we,ye.mode,gt),he.return=ye,ye=he}return ee(ye);case b:return Kt=we._init,Ji(ye,he,Kt(we._payload),gt)}if(te(we))return Pt(ye,he,we,gt);if(C(we))return Pr(ye,he,we,gt);Jf(ye,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,he!==null&&he.tag===6?(v(ye,he.sibling),he=E(he,we),he.return=ye,ye=he):(v(ye,he),he=Uy(we,ye.mode,gt),he.return=ye,ye=he),ee(ye)):v(ye,he)}return Ji}var mc=NS(!0),RS=NS(!1),hd={},Gi=Ue(hd),fd=Ue(hd),gc=Ue(hd);function Ds(d){if(d===hd)throw Error(a(174));return d}function ry(d,h){De(gc,h),De(fd,d),De(Gi,hd),d=$(h),Ne(Gi),De(Gi,d)}function xc(){Ne(Gi),Ne(fd),Ne(gc)}function IS(d){var h=Ds(gc.current),v=Ds(Gi.current);h=U(v,d.type,h),v!==h&&(De(fd,d),De(Gi,h))}function iy(d){fd.current===d&&(Ne(Gi),Ne(fd))}var Nn=Ue(0);function Yf(d){for(var h=d;h!==null;){if(h.tag===13){var v=h.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||ls(v)||Vo(v)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if(h.flags&128)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break;for(;h.sibling===null;){if(h.return===null||h.return===d)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var sy=[];function ay(){for(var d=0;d<sy.length;d++){var h=sy[d];qe?h._workInProgressVersionPrimary=null:h._workInProgressVersionSecondary=null}sy.length=0}var Kf=o.ReactCurrentDispatcher,Vi=o.ReactCurrentBatchConfig,yc=0,Dn=null,Nr=null,hr=null,Zf=!1,pd=!1,md=0,YI=0;function Rr(){throw Error(a(321))}function oy(d,h){if(h===null)return!1;for(var v=0;v<h.length&&v<d.length;v++)if(!Ps(d[v],h[v]))return!1;return!0}function ly(d,h,v,A,E,B){if(yc=B,Dn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Kf.current=d===null||d.memoizedState===null?QI:$I,d=v(A,E),pd){B=0;do{if(pd=!1,md=0,25<=B)throw Error(a(301));B+=1,hr=Nr=null,h.updateQueue=null,Kf.current=eP,d=v(A,E)}while(pd)}if(Kf.current=tp,h=Nr!==null&&Nr.next!==null,yc=0,hr=Nr=Dn=null,Zf=!1,h)throw Error(a(300));return d}function cy(){var d=md!==0;return md=0,d}function aa(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Dn.memoizedState=hr=d:hr=hr.next=d,hr}function Fs(){if(Nr===null){var d=Dn.alternate;d=d!==null?d.memoizedState:null}else d=Nr.next;var h=hr===null?Dn.memoizedState:hr.next;if(h!==null)hr=h,Nr=d;else{if(d===null)throw Error(a(310));Nr=d,d={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},hr===null?Dn.memoizedState=hr=d:hr=hr.next=d}return hr}function Jo(d,h){return typeof h=="function"?h(d):h}function qf(d){var h=Fs(),v=h.queue;if(v===null)throw Error(a(311));v.lastRenderedReducer=d;var A=Nr,E=A.baseQueue,B=v.pending;if(B!==null){if(E!==null){var ee=E.next;E.next=B.next,B.next=ee}A.baseQueue=E=B,v.pending=null}if(E!==null){B=E.next,A=A.baseState;var ue=ee=null,Ee=null,$e=B;do{var Mt=$e.lane;if((yc&Mt)===Mt)Ee!==null&&(Ee=Ee.next={lane:0,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),A=$e.hasEagerState?$e.eagerState:d(A,$e.action);else{var Ht={lane:Mt,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null};Ee===null?(ue=Ee=Ht,ee=A):Ee=Ee.next=Ht,Dn.lanes|=Mt,_c|=Mt}$e=$e.next}while($e!==null&&$e!==B);Ee===null?ee=A:Ee.next=ue,Ps(A,h.memoizedState)||(wi=!0),h.memoizedState=A,h.baseState=ee,h.baseQueue=Ee,v.lastRenderedState=A}if(d=v.interleaved,d!==null){E=d;do B=E.lane,Dn.lanes|=B,_c|=B,E=E.next;while(E!==d)}else E===null&&(v.lanes=0);return[h.memoizedState,v.dispatch]}function Qf(d){var h=Fs(),v=h.queue;if(v===null)throw Error(a(311));v.lastRenderedReducer=d;var A=v.dispatch,E=v.pending,B=h.memoizedState;if(E!==null){v.pending=null;var ee=E=E.next;do B=d(B,ee.action),ee=ee.next;while(ee!==E);Ps(B,h.memoizedState)||(wi=!0),h.memoizedState=B,h.baseQueue===null&&(h.baseState=B),v.lastRenderedState=B}return[B,A]}function PS(){}function BS(d,h){var v=Dn,A=Fs(),E=h(),B=!Ps(A.memoizedState,E);if(B&&(A.memoizedState=E,wi=!0),A=A.queue,xd(FS.bind(null,v,A,d),[d]),A.getSnapshot!==h||B||hr!==null&&hr.memoizedState.tag&1){if(v.flags|=2048,gd(9,DS.bind(null,v,A,E,h),void 0,null),Zn===null)throw Error(a(349));yc&30||LS(v,h,E)}return E}function LS(d,h,v){d.flags|=16384,d={getSnapshot:h,value:v},h=Dn.updateQueue,h===null?(h={lastEffect:null,stores:null},Dn.updateQueue=h,h.stores=[d]):(v=h.stores,v===null?h.stores=[d]:v.push(d))}function DS(d,h,v,A){h.value=v,h.getSnapshot=A,kS(h)&&Wi(d,1,-1)}function FS(d,h,v){return v(function(){kS(h)&&Wi(d,1,-1)})}function kS(d){var h=d.getSnapshot;d=d.value;try{var v=h();return!Ps(d,v)}catch{return!0}}function uy(d){var h=aa();return typeof d=="function"&&(d=d()),h.memoizedState=h.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:d},h.queue=d,d=d.dispatch=qI.bind(null,Dn,d),[h.memoizedState,d]}function gd(d,h,v,A){return d={tag:d,create:h,destroy:v,deps:A,next:null},h=Dn.updateQueue,h===null?(h={lastEffect:null,stores:null},Dn.updateQueue=h,h.lastEffect=d.next=d):(v=h.lastEffect,v===null?h.lastEffect=d.next=d:(A=v.next,v.next=d,d.next=A,h.lastEffect=d)),d}function jS(){return Fs().memoizedState}function $f(d,h,v,A){var E=aa();Dn.flags|=d,E.memoizedState=gd(1|h,v,void 0,A===void 0?null:A)}function ep(d,h,v,A){var E=Fs();A=A===void 0?null:A;var B=void 0;if(Nr!==null){var ee=Nr.memoizedState;if(B=ee.destroy,A!==null&&oy(A,ee.deps)){E.memoizedState=gd(h,v,B,A);return}}Dn.flags|=d,E.memoizedState=gd(1|h,v,B,A)}function dy(d,h){return $f(8390656,8,d,h)}function xd(d,h){return ep(2048,8,d,h)}function US(d,h){return ep(4,2,d,h)}function OS(d,h){return ep(4,4,d,h)}function zS(d,h){if(typeof h=="function")return d=d(),h(d),function(){h(null)};if(h!=null)return d=d(),h.current=d,function(){h.current=null}}function HS(d,h,v){return v=v!=null?v.concat([d]):null,ep(4,4,zS.bind(null,h,d),v)}function hy(){}function GS(d,h){var v=Fs();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&oy(h,A[1])?A[0]:(v.memoizedState=[d,h],d)}function VS(d,h){var v=Fs();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&oy(h,A[1])?A[0]:(d=d(),v.memoizedState=[d,h],d)}function KI(d,h){var v=cn;cn=v!==0&&4>v?v:4,d(!0);var A=Vi.transition;Vi.transition={};try{d(!1),h()}finally{cn=v,Vi.transition=A}}function WS(){return Fs().memoizedState}function ZI(d,h,v){var A=Oa(d);v={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null},XS(d)?JS(h,v):(YS(d,h,v),v=Wr(),d=Wi(d,A,v),d!==null&&KS(d,h,A))}function qI(d,h,v){var A=Oa(d),E={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null};if(XS(d))JS(h,E);else{YS(d,h,E);var B=d.alternate;if(d.lanes===0&&(B===null||B.lanes===0)&&(B=h.lastRenderedReducer,B!==null))try{var ee=h.lastRenderedState,ue=B(ee,v);if(E.hasEagerState=!0,E.eagerState=ue,Ps(ue,ee))return}catch{}finally{}v=Wr(),d=Wi(d,A,v),d!==null&&KS(d,h,A)}}function XS(d){var h=d.alternate;return d===Dn||h!==null&&h===Dn}function JS(d,h){pd=Zf=!0;var v=d.pending;v===null?h.next=h:(h.next=v.next,v.next=h),d.pending=h}function YS(d,h,v){Zn!==null&&d.mode&1&&!(Zt&2)?(d=h.interleaved,d===null?(v.next=v,Ls===null?Ls=[h]:Ls.push(h)):(v.next=d.next,d.next=v),h.interleaved=v):(d=h.pending,d===null?v.next=v:(v.next=d.next,d.next=v),h.pending=v)}function KS(d,h,v){if(v&4194240){var A=h.lanes;A&=d.pendingLanes,v|=A,h.lanes=v,Ox(d,v)}}var tp={readContext:Oi,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},QI={readContext:Oi,useCallback:function(d,h){return aa().memoizedState=[d,h===void 0?null:h],d},useContext:Oi,useEffect:dy,useImperativeHandle:function(d,h,v){return v=v!=null?v.concat([d]):null,$f(4194308,4,zS.bind(null,h,d),v)},useLayoutEffect:function(d,h){return $f(4194308,4,d,h)},useInsertionEffect:function(d,h){return $f(4,2,d,h)},useMemo:function(d,h){var v=aa();return h=h===void 0?null:h,d=d(),v.memoizedState=[d,h],d},useReducer:function(d,h,v){var A=aa();return h=v!==void 0?v(h):h,A.memoizedState=A.baseState=h,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:h},A.queue=d,d=d.dispatch=ZI.bind(null,Dn,d),[A.memoizedState,d]},useRef:function(d){var h=aa();return d={current:d},h.memoizedState=d},useState:uy,useDebugValue:hy,useDeferredValue:function(d){var h=uy(d),v=h[0],A=h[1];return dy(function(){var E=Vi.transition;Vi.transition={};try{A(d)}finally{Vi.transition=E}},[d]),v},useTransition:function(){var d=uy(!1),h=d[0];return d=KI.bind(null,d[1]),aa().memoizedState=d,[h,d]},useMutableSource:function(){},useSyncExternalStore:function(d,h,v){var A=Dn,E=aa();if(An){if(v===void 0)throw Error(a(407));v=v()}else{if(v=h(),Zn===null)throw Error(a(349));yc&30||LS(A,h,v)}E.memoizedState=v;var B={value:v,getSnapshot:h};return E.queue=B,dy(FS.bind(null,A,B,d),[d]),A.flags|=2048,gd(9,DS.bind(null,A,B,v,h),void 0,null),v},useId:function(){var d=aa(),h=Zn.identifierPrefix;if(An){var v=sa,A=ia;v=(A&~(1<<32-qt(A)-1)).toString(32)+v,h=":"+h+"R"+v,v=md++,0<v&&(h+="H"+v.toString(32)),h+=":"}else v=YI++,h=":"+h+"r"+v.toString(32)+":";return d.memoizedState=h},unstable_isNewReconciler:!1},$I={readContext:Oi,useCallback:GS,useContext:Oi,useEffect:xd,useImperativeHandle:HS,useInsertionEffect:US,useLayoutEffect:OS,useMemo:VS,useReducer:qf,useRef:jS,useState:function(){return qf(Jo)},useDebugValue:hy,useDeferredValue:function(d){var h=qf(Jo),v=h[0],A=h[1];return xd(function(){var E=Vi.transition;Vi.transition={};try{A(d)}finally{Vi.transition=E}},[d]),v},useTransition:function(){var d=qf(Jo)[0],h=Fs().memoizedState;return[d,h]},useMutableSource:PS,useSyncExternalStore:BS,useId:WS,unstable_isNewReconciler:!1},eP={readContext:Oi,useCallback:GS,useContext:Oi,useEffect:xd,useImperativeHandle:HS,useInsertionEffect:US,useLayoutEffect:OS,useMemo:VS,useReducer:Qf,useRef:jS,useState:function(){return Qf(Jo)},useDebugValue:hy,useDeferredValue:function(d){var h=Qf(Jo),v=h[0],A=h[1];return xd(function(){var E=Vi.transition;Vi.transition={};try{A(d)}finally{Vi.transition=E}},[d]),v},useTransition:function(){var d=Qf(Jo)[0],h=Fs().memoizedState;return[d,h]},useMutableSource:PS,useSyncExternalStore:BS,useId:WS,unstable_isNewReconciler:!1};function fy(d,h){try{var v="",A=h;do v+=JI(A),A=A.return;while(A);var E=v}catch(B){E=`
Error generating stack: `+B.message+`
`+B.stack}return{value:d,source:h,stack:E}}function py(d,h){try{console.error(h.value)}catch(v){setTimeout(function(){throw v})}}var tP=typeof WeakMap=="function"?WeakMap:Map;function ZS(d,h,v){v=ra(-1,v),v.tag=3,v.payload={element:null};var A=h.value;return v.callback=function(){xp||(xp=!0,Py=A),py(d,h)},v}function qS(d,h,v){v=ra(-1,v),v.tag=3;var A=d.type.getDerivedStateFromError;if(typeof A=="function"){var E=h.value;v.payload=function(){return A(E)},v.callback=function(){py(d,h)}}var B=d.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(v.callback=function(){py(d,h),typeof A!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var ee=h.stack;this.componentDidCatch(h.value,{componentStack:ee!==null?ee:""})}),v}function QS(d,h,v){var A=d.pingCache;if(A===null){A=d.pingCache=new tP;var E=new Set;A.set(h,E)}else E=A.get(h),E===void 0&&(E=new Set,A.set(h,E));E.has(v)||(E.add(v),d=mP.bind(null,d,h,v),h.then(d,d))}function $S(d){do{var h;if((h=d.tag===13)&&(h=d.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return d;d=d.return}while(d!==null);return null}function eA(d,h,v,A,E){return d.mode&1?(d.flags|=65536,d.lanes=E,d):(d===h?d.flags|=65536:(d.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(h=ra(-1,1),h.tag=2,ka(v,h))),v.lanes|=1),d)}function ks(d){d.flags|=4}function tA(d,h){if(d!==null&&d.child===h.child)return!0;if(h.flags&16)return!1;for(d=h.child;d!==null;){if(d.flags&12854||d.subtreeFlags&12854)return!1;d=d.sibling}return!0}var yd,vd,np,rp;if(lt)yd=function(d,h){for(var v=h.child;v!==null;){if(v.tag===5||v.tag===6)G(d,v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===h)break;for(;v.sibling===null;){if(v.return===null||v.return===h)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},vd=function(){},np=function(d,h,v,A,E){if(d=d.memoizedProps,d!==A){var B=h.stateNode,ee=Ds(Gi.current);v=Ce(B,v,d,A,E,ee),(h.updateQueue=v)&&ks(h)}},rp=function(d,h,v,A){v!==A&&ks(h)};else if(kt){yd=function(d,h,v,A){for(var E=h.child;E!==null;){if(E.tag===5){var B=E.stateNode;v&&A&&(B=Jt(B,E.type,E.memoizedProps,E)),G(d,B)}else if(E.tag===6)B=E.stateNode,v&&A&&(B=Gn(B,E.memoizedProps,E)),G(d,B);else if(E.tag!==4){if(E.tag===22&&E.memoizedState!==null)B=E.child,B!==null&&(B.return=E),yd(d,E,!0,!0);else if(E.child!==null){E.child.return=E,E=E.child;continue}}if(E===h)break;for(;E.sibling===null;){if(E.return===null||E.return===h)return;E=E.return}E.sibling.return=E.return,E=E.sibling}};var nA=function(d,h,v,A){for(var E=h.child;E!==null;){if(E.tag===5){var B=E.stateNode;v&&A&&(B=Jt(B,E.type,E.memoizedProps,E)),Ve(d,B)}else if(E.tag===6)B=E.stateNode,v&&A&&(B=Gn(B,E.memoizedProps,E)),Ve(d,B);else if(E.tag!==4){if(E.tag===22&&E.memoizedState!==null)B=E.child,B!==null&&(B.return=E),nA(d,E,!0,!0);else if(E.child!==null){E.child.return=E,E=E.child;continue}}if(E===h)break;for(;E.sibling===null;){if(E.return===null||E.return===h)return;E=E.return}E.sibling.return=E.return,E=E.sibling}};vd=function(d,h){var v=h.stateNode;if(!tA(d,h)){d=v.containerInfo;var A=Re(d);nA(A,h,!1,!1),v.pendingChildren=A,ks(h),Tt(d,A)}},np=function(d,h,v,A,E){var B=d.stateNode,ee=d.memoizedProps;if((d=tA(d,h))&&ee===A)h.stateNode=B;else{var ue=h.stateNode,Ee=Ds(Gi.current),$e=null;ee!==A&&($e=Ce(ue,v,ee,A,E,Ee)),d&&$e===null?h.stateNode=B:(B=ze(B,$e,v,ee,A,h,d,ue),de(B,v,A,E,Ee)&&ks(h),h.stateNode=B,d?ks(h):yd(B,h,!1,!1))}},rp=function(d,h,v,A){v!==A?(d=Ds(gc.current),v=Ds(Gi.current),h.stateNode=se(A,d,v,h),ks(h)):h.stateNode=d.stateNode}}else vd=function(){},np=function(){},rp=function(){};function _d(d,h){if(!An)switch(d.tailMode){case"hidden":h=d.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?d.tail=null:v.sibling=null;break;case"collapsed":v=d.tail;for(var A=null;v!==null;)v.alternate!==null&&(A=v),v=v.sibling;A===null?h||d.tail===null?d.tail=null:d.tail.sibling=null:A.sibling=null}}function Ir(d){var h=d.alternate!==null&&d.alternate.child===d.child,v=0,A=0;if(h)for(var E=d.child;E!==null;)v|=E.lanes|E.childLanes,A|=E.subtreeFlags&14680064,A|=E.flags&14680064,E.return=d,E=E.sibling;else for(E=d.child;E!==null;)v|=E.lanes|E.childLanes,A|=E.subtreeFlags,A|=E.flags,E.return=d,E=E.sibling;return d.subtreeFlags|=A,d.childLanes=v,h}function nP(d,h,v){var A=h.pendingProps;switch($x(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ir(h),null;case 1:return zt(h.type)&&Yt(),Ir(h),null;case 3:return A=h.stateNode,xc(),Ne(Xe),Ne(ht),ay(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(d===null||d.child===null)&&(ud(h)?ks(h):d===null||d.memoizedState.isDehydrated&&!(h.flags&256)||(h.flags|=1024,ds!==null&&(Dy(ds),ds=null))),vd(d,h),Ir(h),null;case 5:iy(h),v=Ds(gc.current);var E=h.type;if(d!==null&&h.stateNode!=null)np(d,h,E,A,v),d.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!A){if(h.stateNode===null)throw Error(a(166));return Ir(h),null}if(d=Ds(Gi.current),ud(h)){if(!it)throw Error(a(175));d=D(h.stateNode,h.type,h.memoizedProps,v,d,h,!cd),h.updateQueue=d,d!==null&&ks(h)}else{var B=Y(E,A,v,d,h);yd(B,h,!1,!1),h.stateNode=B,de(B,E,A,v,d)&&ks(h)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Ir(h),null;case 6:if(d&&h.stateNode!=null)rp(d,h,d.memoizedProps,A);else{if(typeof A!="string"&&h.stateNode===null)throw Error(a(166));if(d=Ds(gc.current),v=Ds(Gi.current),ud(h)){if(!it)throw Error(a(176));if(d=h.stateNode,A=h.memoizedProps,(v=V(d,A,h,!cd))&&(E=_i,E!==null))switch(B=(E.mode&1)!==0,E.tag){case 3:tt(E.stateNode.containerInfo,d,A,B);break;case 5:rt(E.type,E.memoizedProps,E.stateNode,d,A,B)}v&&ks(h)}else h.stateNode=se(A,d,v,h)}return Ir(h),null;case 13:if(Ne(Nn),A=h.memoizedState,An&&bi!==null&&h.mode&1&&!(h.flags&128)){for(d=bi;d;)d=ri(d);return pc(),h.flags|=98560,h}if(A!==null&&A.dehydrated!==null){if(A=ud(h),d===null){if(!A)throw Error(a(318));if(!it)throw Error(a(344));if(d=h.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(a(317));ae(d,h)}else pc(),!(h.flags&128)&&(h.memoizedState=null),h.flags|=4;return Ir(h),null}return ds!==null&&(Dy(ds),ds=null),h.flags&128?(h.lanes=v,h):(A=A!==null,v=!1,d===null?ud(h):v=d.memoizedState!==null,A&&!v&&(h.child.flags|=8192,h.mode&1&&(d===null||Nn.current&1?tr===0&&(tr=3):ky())),h.updateQueue!==null&&(h.flags|=4),Ir(h),null);case 4:return xc(),vd(d,h),d===null&&Be(h.stateNode.containerInfo),Ir(h),null;case 10:return Jx(h.type._context),Ir(h),null;case 17:return zt(h.type)&&Yt(),Ir(h),null;case 19:if(Ne(Nn),E=h.memoizedState,E===null)return Ir(h),null;if(A=(h.flags&128)!==0,B=E.rendering,B===null)if(A)_d(E,!1);else{if(tr!==0||d!==null&&d.flags&128)for(d=h.child;d!==null;){if(B=Yf(d),B!==null){for(h.flags|=128,_d(E,!1),d=B.updateQueue,d!==null&&(h.updateQueue=d,h.flags|=4),h.subtreeFlags=0,d=v,A=h.child;A!==null;)v=A,E=d,v.flags&=14680066,B=v.alternate,B===null?(v.childLanes=0,v.lanes=E,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=B.childLanes,v.lanes=B.lanes,v.child=B.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=B.memoizedProps,v.memoizedState=B.memoizedState,v.updateQueue=B.updateQueue,v.type=B.type,E=B.dependencies,v.dependencies=E===null?null:{lanes:E.lanes,firstContext:E.firstContext}),A=A.sibling;return De(Nn,Nn.current&1|2),h.child}d=d.sibling}E.tail!==null&&dr()>Iy&&(h.flags|=128,A=!0,_d(E,!1),h.lanes=4194304)}else{if(!A)if(d=Yf(B),d!==null){if(h.flags|=128,A=!0,d=d.updateQueue,d!==null&&(h.updateQueue=d,h.flags|=4),_d(E,!0),E.tail===null&&E.tailMode==="hidden"&&!B.alternate&&!An)return Ir(h),null}else 2*dr()-E.renderingStartTime>Iy&&v!==1073741824&&(h.flags|=128,A=!0,_d(E,!1),h.lanes=4194304);E.isBackwards?(B.sibling=h.child,h.child=B):(d=E.last,d!==null?d.sibling=B:h.child=B,E.last=B)}return E.tail!==null?(h=E.tail,E.rendering=h,E.tail=h.sibling,E.renderingStartTime=dr(),h.sibling=null,d=Nn.current,De(Nn,A?d&1|2:d&1),h):(Ir(h),null);case 22:case 23:return Fy(),A=h.memoizedState!==null,d!==null&&d.memoizedState!==null!==A&&(h.flags|=8192),A&&h.mode&1?Si&1073741824&&(Ir(h),lt&&h.subtreeFlags&6&&(h.flags|=8192)):Ir(h),null;case 24:return null;case 25:return null}throw Error(a(156,h.tag))}var rP=o.ReactCurrentOwner,wi=!1;function Vr(d,h,v,A){h.child=d===null?RS(h,null,v,A):mc(h,d.child,v,A)}function rA(d,h,v,A,E){v=v.render;var B=h.ref;return dc(h,E),A=ly(d,h,v,A,B,E),v=cy(),d!==null&&!wi?(h.updateQueue=d.updateQueue,h.flags&=-2053,d.lanes&=~E,oa(d,h,E)):(An&&v&&Qx(h),h.flags|=1,Vr(d,h,A,E),h.child)}function iA(d,h,v,A,E){if(d===null){var B=v.type;return typeof B=="function"&&!jy(B)&&B.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(h.tag=15,h.type=B,sA(d,h,B,A,E)):(d=Ap(v.type,null,A,h,h.mode,E),d.ref=h.ref,d.return=h,h.child=d)}if(B=d.child,!(d.lanes&E)){var ee=B.memoizedProps;if(v=v.compare,v=v!==null?v:Uf,v(ee,A)&&d.ref===h.ref)return oa(d,h,E)}return h.flags|=1,d=Ha(B,A),d.ref=h.ref,d.return=h,h.child=d}function sA(d,h,v,A,E){if(d!==null&&Uf(d.memoizedProps,A)&&d.ref===h.ref)if(wi=!1,(d.lanes&E)!==0)d.flags&131072&&(wi=!0);else return h.lanes=d.lanes,oa(d,h,E);return my(d,h,v,A,E)}function aA(d,h,v){var A=h.pendingProps,E=A.children,B=d!==null?d.memoizedState:null;if(A.mode==="hidden")if(!(h.mode&1))h.memoizedState={baseLanes:0,cachePool:null},De(vc,Si),Si|=v;else if(v&1073741824)h.memoizedState={baseLanes:0,cachePool:null},A=B!==null?B.baseLanes:v,De(vc,Si),Si|=A;else return d=B!==null?B.baseLanes|v:v,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:d,cachePool:null},h.updateQueue=null,De(vc,Si),Si|=d,null;else B!==null?(A=B.baseLanes|v,h.memoizedState=null):A=v,De(vc,Si),Si|=A;return Vr(d,h,E,v),h.child}function oA(d,h){var v=h.ref;(d===null&&v!==null||d!==null&&d.ref!==v)&&(h.flags|=512,h.flags|=2097152)}function my(d,h,v,A,E){var B=zt(v)?St:ht.current;return B=Ot(h,B),dc(h,E),v=ly(d,h,v,A,B,E),A=cy(),d!==null&&!wi?(h.updateQueue=d.updateQueue,h.flags&=-2053,d.lanes&=~E,oa(d,h,E)):(An&&A&&Qx(h),h.flags|=1,Vr(d,h,v,E),h.child)}function lA(d,h,v,A,E){if(zt(v)){var B=!0;Et(h)}else B=!1;if(dc(h,E),h.stateNode===null)d!==null&&(d.alternate=null,h.alternate=null,h.flags|=2),wS(h,v,A),qx(h,v,A,E),A=!0;else if(d===null){var ee=h.stateNode,ue=h.memoizedProps;ee.props=ue;var Ee=ee.context,$e=v.contextType;typeof $e=="object"&&$e!==null?$e=Oi($e):($e=zt(v)?St:ht.current,$e=Ot(h,$e));var Mt=v.getDerivedStateFromProps,Ht=typeof Mt=="function"||typeof ee.getSnapshotBeforeUpdate=="function";Ht||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(ue!==A||Ee!==$e)&&SS(h,ee,A,$e),Fa=!1;var Bt=h.memoizedState;ee.state=Bt,Gf(h,A,ee,E),Ee=h.memoizedState,ue!==A||Bt!==Ee||Xe.current||Fa?(typeof Mt=="function"&&(Zx(h,v,Mt,A),Ee=h.memoizedState),(ue=Fa||bS(h,v,ue,A,Bt,Ee,$e))?(Ht||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount()),typeof ee.componentDidMount=="function"&&(h.flags|=4194308)):(typeof ee.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=A,h.memoizedState=Ee),ee.props=A,ee.state=Ee,ee.context=$e,A=ue):(typeof ee.componentDidMount=="function"&&(h.flags|=4194308),A=!1)}else{ee=h.stateNode,xS(d,h),ue=h.memoizedProps,$e=h.type===h.elementType?ue:us(h.type,ue),ee.props=$e,Ht=h.pendingProps,Bt=ee.context,Ee=v.contextType,typeof Ee=="object"&&Ee!==null?Ee=Oi(Ee):(Ee=zt(v)?St:ht.current,Ee=Ot(h,Ee));var xn=v.getDerivedStateFromProps;(Mt=typeof xn=="function"||typeof ee.getSnapshotBeforeUpdate=="function")||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(ue!==Ht||Bt!==Ee)&&SS(h,ee,A,Ee),Fa=!1,Bt=h.memoizedState,ee.state=Bt,Gf(h,A,ee,E);var Pt=h.memoizedState;ue!==Ht||Bt!==Pt||Xe.current||Fa?(typeof xn=="function"&&(Zx(h,v,xn,A),Pt=h.memoizedState),($e=Fa||bS(h,v,$e,A,Bt,Pt,Ee)||!1)?(Mt||typeof ee.UNSAFE_componentWillUpdate!="function"&&typeof ee.componentWillUpdate!="function"||(typeof ee.componentWillUpdate=="function"&&ee.componentWillUpdate(A,Pt,Ee),typeof ee.UNSAFE_componentWillUpdate=="function"&&ee.UNSAFE_componentWillUpdate(A,Pt,Ee)),typeof ee.componentDidUpdate=="function"&&(h.flags|=4),typeof ee.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof ee.componentDidUpdate!="function"||ue===d.memoizedProps&&Bt===d.memoizedState||(h.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||ue===d.memoizedProps&&Bt===d.memoizedState||(h.flags|=1024),h.memoizedProps=A,h.memoizedState=Pt),ee.props=A,ee.state=Pt,ee.context=Ee,A=$e):(typeof ee.componentDidUpdate!="function"||ue===d.memoizedProps&&Bt===d.memoizedState||(h.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||ue===d.memoizedProps&&Bt===d.memoizedState||(h.flags|=1024),A=!1)}return gy(d,h,v,A,B,E)}function gy(d,h,v,A,E,B){oA(d,h);var ee=(h.flags&128)!==0;if(!A&&!ee)return E&&At(h,v,!1),oa(d,h,B);A=h.stateNode,rP.current=h;var ue=ee&&typeof v.getDerivedStateFromError!="function"?null:A.render();return h.flags|=1,d!==null&&ee?(h.child=mc(h,d.child,null,B),h.child=mc(h,null,ue,B)):Vr(d,h,ue,B),h.memoizedState=A.state,E&&At(h,v,!0),h.child}function cA(d){var h=d.stateNode;h.pendingContext?Nt(d,h.pendingContext,h.pendingContext!==h.context):h.context&&Nt(d,h.context,!1),ry(d,h.containerInfo)}function uA(d,h,v,A,E){return pc(),ny(E),h.flags|=256,Vr(d,h,v,A),h.child}var ip={dehydrated:null,treeContext:null,retryLane:0};function sp(d){return{baseLanes:d,cachePool:null}}function dA(d,h,v){var A=h.pendingProps,E=Nn.current,B=!1,ee=(h.flags&128)!==0,ue;if((ue=ee)||(ue=d!==null&&d.memoizedState===null?!1:(E&2)!==0),ue?(B=!0,h.flags&=-129):(d===null||d.memoizedState!==null)&&(E|=1),De(Nn,E&1),d===null)return ty(h),d=h.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?(h.mode&1?Vo(d)?h.lanes=8:h.lanes=1073741824:h.lanes=1,null):(E=A.children,d=A.fallback,B?(A=h.mode,B=h.child,E={mode:"hidden",children:E},!(A&1)&&B!==null?(B.childLanes=0,B.pendingProps=E):B=Mp(E,A,0,null),d=$o(d,A,v,null),B.return=h,d.return=h,B.sibling=d,h.child=B,h.child.memoizedState=sp(v),h.memoizedState=ip,d):xy(h,E));if(E=d.memoizedState,E!==null){if(ue=E.dehydrated,ue!==null){if(ee)return h.flags&256?(h.flags&=-257,ap(d,h,v,Error(a(422)))):h.memoizedState!==null?(h.child=d.child,h.flags|=128,null):(B=A.fallback,E=h.mode,A=Mp({mode:"visible",children:A.children},E,0,null),B=$o(B,E,v,null),B.flags|=2,A.return=h,B.return=h,A.sibling=B,h.child=A,h.mode&1&&mc(h,d.child,null,v),h.child.memoizedState=sp(v),h.memoizedState=ip,B);if(!(h.mode&1))h=ap(d,h,v,null);else if(Vo(ue))h=ap(d,h,v,Error(a(419)));else if(A=(v&d.childLanes)!==0,wi||A){if(A=Zn,A!==null){switch(v&-v){case 4:B=2;break;case 16:B=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:B=32;break;case 536870912:B=268435456;break;default:B=0}A=B&(A.suspendedLanes|v)?0:B,A!==0&&A!==E.retryLane&&(E.retryLane=A,Wi(d,A,-1))}ky(),h=ap(d,h,v,Error(a(421)))}else ls(ue)?(h.flags|=128,h.child=d.child,h=gP.bind(null,d),Rs(ue,h),h=null):(v=E.treeContext,it&&(bi=cc(ue),_i=h,An=!0,ds=null,cd=!1,v!==null&&(zi[Hi++]=ia,zi[Hi++]=sa,zi[Hi++]=Wo,ia=v.id,sa=v.overflow,Wo=h)),h=xy(h,h.pendingProps.children),h.flags|=4096);return h}return B?(A=fA(d,h,A.children,A.fallback,v),B=h.child,E=d.child.memoizedState,B.memoizedState=E===null?sp(v):{baseLanes:E.baseLanes|v,cachePool:null},B.childLanes=d.childLanes&~v,h.memoizedState=ip,A):(v=hA(d,h,A.children,v),h.memoizedState=null,v)}return B?(A=fA(d,h,A.children,A.fallback,v),B=h.child,E=d.child.memoizedState,B.memoizedState=E===null?sp(v):{baseLanes:E.baseLanes|v,cachePool:null},B.childLanes=d.childLanes&~v,h.memoizedState=ip,A):(v=hA(d,h,A.children,v),h.memoizedState=null,v)}function xy(d,h){return h=Mp({mode:"visible",children:h},d.mode,0,null),h.return=d,d.child=h}function hA(d,h,v,A){var E=d.child;return d=E.sibling,v=Ha(E,{mode:"visible",children:v}),!(h.mode&1)&&(v.lanes=A),v.return=h,v.sibling=null,d!==null&&(A=h.deletions,A===null?(h.deletions=[d],h.flags|=16):A.push(d)),h.child=v}function fA(d,h,v,A,E){var B=h.mode;d=d.child;var ee=d.sibling,ue={mode:"hidden",children:v};return!(B&1)&&h.child!==d?(v=h.child,v.childLanes=0,v.pendingProps=ue,h.deletions=null):(v=Ha(d,ue),v.subtreeFlags=d.subtreeFlags&14680064),ee!==null?A=Ha(ee,A):(A=$o(A,B,E,null),A.flags|=2),A.return=h,v.return=h,v.sibling=A,h.child=v,A}function ap(d,h,v,A){return A!==null&&ny(A),mc(h,d.child,null,v),d=xy(h,h.pendingProps.children),d.flags|=2,h.memoizedState=null,d}function pA(d,h,v){d.lanes|=h;var A=d.alternate;A!==null&&(A.lanes|=h),Yx(d.return,h,v)}function yy(d,h,v,A,E){var B=d.memoizedState;B===null?d.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:A,tail:v,tailMode:E}:(B.isBackwards=h,B.rendering=null,B.renderingStartTime=0,B.last=A,B.tail=v,B.tailMode=E)}function mA(d,h,v){var A=h.pendingProps,E=A.revealOrder,B=A.tail;if(Vr(d,h,A.children,v),A=Nn.current,A&2)A=A&1|2,h.flags|=128;else{if(d!==null&&d.flags&128)e:for(d=h.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&pA(d,v,h);else if(d.tag===19)pA(d,v,h);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===h)break e;for(;d.sibling===null;){if(d.return===null||d.return===h)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}A&=1}if(De(Nn,A),!(h.mode&1))h.memoizedState=null;else switch(E){case"forwards":for(v=h.child,E=null;v!==null;)d=v.alternate,d!==null&&Yf(d)===null&&(E=v),v=v.sibling;v=E,v===null?(E=h.child,h.child=null):(E=v.sibling,v.sibling=null),yy(h,!1,E,v,B);break;case"backwards":for(v=null,E=h.child,h.child=null;E!==null;){if(d=E.alternate,d!==null&&Yf(d)===null){h.child=E;break}d=E.sibling,E.sibling=v,v=E,E=d}yy(h,!0,v,null,B);break;case"together":yy(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function oa(d,h,v){if(d!==null&&(h.dependencies=d.dependencies),_c|=h.lanes,!(v&h.childLanes))return null;if(d!==null&&h.child!==d.child)throw Error(a(153));if(h.child!==null){for(d=h.child,v=Ha(d,d.pendingProps),h.child=v,v.return=h;d.sibling!==null;)d=d.sibling,v=v.sibling=Ha(d,d.pendingProps),v.return=h;v.sibling=null}return h.child}function iP(d,h,v){switch(h.tag){case 3:cA(h),pc();break;case 5:IS(h);break;case 1:zt(h.type)&&Et(h);break;case 4:ry(h,h.stateNode.containerInfo);break;case 10:gS(h,h.type._context,h.memoizedProps.value);break;case 13:var A=h.memoizedState;if(A!==null)return A.dehydrated!==null?(De(Nn,Nn.current&1),h.flags|=128,null):v&h.child.childLanes?dA(d,h,v):(De(Nn,Nn.current&1),d=oa(d,h,v),d!==null?d.sibling:null);De(Nn,Nn.current&1);break;case 19:if(A=(v&h.childLanes)!==0,d.flags&128){if(A)return mA(d,h,v);h.flags|=128}var E=h.memoizedState;if(E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),De(Nn,Nn.current),A)break;return null;case 22:case 23:return h.lanes=0,aA(d,h,v)}return oa(d,h,v)}function sP(d,h){switch($x(h),h.tag){case 1:return zt(h.type)&&Yt(),d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 3:return xc(),Ne(Xe),Ne(ht),ay(),d=h.flags,d&65536&&!(d&128)?(h.flags=d&-65537|128,h):null;case 5:return iy(h),null;case 13:if(Ne(Nn),d=h.memoizedState,d!==null&&d.dehydrated!==null){if(h.alternate===null)throw Error(a(340));pc()}return d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 19:return Ne(Nn),null;case 4:return xc(),null;case 10:return Jx(h.type._context),null;case 22:case 23:return Fy(),null;case 24:return null;default:return null}}var op=!1,Yo=!1,aP=typeof WeakSet=="function"?WeakSet:Set,pt=null;function lp(d,h){var v=d.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(A){ai(d,h,A)}else v.current=null}function vy(d,h,v){try{v()}catch(A){ai(d,h,A)}}var gA=!1;function oP(d,h){for(H(d.containerInfo),pt=h;pt!==null;)if(d=pt,h=d.child,(d.subtreeFlags&1028)!==0&&h!==null)h.return=d,pt=h;else for(;pt!==null;){d=pt;try{var v=d.alternate;if(d.flags&1024)switch(d.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var A=v.memoizedProps,E=v.memoizedState,B=d.stateNode,ee=B.getSnapshotBeforeUpdate(d.elementType===d.type?A:us(d.type,A),E);B.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:lt&&at(d.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(ue){ai(d,d.return,ue)}if(h=d.sibling,h!==null){h.return=d.return,pt=h;break}pt=d.return}return v=gA,gA=!1,v}function Ko(d,h,v){var A=h.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var E=A=A.next;do{if((E.tag&d)===d){var B=E.destroy;E.destroy=void 0,B!==void 0&&vy(h,v,B)}E=E.next}while(E!==A)}}function bd(d,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var v=h=h.next;do{if((v.tag&d)===d){var A=v.create;v.destroy=A()}v=v.next}while(v!==h)}}function _y(d){var h=d.ref;if(h!==null){var v=d.stateNode;switch(d.tag){case 5:d=K(v);break;default:d=v}typeof h=="function"?h(d):h.current=d}}function xA(d,h,v){if(Is&&typeof Is.onCommitFiberUnmount=="function")try{Is.onCommitFiberUnmount(kf,h)}catch{}switch(h.tag){case 0:case 11:case 14:case 15:if(d=h.updateQueue,d!==null&&(d=d.lastEffect,d!==null)){var A=d=d.next;do{var E=A,B=E.destroy;E=E.tag,B!==void 0&&(E&2||E&4)&&vy(h,v,B),A=A.next}while(A!==d)}break;case 1:if(lp(h,v),d=h.stateNode,typeof d.componentWillUnmount=="function")try{d.props=h.memoizedProps,d.state=h.memoizedState,d.componentWillUnmount()}catch(ee){ai(h,v,ee)}break;case 5:lp(h,v);break;case 4:lt?SA(d,h,v):kt&&kt&&(h=h.stateNode.containerInfo,v=Re(h),Qt(h,v))}}function yA(d,h,v){for(var A=h;;)if(xA(d,A,v),A.child===null||lt&&A.tag===4){if(A===h)break;for(;A.sibling===null;){if(A.return===null||A.return===h)return;A=A.return}A.sibling.return=A.return,A=A.sibling}else A.child.return=A,A=A.child}function vA(d){var h=d.alternate;h!==null&&(d.alternate=null,vA(h)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(h=d.stateNode,h!==null&&Ye(h)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function _A(d){return d.tag===5||d.tag===3||d.tag===4}function bA(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||_A(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function wA(d){if(lt){e:{for(var h=d.return;h!==null;){if(_A(h))break e;h=h.return}throw Error(a(160))}var v=h;switch(v.tag){case 5:h=v.stateNode,v.flags&32&&(fe(h),v.flags&=-33),v=bA(d),wy(d,v,h);break;case 3:case 4:h=v.stateNode.containerInfo,v=bA(d),by(d,v,h);break;default:throw Error(a(161))}}}function by(d,h,v){var A=d.tag;if(A===5||A===6)d=d.stateNode,h?He(v,d,h):st(v,d);else if(A!==4&&(d=d.child,d!==null))for(by(d,h,v),d=d.sibling;d!==null;)by(d,h,v),d=d.sibling}function wy(d,h,v){var A=d.tag;if(A===5||A===6)d=d.stateNode,h?Fe(v,d,h):ge(v,d);else if(A!==4&&(d=d.child,d!==null))for(wy(d,h,v),d=d.sibling;d!==null;)wy(d,h,v),d=d.sibling}function SA(d,h,v){for(var A=h,E=!1,B,ee;;){if(!E){E=A.return;e:for(;;){if(E===null)throw Error(a(160));switch(B=E.stateNode,E.tag){case 5:ee=!1;break e;case 3:B=B.containerInfo,ee=!0;break e;case 4:B=B.containerInfo,ee=!0;break e}E=E.return}E=!0}if(A.tag===5||A.tag===6)yA(d,A,v),ee?re(B,A.stateNode):xt(B,A.stateNode);else if(A.tag===18)ee?Oe(B,A.stateNode):Ze(B,A.stateNode);else if(A.tag===4){if(A.child!==null){B=A.stateNode.containerInfo,ee=!0,A.child.return=A,A=A.child;continue}}else if(xA(d,A,v),A.child!==null){A.child.return=A,A=A.child;continue}if(A===h)break;for(;A.sibling===null;){if(A.return===null||A.return===h)return;A=A.return,A.tag===4&&(E=!1)}A.sibling.return=A.return,A=A.sibling}}function Sy(d,h){if(lt){switch(h.tag){case 0:case 11:case 14:case 15:Ko(3,h,h.return),bd(3,h),Ko(5,h,h.return);return;case 1:return;case 5:var v=h.stateNode;if(v!=null){var A=h.memoizedProps;d=d!==null?d.memoizedProps:A;var E=h.type,B=h.updateQueue;h.updateQueue=null,B!==null&&_t(v,B,E,d,A,h)}return;case 6:if(h.stateNode===null)throw Error(a(162));v=h.memoizedProps,Ke(h.stateNode,d!==null?d.memoizedProps:v,v);return;case 3:it&&d!==null&&d.memoizedState.isDehydrated&&Se(h.stateNode.containerInfo);return;case 12:return;case 13:cp(h);return;case 19:cp(h);return;case 17:return}throw Error(a(163))}switch(h.tag){case 0:case 11:case 14:case 15:Ko(3,h,h.return),bd(3,h),Ko(5,h,h.return);return;case 12:return;case 13:cp(h);return;case 19:cp(h);return;case 3:it&&d!==null&&d.memoizedState.isDehydrated&&Se(h.stateNode.containerInfo);break;case 22:case 23:return}e:if(kt){switch(h.tag){case 1:case 5:case 6:break e;case 3:case 4:h=h.stateNode,Qt(h.containerInfo,h.pendingChildren);break e}throw Error(a(163))}}function cp(d){var h=d.updateQueue;if(h!==null){d.updateQueue=null;var v=d.stateNode;v===null&&(v=d.stateNode=new aP),h.forEach(function(A){var E=xP.bind(null,d,A);v.has(A)||(v.add(A),A.then(E,E))})}}function lP(d,h){for(pt=h;pt!==null;){h=pt;var v=h.deletions;if(v!==null)for(var A=0;A<v.length;A++){var E=v[A];try{var B=d;lt?SA(B,E,h):yA(B,E,h);var ee=E.alternate;ee!==null&&(ee.return=null),E.return=null}catch(Rt){ai(E,h,Rt)}}if(v=h.child,h.subtreeFlags&12854&&v!==null)v.return=h,pt=v;else for(;pt!==null;){h=pt;try{var ue=h.flags;if(ue&32&&lt&&fe(h.stateNode),ue&512){var Ee=h.alternate;if(Ee!==null){var $e=Ee.ref;$e!==null&&(typeof $e=="function"?$e(null):$e.current=null)}}if(ue&8192)switch(h.tag){case 13:if(h.memoizedState!==null){var Mt=h.alternate;(Mt===null||Mt.memoizedState===null)&&(Ry=dr())}break;case 22:var Ht=h.memoizedState!==null,Bt=h.alternate,xn=Bt!==null&&Bt.memoizedState!==null;if(v=h,lt){e:if(A=v,E=Ht,B=null,lt)for(var Pt=A;;){if(Pt.tag===5){if(B===null){B=Pt;var Pr=Pt.stateNode;E?ke(Pr):me(Pt.stateNode,Pt.memoizedProps)}}else if(Pt.tag===6){if(B===null){var Ji=Pt.stateNode;E?ie(Ji):je(Ji,Pt.memoizedProps)}}else if((Pt.tag!==22&&Pt.tag!==23||Pt.memoizedState===null||Pt===A)&&Pt.child!==null){Pt.child.return=Pt,Pt=Pt.child;continue}if(Pt===A)break;for(;Pt.sibling===null;){if(Pt.return===null||Pt.return===A)break e;B===Pt&&(B=null),Pt=Pt.return}B===Pt&&(B=null),Pt.sibling.return=Pt.return,Pt=Pt.sibling}}if(Ht&&!xn&&v.mode&1){pt=v;for(var ye=v.child;ye!==null;){for(v=pt=ye;pt!==null;){A=pt;var he=A.child;switch(A.tag){case 0:case 11:case 14:case 15:Ko(4,A,A.return);break;case 1:lp(A,A.return);var we=A.stateNode;if(typeof we.componentWillUnmount=="function"){var gt=A.return;try{we.props=A.memoizedProps,we.state=A.memoizedState,we.componentWillUnmount()}catch(Rt){ai(A,gt,Rt)}}break;case 5:lp(A,A.return);break;case 22:if(A.memoizedState!==null){CA(v);continue}}he!==null?(he.return=A,pt=he):CA(v)}ye=ye.sibling}}}switch(ue&4102){case 2:wA(h),h.flags&=-3;break;case 6:wA(h),h.flags&=-3,Sy(h.alternate,h);break;case 4096:h.flags&=-4097;break;case 4100:h.flags&=-4097,Sy(h.alternate,h);break;case 4:Sy(h.alternate,h)}}catch(Rt){ai(h,h.return,Rt)}if(v=h.sibling,v!==null){v.return=h.return,pt=v;break}pt=h.return}}}function cP(d,h,v){pt=d,AA(d)}function AA(d,h,v){for(var A=(d.mode&1)!==0;pt!==null;){var E=pt,B=E.child;if(E.tag===22&&A){var ee=E.memoizedState!==null||op;if(!ee){var ue=E.alternate,Ee=ue!==null&&ue.memoizedState!==null||Yo;ue=op;var $e=Yo;if(op=ee,(Yo=Ee)&&!$e)for(pt=E;pt!==null;)ee=pt,Ee=ee.child,ee.tag===22&&ee.memoizedState!==null?EA(E):Ee!==null?(Ee.return=ee,pt=Ee):EA(E);for(;B!==null;)pt=B,AA(B),B=B.sibling;pt=E,op=ue,Yo=$e}MA(d)}else E.subtreeFlags&8772&&B!==null?(B.return=E,pt=B):MA(d)}}function MA(d){for(;pt!==null;){var h=pt;if(h.flags&8772){var v=h.alternate;try{if(h.flags&8772)switch(h.tag){case 0:case 11:case 15:Yo||bd(5,h);break;case 1:var A=h.stateNode;if(h.flags&4&&!Yo)if(v===null)A.componentDidMount();else{var E=h.elementType===h.type?v.memoizedProps:us(h.type,v.memoizedProps);A.componentDidUpdate(E,v.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var B=h.updateQueue;B!==null&&vS(h,B,A);break;case 3:var ee=h.updateQueue;if(ee!==null){if(v=null,h.child!==null)switch(h.child.tag){case 5:v=K(h.child.stateNode);break;case 1:v=h.child.stateNode}vS(h,ee,v)}break;case 5:var ue=h.stateNode;v===null&&h.flags&4&&dt(ue,h.type,h.memoizedProps,h);break;case 6:break;case 4:break;case 12:break;case 13:if(it&&h.memoizedState===null){var Ee=h.alternate;if(Ee!==null){var $e=Ee.memoizedState;if($e!==null){var Mt=$e.dehydrated;Mt!==null&&Ae(Mt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(a(163))}Yo||h.flags&512&&_y(h)}catch(Ht){ai(h,h.return,Ht)}}if(h===d){pt=null;break}if(v=h.sibling,v!==null){v.return=h.return,pt=v;break}pt=h.return}}function CA(d){for(;pt!==null;){var h=pt;if(h===d){pt=null;break}var v=h.sibling;if(v!==null){v.return=h.return,pt=v;break}pt=h.return}}function EA(d){for(;pt!==null;){var h=pt;try{switch(h.tag){case 0:case 11:case 15:var v=h.return;try{bd(4,h)}catch(Ee){ai(h,v,Ee)}break;case 1:var A=h.stateNode;if(typeof A.componentDidMount=="function"){var E=h.return;try{A.componentDidMount()}catch(Ee){ai(h,E,Ee)}}var B=h.return;try{_y(h)}catch(Ee){ai(h,B,Ee)}break;case 5:var ee=h.return;try{_y(h)}catch(Ee){ai(h,ee,Ee)}}}catch(Ee){ai(h,h.return,Ee)}if(h===d){pt=null;break}var ue=h.sibling;if(ue!==null){ue.return=h.return,pt=ue;break}pt=h.return}}var up=0,dp=1,hp=2,fp=3,pp=4;if(typeof Symbol=="function"&&Symbol.for){var wd=Symbol.for;up=wd("selector.component"),dp=wd("selector.has_pseudo_class"),hp=wd("selector.role"),fp=wd("selector.test_id"),pp=wd("selector.text")}function Ay(d){var h=Me(d);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(a(364));return h}if(d=Ct(d),d===null)throw Error(a(362));return d.stateNode.current}function My(d,h){switch(h.$$typeof){case up:if(d.type===h.value)return!0;break;case dp:e:{h=h.value,d=[d,0];for(var v=0;v<d.length;){var A=d[v++],E=d[v++],B=h[E];if(A.tag!==5||!L(A)){for(;B!=null&&My(A,B);)E++,B=h[E];if(E===h.length){h=!0;break e}else for(A=A.child;A!==null;)d.push(A,E),A=A.sibling}}h=!1}return h;case hp:if(d.tag===5&&q(d.stateNode,h.value))return!0;break;case pp:if((d.tag===5||d.tag===6)&&(d=J(d),d!==null&&0<=d.indexOf(h.value)))return!0;break;case fp:if(d.tag===5&&(d=d.memoizedProps["data-testname"],typeof d=="string"&&d.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Cy(d){switch(d.$$typeof){case up:return"<"+(I(d.value)||"Unknown")+">";case dp:return":has("+(Cy(d)||"")+")";case hp:return'[role="'+d.value+'"]';case pp:return'"'+d.value+'"';case fp:return'[data-testname="'+d.value+'"]';default:throw Error(a(365))}}function TA(d,h){var v=[];d=[d,0];for(var A=0;A<d.length;){var E=d[A++],B=d[A++],ee=h[B];if(E.tag!==5||!L(E)){for(;ee!=null&&My(E,ee);)B++,ee=h[B];if(B===h.length)v.push(E);else for(E=E.child;E!==null;)d.push(E,B),E=E.sibling}}return v}function Ey(d,h){if(!et)throw Error(a(363));d=Ay(d),d=TA(d,h),h=[],d=Array.from(d);for(var v=0;v<d.length;){var A=d[v++];if(A.tag===5)L(A)||h.push(A.stateNode);else for(A=A.child;A!==null;)d.push(A),A=A.sibling}return h}var uP=Math.ceil,mp=o.ReactCurrentDispatcher,Ty=o.ReactCurrentOwner,Vn=o.ReactCurrentBatchConfig,Zt=0,Zn=null,qn=null,_r=0,Si=0,vc=Ue(0),tr=0,Sd=null,_c=0,gp=0,Ny=0,Ad=null,ii=null,Ry=0,Iy=1/0;function bc(){Iy=dr()+500}var xp=!1,Py=null,ja=null,yp=!1,Ua=null,vp=0,Md=0,By=null,_p=-1,bp=0;function Wr(){return Zt&6?dr():_p!==-1?_p:_p=dr()}function Oa(d){return d.mode&1?Zt&2&&_r!==0?_r&-_r:XI.transition!==null?(bp===0&&(d=hn,hn<<=1,!(hn&4194240)&&(hn=64),bp=d),bp):(d=cn,d!==0?d:Ie()):1}function Wi(d,h,v){if(50<Md)throw Md=0,By=null,Error(a(185));var A=wp(d,h);return A===null?null:(ld(A,h,v),(!(Zt&2)||A!==Zn)&&(A===Zn&&(!(Zt&2)&&(gp|=h),tr===4&&za(A,_r)),si(A,v),h===1&&Zt===0&&!(d.mode&1)&&(bc(),jf&&Bs())),A)}function wp(d,h){d.lanes|=h;var v=d.alternate;for(v!==null&&(v.lanes|=h),v=d,d=d.return;d!==null;)d.childLanes|=h,v=d.alternate,v!==null&&(v.childLanes|=h),v=d,d=d.return;return v.tag===3?v.stateNode:null}function si(d,h){var v=d.callbackNode;od(d,h);var A=Kn(d,d===Zn?_r:0);if(A===0)v!==null&&pS(v),d.callbackNode=null,d.callbackPriority=0;else if(h=A&-A,d.callbackPriority!==h){if(v!=null&&pS(v),h===1)d.tag===0?WI(RA.bind(null,d)):mS(RA.bind(null,d)),Q?vt(function(){Zt===0&&Bs()}):zx(Hx,Bs),v=null;else{switch(fS(A)){case 1:v=Hx;break;case 4:v=zI;break;case 16:v=Gx;break;case 536870912:v=HI;break;default:v=Gx}v=UA(v,NA.bind(null,d))}d.callbackPriority=h,d.callbackNode=v}}function NA(d,h){if(_p=-1,bp=0,Zt&6)throw Error(a(327));var v=d.callbackNode;if(Qo()&&d.callbackNode!==v)return null;var A=Kn(d,d===Zn?_r:0);if(A===0)return null;if(A&30||A&d.expiredLanes||h)h=Sp(d,A);else{h=A;var E=Zt;Zt|=2;var B=BA();(Zn!==d||_r!==h)&&(bc(),Zo(d,h));do try{fP();break}catch(ue){PA(d,ue)}while(!0);Xx(),mp.current=B,Zt=E,qn!==null?h=0:(Zn=null,_r=0,h=tr)}if(h!==0){if(h===2&&(E=cs(d),E!==0&&(A=E,h=Ly(d,E))),h===1)throw v=Sd,Zo(d,0),za(d,A),si(d,dr()),v;if(h===6)za(d,A);else{if(E=d.current.alternate,!(A&30)&&!dP(E)&&(h=Sp(d,A),h===2&&(B=cs(d),B!==0&&(A=B,h=Ly(d,B))),h===1))throw v=Sd,Zo(d,0),za(d,A),si(d,dr()),v;switch(d.finishedWork=E,d.finishedLanes=A,h){case 0:case 1:throw Error(a(345));case 2:qo(d,ii);break;case 3:if(za(d,A),(A&130023424)===A&&(h=Ry+500-dr(),10<h)){if(Kn(d,0)!==0)break;if(E=d.suspendedLanes,(E&A)!==A){Wr(),d.pingedLanes|=d.suspendedLanes&E;break}d.timeoutHandle=_e(qo.bind(null,d,ii),h);break}qo(d,ii);break;case 4:if(za(d,A),(A&4194240)===A)break;for(h=d.eventTimes,E=-1;0<A;){var ee=31-qt(A);B=1<<ee,ee=h[ee],ee>E&&(E=ee),A&=~B}if(A=E,A=dr()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*uP(A/1960))-A,10<A){d.timeoutHandle=_e(qo.bind(null,d,ii),A);break}qo(d,ii);break;case 5:qo(d,ii);break;default:throw Error(a(329))}}}return si(d,dr()),d.callbackNode===v?NA.bind(null,d):null}function Ly(d,h){var v=Ad;return d.current.memoizedState.isDehydrated&&(Zo(d,h).flags|=256),d=Sp(d,h),d!==2&&(h=ii,ii=v,h!==null&&Dy(h)),d}function Dy(d){ii===null?ii=d:ii.push.apply(ii,d)}function dP(d){for(var h=d;;){if(h.flags&16384){var v=h.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var A=0;A<v.length;A++){var E=v[A],B=E.getSnapshot;E=E.value;try{if(!Ps(B(),E))return!1}catch{return!1}}}if(v=h.child,h.subtreeFlags&16384&&v!==null)v.return=h,h=v;else{if(h===d)break;for(;h.sibling===null;){if(h.return===null||h.return===d)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function za(d,h){for(h&=~Ny,h&=~gp,d.suspendedLanes|=h,d.pingedLanes&=~h,d=d.expirationTimes;0<h;){var v=31-qt(h),A=1<<v;d[v]=-1,h&=~A}}function RA(d){if(Zt&6)throw Error(a(327));Qo();var h=Kn(d,0);if(!(h&1))return si(d,dr()),null;var v=Sp(d,h);if(d.tag!==0&&v===2){var A=cs(d);A!==0&&(h=A,v=Ly(d,A))}if(v===1)throw v=Sd,Zo(d,0),za(d,h),si(d,dr()),v;if(v===6)throw Error(a(345));return d.finishedWork=d.current.alternate,d.finishedLanes=h,qo(d,ii),si(d,dr()),null}function IA(d){Ua!==null&&Ua.tag===0&&!(Zt&6)&&Qo();var h=Zt;Zt|=1;var v=Vn.transition,A=cn;try{if(Vn.transition=null,cn=1,d)return d()}finally{cn=A,Vn.transition=v,Zt=h,!(Zt&6)&&Bs()}}function Fy(){Si=vc.current,Ne(vc)}function Zo(d,h){d.finishedWork=null,d.finishedLanes=0;var v=d.timeoutHandle;if(v!==yt&&(d.timeoutHandle=yt,Le(v)),qn!==null)for(v=qn.return;v!==null;){var A=v;switch($x(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Yt();break;case 3:xc(),Ne(Xe),Ne(ht),ay();break;case 5:iy(A);break;case 4:xc();break;case 13:Ne(Nn);break;case 19:Ne(Nn);break;case 10:Jx(A.type._context);break;case 22:case 23:Fy()}v=v.return}if(Zn=d,qn=d=Ha(d.current,null),_r=Si=h,tr=0,Sd=null,Ny=gp=_c=0,ii=Ad=null,Ls!==null){for(h=0;h<Ls.length;h++)if(v=Ls[h],A=v.interleaved,A!==null){v.interleaved=null;var E=A.next,B=v.pending;if(B!==null){var ee=B.next;B.next=E,A.next=ee}v.pending=A}Ls=null}return d}function PA(d,h){do{var v=qn;try{if(Xx(),Kf.current=tp,Zf){for(var A=Dn.memoizedState;A!==null;){var E=A.queue;E!==null&&(E.pending=null),A=A.next}Zf=!1}if(yc=0,hr=Nr=Dn=null,pd=!1,md=0,Ty.current=null,v===null||v.return===null){tr=1,Sd=h,qn=null;break}e:{var B=d,ee=v.return,ue=v,Ee=h;if(h=_r,ue.flags|=32768,Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var $e=Ee,Mt=ue,Ht=Mt.tag;if(!(Mt.mode&1)&&(Ht===0||Ht===11||Ht===15)){var Bt=Mt.alternate;Bt?(Mt.updateQueue=Bt.updateQueue,Mt.memoizedState=Bt.memoizedState,Mt.lanes=Bt.lanes):(Mt.updateQueue=null,Mt.memoizedState=null)}var xn=$S(ee);if(xn!==null){xn.flags&=-257,eA(xn,ee,ue,B,h),xn.mode&1&&QS(B,$e,h),h=xn,Ee=$e;var Pt=h.updateQueue;if(Pt===null){var Pr=new Set;Pr.add(Ee),h.updateQueue=Pr}else Pt.add(Ee);break e}else{if(!(h&1)){QS(B,$e,h),ky();break e}Ee=Error(a(426))}}else if(An&&ue.mode&1){var Ji=$S(ee);if(Ji!==null){!(Ji.flags&65536)&&(Ji.flags|=256),eA(Ji,ee,ue,B,h),ny(Ee);break e}}B=Ee,tr!==4&&(tr=2),Ad===null?Ad=[B]:Ad.push(B),Ee=fy(Ee,ue),ue=ee;do{switch(ue.tag){case 3:ue.flags|=65536,h&=-h,ue.lanes|=h;var ye=ZS(ue,Ee,h);yS(ue,ye);break e;case 1:B=Ee;var he=ue.type,we=ue.stateNode;if(!(ue.flags&128)&&(typeof he.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(ja===null||!ja.has(we)))){ue.flags|=65536,h&=-h,ue.lanes|=h;var gt=qS(ue,B,h);yS(ue,gt);break e}}ue=ue.return}while(ue!==null)}DA(v)}catch(Rt){h=Rt,qn===v&&v!==null&&(qn=v=v.return);continue}break}while(!0)}function BA(){var d=mp.current;return mp.current=tp,d===null?tp:d}function ky(){(tr===0||tr===3||tr===2)&&(tr=4),Zn===null||!(_c&268435455)&&!(gp&268435455)||za(Zn,_r)}function Sp(d,h){var v=Zt;Zt|=2;var A=BA();Zn===d&&_r===h||Zo(d,h);do try{hP();break}catch(E){PA(d,E)}while(!0);if(Xx(),Zt=v,mp.current=A,qn!==null)throw Error(a(261));return Zn=null,_r=0,tr}function hP(){for(;qn!==null;)LA(qn)}function fP(){for(;qn!==null&&!UI();)LA(qn)}function LA(d){var h=jA(d.alternate,d,Si);d.memoizedProps=d.pendingProps,h===null?DA(d):qn=h,Ty.current=null}function DA(d){var h=d;do{var v=h.alternate;if(d=h.return,h.flags&32768){if(v=sP(v,h),v!==null){v.flags&=32767,qn=v;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{tr=6,qn=null;return}}else if(v=nP(v,h,Si),v!==null){qn=v;return}if(h=h.sibling,h!==null){qn=h;return}qn=h=d}while(h!==null);tr===0&&(tr=5)}function qo(d,h){var v=cn,A=Vn.transition;try{Vn.transition=null,cn=1,pP(d,h,v)}finally{Vn.transition=A,cn=v}return null}function pP(d,h,v){do Qo();while(Ua!==null);if(Zt&6)throw Error(a(327));var A=d.finishedWork,E=d.finishedLanes;if(A===null)return null;if(d.finishedWork=null,d.finishedLanes=0,A===d.current)throw Error(a(177));d.callbackNode=null,d.callbackPriority=0;var B=A.lanes|A.childLanes;if(jI(d,B),d===Zn&&(qn=Zn=null,_r=0),!(A.subtreeFlags&2064)&&!(A.flags&2064)||yp||(yp=!0,UA(Gx,function(){return Qo(),null})),B=(A.flags&15990)!==0,A.subtreeFlags&15990||B){B=Vn.transition,Vn.transition=null;var ee=cn;cn=1;var ue=Zt;Zt|=4,Ty.current=null,oP(d,A),lP(d,A),W(d.containerInfo),d.current=A,cP(A),OI(),Zt=ue,cn=ee,Vn.transition=B}else d.current=A;if(yp&&(yp=!1,Ua=d,vp=E),B=d.pendingLanes,B===0&&(ja=null),GI(A.stateNode),si(d,dr()),h!==null)for(v=d.onRecoverableError,A=0;A<h.length;A++)v(h[A]);if(xp)throw xp=!1,d=Py,Py=null,d;return vp&1&&d.tag!==0&&Qo(),B=d.pendingLanes,B&1?d===By?Md++:(Md=0,By=d):Md=0,Bs(),null}function Qo(){if(Ua!==null){var d=fS(vp),h=Vn.transition,v=cn;try{if(Vn.transition=null,cn=16>d?16:d,Ua===null)var A=!1;else{if(d=Ua,Ua=null,vp=0,Zt&6)throw Error(a(331));var E=Zt;for(Zt|=4,pt=d.current;pt!==null;){var B=pt,ee=B.child;if(pt.flags&16){var ue=B.deletions;if(ue!==null){for(var Ee=0;Ee<ue.length;Ee++){var $e=ue[Ee];for(pt=$e;pt!==null;){var Mt=pt;switch(Mt.tag){case 0:case 11:case 15:Ko(8,Mt,B)}var Ht=Mt.child;if(Ht!==null)Ht.return=Mt,pt=Ht;else for(;pt!==null;){Mt=pt;var Bt=Mt.sibling,xn=Mt.return;if(vA(Mt),Mt===$e){pt=null;break}if(Bt!==null){Bt.return=xn,pt=Bt;break}pt=xn}}}var Pt=B.alternate;if(Pt!==null){var Pr=Pt.child;if(Pr!==null){Pt.child=null;do{var Ji=Pr.sibling;Pr.sibling=null,Pr=Ji}while(Pr!==null)}}pt=B}}if(B.subtreeFlags&2064&&ee!==null)ee.return=B,pt=ee;else e:for(;pt!==null;){if(B=pt,B.flags&2048)switch(B.tag){case 0:case 11:case 15:Ko(9,B,B.return)}var ye=B.sibling;if(ye!==null){ye.return=B.return,pt=ye;break e}pt=B.return}}var he=d.current;for(pt=he;pt!==null;){ee=pt;var we=ee.child;if(ee.subtreeFlags&2064&&we!==null)we.return=ee,pt=we;else e:for(ee=he;pt!==null;){if(ue=pt,ue.flags&2048)try{switch(ue.tag){case 0:case 11:case 15:bd(9,ue)}}catch(Rt){ai(ue,ue.return,Rt)}if(ue===ee){pt=null;break e}var gt=ue.sibling;if(gt!==null){gt.return=ue.return,pt=gt;break e}pt=ue.return}}if(Zt=E,Bs(),Is&&typeof Is.onPostCommitFiberRoot=="function")try{Is.onPostCommitFiberRoot(kf,d)}catch{}A=!0}return A}finally{cn=v,Vn.transition=h}}return!1}function FA(d,h,v){h=fy(v,h),h=ZS(d,h,1),ka(d,h),h=Wr(),d=wp(d,1),d!==null&&(ld(d,1,h),si(d,h))}function ai(d,h,v){if(d.tag===3)FA(d,d,v);else for(;h!==null;){if(h.tag===3){FA(h,d,v);break}else if(h.tag===1){var A=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(ja===null||!ja.has(A))){d=fy(v,d),d=qS(h,d,1),ka(h,d),d=Wr(),h=wp(h,1),h!==null&&(ld(h,1,d),si(h,d));break}}h=h.return}}function mP(d,h,v){var A=d.pingCache;A!==null&&A.delete(h),h=Wr(),d.pingedLanes|=d.suspendedLanes&v,Zn===d&&(_r&v)===v&&(tr===4||tr===3&&(_r&130023424)===_r&&500>dr()-Ry?Zo(d,0):Ny|=v),si(d,h)}function kA(d,h){h===0&&(d.mode&1?(h=er,er<<=1,!(er&130023424)&&(er=4194304)):h=1);var v=Wr();d=wp(d,h),d!==null&&(ld(d,h,v),si(d,v))}function gP(d){var h=d.memoizedState,v=0;h!==null&&(v=h.retryLane),kA(d,v)}function xP(d,h){var v=0;switch(d.tag){case 13:var A=d.stateNode,E=d.memoizedState;E!==null&&(v=E.retryLane);break;case 19:A=d.stateNode;break;default:throw Error(a(314))}A!==null&&A.delete(h),kA(d,v)}var jA;jA=function(d,h,v){if(d!==null)if(d.memoizedProps!==h.pendingProps||Xe.current)wi=!0;else{if(!(d.lanes&v)&&!(h.flags&128))return wi=!1,iP(d,h,v);wi=!!(d.flags&131072)}else wi=!1,An&&h.flags&1048576&&AS(h,Xf,h.index);switch(h.lanes=0,h.tag){case 2:var A=h.type;d!==null&&(d.alternate=null,h.alternate=null,h.flags|=2),d=h.pendingProps;var E=Ot(h,ht.current);dc(h,v),E=ly(null,h,A,d,E,v);var B=cy();return h.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,zt(A)?(B=!0,Et(h)):B=!1,h.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Kx(h),E.updater=Vf,h.stateNode=E,E._reactInternals=h,qx(h,A,d,v),h=gy(null,h,A,!0,B,v)):(h.tag=0,An&&B&&Qx(h),Vr(null,h,E,v),h=h.child),h;case 16:A=h.elementType;e:{switch(d!==null&&(d.alternate=null,h.alternate=null,h.flags|=2),d=h.pendingProps,E=A._init,A=E(A._payload),h.type=A,E=h.tag=vP(A),d=us(A,d),E){case 0:h=my(null,h,A,d,v);break e;case 1:h=lA(null,h,A,d,v);break e;case 11:h=rA(null,h,A,d,v);break e;case 14:h=iA(null,h,A,us(A.type,d),v);break e}throw Error(a(306,A,""))}return h;case 0:return A=h.type,E=h.pendingProps,E=h.elementType===A?E:us(A,E),my(d,h,A,E,v);case 1:return A=h.type,E=h.pendingProps,E=h.elementType===A?E:us(A,E),lA(d,h,A,E,v);case 3:e:{if(cA(h),d===null)throw Error(a(387));A=h.pendingProps,B=h.memoizedState,E=B.element,xS(d,h),Gf(h,A,null,v);var ee=h.memoizedState;if(A=ee.element,it&&B.isDehydrated)if(B={element:A,isDehydrated:!1,cache:ee.cache,transitions:ee.transitions},h.updateQueue.baseState=B,h.memoizedState=B,h.flags&256){E=Error(a(423)),h=uA(d,h,A,v,E);break e}else if(A!==E){E=Error(a(424)),h=uA(d,h,A,v,E);break e}else for(it&&(bi=Da(h.stateNode.containerInfo),_i=h,An=!0,ds=null,cd=!1),v=RS(h,null,A,v),h.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(pc(),A===E){h=oa(d,h,v);break e}Vr(d,h,A,v)}h=h.child}return h;case 5:return IS(h),d===null&&ty(h),A=h.type,E=h.pendingProps,B=d!==null?d.memoizedProps:null,ee=E.children,be(A,E)?ee=null:B!==null&&be(A,B)&&(h.flags|=32),oA(d,h),Vr(d,h,ee,v),h.child;case 6:return d===null&&ty(h),null;case 13:return dA(d,h,v);case 4:return ry(h,h.stateNode.containerInfo),A=h.pendingProps,d===null?h.child=mc(h,null,A,v):Vr(d,h,A,v),h.child;case 11:return A=h.type,E=h.pendingProps,E=h.elementType===A?E:us(A,E),rA(d,h,A,E,v);case 7:return Vr(d,h,h.pendingProps,v),h.child;case 8:return Vr(d,h,h.pendingProps.children,v),h.child;case 12:return Vr(d,h,h.pendingProps.children,v),h.child;case 10:e:{if(A=h.type._context,E=h.pendingProps,B=h.memoizedProps,ee=E.value,gS(h,A,ee),B!==null)if(Ps(B.value,ee)){if(B.children===E.children&&!Xe.current){h=oa(d,h,v);break e}}else for(B=h.child,B!==null&&(B.return=h);B!==null;){var ue=B.dependencies;if(ue!==null){ee=B.child;for(var Ee=ue.firstContext;Ee!==null;){if(Ee.context===A){if(B.tag===1){Ee=ra(-1,v&-v),Ee.tag=2;var $e=B.updateQueue;if($e!==null){$e=$e.shared;var Mt=$e.pending;Mt===null?Ee.next=Ee:(Ee.next=Mt.next,Mt.next=Ee),$e.pending=Ee}}B.lanes|=v,Ee=B.alternate,Ee!==null&&(Ee.lanes|=v),Yx(B.return,v,h),ue.lanes|=v;break}Ee=Ee.next}}else if(B.tag===10)ee=B.type===h.type?null:B.child;else if(B.tag===18){if(ee=B.return,ee===null)throw Error(a(341));ee.lanes|=v,ue=ee.alternate,ue!==null&&(ue.lanes|=v),Yx(ee,v,h),ee=B.sibling}else ee=B.child;if(ee!==null)ee.return=B;else for(ee=B;ee!==null;){if(ee===h){ee=null;break}if(B=ee.sibling,B!==null){B.return=ee.return,ee=B;break}ee=ee.return}B=ee}Vr(d,h,E.children,v),h=h.child}return h;case 9:return E=h.type,A=h.pendingProps.children,dc(h,v),E=Oi(E),A=A(E),h.flags|=1,Vr(d,h,A,v),h.child;case 14:return A=h.type,E=us(A,h.pendingProps),E=us(A.type,E),iA(d,h,A,E,v);case 15:return sA(d,h,h.type,h.pendingProps,v);case 17:return A=h.type,E=h.pendingProps,E=h.elementType===A?E:us(A,E),d!==null&&(d.alternate=null,h.alternate=null,h.flags|=2),h.tag=1,zt(A)?(d=!0,Et(h)):d=!1,dc(h,v),wS(h,A,E),qx(h,A,E,v),gy(null,h,A,!0,d,v);case 19:return mA(d,h,v);case 22:return aA(d,h,v)}throw Error(a(156,h.tag))};function UA(d,h){return zx(d,h)}function yP(d,h,v,A){this.tag=d,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xi(d,h,v,A){return new yP(d,h,v,A)}function jy(d){return d=d.prototype,!(!d||!d.isReactComponent)}function vP(d){if(typeof d=="function")return jy(d)?1:0;if(d!=null){if(d=d.$$typeof,d===S)return 11;if(d===_)return 14}return 2}function Ha(d,h){var v=d.alternate;return v===null?(v=Xi(d.tag,h,d.key,d.mode),v.elementType=d.elementType,v.type=d.type,v.stateNode=d.stateNode,v.alternate=d,d.alternate=v):(v.pendingProps=h,v.type=d.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=d.flags&14680064,v.childLanes=d.childLanes,v.lanes=d.lanes,v.child=d.child,v.memoizedProps=d.memoizedProps,v.memoizedState=d.memoizedState,v.updateQueue=d.updateQueue,h=d.dependencies,v.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},v.sibling=d.sibling,v.index=d.index,v.ref=d.ref,v}function Ap(d,h,v,A,E,B){var ee=2;if(A=d,typeof d=="function")jy(d)&&(ee=1);else if(typeof d=="string")ee=5;else e:switch(d){case f:return $o(v.children,E,B,h);case p:ee=8,E|=8;break;case m:return d=Xi(12,v,h,E|2),d.elementType=m,d.lanes=B,d;case w:return d=Xi(13,v,h,E),d.elementType=w,d.lanes=B,d;case x:return d=Xi(19,v,h,E),d.elementType=x,d.lanes=B,d;case M:return Mp(v,E,B,h);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case g:ee=10;break e;case y:ee=9;break e;case S:ee=11;break e;case _:ee=14;break e;case b:ee=16,A=null;break e}throw Error(a(130,d==null?d:typeof d,""))}return h=Xi(ee,v,h,E),h.elementType=d,h.type=A,h.lanes=B,h}function $o(d,h,v,A){return d=Xi(7,d,A,h),d.lanes=v,d}function Mp(d,h,v,A){return d=Xi(22,d,A,h),d.elementType=M,d.lanes=v,d.stateNode={},d}function Uy(d,h,v){return d=Xi(6,d,null,h),d.lanes=v,d}function Oy(d,h,v){return h=Xi(4,d.children!==null?d.children:[],d.key,h),h.lanes=v,h.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},h}function _P(d,h,v,A,E){this.tag=h,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=yt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ux(0),this.expirationTimes=Ux(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ux(0),this.identifierPrefix=A,this.onRecoverableError=E,it&&(this.mutableSourceEagerHydrationData=null)}function OA(d,h,v,A,E,B,ee,ue,Ee){return d=new _P(d,h,v,ue,Ee),h===1?(h=1,B===!0&&(h|=8)):h=0,B=Xi(3,null,null,h),d.current=B,B.stateNode=d,B.memoizedState={element:A,isDehydrated:v,cache:null,transitions:null},Kx(B),d}function zA(d){if(!d)return We;d=d._reactInternals;e:{if(T(d)!==d||d.tag!==1)throw Error(a(170));var h=d;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(zt(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(a(171))}if(d.tag===1){var v=d.type;if(zt(v))return mt(d,v,h)}return h}function HA(d){var h=d._reactInternals;if(h===void 0)throw typeof d.render=="function"?Error(a(188)):(d=Object.keys(d).join(","),Error(a(268,d)));return d=O(h),d===null?null:d.stateNode}function GA(d,h){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var v=d.retryLane;d.retryLane=v!==0&&v<h?v:h}}function zy(d,h){GA(d,h),(d=d.alternate)&&GA(d,h)}function bP(d){return d=O(d),d===null?null:d.stateNode}function wP(){return null}return t.attemptContinuousHydration=function(d){if(d.tag===13){var h=Wr();Wi(d,134217728,h),zy(d,134217728)}},t.attemptHydrationAtCurrentPriority=function(d){if(d.tag===13){var h=Wr(),v=Oa(d);Wi(d,v,h),zy(d,v)}},t.attemptSynchronousHydration=function(d){switch(d.tag){case 3:var h=d.stateNode;if(h.current.memoizedState.isDehydrated){var v=ur(h.pendingLanes);v!==0&&(Ox(h,v|1),si(h,dr()),!(Zt&6)&&(bc(),Bs()))}break;case 13:var A=Wr();IA(function(){return Wi(d,1,A)}),zy(d,1)}},t.batchedUpdates=function(d,h){var v=Zt;Zt|=1;try{return d(h)}finally{Zt=v,Zt===0&&(bc(),jf&&Bs())}},t.createComponentSelector=function(d){return{$$typeof:up,value:d}},t.createContainer=function(d,h,v,A,E,B,ee){return OA(d,h,!1,null,v,A,E,B,ee)},t.createHasPseudoClassSelector=function(d){return{$$typeof:dp,value:d}},t.createHydrationContainer=function(d,h,v,A,E,B,ee,ue,Ee){return d=OA(v,A,!0,d,E,B,ee,ue,Ee),d.context=zA(null),v=d.current,A=Wr(),E=Oa(v),B=ra(A,E),B.callback=h??null,ka(v,B),d.current.lanes=E,ld(d,E,A),si(d,A),d},t.createPortal=function(d,h,v){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:A==null?null:""+A,children:d,containerInfo:h,implementation:v}},t.createRoleSelector=function(d){return{$$typeof:hp,value:d}},t.createTestNameSelector=function(d){return{$$typeof:fp,value:d}},t.createTextSelector=function(d){return{$$typeof:pp,value:d}},t.deferredUpdates=function(d){var h=cn,v=Vn.transition;try{return Vn.transition=null,cn=16,d()}finally{cn=h,Vn.transition=v}},t.discreteUpdates=function(d,h,v,A,E){var B=cn,ee=Vn.transition;try{return Vn.transition=null,cn=1,d(h,v,A,E)}finally{cn=B,Vn.transition=ee,Zt===0&&bc()}},t.findAllNodes=Ey,t.findBoundingRects=function(d,h){if(!et)throw Error(a(363));h=Ey(d,h),d=[];for(var v=0;v<h.length;v++)d.push(Ge(h[v]));for(h=d.length-1;0<h;h--){v=d[h];for(var A=v.x,E=A+v.width,B=v.y,ee=B+v.height,ue=h-1;0<=ue;ue--)if(h!==ue){var Ee=d[ue],$e=Ee.x,Mt=$e+Ee.width,Ht=Ee.y,Bt=Ht+Ee.height;if(A>=$e&&B>=Ht&&E<=Mt&&ee<=Bt){d.splice(h,1);break}else if(A!==$e||v.width!==Ee.width||Bt<B||Ht>ee){if(!(B!==Ht||v.height!==Ee.height||Mt<A||$e>E)){$e>A&&(Ee.width+=$e-A,Ee.x=A),Mt<E&&(Ee.width=E-$e),d.splice(h,1);break}}else{Ht>B&&(Ee.height+=Ht-B,Ee.y=B),Bt<ee&&(Ee.height=ee-Ht),d.splice(h,1);break}}}return d},t.findHostInstance=HA,t.findHostInstanceWithNoPortals=function(d){return d=j(d),d=d!==null?Z(d):null,d===null?null:d.stateNode},t.findHostInstanceWithWarning=function(d){return HA(d)},t.flushControlled=function(d){var h=Zt;Zt|=1;var v=Vn.transition,A=cn;try{Vn.transition=null,cn=1,d()}finally{cn=A,Vn.transition=v,Zt=h,Zt===0&&(bc(),Bs())}},t.flushPassiveEffects=Qo,t.flushSync=IA,t.focusWithin=function(d,h){if(!et)throw Error(a(363));for(d=Ay(d),h=TA(d,h),h=Array.from(h),d=0;d<h.length;){var v=h[d++];if(!L(v)){if(v.tag===5&&pe(v.stateNode))return!0;for(v=v.child;v!==null;)h.push(v),v=v.sibling}}return!1},t.getCurrentUpdatePriority=function(){return cn},t.getFindAllNodesFailureDescription=function(d,h){if(!et)throw Error(a(363));var v=0,A=[];d=[Ay(d),0];for(var E=0;E<d.length;){var B=d[E++],ee=d[E++],ue=h[ee];if((B.tag!==5||!L(B))&&(My(B,ue)&&(A.push(Cy(ue)),ee++,ee>v&&(v=ee)),ee<h.length))for(B=B.child;B!==null;)d.push(B,ee),B=B.sibling}if(v<h.length){for(d=[];v<h.length;v++)d.push(Cy(h[v]));return`findAllNodes was able to match part of the selector:
  `+(A.join(" > ")+`

No matching component was found for:
  `)+d.join(" > ")}return null},t.getPublicRootInstance=function(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return K(d.child.stateNode);default:return d.child.stateNode}},t.injectIntoDevTools=function(d){if(d={bundleType:d.bundleType,version:d.version,rendererPackageName:d.rendererPackageName,rendererConfig:d.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:bP,findFiberByHostInstance:d.findFiberByHostInstance||wP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")d=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)d=!0;else{try{kf=h.inject(d),Is=h}catch{}d=!!h.checkDCE}}return d},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(d,h,v,A){if(!et)throw Error(a(363));d=Ey(d,h);var E=ve(d,v,A).disconnect;return{disconnect:function(){E()}}},t.registerMutableSourceForHydration=function(d,h){var v=h._getVersion;v=v(h._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[h,v]:d.mutableSourceEagerHydrationData.push(h,v)},t.runWithPriority=function(d,h){var v=cn;try{return cn=d,h()}finally{cn=v}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(d,h,v,A){var E=h.current,B=Wr(),ee=Oa(E);return v=zA(v),h.context===null?h.context=v:h.pendingContext=v,h=ra(B,ee),h.payload={element:d},A=A===void 0?null:A,A!==null&&(h.callback=A),ka(E,h),d=Wi(E,ee,B),d!==null&&Hf(d,E,ee),ee},t};eI.exports=QG;var $G=eI.exports;const e8=$1($G);var tI={exports:{}},nI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,H){var W=U.length;U.push(H);e:for(;0<W;){var Y=W-1>>>1,G=U[Y];if(0<i(G,H))U[Y]=H,U[W]=G,W=Y;else break e}}function t(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],W=U.pop();if(W!==H){U[0]=W;e:for(var Y=0,G=U.length,de=G>>>1;Y<de;){var Ce=2*(Y+1)-1,be=U[Ce],se=Ce+1,_e=U[se];if(0>i(be,W))se<G&&0>i(_e,be)?(U[Y]=_e,U[se]=W,Y=se):(U[Y]=be,U[Ce]=W,Y=Ce);else if(se<G&&0>i(_e,W))U[Y]=_e,U[se]=W,Y=se;else break e}}return H}function i(U,H){var W=U.sortIndex-H.sortIndex;return W!==0?W:U.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],f=1,p=null,m=3,g=!1,y=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(U){for(var H=t(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=U)r(u),H.sortIndex=H.expirationTime,e(c,H);else break;H=t(u)}}function M(U){if(S=!1,b(U),!y)if(t(c)!==null)y=!0,K(N);else{var H=t(u);H!==null&&$(M,H.startTime-U)}}function N(U,H){y=!1,S&&(S=!1,x(P),P=-1),g=!0;var W=m;try{for(b(H),p=t(c);p!==null&&(!(p.expirationTime>H)||U&&!j());){var Y=p.callback;if(typeof Y=="function"){p.callback=null,m=p.priorityLevel;var G=Y(p.expirationTime<=H);H=n.unstable_now(),typeof G=="function"?p.callback=G:p===t(c)&&r(c),b(H)}else r(c);p=t(c)}if(p!==null)var de=!0;else{var Ce=t(u);Ce!==null&&$(M,Ce.startTime-H),de=!1}return de}finally{p=null,m=W,g=!1}}var C=!1,I=null,P=-1,T=5,R=-1;function j(){return!(n.unstable_now()-R<T)}function O(){if(I!==null){var U=n.unstable_now();R=U;var H=!0;try{H=I(!0,U)}finally{H?k():(C=!1,I=null)}}else C=!1}var k;if(typeof _=="function")k=function(){_(O)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,te=Z.port2;Z.port1.onmessage=O,k=function(){te.postMessage(null)}}else k=function(){w(O,0)};function K(U){I=U,C||(C=!0,k())}function $(U,H){P=w(function(){U(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,K(N))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(U){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var W=m;m=H;try{return U()}finally{m=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var W=m;m=U;try{return H()}finally{m=W}},n.unstable_scheduleCallback=function(U,H,W){var Y=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Y+W:Y):W=Y,U){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=W+G,U={id:f++,callback:H,priorityLevel:U,startTime:W,expirationTime:G,sortIndex:-1},W>Y?(U.sortIndex=W,e(u,U),t(c)===null&&U===t(u)&&(S?(x(P),P=-1):S=!0,$(M,W-Y))):(U.sortIndex=G,e(c,U),y||g||(y=!0,K(N))),U},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(U){var H=m;return function(){var W=m;m=H;try{return U.apply(this,arguments)}finally{m=W}}}})(nI);tI.exports=nI;var XE=tI.exports;const Qw={},$w=n=>void Object.assign(Qw,n);function t8(n,e){function t(f,{args:p=[],attach:m,...g},y){let S=`${f[0].toUpperCase()}${f.slice(1)}`,w;if(f==="primitive"){if(g.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const x=g.object;w=Jc(x,{type:f,root:y,attach:m,primitive:!0})}else{const x=Qw[S];if(!x)throw new Error(`R3F: ${S} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(p))throw new Error("R3F: The args prop must be an array!");w=Jc(new x(...p),{type:f,root:y,attach:m,memoizedProps:{args:p}})}return w.__r3f.attach===void 0&&(w.isBufferGeometry?w.__r3f.attach="geometry":w.isMaterial&&(w.__r3f.attach="material")),S!=="inject"&&p_(w,g),w}function r(f,p){let m=!1;if(p){var g,y;(g=p.__r3f)!=null&&g.attach?f_(f,p,p.__r3f.attach):p.isObject3D&&f.isObject3D&&(f.add(p),m=!0),m||(y=f.__r3f)==null||y.objects.push(p),p.__r3f||Jc(p,{}),p.__r3f.parent=f,J1(p),Yc(p)}}function i(f,p,m){let g=!1;if(p){var y,S;if((y=p.__r3f)!=null&&y.attach)f_(f,p,p.__r3f.attach);else if(p.isObject3D&&f.isObject3D){p.parent=f,p.dispatchEvent({type:"added"}),f.dispatchEvent({type:"childadded",child:p});const w=f.children.filter(_=>_!==p),x=w.indexOf(m);f.children=[...w.slice(0,x),p,...w.slice(x)],g=!0}g||(S=f.__r3f)==null||S.objects.push(p),p.__r3f||Jc(p,{}),p.__r3f.parent=f,J1(p),Yc(p)}}function s(f,p,m=!1){f&&[...f].forEach(g=>a(p,g,m))}function a(f,p,m){if(p){var g,y,S;if(p.__r3f&&(p.__r3f.parent=null),(g=f.__r3f)!=null&&g.objects&&(f.__r3f.objects=f.__r3f.objects.filter(M=>M!==p)),(y=p.__r3f)!=null&&y.attach)qE(f,p,p.__r3f.attach);else if(p.isObject3D&&f.isObject3D){var w;f.remove(p),(w=p.__r3f)!=null&&w.root&&l8(ng(p),p)}const _=(S=p.__r3f)==null?void 0:S.primitive,b=!_&&(m===void 0?p.dispose!==null:m);if(!_){var x;s((x=p.__r3f)==null?void 0:x.objects,p,b),s(p.children,p,b)}if(delete p.__r3f,b&&p.dispose&&p.type!=="Scene"){const M=()=>{try{p.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?XE.unstable_scheduleCallback(XE.unstable_IdlePriority,M):M()}Yc(f)}}function o(f,p,m,g){var y;const S=(y=f.__r3f)==null?void 0:y.parent;if(!S)return;const w=t(p,m,f.__r3f.root);if(f.children){for(const x of f.children)x.__r3f&&r(w,x);f.children=f.children.filter(x=>!x.__r3f)}f.__r3f.objects.forEach(x=>r(w,x)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||a(S,f),w.parent&&(w.__r3f.autoRemovedBeforeAppend=!0),r(S,w),w.raycast&&w.__r3f.eventCount&&ng(w).getState().internal.interaction.push(w),[g,g.alternate].forEach(x=>{x!==null&&(x.stateNode=w,x.ref&&(typeof x.ref=="function"?x.ref(w):x.ref.current=w))})}const c=()=>{};return{reconciler:e8({createInstance:t,removeChild:a,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,p)=>{if(!p)return;const m=f.getState().scene;m.__r3f&&(m.__r3f.root=f,r(m,p))},removeChildFromContainer:(f,p)=>{p&&a(f.getState().scene,p)},insertInContainerBefore:(f,p,m)=>{if(!p||!m)return;const g=f.getState().scene;g.__r3f&&i(g,p,m)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var p;return!!((p=f==null?void 0:f.__r3f)!=null?p:{}).handlers},prepareUpdate(f,p,m,g){var y;if(((y=f==null?void 0:f.__r3f)!=null?y:{}).primitive&&g.object&&g.object!==f)return[!0];{const{args:w=[],children:x,..._}=g,{args:b=[],children:M,...N}=m;if(!Array.isArray(w))throw new Error("R3F: the args prop must be an array!");if(w.some((I,P)=>I!==b[P]))return[!0];const C=cI(f,_,N,!0);return C.changes.length?[!1,C]:null}},commitUpdate(f,[p,m],g,y,S,w){p?o(f,g,S,w):p_(f,m)},commitMount(f,p,m,g){var y;const S=(y=f.__r3f)!=null?y:{};f.raycast&&S.handlers&&S.eventCount&&ng(f).getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>Jc(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var p;const{attach:m,parent:g}=(p=f.__r3f)!=null?p:{};m&&g&&qE(g,f,m),f.isObject3D&&(f.visible=!1),Yc(f)},unhideInstance(f,p){var m;const{attach:g,parent:y}=(m=f.__r3f)!=null?m:{};g&&y&&f_(y,f,g),(f.isObject3D&&p.visible==null||p.visible)&&(f.visible=!0),Yc(f)},createTextInstance:c,hideTextInstance:c,unhideTextInstance:c,getCurrentEventPriority:()=>e?e():uu.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&vn.fun(performance.now)?performance.now:vn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:vn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:vn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:p_}}var JE,YE;const h_=n=>"colorSpace"in n||"outputColorSpace"in n,rI=()=>{var n;return(n=Qw.ColorManagement)!=null?n:null},iI=n=>n&&n.isOrthographicCamera,n8=n=>n&&n.hasOwnProperty("current"),Bf=typeof window<"u"&&((JE=window.document)!=null&&JE.createElement||((YE=window.navigator)==null?void 0:YE.product)==="ReactNative")?F.useLayoutEffect:F.useEffect;function sI(n){const e=F.useRef(n);return Bf(()=>void(e.current=n),[n]),e}function r8({set:n}){return Bf(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class aI extends F.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}aI.getDerivedStateFromError=()=>({error:!0});const oI="__default",KE=new Map,i8=n=>n&&!!n.memoized&&!!n.changes;function lI(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const Jd=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function ng(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const vn={obj:n=>n===Object(n)&&!vn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(vn.str(n)||vn.num(n)||vn.boo(n))return n===e;const s=vn.obj(n);if(s&&r==="reference")return n===e;const a=vn.arr(n);if(a&&t==="reference")return n===e;if((a||s)&&n===e)return!0;let o;for(o in n)if(!(o in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(o in i?e:n)if(!vn.equ(n[o],e[o],{strict:i,objects:"reference"}))return!1}else for(o in i?e:n)if(n[o]!==e[o])return!1;if(vn.und(o)){if(a&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function s8(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function a8(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Jc(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function X1(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,a)=>s[a],n),{target:t,key:i}}else return{target:t,key:e}}const ZE=/-\d+$/;function f_(n,e,t){if(vn.str(t)){if(ZE.test(t)){const s=t.replace(ZE,""),{target:a,key:o}=X1(n,s);Array.isArray(a[o])||(a[o]=[])}const{target:r,key:i}=X1(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function qE(n,e,t){var r,i;if(vn.str(t)){const{target:s,key:a}=X1(n,t),o=e.__r3f.previousAttach;o===void 0?delete s[a]:s[a]=o}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function cI(n,{children:e,key:t,ref:r,...i},{children:s,key:a,ref:o,...c}={},u=!1){const f=n.__r3f,p=Object.entries(i),m=[];if(u){const y=Object.keys(c);for(let S=0;S<y.length;S++)i.hasOwnProperty(y[S])||p.unshift([y[S],oI+"remove"])}p.forEach(([y,S])=>{var w;if((w=n.__r3f)!=null&&w.primitive&&y==="object"||vn.equ(S,c[y]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y))return m.push([y,S,!0,[]]);let x=[];y.includes("-")&&(x=y.split("-")),m.push([y,S,!1,x]);for(const _ in i){const b=i[_];_.startsWith(`${y}-`)&&m.push([_,b,!1,_.split("-")])}});const g={...i};return f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.args&&(g.args=f.memoizedProps.args),f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.attach&&(g.attach=f.memoizedProps.attach),{memoized:g,changes:m}}function p_(n,e){var t;const r=n.__r3f,i=r==null?void 0:r.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:a,changes:o}=i8(e)?e:cI(n,e),c=r==null?void 0:r.eventCount;n.__r3f&&(n.__r3f.memoizedProps=a);for(let m=0;m<o.length;m++){let[g,y,S,w]=o[m];if(h_(n)){const M="srgb",N="srgb-linear";g==="encoding"?(g="colorSpace",y=y===3001?M:N):g==="outputEncoding"&&(g="outputColorSpace",y=y===3001?M:N)}let x=n,_=x[g];if(w.length&&(_=w.reduce((b,M)=>b[M],n),!(_&&_.set))){const[b,...M]=w.reverse();x=M.reverse().reduce((N,C)=>N[C],n),g=b}if(y===oI+"remove")if(x.constructor){let b=KE.get(x.constructor);b||(b=new x.constructor,KE.set(x.constructor,b)),y=b[g]}else y=0;if(S&&r)y?r.handlers[g]=y:delete r.handlers[g],r.eventCount=Object.keys(r.handlers).length;else if(_&&_.set&&(_.copy||_ instanceof Fl)){if(Array.isArray(y))_.fromArray?_.fromArray(y):_.set(...y);else if(_.copy&&y&&y.constructor&&_.constructor===y.constructor)_.copy(y);else if(y!==void 0){var u;const b=(u=_)==null?void 0:u.isColor;!b&&_.setScalar?_.setScalar(y):_ instanceof Fl&&y instanceof Fl?_.mask=y.mask:_.set(y),!rI()&&s&&!s.linear&&b&&_.convertSRGBToLinear()}}else{var f;if(x[g]=y,(f=x[g])!=null&&f.isTexture&&x[g].format===Yn&&x[g].type===gr&&s){const b=x[g];h_(b)&&h_(s.gl)?b.colorSpace=s.gl.outputColorSpace:b.encoding=s.gl.outputEncoding}}Yc(n)}if(r&&r.parent&&n.raycast&&c!==r.eventCount){const m=ng(n).getState().internal,g=m.interaction.indexOf(n);g>-1&&m.interaction.splice(g,1),r.eventCount&&m.interaction.push(n)}return!(o.length===1&&o[0][0]==="onUpdate")&&o.length&&(t=n.__r3f)!=null&&t.parent&&J1(n),n}function Yc(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function J1(n){n.onUpdate==null||n.onUpdate(n)}function uI(n,e){n.manual||(iI(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function Lm(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function o8(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return uu.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return uu.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return uu.ContinuousEventPriority;default:return uu.DefaultEventPriority}}function dI(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function l8(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{dI(t.capturedMap,e,r,i)})}function c8(n){function e(c){const{internal:u}=n.getState(),f=c.offsetX-u.initialClick[0],p=c.offsetY-u.initialClick[1];return Math.round(Math.sqrt(f*f+p*p))}function t(c){return c.filter(u=>["Move","Over","Enter","Out","Leave"].some(f=>{var p;return(p=u.__r3f)==null?void 0:p.handlers["onPointer"+f]}))}function r(c,u){const f=n.getState(),p=new Set,m=[],g=u?u(f.internal.interaction):f.internal.interaction;for(let x=0;x<g.length;x++){const _=Jd(g[x]);_&&(_.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(c,f);function y(x){const _=Jd(x);if(!_||!_.events.enabled||_.raycaster.camera===null)return[];if(_.raycaster.camera===void 0){var b;_.events.compute==null||_.events.compute(c,_,(b=_.previousRoot)==null?void 0:b.getState()),_.raycaster.camera===void 0&&(_.raycaster.camera=null)}return _.raycaster.camera?_.raycaster.intersectObject(x,!0):[]}let S=g.flatMap(y).sort((x,_)=>{const b=Jd(x.object),M=Jd(_.object);return!b||!M?x.distance-_.distance:M.events.priority-b.events.priority||x.distance-_.distance}).filter(x=>{const _=Lm(x);return p.has(_)?!1:(p.add(_),!0)});f.events.filter&&(S=f.events.filter(S,f));for(const x of S){let _=x.object;for(;_;){var w;(w=_.__r3f)!=null&&w.eventCount&&m.push({...x,eventObject:_}),_=_.parent}}if("pointerId"in c&&f.internal.capturedMap.has(c.pointerId))for(let x of f.internal.capturedMap.get(c.pointerId).values())p.has(Lm(x.intersection))||m.push(x.intersection);return m}function i(c,u,f,p){const m=n.getState();if(c.length){const g={stopped:!1};for(const y of c){const S=Jd(y.object)||m,{raycaster:w,pointer:x,camera:_,internal:b}=S,M=new X(x.x,x.y,0).unproject(_),N=R=>{var j,O;return(j=(O=b.capturedMap.get(R))==null?void 0:O.has(y.eventObject))!=null?j:!1},C=R=>{const j={intersection:y,target:u.target};b.capturedMap.has(R)?b.capturedMap.get(R).set(y.eventObject,j):b.capturedMap.set(R,new Map([[y.eventObject,j]])),u.target.setPointerCapture(R)},I=R=>{const j=b.capturedMap.get(R);j&&dI(b.capturedMap,y.eventObject,j,R)};let P={};for(let R in u){let j=u[R];typeof j!="function"&&(P[R]=j)}let T={...y,...P,pointer:x,intersections:c,stopped:g.stopped,delta:f,unprojectedPoint:M,ray:w.ray,camera:_,stopPropagation(){const R="pointerId"in u&&b.capturedMap.get(u.pointerId);if((!R||R.has(y.eventObject))&&(T.stopped=g.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(j=>j.eventObject===y.eventObject))){const j=c.slice(0,c.indexOf(y));s([...j,y])}},target:{hasPointerCapture:N,setPointerCapture:C,releasePointerCapture:I},currentTarget:{hasPointerCapture:N,setPointerCapture:C,releasePointerCapture:I},nativeEvent:u};if(p(T),g.stopped===!0)break}}return c}function s(c){const{internal:u}=n.getState();for(const f of u.hovered.values())if(!c.length||!c.find(p=>p.object===f.object&&p.index===f.index&&p.instanceId===f.instanceId)){const m=f.eventObject.__r3f,g=m==null?void 0:m.handlers;if(u.hovered.delete(Lm(f)),m!=null&&m.eventCount){const y={...f,intersections:c};g.onPointerOut==null||g.onPointerOut(y),g.onPointerLeave==null||g.onPointerLeave(y)}}}function a(c,u){for(let f=0;f<u.length;f++){const p=u[f].__r3f;p==null||p.handlers.onPointerMissed==null||p.handlers.onPointerMissed(c)}}function o(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:f}=n.getState();"pointerId"in u&&f.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(u.pointerId)&&(f.capturedMap.delete(u.pointerId),s([]))})}}return function(f){const{onPointerMissed:p,internal:m}=n.getState();m.lastEvent.current=f;const g=c==="onPointerMove",y=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",w=r(f,g?t:void 0),x=y?e(f):0;c==="onPointerDown"&&(m.initialClick=[f.offsetX,f.offsetY],m.initialHits=w.map(b=>b.eventObject)),y&&!w.length&&x<=2&&(a(f,m.interaction),p&&p(f)),g&&s(w);function _(b){const M=b.eventObject,N=M.__r3f,C=N==null?void 0:N.handlers;if(N!=null&&N.eventCount)if(g){if(C.onPointerOver||C.onPointerEnter||C.onPointerOut||C.onPointerLeave){const I=Lm(b),P=m.hovered.get(I);P?P.stopped&&b.stopPropagation():(m.hovered.set(I,b),C.onPointerOver==null||C.onPointerOver(b),C.onPointerEnter==null||C.onPointerEnter(b))}C.onPointerMove==null||C.onPointerMove(b)}else{const I=C[c];I?(!y||m.initialHits.includes(M))&&(a(f,m.interaction.filter(P=>!m.initialHits.includes(P))),I(b)):y&&m.initialHits.includes(M)&&a(f,m.interaction.filter(P=>!m.initialHits.includes(P)))}}i(w,f,x,_)}}return{handlePointer:o}}const u8=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],hI=n=>!!(n!=null&&n.render),eS=F.createContext(null),d8=(n,e)=>{const t=qR((o,c)=>{const u=new X,f=new X,p=new X;function m(x=c().camera,_=f,b=c().size){const{width:M,height:N,top:C,left:I}=b,P=M/N;_.isVector3?p.copy(_):p.set(..._);const T=x.getWorldPosition(u).distanceTo(p);if(iI(x))return{width:M/x.zoom,height:N/x.zoom,top:C,left:I,factor:1,distance:T,aspect:P};{const R=x.fov*Math.PI/180,j=2*Math.tan(R/2)*T,O=j*(M/N);return{width:O,height:j,top:C,left:I,factor:M/O,distance:T,aspect:P}}}let g;const y=x=>o(_=>({performance:{..._.performance,current:x}})),S=new Te;return{set:o,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(x=1)=>n(c(),x),advance:(x,_)=>e(x,_,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Ww,pointer:S,mouse:S,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const x=c();g&&clearTimeout(g),x.performance.current!==x.performance.min&&y(x.performance.min),g=setTimeout(()=>y(c().performance.max),x.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:m},setEvents:x=>o(_=>({..._,events:{..._.events,...x}})),setSize:(x,_,b,M,N)=>{const C=c().camera,I={width:x,height:_,top:M||0,left:N||0,updateStyle:b};o(P=>({size:I,viewport:{...P.viewport,...m(C,f,I)}}))},setDpr:x=>o(_=>{const b=lI(x);return{viewport:{..._.viewport,dpr:b,initialDpr:_.viewport.initialDpr||b}}}),setFrameloop:(x="always")=>{const _=c().clock;_.stop(),_.elapsedTime=0,x!=="never"&&(_.start(),_.elapsedTime=0),o(()=>({frameloop:x}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:F.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(x,_,b)=>{const M=c().internal;return M.priority=M.priority+(_>0?1:0),M.subscribers.push({ref:x,priority:_,store:b}),M.subscribers=M.subscribers.sort((N,C)=>N.priority-C.priority),()=>{const N=c().internal;N!=null&&N.subscribers&&(N.priority=N.priority-(_>0?1:0),N.subscribers=N.subscribers.filter(C=>C.ref!==x))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,a=r.camera;return t.subscribe(()=>{const{camera:o,size:c,viewport:u,gl:f,set:p}=t.getState();if(c.width!==i.width||c.height!==i.height||u.dpr!==s){var m;i=c,s=u.dpr,uI(o,c),f.setPixelRatio(u.dpr);const g=(m=c.updateStyle)!=null?m:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(c.width,c.height,g)}o!==a&&(a=o,p(g=>({viewport:{...g.viewport,...g.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>n(o)),t};let Dm,h8=new Set,f8=new Set,p8=new Set;function m_(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function Yd(n,e){switch(n){case"before":return m_(h8,e);case"after":return m_(f8,e);case"tail":return m_(p8,e)}}let g_,x_;function y_(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),g_=e.internal.subscribers,Dm=0;Dm<g_.length;Dm++)x_=g_[Dm],x_.ref.current(x_.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function m8(n){let e=!1,t=!1,r,i,s;function a(u){i=requestAnimationFrame(a),e=!0,r=0,Yd("before",u),t=!0;for(const p of n.values()){var f;s=p.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((f=s.gl.xr)!=null&&f.isPresenting)&&(r+=y_(u,s))}if(t=!1,Yd("after",u),r===0)return Yd("tail",u),e=!1,cancelAnimationFrame(i)}function o(u,f=1){var p;if(!u)return n.forEach(m=>o(m.store.getState(),f));(p=u.gl.xr)!=null&&p.isPresenting||!u.internal.active||u.frameloop==="never"||(f>1?u.internal.frames=Math.min(60,u.internal.frames+f):t?u.internal.frames=2:u.internal.frames=1,e||(e=!0,requestAnimationFrame(a)))}function c(u,f=!0,p,m){if(f&&Yd("before",u),p)y_(u,p,m);else for(const g of n.values())y_(u,g.store.getState());f&&Yd("after",u)}return{loop:a,invalidate:o,advance:c}}function tS(){const n=F.useContext(eS);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Zr(n=t=>t,e){return tS()(n,e)}function kx(n,e=0){const t=tS(),r=t.getState().internal.subscribe,i=sI(n);return Bf(()=>r(i,e,t),[e,r,t]),null}const QE=new WeakMap;function fI(n,e){return function(t,...r){let i=QE.get(t);return i||(i=new t,QE.set(t,i)),n&&n(i),Promise.all(r.map(s=>new Promise((a,o)=>i.load(s,c=>{c.scene&&Object.assign(c,s8(c.scene)),a(c)},e,c=>o(new Error(`Could not load ${s}: ${c==null?void 0:c.message}`))))))}}function Ia(n,e,t,r){const i=Array.isArray(e)?e:[e],s=JG(fI(t,r),[n,...i],{equal:vn.equ});return Array.isArray(e)?s:s[0]}Ia.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return YG(fI(t),[n,...r])};Ia.clear=function(n,e){const t=Array.isArray(e)?e:[e];return KG([n,...t])};const Xu=new Map,{invalidate:$E,advance:e2}=m8(Xu),{reconciler:sf,applyProps:ro}=t8(Xu,o8),Vc={objects:"shallow",strict:!1},g8=(n,e)=>{const t=typeof n=="function"?n(e):n;return hI(t)?t:new qw({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function x8(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:a,updateStyle:o=t}=e;return{width:r,height:i,top:s,left:a,updateStyle:o}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:a}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:a,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function y8(n){const e=Xu.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||d8($E,e2),a=t||sf.createContainer(s,uu.ConcurrentRoot,null,!1,null,"",i,null);e||Xu.set(n,{fiber:a,store:s});let o,c=!1,u;return{configure(f={}){let{gl:p,size:m,scene:g,events:y,onCreated:S,shadows:w=!1,linear:x=!1,flat:_=!1,legacy:b=!1,orthographic:M=!1,frameloop:N="always",dpr:C=[1,2],performance:I,raycaster:P,camera:T,onPointerMissed:R}=f,j=s.getState(),O=j.gl;j.gl||j.set({gl:O=g8(p,n)});let k=j.raycaster;k||j.set({raycaster:k=new Kw});const{params:Z,...te}=P||{};if(vn.equ(te,k,Vc)||ro(k,{...te}),vn.equ(Z,k.params,Vc)||ro(k,{params:{...k.params,...Z}}),!j.camera||j.camera===u&&!vn.equ(u,T,Vc)){u=T;const W=T instanceof wf,Y=W?T:M?new Bi(0,0,0,0,.1,1e3):new Cn(75,0,.1,1e3);W||(Y.position.z=5,T&&(ro(Y,T),("aspect"in T||"left"in T||"right"in T||"bottom"in T||"top"in T)&&(Y.manual=!0,Y.updateProjectionMatrix())),!j.camera&&!(T!=null&&T.rotation)&&Y.lookAt(0,0,0)),j.set({camera:Y}),k.camera=Y}if(!j.scene){let W;g!=null&&g.isScene?W=g:(W=new Af,g&&ro(W,g)),j.set({scene:Jc(W)})}if(!j.xr){var K;const W=(de,Ce)=>{const be=s.getState();be.frameloop!=="never"&&e2(de,!0,be,Ce)},Y=()=>{const de=s.getState();de.gl.xr.enabled=de.gl.xr.isPresenting,de.gl.xr.setAnimationLoop(de.gl.xr.isPresenting?W:null),de.gl.xr.isPresenting||$E(de)},G={connect(){const de=s.getState().gl;de.xr.addEventListener("sessionstart",Y),de.xr.addEventListener("sessionend",Y)},disconnect(){const de=s.getState().gl;de.xr.removeEventListener("sessionstart",Y),de.xr.removeEventListener("sessionend",Y)}};typeof((K=O.xr)==null?void 0:K.addEventListener)=="function"&&G.connect(),j.set({xr:G})}if(O.shadowMap){const W=O.shadowMap.enabled,Y=O.shadowMap.type;if(O.shadowMap.enabled=!!w,vn.boo(w))O.shadowMap.type=xh;else if(vn.str(w)){var $;const G={basic:m3,percentage:xu,soft:xh,variance:Al};O.shadowMap.type=($=G[w])!=null?$:xh}else vn.obj(w)&&Object.assign(O.shadowMap,w);(W!==O.shadowMap.enabled||Y!==O.shadowMap.type)&&(O.shadowMap.needsUpdate=!0)}const U=rI();U&&("enabled"in U?U.enabled=!b:"legacyMode"in U&&(U.legacyMode=b)),c||ro(O,{outputEncoding:x?3e3:3001,toneMapping:_?ns:tx}),j.legacy!==b&&j.set(()=>({legacy:b})),j.linear!==x&&j.set(()=>({linear:x})),j.flat!==_&&j.set(()=>({flat:_})),p&&!vn.fun(p)&&!hI(p)&&!vn.equ(p,O,Vc)&&ro(O,p),y&&!j.events.handlers&&j.set({events:y(s)});const H=x8(n,m);return vn.equ(H,j.size,Vc)||j.setSize(H.width,H.height,H.updateStyle,H.top,H.left),C&&j.viewport.dpr!==lI(C)&&j.setDpr(C),j.frameloop!==N&&j.setFrameloop(N),j.onPointerMissed||j.set({onPointerMissed:R}),I&&!vn.equ(I,j.performance,Vc)&&j.set(W=>({performance:{...W.performance,...I}})),o=S,c=!0,this},render(f){return c||this.configure(),sf.updateContainer(l.jsx(v8,{store:s,children:f,onCreated:o,rootElement:n}),a,null,()=>{}),s},unmount(){pI(n)}}}function v8({store:n,children:e,onCreated:t,rootElement:r}){return Bf(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),l.jsx(eS.Provider,{value:n,children:e})}function pI(n,e){const t=Xu.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),sf.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,a,o,c;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=i.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(c=i.gl)!=null&&c.xr&&i.xr.disconnect(),a8(i),Xu.delete(n)}catch{}},500)})}}function _8(n,e,t){return l.jsx(b8,{children:n,container:e,state:t},e.uuid)}function b8({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,a=tS(),[o]=F.useState(()=>new Kw),[c]=F.useState(()=>new Te),u=F.useCallback((p,m)=>{const g={...p};Object.keys(p).forEach(S=>{(u8.includes(S)||p[S]!==m[S]&&m[S])&&delete g[S]});let y;if(m&&i){const S=m.camera;y=p.viewport.getCurrentViewport(S,new X,i),S!==p.camera&&uI(S,i)}return{...g,scene:t,raycaster:o,pointer:c,mouse:c,previousRoot:a,events:{...p.events,...m==null?void 0:m.events,...r},size:{...p.size,...i},viewport:{...p.viewport,...y},...s}},[n]),[f]=F.useState(()=>{const p=a.getState();return qR((g,y)=>({...p,scene:t,raycaster:o,pointer:c,mouse:c,previousRoot:a,events:{...p.events,...r},size:{...p.size,...i},...s,set:g,get:y,setEvents:S=>g(w=>({...w,events:{...w.events,...S}}))}))});return F.useEffect(()=>{const p=a.subscribe(m=>f.setState(g=>u(m,g)));return()=>{p()}},[u]),F.useEffect(()=>{f.setState(p=>u(a.getState(),p))},[u]),F.useEffect(()=>()=>{f.destroy()},[]),l.jsx(l.Fragment,{children:sf.createPortal(l.jsx(eS.Provider,{value:f,children:e}),f,null)})}sf.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:F.version});const v_={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function w8(n){const{handlePointer:e}=c8(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(v_).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(a=>({events:{...a.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([a,o])=>{const[c,u]=v_[a];t.addEventListener(c,o,{passive:u})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,a])=>{if(r&&r.connected instanceof HTMLElement){const[o]=v_[s];r.connected.removeEventListener(o,a)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function t2(n,e){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...r),e)}}function S8({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=F.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=F.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=n?typeof n=="number"?n:n.scroll:null,u=n?typeof n=="number"?n:n.resize:null,f=F.useRef(!1);F.useEffect(()=>(f.current=!0,()=>void(f.current=!1)));const[p,m,g]=F.useMemo(()=>{const x=()=>{if(!o.current.element)return;const{left:_,top:b,width:M,height:N,bottom:C,right:I,x:P,y:T}=o.current.element.getBoundingClientRect(),R={left:_,top:b,width:M,height:N,bottom:C,right:I,x:P,y:T};o.current.element instanceof HTMLElement&&r&&(R.height=o.current.element.offsetHeight,R.width=o.current.element.offsetWidth),Object.freeze(R),f.current&&!E8(o.current.lastBounds,R)&&a(o.current.lastBounds=R)};return[x,u?t2(x,u):x,c?t2(x,c):x]},[a,r,c,u]);function y(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(x=>x.removeEventListener("scroll",g,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function S(){o.current.element&&(o.current.resizeObserver=new i(g),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(x=>x.addEventListener("scroll",g,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{g()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const w=x=>{!x||x===o.current.element||(y(),o.current.element=x,o.current.scrollContainers=mI(x),S())};return M8(g,!!e),A8(m),F.useEffect(()=>{y(),S()},[e,g,m]),F.useEffect(()=>y,[]),[w,s,p]}function A8(n){F.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function M8(n,e){F.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function mI(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...mI(n.parentElement)]}const C8=["x","y","top","bottom","left","right","width","height"],E8=(n,e)=>C8.every(t=>n[t]===e[t]);var T8=Object.defineProperty,N8=Object.defineProperties,R8=Object.getOwnPropertyDescriptors,n2=Object.getOwnPropertySymbols,I8=Object.prototype.hasOwnProperty,P8=Object.prototype.propertyIsEnumerable,r2=(n,e,t)=>e in n?T8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,i2=(n,e)=>{for(var t in e||(e={}))I8.call(e,t)&&r2(n,t,e[t]);if(n2)for(var t of n2(e))P8.call(e,t)&&r2(n,t,e[t]);return n},B8=(n,e)=>N8(n,R8(e)),s2,a2;typeof window<"u"&&((s2=window.document)!=null&&s2.createElement||((a2=window.navigator)==null?void 0:a2.product)==="ReactNative")?F.useLayoutEffect:F.useEffect;function gI(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=gI(r,e,t);if(i)return i;r=r.sibling}}function xI(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const o2=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=o2;return}return o2.apply(this,arguments)};const nS=xI(F.createContext(null));class yI extends F.Component{render(){return F.createElement(nS.Provider,{value:this._reactInternals},this.props.children)}}function L8(){const n=F.useContext(nS);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=F.useId();return F.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=gI(r,!1,s=>{let a=s.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(i)return i}},[n,e])}function D8(){const n=L8(),[e]=F.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==nS&&!e.has(i)&&e.set(i,F.useContext(xI(i)))}t=t.return}return e}function F8(){const n=D8();return F.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>F.createElement(e,null,F.createElement(t.Provider,B8(i2({},r),{value:n.get(t)}))),e=>F.createElement(yI,i2({},e))),[n])}const k8=F.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:a=w8,eventSource:o,eventPrefix:c,shadows:u,linear:f,flat:p,legacy:m,orthographic:g,frameloop:y,dpr:S,performance:w,raycaster:x,camera:_,scene:b,onPointerMissed:M,onCreated:N,...C},I){F.useMemo(()=>$w(GG),[]);const P=F8(),[T,R]=S8({scroll:!0,debounce:{scroll:50,resize:0},...r}),j=F.useRef(null),O=F.useRef(null);F.useImperativeHandle(I,()=>j.current);const k=sI(M),[Z,te]=F.useState(!1),[K,$]=F.useState(!1);if(Z)throw Z;if(K)throw K;const U=F.useRef(null);Bf(()=>{const W=j.current;R.width>0&&R.height>0&&W&&(U.current||(U.current=y8(W)),U.current.configure({gl:s,events:a,shadows:u,linear:f,flat:p,legacy:m,orthographic:g,frameloop:y,dpr:S,performance:w,raycaster:x,camera:_,scene:b,size:R,onPointerMissed:(...Y)=>k.current==null?void 0:k.current(...Y),onCreated:Y=>{Y.events.connect==null||Y.events.connect(o?n8(o)?o.current:o:O.current),c&&Y.setEvents({compute:(G,de)=>{const Ce=G[c+"X"],be=G[c+"Y"];de.pointer.set(Ce/de.size.width*2-1,-(be/de.size.height)*2+1),de.raycaster.setFromCamera(de.pointer,de.camera)}}),N==null||N(Y)}}),U.current.render(l.jsx(P,{children:l.jsx(aI,{set:$,children:l.jsx(F.Suspense,{fallback:l.jsx(r8,{set:te}),children:e??null})})})))}),F.useEffect(()=>{const W=j.current;if(W)return()=>pI(W)},[]);const H=o?"none":"auto";return l.jsx("div",{ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:H,...i},...C,children:l.jsx("div",{ref:T,style:{width:"100%",height:"100%"},children:l.jsx("canvas",{ref:j,style:{display:"block"},children:t})})})}),j8=F.forwardRef(function(e,t){return l.jsx(yI,{children:l.jsx(k8,{...e,ref:t})})});function Lo(){return Lo=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Lo.apply(null,arguments)}const Lf=new X,rS=new X,U8=new X,l2=new Te;function O8(n,e,t){const r=Lf.setFromMatrixPosition(n.matrixWorld);r.project(e);const i=t.width/2,s=t.height/2;return[r.x*i+i,-(r.y*s)+s]}function z8(n,e){const t=Lf.setFromMatrixPosition(n.matrixWorld),r=rS.setFromMatrixPosition(e.matrixWorld),i=t.sub(r),s=e.getWorldDirection(U8);return i.angleTo(s)>Math.PI/2}function H8(n,e,t,r){const i=Lf.setFromMatrixPosition(n.matrixWorld),s=i.clone();s.project(e),l2.set(s.x,s.y),t.setFromCamera(l2,e);const a=t.intersectObjects(r,!0);if(a.length){const o=a[0].distance;return i.distanceTo(t.ray.origin)<o}return!0}function G8(n,e){if(e instanceof Bi)return e.zoom;if(e instanceof Cn){const t=Lf.setFromMatrixPosition(n.matrixWorld),r=rS.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=t.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}else return 1}function V8(n,e,t){if(e instanceof Cn||e instanceof Bi){const r=Lf.setFromMatrixPosition(n.matrixWorld),i=rS.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(i),a=(t[1]-t[0])/(e.far-e.near),o=t[1]-a*e.far;return Math.round(a*s+o)}}const Y1=n=>Math.abs(n)<1e-10?0:n;function vI(n,e,t=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=Y1(e[i]*n.elements[i])+(i!==15?",":")");return t+r}const W8=(n=>e=>vI(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),X8=(n=>(e,t)=>vI(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function J8(n){return n&&typeof n=="object"&&"current"in n}const Y8=F.forwardRef(({children:n,eps:e=.001,style:t,className:r,prepend:i,center:s,fullscreen:a,portal:o,distanceFactor:c,sprite:u=!1,transform:f=!1,occlude:p,onOcclude:m,castShadow:g,receiveShadow:y,material:S,geometry:w,zIndexRange:x=[16777271,0],calculatePosition:_=O8,as:b="div",wrapperClass:M,pointerEvents:N="auto",...C},I)=>{const{gl:P,camera:T,scene:R,size:j,raycaster:O,events:k,viewport:Z}=Zr(),[te]=F.useState(()=>document.createElement(b)),K=F.useRef(),$=F.useRef(null),U=F.useRef(0),H=F.useRef([0,0]),W=F.useRef(null),Y=F.useRef(null),G=(o==null?void 0:o.current)||k.connected||P.domElement.parentNode,de=F.useRef(null),Ce=F.useRef(!1),be=F.useMemo(()=>p&&p!=="blending"||Array.isArray(p)&&p.length&&J8(p[0]),[p]);F.useLayoutEffect(()=>{const qe=P.domElement;p&&p==="blending"?(qe.style.zIndex=`${Math.floor(x[0]/2)}`,qe.style.position="absolute",qe.style.pointerEvents="none"):(qe.style.zIndex=null,qe.style.position=null,qe.style.pointerEvents=null)},[p]),F.useLayoutEffect(()=>{if($.current){const qe=K.current=BN(te);if(R.updateMatrixWorld(),f)te.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const lt=_($.current,T,j);te.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${lt[0]}px,${lt[1]}px,0);transform-origin:0 0;`}return G&&(i?G.prepend(te):G.appendChild(te)),()=>{G&&G.removeChild(te),qe.unmount()}}},[G,f]),F.useLayoutEffect(()=>{M&&(te.className=M)},[M]);const se=F.useMemo(()=>f?{position:"absolute",top:0,left:0,width:j.width,height:j.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...a&&{top:-j.height/2,left:-j.width/2,width:j.width,height:j.height},...t},[t,s,a,j,f]),_e=F.useMemo(()=>({position:"absolute",pointerEvents:N}),[N]);F.useLayoutEffect(()=>{if(Ce.current=!1,f){var qe;(qe=K.current)==null||qe.render(F.createElement("div",{ref:W,style:se},F.createElement("div",{ref:Y,style:_e},F.createElement("div",{ref:I,className:r,style:t,children:n}))))}else{var lt;(lt=K.current)==null||lt.render(F.createElement("div",{ref:I,style:se,className:r,children:n}))}});const Le=F.useRef(!0);kx(qe=>{if($.current){T.updateMatrixWorld(),$.current.updateWorldMatrix(!0,!1);const lt=f?H.current:_($.current,T,j);if(f||Math.abs(U.current-T.zoom)>e||Math.abs(H.current[0]-lt[0])>e||Math.abs(H.current[1]-lt[1])>e){const kt=z8($.current,T);let it=!1;be&&(Array.isArray(p)?it=p.map(Ye=>Ye.current):p!=="blending"&&(it=[R]));const Me=Le.current;if(it){const Ye=H8($.current,T,O,it);Le.current=Ye&&!kt}else Le.current=!kt;Me!==Le.current&&(m?m(!Le.current):te.style.display=Le.current?"block":"none");const Be=Math.floor(x[0]/2),Ie=p?be?[x[0],Be]:[Be-1,0]:x;if(te.style.zIndex=`${V8($.current,T,Ie)}`,f){const[Ye,Q]=[j.width/2,j.height/2],vt=T.projectionMatrix.elements[5]*Q,{isOrthographicCamera:et,top:Ct,left:Ge,bottom:J,right:L}=T,q=W8(T.matrixWorldInverse),pe=et?`scale(${vt})translate(${Y1(-(L+Ge)/2)}px,${Y1((Ct+J)/2)}px)`:`translateZ(${vt}px)`;let ve=$.current.matrixWorld;u&&(ve=T.matrixWorldInverse.clone().transpose().copyPosition(ve).scale($.current.scale),ve.elements[3]=ve.elements[7]=ve.elements[11]=0,ve.elements[15]=1),te.style.width=j.width+"px",te.style.height=j.height+"px",te.style.perspective=et?"":`${vt}px`,W.current&&Y.current&&(W.current.style.transform=`${pe}${q}translate(${Ye}px,${Q}px)`,Y.current.style.transform=X8(ve,1/((c||10)/400)))}else{const Ye=c===void 0?1:G8($.current,T)*c;te.style.transform=`translate3d(${lt[0]}px,${lt[1]}px,0) scale(${Ye})`}H.current=lt,U.current=T.zoom}}if(!be&&de.current&&!Ce.current)if(f){if(W.current){const lt=W.current.children[0];if(lt!=null&&lt.clientWidth&&lt!=null&&lt.clientHeight){const{isOrthographicCamera:kt}=T;if(kt||w)C.scale&&(Array.isArray(C.scale)?C.scale instanceof X?de.current.scale.copy(C.scale.clone().divideScalar(1)):de.current.scale.set(1/C.scale[0],1/C.scale[1],1/C.scale[2]):de.current.scale.setScalar(1/C.scale));else{const it=(c||10)/400,Me=lt.clientWidth*it,Be=lt.clientHeight*it;de.current.scale.set(Me,Be,1)}Ce.current=!0}}}else{const lt=te.children[0];if(lt!=null&&lt.clientWidth&&lt!=null&&lt.clientHeight){const kt=1/Z.factor,it=lt.clientWidth*kt,Me=lt.clientHeight*kt;de.current.scale.set(it,Me,1),Ce.current=!0}de.current.lookAt(qe.camera.position)}});const yt=F.useMemo(()=>({vertexShader:f?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[f]);return F.createElement("group",Lo({},C,{ref:$}),p&&!be&&F.createElement("mesh",{castShadow:g,receiveShadow:y,ref:de},w||F.createElement("planeGeometry",null),S||F.createElement("shaderMaterial",{side:Ti,vertexShader:yt.vertexShader,fragmentShader:yt.fragmentShader})))}),c2=n=>{let e;const t=new Set,r=(u,f)=>{const p=typeof u=="function"?u(e):u;if(!Object.is(p,e)){const m=e;e=f??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(g=>g(e,m))}},i=()=>e,o={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(t.add(u),()=>t.delete(u))},c=e=n(r,i,o);return o},K8=n=>n?c2(n):c2,Z8=n=>n;function q8(n,e=Z8){const t=Ys.useSyncExternalStore(n.subscribe,Ys.useCallback(()=>e(n.getState()),[n,e]),Ys.useCallback(()=>e(n.getInitialState()),[n,e]));return Ys.useDebugValue(t),t}const u2=n=>{const e=K8(n),t=r=>q8(e,r);return Object.assign(t,e),t},Q8=n=>n?u2(n):u2;let Kd=0;const $8=Q8(n=>(cu.onStart=(e,t,r)=>{n({active:!0,item:e,loaded:t,total:r,progress:(t-Kd)/(r-Kd)*100})},cu.onLoad=()=>{n({active:!1})},cu.onError=e=>n(t=>({errors:[...t.errors,e]})),cu.onProgress=(e,t,r)=>{t===r&&(Kd=r),n({active:!0,item:e,loaded:t,total:r,progress:(t-Kd)/(r-Kd)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),iS=parseInt(td.replace(/\D+/g,""));function d2(n,e){if(e===O3)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===w0||e===fw){let t=n.getIndex();if(t===null){const a=[],o=n.getAttribute("position");if(o!==void 0){for(let c=0;c<o.count;c++)a.push(c);n.setIndex(a),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(t)if(e===w0)for(let a=1;a<=r;a++)i.push(t.getX(0)),i.push(t.getX(a)),i.push(t.getX(a+1));else for(let a=0;a<r;a++)a%2===0?(i.push(t.getX(a)),i.push(t.getX(a+1)),i.push(t.getX(a+2))):(i.push(t.getX(a+2)),i.push(t.getX(a+1)),i.push(t.getX(a)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}var Qi=Uint8Array,mo=Uint16Array,K1=Uint32Array,_I=new Qi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bI=new Qi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),e9=new Qi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wI=function(n,e){for(var t=new mo(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new K1(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},SI=wI(_I,2),AI=SI[0],t9=SI[1];AI[28]=258,t9[258]=28;var n9=wI(bI,0),r9=n9[0],Z1=new mo(32768);for(var wn=0;wn<32768;++wn){var $a=(wn&43690)>>>1|(wn&21845)<<1;$a=($a&52428)>>>2|($a&13107)<<2,$a=($a&61680)>>>4|($a&3855)<<4,Z1[wn]=(($a&65280)>>>8|($a&255)<<8)>>>1}var Mh=function(n,e,t){for(var r=n.length,i=0,s=new mo(e);i<r;++i)++s[n[i]-1];var a=new mo(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(t){o=new mo(1<<e);var c=15-e;for(i=0;i<r;++i)if(n[i])for(var u=i<<4|n[i],f=e-n[i],p=a[n[i]-1]++<<f,m=p|(1<<f)-1;p<=m;++p)o[Z1[p]>>>c]=u}else for(o=new mo(r),i=0;i<r;++i)n[i]&&(o[i]=Z1[a[n[i]-1]++]>>>15-n[i]);return o},Df=new Qi(288);for(var wn=0;wn<144;++wn)Df[wn]=8;for(var wn=144;wn<256;++wn)Df[wn]=9;for(var wn=256;wn<280;++wn)Df[wn]=7;for(var wn=280;wn<288;++wn)Df[wn]=8;var MI=new Qi(32);for(var wn=0;wn<32;++wn)MI[wn]=5;var i9=Mh(Df,9,1),s9=Mh(MI,5,1),__=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},gs=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},b_=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},a9=function(n){return(n/8|0)+(n&7&&1)},o9=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof mo?mo:n instanceof K1?K1:Qi)(t-e);return r.set(n.subarray(e,t)),r},l9=function(n,e,t){var r=n.length;if(!r||t&&!t.l&&r<5)return e||new Qi(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new Qi(r*3));var a=function(se){var _e=e.length;if(se>_e){var Le=new Qi(Math.max(_e*2,se));Le.set(e),e=Le}},o=t.f||0,c=t.p||0,u=t.b||0,f=t.l,p=t.d,m=t.m,g=t.n,y=r*8;do{if(!f){t.f=o=gs(n,c,1);var S=gs(n,c+1,3);if(c+=3,S)if(S==1)f=i9,p=s9,m=9,g=5;else if(S==2){var b=gs(n,c,31)+257,M=gs(n,c+10,15)+4,N=b+gs(n,c+5,31)+1;c+=14;for(var C=new Qi(N),I=new Qi(19),P=0;P<M;++P)I[e9[P]]=gs(n,c+P*3,7);c+=M*3;for(var T=__(I),R=(1<<T)-1,j=Mh(I,T,1),P=0;P<N;){var O=j[gs(n,c,R)];c+=O&15;var w=O>>>4;if(w<16)C[P++]=w;else{var k=0,Z=0;for(w==16?(Z=3+gs(n,c,3),c+=2,k=C[P-1]):w==17?(Z=3+gs(n,c,7),c+=3):w==18&&(Z=11+gs(n,c,127),c+=7);Z--;)C[P++]=k}}var te=C.subarray(0,b),K=C.subarray(b);m=__(te),g=__(K),f=Mh(te,m,1),p=Mh(K,g,1)}else throw"invalid block type";else{var w=a9(c)+4,x=n[w-4]|n[w-3]<<8,_=w+x;if(_>r){if(s)throw"unexpected EOF";break}i&&a(u+x),e.set(n.subarray(w,_),u),t.b=u+=x,t.p=c=_*8;continue}if(c>y){if(s)throw"unexpected EOF";break}}i&&a(u+131072);for(var $=(1<<m)-1,U=(1<<g)-1,H=c;;H=c){var k=f[b_(n,c)&$],W=k>>>4;if(c+=k&15,c>y){if(s)throw"unexpected EOF";break}if(!k)throw"invalid length/literal";if(W<256)e[u++]=W;else if(W==256){H=c,f=null;break}else{var Y=W-254;if(W>264){var P=W-257,G=_I[P];Y=gs(n,c,(1<<G)-1)+AI[P],c+=G}var de=p[b_(n,c)&U],Ce=de>>>4;if(!de)throw"invalid distance";c+=de&15;var K=r9[Ce];if(Ce>3){var G=bI[Ce];K+=b_(n,c)&(1<<G)-1,c+=G}if(c>y){if(s)throw"unexpected EOF";break}i&&a(u+131072);for(var be=u+Y;u<be;u+=4)e[u]=e[u-K],e[u+1]=e[u+1-K],e[u+2]=e[u+2-K],e[u+3]=e[u+3-K];u=be}}t.l=f,t.p=H,t.b=u,f&&(o=1,t.m=m,t.d=p,t.n=g)}while(!o);return u==e.length?e:o9(e,0,u)},c9=new Qi(0),u9=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Fm(n,e){return l9((u9(n),n.subarray(2,-4)),e)}var d9=typeof TextDecoder<"u"&&new TextDecoder,h9=0;try{d9.decode(c9,{stream:!0}),h9=1}catch{}const f9=n=>n&&n.isCubeTexture;class p9 extends Tn{constructor(e,t){var r,i;const s=f9(e),o=((i=s?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?i:1024)/4,c=Math.floor(Math.log2(o)),u=Math.pow(2,c),f=3*Math.max(u,16*7),p=4*u,m=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/f}`,`#define CUBEUV_TEXEL_HEIGHT ${1/p}`,`#define CUBEUV_MAX_MIP ${c}.0`],g=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,y=m.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${iS>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,S={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},w=new Nf(1,16),x=new Hr({uniforms:S,fragmentShader:y,vertexShader:g,side:Ti});super(w,x)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var m9=Object.defineProperty,g9=(n,e,t)=>e in n?m9(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,x9=(n,e,t)=>(g9(n,e+"",t),t);class y9{constructor(){x9(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}var v9=Object.defineProperty,_9=(n,e,t)=>e in n?v9(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Lt=(n,e,t)=>(_9(n,typeof e!="symbol"?e+"":e,t),t);const km=new rc,h2=new Xs,b9=Math.cos(70*(Math.PI/180)),f2=(n,e)=>(n%e+e)%e;let w9=class extends y9{constructor(e,t){super(),Lt(this,"object"),Lt(this,"domElement"),Lt(this,"enabled",!0),Lt(this,"target",new X),Lt(this,"minDistance",0),Lt(this,"maxDistance",1/0),Lt(this,"minZoom",0),Lt(this,"maxZoom",1/0),Lt(this,"minPolarAngle",0),Lt(this,"maxPolarAngle",Math.PI),Lt(this,"minAzimuthAngle",-1/0),Lt(this,"maxAzimuthAngle",1/0),Lt(this,"enableDamping",!1),Lt(this,"dampingFactor",.05),Lt(this,"enableZoom",!0),Lt(this,"zoomSpeed",1),Lt(this,"enableRotate",!0),Lt(this,"rotateSpeed",1),Lt(this,"enablePan",!0),Lt(this,"panSpeed",1),Lt(this,"screenSpacePanning",!0),Lt(this,"keyPanSpeed",7),Lt(this,"zoomToCursor",!1),Lt(this,"autoRotate",!1),Lt(this,"autoRotateSpeed",2),Lt(this,"reverseOrbit",!1),Lt(this,"reverseHorizontalOrbit",!1),Lt(this,"reverseVerticalOrbit",!1),Lt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Lt(this,"mouseButtons",{LEFT:xl.ROTATE,MIDDLE:xl.DOLLY,RIGHT:xl.PAN}),Lt(this,"touches",{ONE:yl.ROTATE,TWO:yl.DOLLY_PAN}),Lt(this,"target0"),Lt(this,"position0"),Lt(this,"zoom0"),Lt(this,"_domElementKeyEvents",null),Lt(this,"getPolarAngle"),Lt(this,"getAzimuthalAngle"),Lt(this,"setPolarAngle"),Lt(this,"setAzimuthalAngle"),Lt(this,"getDistance"),Lt(this,"getZoomScale"),Lt(this,"listenToKeyEvents"),Lt(this,"stopListenToKeyEvents"),Lt(this,"saveState"),Lt(this,"reset"),Lt(this,"update"),Lt(this,"connect"),Lt(this,"dispose"),Lt(this,"dollyIn"),Lt(this,"dollyOut"),Lt(this,"getScale"),Lt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=re=>{let fe=f2(re,2*Math.PI),ke=f.phi;ke<0&&(ke+=2*Math.PI),fe<0&&(fe+=2*Math.PI);let ie=Math.abs(fe-ke);2*Math.PI-ie<ie&&(fe<ke?fe+=2*Math.PI:ke+=2*Math.PI),p.phi=fe-ke,r.update()},this.setAzimuthalAngle=re=>{let fe=f2(re,2*Math.PI),ke=f.theta;ke<0&&(ke+=2*Math.PI),fe<0&&(fe+=2*Math.PI);let ie=Math.abs(fe-ke);2*Math.PI-ie<ie&&(fe<ke?fe+=2*Math.PI:ke+=2*Math.PI),p.theta=fe-ke,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=re=>{re.addEventListener("keydown",ge),this._domElementKeyEvents=re},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ge),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),c=o.NONE},this.update=(()=>{const re=new X,fe=new X(0,1,0),ke=new vr().setFromUnitVectors(e.up,fe),ie=ke.clone().invert(),me=new X,je=new vr,at=2*Math.PI;return function(){const Re=r.object.position;ke.setFromUnitVectors(e.up,fe),ie.copy(ke).invert(),re.copy(Re).sub(r.target),re.applyQuaternion(ke),f.setFromVector3(re),r.autoRotate&&c===o.NONE&&Z(O()),r.enableDamping?(f.theta+=p.theta*r.dampingFactor,f.phi+=p.phi*r.dampingFactor):(f.theta+=p.theta,f.phi+=p.phi);let Ve=r.minAzimuthAngle,Tt=r.maxAzimuthAngle;isFinite(Ve)&&isFinite(Tt)&&(Ve<-Math.PI?Ve+=at:Ve>Math.PI&&(Ve-=at),Tt<-Math.PI?Tt+=at:Tt>Math.PI&&(Tt-=at),Ve<=Tt?f.theta=Math.max(Ve,Math.min(Tt,f.theta)):f.theta=f.theta>(Ve+Tt)/2?Math.max(Ve,f.theta):Math.min(Tt,f.theta)),f.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,f.phi)),f.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(g,r.dampingFactor):r.target.add(g),r.zoomToCursor&&T||r.object.isOrthographicCamera?f.radius=de(f.radius):f.radius=de(f.radius*m),re.setFromSpherical(f),re.applyQuaternion(ie),Re.copy(r.target).add(re),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,g.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),g.set(0,0,0));let Qt=!1;if(r.zoomToCursor&&T){let Jt=null;if(r.object instanceof Cn&&r.object.isPerspectiveCamera){const Gn=re.length();Jt=de(Gn*m);const cr=Gn-Jt;r.object.position.addScaledVector(I,cr),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const Gn=new X(P.x,P.y,0);Gn.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix(),Qt=!0;const cr=new X(P.x,P.y,0);cr.unproject(r.object),r.object.position.sub(cr).add(Gn),r.object.updateMatrixWorld(),Jt=re.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Jt!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Jt).add(r.object.position):(km.origin.copy(r.object.position),km.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(km.direction))<b9?e.lookAt(r.target):(h2.setFromNormalAndCoplanarPoint(r.object.up,r.target),km.intersectPlane(h2,r.target))))}else r.object instanceof Bi&&r.object.isOrthographicCamera&&(Qt=m!==1,Qt&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix()));return m=1,T=!1,Qt||me.distanceToSquared(r.object.position)>u||8*(1-je.dot(r.object.quaternion))>u?(r.dispatchEvent(i),me.copy(r.object.position),je.copy(r.object.quaternion),Qt=!1,!0):!1}})(),this.connect=re=>{r.domElement=re,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",dt),r.domElement.addEventListener("pointerdown",Ge),r.domElement.addEventListener("pointercancel",L),r.domElement.addEventListener("wheel",ve)},this.dispose=()=>{var re,fe,ke,ie,me,je;r.domElement&&(r.domElement.style.touchAction="auto"),(re=r.domElement)==null||re.removeEventListener("contextmenu",dt),(fe=r.domElement)==null||fe.removeEventListener("pointerdown",Ge),(ke=r.domElement)==null||ke.removeEventListener("pointercancel",L),(ie=r.domElement)==null||ie.removeEventListener("wheel",ve),(me=r.domElement)==null||me.ownerDocument.removeEventListener("pointermove",J),(je=r.domElement)==null||je.ownerDocument.removeEventListener("pointerup",L),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",ge)};const r=this,i={type:"change"},s={type:"start"},a={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=o.NONE;const u=1e-6,f=new z1,p=new z1;let m=1;const g=new X,y=new Te,S=new Te,w=new Te,x=new Te,_=new Te,b=new Te,M=new Te,N=new Te,C=new Te,I=new X,P=new Te;let T=!1;const R=[],j={};function O(){return 2*Math.PI/60/60*r.autoRotateSpeed}function k(){return Math.pow(.95,r.zoomSpeed)}function Z(re){r.reverseOrbit||r.reverseHorizontalOrbit?p.theta+=re:p.theta-=re}function te(re){r.reverseOrbit||r.reverseVerticalOrbit?p.phi+=re:p.phi-=re}const K=(()=>{const re=new X;return function(ke,ie){re.setFromMatrixColumn(ie,0),re.multiplyScalar(-ke),g.add(re)}})(),$=(()=>{const re=new X;return function(ke,ie){r.screenSpacePanning===!0?re.setFromMatrixColumn(ie,1):(re.setFromMatrixColumn(ie,0),re.crossVectors(r.object.up,re)),re.multiplyScalar(ke),g.add(re)}})(),U=(()=>{const re=new X;return function(ke,ie){const me=r.domElement;if(me&&r.object instanceof Cn&&r.object.isPerspectiveCamera){const je=r.object.position;re.copy(je).sub(r.target);let at=re.length();at*=Math.tan(r.object.fov/2*Math.PI/180),K(2*ke*at/me.clientHeight,r.object.matrix),$(2*ie*at/me.clientHeight,r.object.matrix)}else me&&r.object instanceof Bi&&r.object.isOrthographicCamera?(K(ke*(r.object.right-r.object.left)/r.object.zoom/me.clientWidth,r.object.matrix),$(ie*(r.object.top-r.object.bottom)/r.object.zoom/me.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function H(re){r.object instanceof Cn&&r.object.isPerspectiveCamera||r.object instanceof Bi&&r.object.isOrthographicCamera?m=re:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function W(re){H(m/re)}function Y(re){H(m*re)}function G(re){if(!r.zoomToCursor||!r.domElement)return;T=!0;const fe=r.domElement.getBoundingClientRect(),ke=re.clientX-fe.left,ie=re.clientY-fe.top,me=fe.width,je=fe.height;P.x=ke/me*2-1,P.y=-(ie/je)*2+1,I.set(P.x,P.y,1).unproject(r.object).sub(r.object.position).normalize()}function de(re){return Math.max(r.minDistance,Math.min(r.maxDistance,re))}function Ce(re){y.set(re.clientX,re.clientY)}function be(re){G(re),M.set(re.clientX,re.clientY)}function se(re){x.set(re.clientX,re.clientY)}function _e(re){S.set(re.clientX,re.clientY),w.subVectors(S,y).multiplyScalar(r.rotateSpeed);const fe=r.domElement;fe&&(Z(2*Math.PI*w.x/fe.clientHeight),te(2*Math.PI*w.y/fe.clientHeight)),y.copy(S),r.update()}function Le(re){N.set(re.clientX,re.clientY),C.subVectors(N,M),C.y>0?W(k()):C.y<0&&Y(k()),M.copy(N),r.update()}function yt(re){_.set(re.clientX,re.clientY),b.subVectors(_,x).multiplyScalar(r.panSpeed),U(b.x,b.y),x.copy(_),r.update()}function qe(re){G(re),re.deltaY<0?Y(k()):re.deltaY>0&&W(k()),r.update()}function lt(re){let fe=!1;switch(re.code){case r.keys.UP:U(0,r.keyPanSpeed),fe=!0;break;case r.keys.BOTTOM:U(0,-r.keyPanSpeed),fe=!0;break;case r.keys.LEFT:U(r.keyPanSpeed,0),fe=!0;break;case r.keys.RIGHT:U(-r.keyPanSpeed,0),fe=!0;break}fe&&(re.preventDefault(),r.update())}function kt(){if(R.length==1)y.set(R[0].pageX,R[0].pageY);else{const re=.5*(R[0].pageX+R[1].pageX),fe=.5*(R[0].pageY+R[1].pageY);y.set(re,fe)}}function it(){if(R.length==1)x.set(R[0].pageX,R[0].pageY);else{const re=.5*(R[0].pageX+R[1].pageX),fe=.5*(R[0].pageY+R[1].pageY);x.set(re,fe)}}function Me(){const re=R[0].pageX-R[1].pageX,fe=R[0].pageY-R[1].pageY,ke=Math.sqrt(re*re+fe*fe);M.set(0,ke)}function Be(){r.enableZoom&&Me(),r.enablePan&&it()}function Ie(){r.enableZoom&&Me(),r.enableRotate&&kt()}function Ye(re){if(R.length==1)S.set(re.pageX,re.pageY);else{const ke=xt(re),ie=.5*(re.pageX+ke.x),me=.5*(re.pageY+ke.y);S.set(ie,me)}w.subVectors(S,y).multiplyScalar(r.rotateSpeed);const fe=r.domElement;fe&&(Z(2*Math.PI*w.x/fe.clientHeight),te(2*Math.PI*w.y/fe.clientHeight)),y.copy(S)}function Q(re){if(R.length==1)_.set(re.pageX,re.pageY);else{const fe=xt(re),ke=.5*(re.pageX+fe.x),ie=.5*(re.pageY+fe.y);_.set(ke,ie)}b.subVectors(_,x).multiplyScalar(r.panSpeed),U(b.x,b.y),x.copy(_)}function vt(re){const fe=xt(re),ke=re.pageX-fe.x,ie=re.pageY-fe.y,me=Math.sqrt(ke*ke+ie*ie);N.set(0,me),C.set(0,Math.pow(N.y/M.y,r.zoomSpeed)),W(C.y),M.copy(N)}function et(re){r.enableZoom&&vt(re),r.enablePan&&Q(re)}function Ct(re){r.enableZoom&&vt(re),r.enableRotate&&Ye(re)}function Ge(re){var fe,ke;r.enabled!==!1&&(R.length===0&&((fe=r.domElement)==null||fe.ownerDocument.addEventListener("pointermove",J),(ke=r.domElement)==null||ke.ownerDocument.addEventListener("pointerup",L)),_t(re),re.pointerType==="touch"?st(re):q(re))}function J(re){r.enabled!==!1&&(re.pointerType==="touch"?Ke(re):pe(re))}function L(re){var fe,ke,ie;Fe(re),R.length===0&&((fe=r.domElement)==null||fe.releasePointerCapture(re.pointerId),(ke=r.domElement)==null||ke.ownerDocument.removeEventListener("pointermove",J),(ie=r.domElement)==null||ie.ownerDocument.removeEventListener("pointerup",L)),r.dispatchEvent(a),c=o.NONE}function q(re){let fe;switch(re.button){case 0:fe=r.mouseButtons.LEFT;break;case 1:fe=r.mouseButtons.MIDDLE;break;case 2:fe=r.mouseButtons.RIGHT;break;default:fe=-1}switch(fe){case xl.DOLLY:if(r.enableZoom===!1)return;be(re),c=o.DOLLY;break;case xl.ROTATE:if(re.ctrlKey||re.metaKey||re.shiftKey){if(r.enablePan===!1)return;se(re),c=o.PAN}else{if(r.enableRotate===!1)return;Ce(re),c=o.ROTATE}break;case xl.PAN:if(re.ctrlKey||re.metaKey||re.shiftKey){if(r.enableRotate===!1)return;Ce(re),c=o.ROTATE}else{if(r.enablePan===!1)return;se(re),c=o.PAN}break;default:c=o.NONE}c!==o.NONE&&r.dispatchEvent(s)}function pe(re){if(r.enabled!==!1)switch(c){case o.ROTATE:if(r.enableRotate===!1)return;_e(re);break;case o.DOLLY:if(r.enableZoom===!1)return;Le(re);break;case o.PAN:if(r.enablePan===!1)return;yt(re);break}}function ve(re){r.enabled===!1||r.enableZoom===!1||c!==o.NONE&&c!==o.ROTATE||(re.preventDefault(),r.dispatchEvent(s),qe(re),r.dispatchEvent(a))}function ge(re){r.enabled===!1||r.enablePan===!1||lt(re)}function st(re){switch(He(re),R.length){case 1:switch(r.touches.ONE){case yl.ROTATE:if(r.enableRotate===!1)return;kt(),c=o.TOUCH_ROTATE;break;case yl.PAN:if(r.enablePan===!1)return;it(),c=o.TOUCH_PAN;break;default:c=o.NONE}break;case 2:switch(r.touches.TWO){case yl.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;Be(),c=o.TOUCH_DOLLY_PAN;break;case yl.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Ie(),c=o.TOUCH_DOLLY_ROTATE;break;default:c=o.NONE}break;default:c=o.NONE}c!==o.NONE&&r.dispatchEvent(s)}function Ke(re){switch(He(re),c){case o.TOUCH_ROTATE:if(r.enableRotate===!1)return;Ye(re),r.update();break;case o.TOUCH_PAN:if(r.enablePan===!1)return;Q(re),r.update();break;case o.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;et(re),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Ct(re),r.update();break;default:c=o.NONE}}function dt(re){r.enabled!==!1&&re.preventDefault()}function _t(re){R.push(re)}function Fe(re){delete j[re.pointerId];for(let fe=0;fe<R.length;fe++)if(R[fe].pointerId==re.pointerId){R.splice(fe,1);return}}function He(re){let fe=j[re.pointerId];fe===void 0&&(fe=new Te,j[re.pointerId]=fe),fe.set(re.pageX,re.pageY)}function xt(re){const fe=re.pointerId===R[0].pointerId?R[1]:R[0];return j[fe.pointerId]}this.dollyIn=(re=k())=>{Y(re),r.update()},this.dollyOut=(re=k())=>{W(re),r.update()},this.getScale=()=>m,this.setScale=re=>{H(re),r.update()},this.getZoomScale=()=>k(),t!==void 0&&this.connect(t),this.update()}};function E0(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,r=n.length;t<r;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Il="srgb",Ma="srgb-linear",p2=3001,S9=3e3;class sS extends Mr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new T9(t)}),this.register(function(t){return new N9(t)}),this.register(function(t){return new j9(t)}),this.register(function(t){return new U9(t)}),this.register(function(t){return new O9(t)}),this.register(function(t){return new I9(t)}),this.register(function(t){return new P9(t)}),this.register(function(t){return new B9(t)}),this.register(function(t){return new L9(t)}),this.register(function(t){return new E9(t)}),this.register(function(t){return new D9(t)}),this.register(function(t){return new R9(t)}),this.register(function(t){return new k9(t)}),this.register(function(t){return new F9(t)}),this.register(function(t){return new M9(t)}),this.register(function(t){return new z9(t)}),this.register(function(t){return new H9(t)})}load(e,t,r,i){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const u=Mo.extractUrlBase(e);a=Mo.resolveURL(u,this.path)}else a=Mo.extractUrlBase(e);this.manager.itemStart(e);const o=function(u){i?i(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},c=new Sr(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(u){try{s.parse(u,a,function(f){t(f),s.manager.itemEnd(e)},o)}catch(f){o(f)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const a={},o={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(E0(new Uint8Array(e.slice(0,4)))===CI){try{a[$t.KHR_BINARY_GLTF]=new G9(e)}catch(f){i&&i(f);return}s=JSON.parse(a[$t.KHR_BINARY_GLTF].content)}else s=JSON.parse(E0(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new nV(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const f=this.pluginCallbacks[u](c);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[f.name]=f,a[f.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const f=s.extensionsUsed[u],p=s.extensionsRequired||[];switch(f){case $t.KHR_MATERIALS_UNLIT:a[f]=new C9;break;case $t.KHR_DRACO_MESH_COMPRESSION:a[f]=new V9(s,this.dracoLoader);break;case $t.KHR_TEXTURE_TRANSFORM:a[f]=new W9;break;case $t.KHR_MESH_QUANTIZATION:a[f]=new X9;break;default:p.indexOf(f)>=0&&o[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}c.setExtensions(a),c.setPlugins(o),c.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}}function A9(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const $t={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class M9{constructor(e){this.parser=e,this.name=$t.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const f=new ut(16777215);c.color!==void 0&&f.setRGB(c.color[0],c.color[1],c.color[2],Ma);const p=c.range!==void 0?c.range:0;switch(c.type){case"directional":u=new Hw(f),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new zw(f),u.distance=p;break;case"spot":u=new Ow(f),u.distance=p,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,u.angle=c.spot.outerConeAngle,u.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return u.position.set(0,0,0),u.decay=2,ga(u,c),c.intensity!==void 0&&(u.intensity=c.intensity),u.name=t.createUniqueName(c.name||"light_"+e),i=Promise.resolve(u),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],o=(s.extensions&&s.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(c){return r._getNodeRef(t.cache,o,c)})}}class C9{constructor(){this.name=$t.KHR_MATERIALS_UNLIT}getMaterialType(){return pi}extendParams(e,t,r){const i=[];e.color=new ut(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],Ma),e.opacity=a[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,Il))}return Promise.all(i)}}class E9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class T9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Te(o,o)}return Promise.all(s)}}class N9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class R9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class I9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new ut(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=i.extensions[this.name];if(a.sheenColorFactor!==void 0){const o=a.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],Ma)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Il)),a.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class P9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class B9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=new ut().setRGB(o[0],o[1],o[2],Ma),Promise.all(s)}}class L9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class D9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=new ut().setRGB(o[0],o[1],o[2],Ma),a.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,Il)),Promise.all(s)}}class F9{constructor(e){this.parser=e,this.name=$t.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(r.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}}class k9{constructor(e){this.parser=e,this.name=$t.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:as}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class j9{constructor(e){this.parser=e,this.name=$t.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class U9{constructor(e){this.parser=e,this.name=$t.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=i.images[a.source];let c=r.textureLoader;if(o.uri){const u=r.options.manager.getHandler(o.uri);u!==null&&(c=u)}return this.detectSupport().then(function(u){if(u)return r.loadTextureImage(e,a.source,c);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class O9{constructor(e){this.parser=e,this.name=$t.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=i.images[a.source];let c=r.textureLoader;if(o.uri){const u=r.options.manager.getHandler(o.uri);u!==null&&(c=u)}return this.detectSupport().then(function(u){if(u)return r.loadTextureImage(e,a.source,c);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class z9{constructor(e){this.name=$t.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(o){const c=i.byteOffset||0,u=i.byteLength||0,f=i.count,p=i.byteStride,m=new Uint8Array(o,c,u);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(f,p,m,i.mode,i.filter).then(function(g){return g.buffer}):a.ready.then(function(){const g=new ArrayBuffer(f*p);return a.decodeGltfBuffer(new Uint8Array(g),f,p,m,i.mode,i.filter),g})})}else return null}}class H9{constructor(e){this.name=$t.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const u of i.primitives)if(u.mode!==Ki.TRIANGLES&&u.mode!==Ki.TRIANGLE_STRIP&&u.mode!==Ki.TRIANGLE_FAN&&u.mode!==void 0)return null;const a=r.extensions[this.name].attributes,o=[],c={};for(const u in a)o.push(this.parser.getDependency("accessor",a[u]).then(f=>(c[u]=f,c[u])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(u=>{const f=u.pop(),p=f.isGroup?f.children:[f],m=u[0].count,g=[];for(const y of p){const S=new Dt,w=new X,x=new vr,_=new X(1,1,1),b=new ww(y.geometry,y.material,m);for(let M=0;M<m;M++)c.TRANSLATION&&w.fromBufferAttribute(c.TRANSLATION,M),c.ROTATION&&x.fromBufferAttribute(c.ROTATION,M),c.SCALE&&_.fromBufferAttribute(c.SCALE,M),b.setMatrixAt(M,S.compose(w,x,_));for(const M in c)if(M==="_COLOR_0"){const N=c[M];b.instanceColor=new Yl(N.array,N.itemSize,N.normalized)}else M!=="TRANSLATION"&&M!=="ROTATION"&&M!=="SCALE"&&y.geometry.setAttribute(M,c[M]);sn.prototype.copy.call(b,y),this.parser.assignFinalMaterial(b),g.push(b)}return f.isGroup?(f.clear(),f.add(...g),f):g[0]}))}}const CI="glTF",Zd=12,m2={JSON:1313821514,BIN:5130562};class G9{constructor(e){this.name=$t.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Zd);if(this.header={magic:E0(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==CI)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Zd,i=new DataView(e,Zd);let s=0;for(;s<r;){const a=i.getUint32(s,!0);s+=4;const o=i.getUint32(s,!0);if(s+=4,o===m2.JSON){const c=new Uint8Array(e,Zd+s,a);this.content=E0(c)}else if(o===m2.BIN){const c=Zd+s;this.body=e.slice(c,c+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class V9{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=$t.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},c={},u={};for(const f in a){const p=q1[f]||f.toLowerCase();o[p]=a[f]}for(const f in e.attributes){const p=q1[f]||f.toLowerCase();if(a[f]!==void 0){const m=r.accessors[e.attributes[f]],g=_u[m.componentType];u[p]=g.name,c[p]=m.normalized===!0}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(p,m){i.decodeDracoFile(f,function(g){for(const y in g.attributes){const S=g.attributes[y],w=c[y];w!==void 0&&(S.normalized=w)}p(g)},o,u,Ma,m)})})}}class W9{constructor(){this.name=$t.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class X9{constructor(){this.name=$t.KHR_MESH_QUANTIZATION}}class EI extends id{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let a=0;a!==i;a++)t[a]=r[s+a];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=o*2,u=o*3,f=i-t,p=(r-t)/f,m=p*p,g=m*p,y=e*u,S=y-u,w=-2*g+3*m,x=g-m,_=1-w,b=x-m+p;for(let M=0;M!==o;M++){const N=a[S+M+o],C=a[S+M+c]*f,I=a[y+M+o],P=a[y+M]*f;s[M]=_*N+b*C+w*I+x*P}return s}}const J9=new vr;class Y9 extends EI{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return J9.fromArray(s).normalize().toArray(s),s}}const Ki={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},_u={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},g2={9728:Un,9729:en,9984:nx,9985:yu,9986:Ml,9987:es},x2={33071:Pn,33648:Lu,10497:Io},w_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},q1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...iS>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},eo={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},K9={CUBICSPLINE:void 0,LINEAR:ju,STEP:ku},S_={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Z9(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Pf({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Qs})),n.DefaultMaterial}function pl(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function ga(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function q9(n,e,t){let r=!1,i=!1,s=!1;for(let u=0,f=e.length;u<f;u++){const p=e[u];if(p.POSITION!==void 0&&(r=!0),p.NORMAL!==void 0&&(i=!0),p.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const a=[],o=[],c=[];for(let u=0,f=e.length;u<f;u++){const p=e[u];if(r){const m=p.POSITION!==void 0?t.getDependency("accessor",p.POSITION):n.attributes.position;a.push(m)}if(i){const m=p.NORMAL!==void 0?t.getDependency("accessor",p.NORMAL):n.attributes.normal;o.push(m)}if(s){const m=p.COLOR_0!==void 0?t.getDependency("accessor",p.COLOR_0):n.attributes.color;c.push(m)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(c)]).then(function(u){const f=u[0],p=u[1],m=u[2];return r&&(n.morphAttributes.position=f),i&&(n.morphAttributes.normal=p),s&&(n.morphAttributes.color=m),n.morphTargetsRelative=!0,n})}function Q9(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function $9(n){let e;const t=n.extensions&&n.extensions[$t.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+A_(t.attributes):e=n.indices+":"+A_(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+A_(n.targets[r]);return e}function A_(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function Q1(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function eV(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const tV=new Dt;class nV{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new A9,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&s<98?this.textureLoader=new IR(this.options.manager):this.textureLoader=new jR(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Sr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(a){const o={scene:a[0][i.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:i.asset,parser:r,userData:{}};return pl(s,o,i),ga(o,i),Promise.all(r._invokeAll(function(c){return c.afterRoot&&c.afterRoot(o)})).then(function(){for(const c of o.scenes)c.updateMatrixWorld();e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const a=t[i].joints;for(let o=0,c=a.length;o<c;o++)e[a[o]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const a=e[i];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(r[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(a,o)=>{const c=this.associations.get(a);c!=null&&this.associations.set(o,c);for(const[u,f]of a.children.entries())s(f,o.children[u])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,a){return r.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[$t.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,a){r.load(Mo.resolveURL(t.uri,i.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const a=w_[i.type],o=_u[i.componentType],c=i.normalized===!0,u=new o(i.count*a);return Promise.resolve(new ln(u,a,c))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(a){const o=a[0],c=w_[i.type],u=_u[i.componentType],f=u.BYTES_PER_ELEMENT,p=f*c,m=i.byteOffset||0,g=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,y=i.normalized===!0;let S,w;if(g&&g!==p){const x=Math.floor(m/g),_="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+x+":"+i.count;let b=t.cache.get(_);b||(S=new u(o,x*g,i.count*g/f),b=new Mf(S,g/f),t.cache.add(_,b)),w=new Bo(b,c,m%g/f,y)}else o===null?S=new u(i.count*c):S=new u(o,m,i.count*c),w=new ln(S,c,y);if(i.sparse!==void 0){const x=w_.SCALAR,_=_u[i.sparse.indices.componentType],b=i.sparse.indices.byteOffset||0,M=i.sparse.values.byteOffset||0,N=new _(a[1],b,i.sparse.count*x),C=new u(a[2],M,i.sparse.count*c);o!==null&&(w=new ln(w.array.slice(),w.itemSize,w.normalized));for(let I=0,P=N.length;I<P;I++){const T=N[I];if(w.setX(T,C[I*c]),c>=2&&w.setY(T,C[I*c+1]),c>=3&&w.setZ(T,C[I*c+2]),c>=4&&w.setW(T,C[I*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,a=t.images[s];let o=this.textureLoader;if(a.uri){const c=r.manager.getHandler(a.uri);c!==null&&(o=c)}return this.loadTextureImage(e,s,o)}loadTextureImage(e,t,r){const i=this,s=this.json,a=s.textures[e],o=s.images[t],c=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[c])return this.textureCache[c];const u=this.loadImageSource(t,r).then(function(f){f.flipY=!1,f.name=a.name||o.name||"",f.name===""&&typeof o.uri=="string"&&o.uri.startsWith("data:image/")===!1&&(f.name=o.uri);const m=(s.samplers||{})[a.sampler]||{};return f.magFilter=g2[m.magFilter]||en,f.minFilter=g2[m.minFilter]||es,f.wrapS=x2[m.wrapS]||Io,f.wrapT=x2[m.wrapT]||Io,i.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[c]=u,u}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(p=>p.clone());const a=i.images[e],o=self.URL||self.webkitURL;let c=a.uri||"",u=!1;if(a.bufferView!==void 0)c=r.getDependency("bufferView",a.bufferView).then(function(p){u=!0;const m=new Blob([p],{type:a.mimeType});return c=o.createObjectURL(m),c});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(c).then(function(p){return new Promise(function(m,g){let y=m;t.isImageBitmapLoader===!0&&(y=function(S){const w=new pn(S);w.needsUpdate=!0,m(w)}),t.load(Mo.resolveURL(p,s.path),y,void 0,g)})}).then(function(p){return u===!0&&o.revokeObjectURL(c),ga(p,a),p.userData.mimeType=a.mimeType||eV(a.uri),p}).catch(function(p){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),p});return this.sourceCache[e]=f,f}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(a){if(!a)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(a=a.clone(),a.channel=r.texCoord),s.extensions[$t.KHR_TEXTURE_TRANSFORM]){const o=r.extensions!==void 0?r.extensions[$t.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const c=s.associations.get(a);a=s.extensions[$t.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),s.associations.set(a,c)}}return i!==void 0&&(typeof i=="number"&&(i=i===p2?Il:Ma),"colorSpace"in a?a.colorSpace=i:a.encoding=i===Il?p2:S9),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+r.uuid;let c=this.cache.get(o);c||(c=new vx,ar.prototype.copy.call(c,r),c.color.copy(r.color),c.map=r.map,c.sizeAttenuation=!1,this.cache.add(o,c)),r=c}else if(e.isLine){const o="LineBasicMaterial:"+r.uuid;let c=this.cache.get(o);c||(c=new Gr,ar.prototype.copy.call(c,r),c.color.copy(r.color),c.map=r.map,this.cache.add(o,c)),r=c}if(i||s||a){let o="ClonedMaterial:"+r.uuid+":";i&&(o+="derivative-tangents:"),s&&(o+="vertex-colors:"),a&&(o+="flat-shading:");let c=this.cache.get(o);c||(c=r.clone(),s&&(c.vertexColors=!0),a&&(c.flatShading=!0),i&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(o,c),this.associations.set(c,this.associations.get(r))),r=c}e.material=r}getMaterialType(){return Pf}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let a;const o={},c=s.extensions||{},u=[];if(c[$t.KHR_MATERIALS_UNLIT]){const p=i[$t.KHR_MATERIALS_UNLIT];a=p.getMaterialType(),u.push(p.extendParams(o,s,t))}else{const p=s.pbrMetallicRoughness||{};if(o.color=new ut(1,1,1),o.opacity=1,Array.isArray(p.baseColorFactor)){const m=p.baseColorFactor;o.color.setRGB(m[0],m[1],m[2],Ma),o.opacity=m[3]}p.baseColorTexture!==void 0&&u.push(t.assignTexture(o,"map",p.baseColorTexture,Il)),o.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,o.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(o,"metalnessMap",p.metallicRoughnessTexture)),u.push(t.assignTexture(o,"roughnessMap",p.metallicRoughnessTexture))),a=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,o)})))}s.doubleSided===!0&&(o.side=Ti);const f=s.alphaMode||S_.OPAQUE;if(f===S_.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,f===S_.MASK&&(o.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==pi&&(u.push(t.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new Te(1,1),s.normalTexture.scale!==void 0)){const p=s.normalTexture.scale;o.normalScale.set(p,p)}if(s.occlusionTexture!==void 0&&a!==pi&&(u.push(t.assignTexture(o,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==pi){const p=s.emissiveFactor;o.emissive=new ut().setRGB(p[0],p[1],p[2],Ma)}return s.emissiveTexture!==void 0&&a!==pi&&u.push(t.assignTexture(o,"emissiveMap",s.emissiveTexture,Il)),Promise.all(u).then(function(){const p=new a(o);return s.name&&(p.name=s.name),ga(p,s),t.associations.set(p,{materials:e}),s.extensions&&pl(i,p,s),p})}createUniqueName(e){const t=an.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(o){return r[$t.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(c){return y2(c,o,t)})}const a=[];for(let o=0,c=e.length;o<c;o++){const u=e[o],f=$9(u),p=i[f];if(p)a.push(p.promise);else{let m;u.extensions&&u.extensions[$t.KHR_DRACO_MESH_COMPRESSION]?m=s(u):m=y2(new jt,u,t),i[f]={primitive:u,promise:m},a.push(m)}}return Promise.all(a)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],a=s.primitives,o=[];for(let c=0,u=a.length;c<u;c++){const f=a[c].material===void 0?Z9(this.cache):this.getDependency("material",a[c].material);o.push(f)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(c){const u=c.slice(0,c.length-1),f=c[c.length-1],p=[];for(let g=0,y=f.length;g<y;g++){const S=f[g],w=a[g];let x;const _=u[g];if(w.mode===Ki.TRIANGLES||w.mode===Ki.TRIANGLE_STRIP||w.mode===Ki.TRIANGLE_FAN||w.mode===void 0)x=s.isSkinnedMesh===!0?new bw(S,_):new Tn(S,_),x.isSkinnedMesh===!0&&x.normalizeSkinWeights(),w.mode===Ki.TRIANGLE_STRIP?x.geometry=d2(x.geometry,fw):w.mode===Ki.TRIANGLE_FAN&&(x.geometry=d2(x.geometry,w0));else if(w.mode===Ki.LINES)x=new Ts(S,_);else if(w.mode===Ki.LINE_STRIP)x=new Ra(S,_);else if(w.mode===Ki.LINE_LOOP)x=new Sw(S,_);else if(w.mode===Ki.POINTS)x=new Aw(S,_);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);Object.keys(x.geometry.morphAttributes).length>0&&Q9(x,s),x.name=t.createUniqueName(s.name||"mesh_"+e),ga(x,s),w.extensions&&pl(i,x,w),t.assignFinalMaterial(x),p.push(x)}for(let g=0,y=p.length;g<y;g++)t.associations.set(p[g],{meshes:e,primitives:g});if(p.length===1)return s.extensions&&pl(i,p[0],s),p[0];const m=new wa;s.extensions&&pl(i,m,s),t.associations.set(m,{meshes:e});for(let g=0,y=p.length;g<y;g++)m.add(p[g]);return m})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new Cn(mw.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new Bi(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),ga(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),a=i,o=[],c=[];for(let u=0,f=a.length;u<f;u++){const p=a[u];if(p){o.push(p);const m=new Dt;s!==null&&m.fromArray(s.array,u*16),c.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new Cf(o,c)})}loadAnimation(e){const t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,a=[],o=[],c=[],u=[],f=[];for(let p=0,m=i.channels.length;p<m;p++){const g=i.channels[p],y=i.samplers[g.sampler],S=g.target,w=S.node,x=i.parameters!==void 0?i.parameters[y.input]:y.input,_=i.parameters!==void 0?i.parameters[y.output]:y.output;S.node!==void 0&&(a.push(this.getDependency("node",w)),o.push(this.getDependency("accessor",x)),c.push(this.getDependency("accessor",_)),u.push(y),f.push(S))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(c),Promise.all(u),Promise.all(f)]).then(function(p){const m=p[0],g=p[1],y=p[2],S=p[3],w=p[4],x=[];for(let _=0,b=m.length;_<b;_++){const M=m[_],N=g[_],C=y[_],I=S[_],P=w[_];if(M===void 0)continue;M.updateMatrix&&M.updateMatrix();const T=r._createAnimationTracks(M,N,C,I,P);if(T)for(let R=0;R<T.length;R++)x.push(T[R])}return new Wu(s,void 0,x)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const a=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&a.traverse(function(o){if(o.isMesh)for(let c=0,u=i.weights.length;c<u;c++)o.morphTargetInfluences[c]=i.weights[c]}),a})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),a=[],o=i.children||[];for(let u=0,f=o.length;u<f;u++)a.push(r.getDependency("node",o[u]));const c=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(a),c]).then(function(u){const f=u[0],p=u[1],m=u[2];m!==null&&f.traverse(function(g){g.isSkinnedMesh&&g.bind(m,tV)});for(let g=0,y=p.length;g<y;g++)f.add(p[g]);return f})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],a=s.name?i.createUniqueName(s.name):"",o=[],c=i._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return c&&o.push(c),s.camera!==void 0&&o.push(i.getDependency("camera",s.camera).then(function(u){return i._getNodeRef(i.cameraCache,s.camera,u)})),i._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){o.push(u)}),this.nodeCache[e]=Promise.all(o).then(function(u){let f;if(s.isBone===!0?f=new xx:u.length>1?f=new wa:u.length===1?f=u[0]:f=new sn,f!==u[0])for(let p=0,m=u.length;p<m;p++)f.add(u[p]);if(s.name&&(f.userData.name=s.name,f.name=a),ga(f,s),s.extensions&&pl(r,f,s),s.matrix!==void 0){const p=new Dt;p.fromArray(s.matrix),f.applyMatrix4(p)}else s.translation!==void 0&&f.position.fromArray(s.translation),s.rotation!==void 0&&f.quaternion.fromArray(s.rotation),s.scale!==void 0&&f.scale.fromArray(s.scale);return i.associations.has(f)||i.associations.set(f,{}),i.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new wa;r.name&&(s.name=i.createUniqueName(r.name)),ga(s,r),r.extensions&&pl(t,s,r);const a=r.nodes||[],o=[];for(let c=0,u=a.length;c<u;c++)o.push(i.getDependency("node",a[c]));return Promise.all(o).then(function(c){for(let f=0,p=c.length;f<p;f++)s.add(c[f]);const u=f=>{const p=new Map;for(const[m,g]of i.associations)(m instanceof ar||m instanceof pn)&&p.set(m,g);return f.traverse(m=>{const g=i.associations.get(m);g!=null&&p.set(m,g)}),p};return i.associations=u(s),s})}_createAnimationTracks(e,t,r,i,s){const a=[],o=e.name?e.name:e.uuid,c=[];eo[s.path]===eo.weights?e.traverse(function(m){m.morphTargetInfluences&&c.push(m.name?m.name:m.uuid)}):c.push(o);let u;switch(eo[s.path]){case eo.weights:u=Zl;break;case eo.rotation:u=ql;break;case eo.position:case eo.scale:u=Ql;break;default:switch(r.itemSize){case 1:u=Zl;break;case 2:case 3:default:u=Ql;break}break}const f=i.interpolation!==void 0?K9[i.interpolation]:ju,p=this._getArrayFromAccessor(r);for(let m=0,g=c.length;m<g;m++){const y=new u(c[m]+"."+eo[s.path],t.array,p,f);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(y),a.push(y)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=Q1(t.constructor),i=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s++)i[s]=t[s]*r;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof ql?Y9:EI;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function rV(n,e,t){const r=e.attributes,i=new ir;if(r.POSITION!==void 0){const o=t.json.accessors[r.POSITION],c=o.min,u=o.max;if(c!==void 0&&u!==void 0){if(i.set(new X(c[0],c[1],c[2]),new X(u[0],u[1],u[2])),o.normalized){const f=Q1(_u[o.componentType]);i.min.multiplyScalar(f),i.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const o=new X,c=new X;for(let u=0,f=s.length;u<f;u++){const p=s[u];if(p.POSITION!==void 0){const m=t.json.accessors[p.POSITION],g=m.min,y=m.max;if(g!==void 0&&y!==void 0){if(c.setX(Math.max(Math.abs(g[0]),Math.abs(y[0]))),c.setY(Math.max(Math.abs(g[1]),Math.abs(y[1]))),c.setZ(Math.max(Math.abs(g[2]),Math.abs(y[2]))),m.normalized){const S=Q1(_u[m.componentType]);c.multiplyScalar(S)}o.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(o)}n.boundingBox=i;const a=new sr;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=a}function y2(n,e,t){const r=e.attributes,i=[];function s(a,o){return t.getDependency("accessor",a).then(function(c){n.setAttribute(o,c)})}for(const a in r){const o=q1[a]||a.toLowerCase();o in n.attributes||i.push(s(r[a],o))}if(e.indices!==void 0&&!n.index){const a=t.getDependency("accessor",e.indices).then(function(o){n.setIndex(o)});i.push(a)}return ga(n,e),rV(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?q9(n,e.targets,t):n})}class iV extends jw{constructor(e){super(e),this.type=On}parse(e){const a=function(P,T){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(T||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(T||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(T||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(T||""))}},f=`
`,p=function(P,T,R){T=T||1024;let O=P.pos,k=-1,Z=0,te="",K=String.fromCharCode.apply(null,new Uint16Array(P.subarray(O,O+128)));for(;0>(k=K.indexOf(f))&&Z<T&&O<P.byteLength;)te+=K,Z+=K.length,O+=128,K+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(O,O+128)));return-1<k?(P.pos+=Z+k+1,te+K.slice(0,k)):!1},m=function(P){const T=/^#\?(\S+)/,R=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,O=/^\s*FORMAT=(\S+)\s*$/,k=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Z={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let te,K;for((P.pos>=P.byteLength||!(te=p(P)))&&a(1,"no header found"),(K=te.match(T))||a(3,"bad initial token"),Z.valid|=1,Z.programtype=K[1],Z.string+=te+`
`;te=p(P),te!==!1;){if(Z.string+=te+`
`,te.charAt(0)==="#"){Z.comments+=te+`
`;continue}if((K=te.match(R))&&(Z.gamma=parseFloat(K[1])),(K=te.match(j))&&(Z.exposure=parseFloat(K[1])),(K=te.match(O))&&(Z.valid|=2,Z.format=K[1]),(K=te.match(k))&&(Z.valid|=4,Z.height=parseInt(K[1],10),Z.width=parseInt(K[2],10)),Z.valid&2&&Z.valid&4)break}return Z.valid&2||a(3,"missing format specifier"),Z.valid&4||a(3,"missing image size specifier"),Z},g=function(P,T,R){const j=T;if(j<8||j>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);j!==(P[2]<<8|P[3])&&a(3,"wrong scanline width");const O=new Uint8Array(4*T*R);O.length||a(4,"unable to allocate buffer space");let k=0,Z=0;const te=4*j,K=new Uint8Array(4),$=new Uint8Array(te);let U=R;for(;U>0&&Z<P.byteLength;){Z+4>P.byteLength&&a(1),K[0]=P[Z++],K[1]=P[Z++],K[2]=P[Z++],K[3]=P[Z++],(K[0]!=2||K[1]!=2||(K[2]<<8|K[3])!=j)&&a(3,"bad rgbe scanline format");let H=0,W;for(;H<te&&Z<P.byteLength;){W=P[Z++];const G=W>128;if(G&&(W-=128),(W===0||H+W>te)&&a(3,"bad scanline data"),G){const de=P[Z++];for(let Ce=0;Ce<W;Ce++)$[H++]=de}else $.set(P.subarray(Z,Z+W),H),H+=W,Z+=W}const Y=j;for(let G=0;G<Y;G++){let de=0;O[k]=$[G+de],de+=j,O[k+1]=$[G+de],de+=j,O[k+2]=$[G+de],de+=j,O[k+3]=$[G+de],k+=4}U--}return O},y=function(P,T,R,j){const O=P[T+3],k=Math.pow(2,O-128)/255;R[j+0]=P[T+0]*k,R[j+1]=P[T+1]*k,R[j+2]=P[T+2]*k,R[j+3]=1},S=function(P,T,R,j){const O=P[T+3],k=Math.pow(2,O-128)/255;R[j+0]=Tl.toHalfFloat(Math.min(P[T+0]*k,65504)),R[j+1]=Tl.toHalfFloat(Math.min(P[T+1]*k,65504)),R[j+2]=Tl.toHalfFloat(Math.min(P[T+2]*k,65504)),R[j+3]=Tl.toHalfFloat(1)},w=new Uint8Array(e);w.pos=0;const x=m(w),_=x.width,b=x.height,M=g(w.subarray(w.pos),_,b);let N,C,I;switch(this.type){case En:I=M.length/4;const P=new Float32Array(I*4);for(let R=0;R<I;R++)y(M,R*4,P,R*4);N=P,C=En;break;case On:I=M.length/4;const T=new Uint16Array(I*4);for(let R=0;R<I;R++)S(M,R*4,T,R*4);N=T,C=On;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:_,height:b,data:N,header:x.string,gamma:x.gamma,exposure:x.exposure,type:C}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(a,o){switch(a.type){case En:case On:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=en,a.magFilter=en,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,o)}return super.load(e,s,r,i)}}const qd=iS>=152;class sV extends jw{constructor(e){super(e),this.type=On}parse(e){const T=Math.pow(2.7182818,2.2);function R(D,V){for(var ae=0,xe=0;xe<65536;++xe)(xe==0||D[xe>>3]&1<<(xe&7))&&(V[ae++]=xe);for(var Se=ae-1;ae<65536;)V[ae++]=0;return Se}function j(D){for(var V=0;V<16384;V++)D[V]={},D[V].len=0,D[V].lit=0,D[V].p=null}const O={l:0,c:0,lc:0};function k(D,V,ae,xe,Se){for(;ae<D;)V=V<<8|xt(xe,Se),ae+=8;ae-=D,O.l=V>>ae&(1<<D)-1,O.c=V,O.lc=ae}const Z=new Array(59);function te(D){for(var V=0;V<=58;++V)Z[V]=0;for(var V=0;V<65537;++V)Z[D[V]]+=1;for(var ae=0,V=58;V>0;--V){var xe=ae+Z[V]>>1;Z[V]=ae,ae=xe}for(var V=0;V<65537;++V){var Se=D[V];Se>0&&(D[V]=Se|Z[Se]++<<6)}}function K(D,V,ae,xe,Se,Ae,Ze){for(var Oe=ae,nt=0,tt=0;Se<=Ae;Se++){if(Oe.value-ae.value>xe)return!1;k(6,nt,tt,D,Oe);var rt=O.l;if(nt=O.c,tt=O.lc,Ze[Se]=rt,rt==63){if(Oe.value-ae.value>xe)throw"Something wrong with hufUnpackEncTable";k(8,nt,tt,D,Oe);var Qe=O.l+6;if(nt=O.c,tt=O.lc,Se+Qe>Ae+1)throw"Something wrong with hufUnpackEncTable";for(;Qe--;)Ze[Se++]=0;Se--}else if(rt>=59){var Qe=rt-59+2;if(Se+Qe>Ae+1)throw"Something wrong with hufUnpackEncTable";for(;Qe--;)Ze[Se++]=0;Se--}}te(Ze)}function $(D){return D&63}function U(D){return D>>6}function H(D,V,ae,xe){for(;V<=ae;V++){var Se=U(D[V]),Ae=$(D[V]);if(Se>>Ae)throw"Invalid table entry";if(Ae>14){var Ze=xe[Se>>Ae-14];if(Ze.len)throw"Invalid table entry";if(Ze.lit++,Ze.p){var Oe=Ze.p;Ze.p=new Array(Ze.lit);for(var nt=0;nt<Ze.lit-1;++nt)Ze.p[nt]=Oe[nt]}else Ze.p=new Array(1);Ze.p[Ze.lit-1]=V}else if(Ae)for(var tt=0,nt=1<<14-Ae;nt>0;nt--){var Ze=xe[(Se<<14-Ae)+tt];if(Ze.len||Ze.p)throw"Invalid table entry";Ze.len=Ae,Ze.lit=V,tt++}}return!0}const W={c:0,lc:0};function Y(D,V,ae,xe){D=D<<8|xt(ae,xe),V+=8,W.c=D,W.lc=V}const G={c:0,lc:0};function de(D,V,ae,xe,Se,Ae,Ze,Oe,nt,tt){if(D==V){xe<8&&(Y(ae,xe,Se,Ze),ae=W.c,xe=W.lc),xe-=8;var rt=ae>>xe,rt=new Uint8Array([rt])[0];if(nt.value+rt>tt)return!1;for(var Qe=Oe[nt.value-1];rt-- >0;)Oe[nt.value++]=Qe}else if(nt.value<tt)Oe[nt.value++]=D;else return!1;G.c=ae,G.lc=xe}function Ce(D){return D&65535}function be(D){var V=Ce(D);return V>32767?V-65536:V}const se={a:0,b:0};function _e(D,V){var ae=be(D),xe=be(V),Se=xe,Ae=ae+(Se&1)+(Se>>1),Ze=Ae,Oe=Ae-Se;se.a=Ze,se.b=Oe}function Le(D,V){var ae=Ce(D),xe=Ce(V),Se=ae-(xe>>1)&65535,Ae=xe+Se-32768&65535;se.a=Ae,se.b=Se}function yt(D,V,ae,xe,Se,Ae,Ze){for(var Oe=Ze<16384,nt=ae>Se?Se:ae,tt=1,rt;tt<=nt;)tt<<=1;for(tt>>=1,rt=tt,tt>>=1;tt>=1;){for(var Qe=0,z=Qe+Ae*(Se-rt),ne=Ae*tt,le=Ae*rt,ce=xe*tt,oe=xe*rt,Pe,Ue,Ne,De;Qe<=z;Qe+=le){for(var We=Qe,ht=Qe+xe*(ae-rt);We<=ht;We+=oe){var Xe=We+ce,St=We+ne,Ot=St+ce;Oe?(_e(D[We+V],D[St+V]),Pe=se.a,Ne=se.b,_e(D[Xe+V],D[Ot+V]),Ue=se.a,De=se.b,_e(Pe,Ue),D[We+V]=se.a,D[Xe+V]=se.b,_e(Ne,De),D[St+V]=se.a,D[Ot+V]=se.b):(Le(D[We+V],D[St+V]),Pe=se.a,Ne=se.b,Le(D[Xe+V],D[Ot+V]),Ue=se.a,De=se.b,Le(Pe,Ue),D[We+V]=se.a,D[Xe+V]=se.b,Le(Ne,De),D[St+V]=se.a,D[Ot+V]=se.b)}if(ae&tt){var St=We+ne;Oe?_e(D[We+V],D[St+V]):Le(D[We+V],D[St+V]),Pe=se.a,D[St+V]=se.b,D[We+V]=Pe}}if(Se&tt)for(var We=Qe,ht=Qe+xe*(ae-rt);We<=ht;We+=oe){var Xe=We+ce;Oe?_e(D[We+V],D[Xe+V]):Le(D[We+V],D[Xe+V]),Pe=se.a,D[Xe+V]=se.b,D[We+V]=Pe}rt=tt,tt>>=1}return Qe}function qe(D,V,ae,xe,Se,Ae,Ze,Oe,nt,tt){for(var rt=0,Qe=0,z=Oe,ne=Math.trunc(Se.value+(Ae+7)/8);Se.value<ne;)for(Y(rt,Qe,ae,Se),rt=W.c,Qe=W.lc;Qe>=14;){var le=rt>>Qe-14&16383,ce=V[le];if(ce.len)Qe-=ce.len,de(ce.lit,Ze,rt,Qe,ae,xe,Se,nt,tt,z),rt=G.c,Qe=G.lc;else{if(!ce.p)throw"hufDecode issues";var oe;for(oe=0;oe<ce.lit;oe++){for(var Pe=$(D[ce.p[oe]]);Qe<Pe&&Se.value<ne;)Y(rt,Qe,ae,Se),rt=W.c,Qe=W.lc;if(Qe>=Pe&&U(D[ce.p[oe]])==(rt>>Qe-Pe&(1<<Pe)-1)){Qe-=Pe,de(ce.p[oe],Ze,rt,Qe,ae,xe,Se,nt,tt,z),rt=G.c,Qe=G.lc;break}}if(oe==ce.lit)throw"hufDecode issues"}}var Ue=8-Ae&7;for(rt>>=Ue,Qe-=Ue;Qe>0;){var ce=V[rt<<14-Qe&16383];if(ce.len)Qe-=ce.len,de(ce.lit,Ze,rt,Qe,ae,xe,Se,nt,tt,z),rt=G.c,Qe=G.lc;else throw"hufDecode issues"}return!0}function lt(D,V,ae,xe,Se,Ae){var Ze={value:0},Oe=ae.value,nt=He(V,ae),tt=He(V,ae);ae.value+=4;var rt=He(V,ae);if(ae.value+=4,nt<0||nt>=65537||tt<0||tt>=65537)throw"Something wrong with HUF_ENCSIZE";var Qe=new Array(65537),z=new Array(16384);j(z);var ne=xe-(ae.value-Oe);if(K(D,V,ae,ne,nt,tt,Qe),rt>8*(xe-(ae.value-Oe)))throw"Something wrong with hufUncompress";H(Qe,nt,tt,z),qe(Qe,z,D,V,ae,rt,tt,Ae,Se,Ze)}function kt(D,V,ae){for(var xe=0;xe<ae;++xe)V[xe]=D[V[xe]]}function it(D){for(var V=1;V<D.length;V++){var ae=D[V-1]+D[V]-128;D[V]=ae}}function Me(D,V){for(var ae=0,xe=Math.floor((D.length+1)/2),Se=0,Ae=D.length-1;!(Se>Ae||(V[Se++]=D[ae++],Se>Ae));)V[Se++]=D[xe++]}function Be(D){for(var V=D.byteLength,ae=new Array,xe=0,Se=new DataView(D);V>0;){var Ae=Se.getInt8(xe++);if(Ae<0){var Ze=-Ae;V-=Ze+1;for(var Oe=0;Oe<Ze;Oe++)ae.push(Se.getUint8(xe++))}else{var Ze=Ae;V-=2;for(var nt=Se.getUint8(xe++),Oe=0;Oe<Ze+1;Oe++)ae.push(nt)}}return ae}function Ie(D,V,ae,xe,Se,Ae){var Xe=new DataView(Ae.buffer),Ze=ae[D.idx[0]].width,Oe=ae[D.idx[0]].height,nt=3,tt=Math.floor(Ze/8),rt=Math.ceil(Ze/8),Qe=Math.ceil(Oe/8),z=Ze-(rt-1)*8,ne=Oe-(Qe-1)*8,le={value:0},ce=new Array(nt),oe=new Array(nt),Pe=new Array(nt),Ue=new Array(nt),Ne=new Array(nt);for(let Nt=0;Nt<nt;++Nt)Ne[Nt]=V[D.idx[Nt]],ce[Nt]=Nt<1?0:ce[Nt-1]+rt*Qe,oe[Nt]=new Float32Array(64),Pe[Nt]=new Uint16Array(64),Ue[Nt]=new Uint16Array(rt*64);for(let Nt=0;Nt<Qe;++Nt){var De=8;Nt==Qe-1&&(De=ne);var We=8;for(let Et=0;Et<rt;++Et){Et==rt-1&&(We=z);for(let At=0;At<nt;++At)Pe[At].fill(0),Pe[At][0]=Se[ce[At]++],Ye(le,xe,Pe[At]),Q(Pe[At],oe[At]),vt(oe[At]);et(oe);for(let At=0;At<nt;++At)Ct(oe[At],Ue[At],Et*64)}let mt=0;for(let Et=0;Et<nt;++Et){const At=ae[D.idx[Et]].type;for(let qt=8*Nt;qt<8*Nt+De;++qt){mt=Ne[Et][qt];for(let Cr=0;Cr<tt;++Cr){const mn=Cr*64+(qt&7)*8;Xe.setUint16(mt+0*2*At,Ue[Et][mn+0],!0),Xe.setUint16(mt+1*2*At,Ue[Et][mn+1],!0),Xe.setUint16(mt+2*2*At,Ue[Et][mn+2],!0),Xe.setUint16(mt+3*2*At,Ue[Et][mn+3],!0),Xe.setUint16(mt+4*2*At,Ue[Et][mn+4],!0),Xe.setUint16(mt+5*2*At,Ue[Et][mn+5],!0),Xe.setUint16(mt+6*2*At,Ue[Et][mn+6],!0),Xe.setUint16(mt+7*2*At,Ue[Et][mn+7],!0),mt+=8*2*At}}if(tt!=rt)for(let qt=8*Nt;qt<8*Nt+De;++qt){const Cr=Ne[Et][qt]+8*tt*2*At,mn=tt*64+(qt&7)*8;for(let Er=0;Er<We;++Er)Xe.setUint16(Cr+Er*2*At,Ue[Et][mn+Er],!0)}}}for(var ht=new Uint16Array(Ze),Xe=new DataView(Ae.buffer),St=0;St<nt;++St){ae[D.idx[St]].decoded=!0;var Ot=ae[D.idx[St]].type;if(ae[St].type==2)for(var zt=0;zt<Oe;++zt){const Nt=Ne[St][zt];for(var Yt=0;Yt<Ze;++Yt)ht[Yt]=Xe.getUint16(Nt+Yt*2*Ot,!0);for(var Yt=0;Yt<Ze;++Yt)Xe.setFloat32(Nt+Yt*2*Ot,me(ht[Yt]),!0)}}}function Ye(D,V,ae){for(var xe,Se=1;Se<64;)xe=V[D.value],xe==65280?Se=64:xe>>8==255?Se+=xe&255:(ae[Se]=xe,Se++),D.value++}function Q(D,V){V[0]=me(D[0]),V[1]=me(D[1]),V[2]=me(D[5]),V[3]=me(D[6]),V[4]=me(D[14]),V[5]=me(D[15]),V[6]=me(D[27]),V[7]=me(D[28]),V[8]=me(D[2]),V[9]=me(D[4]),V[10]=me(D[7]),V[11]=me(D[13]),V[12]=me(D[16]),V[13]=me(D[26]),V[14]=me(D[29]),V[15]=me(D[42]),V[16]=me(D[3]),V[17]=me(D[8]),V[18]=me(D[12]),V[19]=me(D[17]),V[20]=me(D[25]),V[21]=me(D[30]),V[22]=me(D[41]),V[23]=me(D[43]),V[24]=me(D[9]),V[25]=me(D[11]),V[26]=me(D[18]),V[27]=me(D[24]),V[28]=me(D[31]),V[29]=me(D[40]),V[30]=me(D[44]),V[31]=me(D[53]),V[32]=me(D[10]),V[33]=me(D[19]),V[34]=me(D[23]),V[35]=me(D[32]),V[36]=me(D[39]),V[37]=me(D[45]),V[38]=me(D[52]),V[39]=me(D[54]),V[40]=me(D[20]),V[41]=me(D[22]),V[42]=me(D[33]),V[43]=me(D[38]),V[44]=me(D[46]),V[45]=me(D[51]),V[46]=me(D[55]),V[47]=me(D[60]),V[48]=me(D[21]),V[49]=me(D[34]),V[50]=me(D[37]),V[51]=me(D[47]),V[52]=me(D[50]),V[53]=me(D[56]),V[54]=me(D[59]),V[55]=me(D[61]),V[56]=me(D[35]),V[57]=me(D[36]),V[58]=me(D[48]),V[59]=me(D[49]),V[60]=me(D[57]),V[61]=me(D[58]),V[62]=me(D[62]),V[63]=me(D[63])}function vt(D){const V=.5*Math.cos(.7853975),ae=.5*Math.cos(3.14159/16),xe=.5*Math.cos(3.14159/8),Se=.5*Math.cos(3*3.14159/16),Ae=.5*Math.cos(5*3.14159/16),Ze=.5*Math.cos(3*3.14159/8),Oe=.5*Math.cos(7*3.14159/16);for(var nt=new Array(4),tt=new Array(4),rt=new Array(4),Qe=new Array(4),z=0;z<8;++z){var ne=z*8;nt[0]=xe*D[ne+2],nt[1]=Ze*D[ne+2],nt[2]=xe*D[ne+6],nt[3]=Ze*D[ne+6],tt[0]=ae*D[ne+1]+Se*D[ne+3]+Ae*D[ne+5]+Oe*D[ne+7],tt[1]=Se*D[ne+1]-Oe*D[ne+3]-ae*D[ne+5]-Ae*D[ne+7],tt[2]=Ae*D[ne+1]-ae*D[ne+3]+Oe*D[ne+5]+Se*D[ne+7],tt[3]=Oe*D[ne+1]-Ae*D[ne+3]+Se*D[ne+5]-ae*D[ne+7],rt[0]=V*(D[ne+0]+D[ne+4]),rt[3]=V*(D[ne+0]-D[ne+4]),rt[1]=nt[0]+nt[3],rt[2]=nt[1]-nt[2],Qe[0]=rt[0]+rt[1],Qe[1]=rt[3]+rt[2],Qe[2]=rt[3]-rt[2],Qe[3]=rt[0]-rt[1],D[ne+0]=Qe[0]+tt[0],D[ne+1]=Qe[1]+tt[1],D[ne+2]=Qe[2]+tt[2],D[ne+3]=Qe[3]+tt[3],D[ne+4]=Qe[3]-tt[3],D[ne+5]=Qe[2]-tt[2],D[ne+6]=Qe[1]-tt[1],D[ne+7]=Qe[0]-tt[0]}for(var le=0;le<8;++le)nt[0]=xe*D[16+le],nt[1]=Ze*D[16+le],nt[2]=xe*D[48+le],nt[3]=Ze*D[48+le],tt[0]=ae*D[8+le]+Se*D[24+le]+Ae*D[40+le]+Oe*D[56+le],tt[1]=Se*D[8+le]-Oe*D[24+le]-ae*D[40+le]-Ae*D[56+le],tt[2]=Ae*D[8+le]-ae*D[24+le]+Oe*D[40+le]+Se*D[56+le],tt[3]=Oe*D[8+le]-Ae*D[24+le]+Se*D[40+le]-ae*D[56+le],rt[0]=V*(D[le]+D[32+le]),rt[3]=V*(D[le]-D[32+le]),rt[1]=nt[0]+nt[3],rt[2]=nt[1]-nt[2],Qe[0]=rt[0]+rt[1],Qe[1]=rt[3]+rt[2],Qe[2]=rt[3]-rt[2],Qe[3]=rt[0]-rt[1],D[0+le]=Qe[0]+tt[0],D[8+le]=Qe[1]+tt[1],D[16+le]=Qe[2]+tt[2],D[24+le]=Qe[3]+tt[3],D[32+le]=Qe[3]-tt[3],D[40+le]=Qe[2]-tt[2],D[48+le]=Qe[1]-tt[1],D[56+le]=Qe[0]-tt[0]}function et(D){for(var V=0;V<64;++V){var ae=D[0][V],xe=D[1][V],Se=D[2][V];D[0][V]=ae+1.5747*Se,D[1][V]=ae-.1873*xe-.4682*Se,D[2][V]=ae+1.8556*xe}}function Ct(D,V,ae){for(var xe=0;xe<64;++xe)V[ae+xe]=Tl.toHalfFloat(Ge(D[xe]))}function Ge(D){return D<=1?Math.sign(D)*Math.pow(Math.abs(D),2.2):Math.sign(D)*Math.pow(T,Math.abs(D)-1)}function J(D){return new DataView(D.array.buffer,D.offset.value,D.size)}function L(D){var V=D.viewer.buffer.slice(D.offset.value,D.offset.value+D.size),ae=new Uint8Array(Be(V)),xe=new Uint8Array(ae.length);return it(ae),Me(ae,xe),new DataView(xe.buffer)}function q(D){var V=D.array.slice(D.offset.value,D.offset.value+D.size),ae=Fm(V),xe=new Uint8Array(ae.length);return it(ae),Me(ae,xe),new DataView(xe.buffer)}function pe(D){for(var V=D.viewer,ae={value:D.offset.value},xe=new Uint16Array(D.width*D.scanlineBlockSize*(D.channels*D.type)),Se=new Uint8Array(8192),Ae=0,Ze=new Array(D.channels),Oe=0;Oe<D.channels;Oe++)Ze[Oe]={},Ze[Oe].start=Ae,Ze[Oe].end=Ze[Oe].start,Ze[Oe].nx=D.width,Ze[Oe].ny=D.lines,Ze[Oe].size=D.type,Ae+=Ze[Oe].nx*Ze[Oe].ny*Ze[Oe].size;var nt=je(V,ae),tt=je(V,ae);if(tt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(nt<=tt)for(var Oe=0;Oe<tt-nt+1;Oe++)Se[Oe+nt]=re(V,ae);var rt=new Uint16Array(65536),Qe=R(Se,rt),z=He(V,ae);lt(D.array,V,ae,z,xe,Ae);for(var Oe=0;Oe<D.channels;++Oe)for(var ne=Ze[Oe],le=0;le<Ze[Oe].size;++le)yt(xe,ne.start+le,ne.nx,ne.size,ne.ny,ne.nx*ne.size,Qe);kt(rt,xe,Ae);for(var ce=0,oe=new Uint8Array(xe.buffer.byteLength),Pe=0;Pe<D.lines;Pe++)for(var Ue=0;Ue<D.channels;Ue++){var ne=Ze[Ue],Ne=ne.nx*ne.size,De=new Uint8Array(xe.buffer,ne.end*2,Ne*2);oe.set(De,ce),ce+=Ne*2,ne.end+=Ne}return new DataView(oe.buffer)}function ve(D){var V=D.array.slice(D.offset.value,D.offset.value+D.size),ae=Fm(V);const xe=D.lines*D.channels*D.width,Se=D.type==1?new Uint16Array(xe):new Uint32Array(xe);let Ae=0,Ze=0;const Oe=new Array(4);for(let nt=0;nt<D.lines;nt++)for(let tt=0;tt<D.channels;tt++){let rt=0;switch(D.type){case 1:Oe[0]=Ae,Oe[1]=Oe[0]+D.width,Ae=Oe[1]+D.width;for(let Qe=0;Qe<D.width;++Qe){const z=ae[Oe[0]++]<<8|ae[Oe[1]++];rt+=z,Se[Ze]=rt,Ze++}break;case 2:Oe[0]=Ae,Oe[1]=Oe[0]+D.width,Oe[2]=Oe[1]+D.width,Ae=Oe[2]+D.width;for(let Qe=0;Qe<D.width;++Qe){const z=ae[Oe[0]++]<<24|ae[Oe[1]++]<<16|ae[Oe[2]++]<<8;rt+=z,Se[Ze]=rt,Ze++}break}}return new DataView(Se.buffer)}function ge(D){var V=D.viewer,ae={value:D.offset.value},xe=new Uint8Array(D.width*D.lines*(D.channels*D.type*2)),Se={version:fe(V,ae),unknownUncompressedSize:fe(V,ae),unknownCompressedSize:fe(V,ae),acCompressedSize:fe(V,ae),dcCompressedSize:fe(V,ae),rleCompressedSize:fe(V,ae),rleUncompressedSize:fe(V,ae),rleRawSize:fe(V,ae),totalAcUncompressedCount:fe(V,ae),totalDcUncompressedCount:fe(V,ae),acCompression:fe(V,ae)};if(Se.version<2)throw"EXRLoader.parse: "+ri.compression+" version "+Se.version+" is unsupported";for(var Ae=new Array,Ze=je(V,ae)-2;Ze>0;){var Oe=st(V.buffer,ae),nt=re(V,ae),tt=nt>>2&3,rt=(nt>>4)-1,Qe=new Int8Array([rt])[0],z=re(V,ae);Ae.push({name:Oe,index:Qe,type:z,compression:tt}),Ze-=Oe.length+3}for(var ne=ri.channels,le=new Array(D.channels),ce=0;ce<D.channels;++ce){var oe=le[ce]={},Pe=ne[ce];oe.name=Pe.name,oe.compression=0,oe.decoded=!1,oe.type=Pe.pixelType,oe.pLinear=Pe.pLinear,oe.width=D.width,oe.height=D.lines}for(var Ue={idx:new Array(3)},Ne=0;Ne<D.channels;++Ne)for(var oe=le[Ne],ce=0;ce<Ae.length;++ce){var De=Ae[ce];oe.name==De.name&&(oe.compression=De.compression,De.index>=0&&(Ue.idx[De.index]=Ne),oe.offset=Ne)}if(Se.acCompressedSize>0)switch(Se.acCompression){case 0:var Xe=new Uint16Array(Se.totalAcUncompressedCount);lt(D.array,V,ae,Se.acCompressedSize,Xe,Se.totalAcUncompressedCount);break;case 1:var We=D.array.slice(ae.value,ae.value+Se.totalAcUncompressedCount),ht=Fm(We),Xe=new Uint16Array(ht.buffer);ae.value+=Se.totalAcUncompressedCount;break}if(Se.dcCompressedSize>0){var St={array:D.array,offset:ae,size:Se.dcCompressedSize},Ot=new Uint16Array(q(St).buffer);ae.value+=Se.dcCompressedSize}if(Se.rleRawSize>0){var We=D.array.slice(ae.value,ae.value+Se.rleCompressedSize),ht=Fm(We),zt=Be(ht.buffer);ae.value+=Se.rleCompressedSize}for(var Yt=0,Nt=new Array(le.length),ce=0;ce<Nt.length;++ce)Nt[ce]=new Array;for(var mt=0;mt<D.lines;++mt)for(var Et=0;Et<le.length;++Et)Nt[Et].push(Yt),Yt+=le[Et].width*D.type*2;Ie(Ue,Nt,le,Xe,Ot,xe);for(var ce=0;ce<le.length;++ce){var oe=le[ce];if(!oe.decoded)switch(oe.compression){case 2:for(var At=0,qt=0,mt=0;mt<D.lines;++mt){for(var Cr=Nt[ce][At],mn=0;mn<oe.width;++mn){for(var Er=0;Er<2*oe.type;++Er)xe[Cr++]=zt[qt+Er*oe.width*oe.height];qt++}At++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(xe.buffer)}function st(D,V){for(var ae=new Uint8Array(D),xe=0;ae[V.value+xe]!=0;)xe+=1;var Se=new TextDecoder().decode(ae.slice(V.value,V.value+xe));return V.value=V.value+xe+1,Se}function Ke(D,V,ae){var xe=new TextDecoder().decode(new Uint8Array(D).slice(V.value,V.value+ae));return V.value=V.value+ae,xe}function dt(D,V){var ae=Fe(D,V),xe=He(D,V);return[ae,xe]}function _t(D,V){var ae=He(D,V),xe=He(D,V);return[ae,xe]}function Fe(D,V){var ae=D.getInt32(V.value,!0);return V.value=V.value+4,ae}function He(D,V){var ae=D.getUint32(V.value,!0);return V.value=V.value+4,ae}function xt(D,V){var ae=D[V.value];return V.value=V.value+1,ae}function re(D,V){var ae=D.getUint8(V.value);return V.value=V.value+1,ae}const fe=function(D,V){let ae;return"getBigInt64"in DataView.prototype?ae=Number(D.getBigInt64(V.value,!0)):ae=D.getUint32(V.value+4,!0)+Number(D.getUint32(V.value,!0)<<32),V.value+=8,ae};function ke(D,V){var ae=D.getFloat32(V.value,!0);return V.value+=4,ae}function ie(D,V){return Tl.toHalfFloat(ke(D,V))}function me(D){var V=(D&31744)>>10,ae=D&1023;return(D>>15?-1:1)*(V?V===31?ae?NaN:1/0:Math.pow(2,V-15)*(1+ae/1024):6103515625e-14*(ae/1024))}function je(D,V){var ae=D.getUint16(V.value,!0);return V.value+=2,ae}function at(D,V){return me(je(D,V))}function ze(D,V,ae,xe){for(var Se=ae.value,Ae=[];ae.value<Se+xe-1;){var Ze=st(V,ae),Oe=Fe(D,ae),nt=re(D,ae);ae.value+=3;var tt=Fe(D,ae),rt=Fe(D,ae);Ae.push({name:Ze,pixelType:Oe,pLinear:nt,xSampling:tt,ySampling:rt})}return ae.value+=1,Ae}function Re(D,V){var ae=ke(D,V),xe=ke(D,V),Se=ke(D,V),Ae=ke(D,V),Ze=ke(D,V),Oe=ke(D,V),nt=ke(D,V),tt=ke(D,V);return{redX:ae,redY:xe,greenX:Se,greenY:Ae,blueX:Ze,blueY:Oe,whiteX:nt,whiteY:tt}}function Ve(D,V){var ae=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],xe=re(D,V);return ae[xe]}function Tt(D,V){var ae=He(D,V),xe=He(D,V),Se=He(D,V),Ae=He(D,V);return{xMin:ae,yMin:xe,xMax:Se,yMax:Ae}}function Qt(D,V){var ae=["INCREASING_Y"],xe=re(D,V);return ae[xe]}function Jt(D,V){var ae=ke(D,V),xe=ke(D,V);return[ae,xe]}function Gn(D,V){var ae=ke(D,V),xe=ke(D,V),Se=ke(D,V);return[ae,xe,Se]}function cr(D,V,ae,xe,Se){if(xe==="string"||xe==="stringvector"||xe==="iccProfile")return Ke(V,ae,Se);if(xe==="chlist")return ze(D,V,ae,Se);if(xe==="chromaticities")return Re(D,ae);if(xe==="compression")return Ve(D,ae);if(xe==="box2i")return Tt(D,ae);if(xe==="lineOrder")return Qt(D,ae);if(xe==="float")return ke(D,ae);if(xe==="v2f")return Jt(D,ae);if(xe==="v3f")return Gn(D,ae);if(xe==="int")return Fe(D,ae);if(xe==="rational")return dt(D,ae);if(xe==="timecode")return _t(D,ae);if(xe==="preview")return ae.value+=Se,"skipped";ae.value+=Se}function ad(D,V,ae){const xe={};if(D.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";xe.version=D.getUint8(4);const Se=D.getUint8(5);xe.spec={singleTile:!!(Se&2),longName:!!(Se&4),deepFormat:!!(Se&8),multiPart:!!(Se&16)},ae.value=8;for(var Ae=!0;Ae;){var Ze=st(V,ae);if(Ze==0)Ae=!1;else{var Oe=st(V,ae),nt=He(D,ae),tt=cr(D,V,ae,Oe,nt);tt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Oe}'.`):xe[Ze]=tt}}if(Se&-5)throw console.error("EXRHeader:",xe),"THREE.EXRLoader: provided file is currently unsupported.";return xe}function lc(D,V,ae,xe,Se){const Ae={size:0,viewer:V,array:ae,offset:xe,width:D.dataWindow.xMax-D.dataWindow.xMin+1,height:D.dataWindow.yMax-D.dataWindow.yMin+1,channels:D.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:D.channels[0].pixelType,uncompress:null,getter:null,format:null,[qd?"colorSpace":"encoding"]:null};switch(D.compression){case"NO_COMPRESSION":Ae.lines=1,Ae.uncompress=J;break;case"RLE_COMPRESSION":Ae.lines=1,Ae.uncompress=L;break;case"ZIPS_COMPRESSION":Ae.lines=1,Ae.uncompress=q;break;case"ZIP_COMPRESSION":Ae.lines=16,Ae.uncompress=q;break;case"PIZ_COMPRESSION":Ae.lines=32,Ae.uncompress=pe;break;case"PXR24_COMPRESSION":Ae.lines=16,Ae.uncompress=ve;break;case"DWAA_COMPRESSION":Ae.lines=32,Ae.uncompress=ge;break;case"DWAB_COMPRESSION":Ae.lines=256,Ae.uncompress=ge;break;default:throw"EXRLoader.parse: "+D.compression+" is unsupported"}if(Ae.scanlineBlockSize=Ae.lines,Ae.type==1)switch(Se){case En:Ae.getter=at,Ae.inputSize=2;break;case On:Ae.getter=je,Ae.inputSize=2;break}else if(Ae.type==2)switch(Se){case En:Ae.getter=ke,Ae.inputSize=4;break;case On:Ae.getter=ie,Ae.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Ae.type+" for "+D.compression+".";Ae.blockCount=(D.dataWindow.yMax+1)/Ae.scanlineBlockSize;for(var Ze=0;Ze<Ae.blockCount;Ze++)fe(V,xe);Ae.outputChannels=Ae.channels==3?4:Ae.channels;const Oe=Ae.width*Ae.height*Ae.outputChannels;switch(Se){case En:Ae.byteArray=new Float32Array(Oe),Ae.channels<Ae.outputChannels&&Ae.byteArray.fill(1,0,Oe);break;case On:Ae.byteArray=new Uint16Array(Oe),Ae.channels<Ae.outputChannels&&Ae.byteArray.fill(15360,0,Oe);break;default:console.error("THREE.EXRLoader: unsupported type: ",Se);break}return Ae.bytesPerLine=Ae.width*Ae.inputSize*Ae.channels,Ae.outputChannels==4?Ae.format=Yn:Ae.format=_f,qd?Ae.colorSpace="srgb-linear":Ae.encoding=3e3,Ae}const ls=new DataView(e),Vo=new Uint8Array(e),Rs={value:0},ri=ad(ls,e,Rs),Ut=lc(ri,ls,Vo,Rs,this.type),Da={value:0},cc={R:0,G:1,B:2,A:3,Y:0};for(let D=0;D<Ut.height/Ut.scanlineBlockSize;D++){const V=He(ls,Rs);Ut.size=He(ls,Rs),Ut.lines=V+Ut.scanlineBlockSize>Ut.height?Ut.height-V:Ut.scanlineBlockSize;const xe=Ut.size<Ut.lines*Ut.bytesPerLine?Ut.uncompress(Ut):J(Ut);Rs.value+=Ut.size;for(let Se=0;Se<Ut.scanlineBlockSize;Se++){const Ae=Se+D*Ut.scanlineBlockSize;if(Ae>=Ut.height)break;for(let Ze=0;Ze<Ut.channels;Ze++){const Oe=cc[ri.channels[Ze].name];for(let nt=0;nt<Ut.width;nt++){Da.value=(Se*(Ut.channels*Ut.width)+Ze*Ut.width+nt)*Ut.inputSize;const tt=(Ut.height-1-Ae)*(Ut.width*Ut.outputChannels)+nt*Ut.outputChannels+Oe;Ut.byteArray[tt]=Ut.getter(xe,Da)}}}}return{header:ri,width:Ut.width,height:Ut.height,data:Ut.byteArray,format:Ut.format,[qd?"colorSpace":"encoding"]:Ut[qd?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(a,o){qd?a.colorSpace=o.colorSpace:a.encoding=o.encoding,a.minFilter=en,a.magFilter=en,a.generateMipmaps=!1,a.flipY=!1,t&&t(a,o)}return super.load(e,s,r,i)}}const M_=new WeakMap;class aV extends Mr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new Sr(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{const o={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,o).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const c in t.attributeTypes){const u=t.attributeTypes[c];u.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=u.name)}const r=JSON.stringify(t);if(M_.has(e)){const c=M_.get(e);if(c.key===r)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(s,a).then(c=>(i=c,new Promise((u,f)=>{i._callbacks[s]={resolve:u,reject:f},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return o.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),M_.set(e,{key:r,promise:o}),o}_createGeometry(e){const t=new jt;e.index&&t.setIndex(new ln(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,a=i.array,o=i.itemSize;t.setAttribute(s,new ln(a,o))}return t}_loadLibrary(e,t){const r=new Sr(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=oV.toString(),a=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const a=s.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function oV(){let n,e;onmessage=function(a){const o=a.data;switch(o.type){case"init":n=o.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(p){f({draco:p})},DracoDecoderModule(n)});break;case"decode":const c=o.buffer,u=o.taskConfig;e.then(f=>{const p=f.draco,m=new p.Decoder,g=new p.DecoderBuffer;g.Init(new Int8Array(c),c.byteLength);try{const y=t(p,m,g,u),S=y.attributes.map(w=>w.array.buffer);y.index&&S.push(y.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:y},S)}catch(y){console.error(y),self.postMessage({type:"error",id:o.id,error:y.message})}finally{p.destroy(g),p.destroy(m)}});break}};function t(a,o,c,u){const f=u.attributeIDs,p=u.attributeTypes;let m,g;const y=o.GetEncodedGeometryType(c);if(y===a.TRIANGULAR_MESH)m=new a.Mesh,g=o.DecodeBufferToMesh(c,m);else if(y===a.POINT_CLOUD)m=new a.PointCloud,g=o.DecodeBufferToPointCloud(c,m);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!g.ok()||m.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+g.error_msg());const S={index:null,attributes:[]};for(const w in f){const x=self[p[w]];let _,b;if(u.useUniqueIDs)b=f[w],_=o.GetAttributeByUniqueId(m,b);else{if(b=o.GetAttributeId(m,a[f[w]]),b===-1)continue;_=o.GetAttribute(m,b)}S.attributes.push(i(a,o,m,w,x,_))}return y===a.TRIANGULAR_MESH&&(S.index=r(a,o,m)),a.destroy(m),S}function r(a,o,c){const f=c.num_faces()*3,p=f*4,m=a._malloc(p);o.GetTrianglesUInt32Array(c,p,m);const g=new Uint32Array(a.HEAPF32.buffer,m,f).slice();return a._free(m),{array:g,itemSize:1}}function i(a,o,c,u,f,p){const m=p.num_components(),y=c.num_points()*m,S=y*f.BYTES_PER_ELEMENT,w=s(a,f),x=a._malloc(S);o.GetAttributeDataArrayForAllPoints(c,p,w,S,x);const _=new f(a.HEAPF32.buffer,x,y).slice();return a._free(x),{name:u,array:_,itemSize:m}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let jm;const C_=()=>{if(jm)return jm;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=n;WebAssembly.validate(t)&&(i=e);let s;const a=WebAssembly.instantiate(o(i),{}).then(p=>{s=p.instance,s.exports.__wasm_call_ctors()});function o(p){const m=new Uint8Array(p.length);for(let y=0;y<p.length;++y){const S=p.charCodeAt(y);m[y]=S>96?S-71:S>64?S-65:S>47?S+4:S>46?63:62}let g=0;for(let y=0;y<p.length;++y)m[g++]=m[y]<60?r[m[y]]:(m[y]-60)*64+m[++y];return m.buffer.slice(0,g)}function c(p,m,g,y,S,w){const x=s.exports.sbrk,_=g+3&-4,b=x(_*y),M=x(S.length),N=new Uint8Array(s.exports.memory.buffer);N.set(S,M);const C=p(b,g,y,M,S.length);if(C===0&&w&&w(b,_,y),m.set(N.subarray(b,b+g*y)),x(b-x(0)),C!==0)throw new Error(`Malformed buffer data: ${C}`)}const u={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},f={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return jm={ready:a,supported:!0,decodeVertexBuffer(p,m,g,y,S){c(s.exports.meshopt_decodeVertexBuffer,p,m,g,y,s.exports[u[S]])},decodeIndexBuffer(p,m,g,y){c(s.exports.meshopt_decodeIndexBuffer,p,m,g,y)},decodeIndexSequence(p,m,g,y){c(s.exports.meshopt_decodeIndexSequence,p,m,g,y)},decodeGltfBuffer(p,m,g,y,S,w){c(s.exports[f[S]],p,m,g,y,s.exports[u[w]])}},jm};function lV(n,e,t,r){const i=class extends Hr{constructor(a={}){const o=Object.entries(n);super({uniforms:o.reduce((c,[u,f])=>{const p=vw.clone({[u]:{value:f}});return{...c,...p}},{}),vertexShader:e,fragmentShader:t}),this.key="",o.forEach(([c])=>Object.defineProperty(this,c,{get:()=>this.uniforms[c].value,set:u=>this.uniforms[c].value=u})),Object.assign(this,a)}};return i.key=mw.generateUUID(),i}const cV=()=>parseInt(td.replace(/\D+/g,"")),uV=cV();let Um=null,TI="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function NI(n=!0,e=!0,t){return r=>{t&&t(r),n&&(Um||(Um=new aV),Um.setDecoderPath(typeof n=="string"?n:TI),r.setDRACOLoader(Um)),e&&r.setMeshoptDecoder(typeof C_=="function"?C_():C_)}}const Ff=(n,e,t,r)=>Ia(sS,n,NI(e,t,r));Ff.preload=(n,e,t,r)=>Ia.preload(sS,n,NI(e,t,r));Ff.clear=n=>Ia.clear(sS,n);Ff.setDecoderPath=n=>{TI=n};const dV=F.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:r,enableDamping:i=!0,keyEvents:s=!1,onChange:a,onStart:o,onEnd:c,...u},f)=>{const p=Zr(C=>C.invalidate),m=Zr(C=>C.camera),g=Zr(C=>C.gl),y=Zr(C=>C.events),S=Zr(C=>C.setEvents),w=Zr(C=>C.set),x=Zr(C=>C.get),_=Zr(C=>C.performance),b=e||m,M=r||y.connected||g.domElement,N=F.useMemo(()=>new w9(b),[b]);return kx(()=>{N.enabled&&N.update()},-1),F.useEffect(()=>(s&&N.connect(s===!0?M:s),N.connect(M),()=>void N.dispose()),[s,M,t,N,p]),F.useEffect(()=>{const C=T=>{p(),t&&_.regress(),a&&a(T)},I=T=>{o&&o(T)},P=T=>{c&&c(T)};return N.addEventListener("change",C),N.addEventListener("start",I),N.addEventListener("end",P),()=>{N.removeEventListener("start",I),N.removeEventListener("end",P),N.removeEventListener("change",C)}},[a,o,c,N,p,S]),F.useEffect(()=>{if(n){const C=x().controls;return w({controls:N}),()=>w({controls:C})}},[n,N]),F.createElement("primitive",Lo({ref:f,object:N,enableDamping:i},u))}),hV=lV({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new ut,sectionColor:new ut,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new X,worldPlanePosition:new X},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${uV>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),fV=F.forwardRef(({args:n,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:r=.5,sectionSize:i=1,followCamera:s=!1,infiniteGrid:a=!1,fadeDistance:o=100,fadeStrength:c=1,fadeFrom:u=1,cellThickness:f=.5,sectionThickness:p=1,side:m=Ur,...g},y)=>{$w({GridMaterial:hV});const S=F.useRef(null);F.useImperativeHandle(y,()=>S.current,[]);const w=new Xs,x=new X(0,1,0),_=new X(0,0,0);kx(N=>{w.setFromNormalAndCoplanarPoint(x,_).applyMatrix4(S.current.matrixWorld);const C=S.current.material,I=C.uniforms.worldCamProjPosition,P=C.uniforms.worldPlanePosition;w.projectPoint(N.camera.position,I.value),P.value.set(0,0,0).applyMatrix4(S.current.matrixWorld)});const b={cellSize:r,sectionSize:i,cellColor:e,sectionColor:t,cellThickness:f,sectionThickness:p},M={fadeDistance:o,fadeStrength:c,fadeFrom:u,infiniteGrid:a,followCamera:s};return F.createElement("mesh",Lo({ref:S,frustumCulled:!1},g),F.createElement("gridMaterial",Lo({transparent:!0,"extensions-derivatives":!0,side:m},b,M)),F.createElement("planeGeometry",{args:n}))}),pV=F.forwardRef(function({children:e,disable:t,disableX:r,disableY:i,disableZ:s,left:a,right:o,top:c,bottom:u,front:f,back:p,onCentered:m,precise:g=!0,cacheKey:y=0,...S},w){const x=F.useRef(null),_=F.useRef(null),b=F.useRef(null);return F.useLayoutEffect(()=>{_.current.matrixWorld.identity();const M=new ir().setFromObject(b.current,g),N=new X,C=new sr,I=M.max.x-M.min.x,P=M.max.y-M.min.y,T=M.max.z-M.min.z;M.getCenter(N),M.getBoundingSphere(C);const R=c?P/2:u?-P/2:0,j=a?-I/2:o?I/2:0,O=f?T/2:p?-T/2:0;_.current.position.set(t||r?0:-N.x+j,t||i?0:-N.y+R,t||s?0:-N.z+O),typeof m<"u"&&m({parent:x.current.parent,container:x.current,width:I,height:P,depth:T,boundingBox:M,boundingSphere:C,center:N,verticalAlignment:R,horizontalAlignment:j,depthAlignment:O})},[y,m,c,a,f,t,r,i,s,g,o,u,p]),F.useImperativeHandle(w,()=>x.current,[]),F.createElement("group",Lo({ref:x},S),F.createElement("group",{ref:_},F.createElement("group",{ref:b},e)))}),mV=3e3,gV=3001,RI=(n,e,t)=>{let r;switch(n){case gr:r=new Uint8ClampedArray(e*t*4);break;case On:r=new Uint16Array(e*t*4);break;case Fi:r=new Uint32Array(e*t*4);break;case rx:r=new Int8Array(e*t*4);break;case ix:r=new Int16Array(e*t*4);break;case vf:r=new Int32Array(e*t*4);break;case En:r=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return r};let Om;const xV=(n,e,t,r)=>{if(Om!==void 0)return Om;const i=new ei(1,1,r);e.setRenderTarget(i);const s=new Tn(new Ho,new pi({color:16777215}));e.render(s,t),e.setRenderTarget(null);const a=RI(n,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,a),i.dispose(),s.geometry.dispose(),s.material.dispose(),Om=a[0]!==0,Om};class aS{constructor(e){Fn(this,"_renderer");Fn(this,"_rendererIsDisposable",!1);Fn(this,"_material");Fn(this,"_scene");Fn(this,"_camera");Fn(this,"_quad");Fn(this,"_renderTarget");Fn(this,"_width");Fn(this,"_height");Fn(this,"_type");Fn(this,"_colorSpace");Fn(this,"_supportsReadPixels",!0);Fn(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var r,i,s,a,o,c,u,f,p,m,g,y,S,w,x,_;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:Yn,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((r=e.renderTargetOptions)==null?void 0:r.anisotropy)!==void 0?(i=e.renderTargetOptions)==null?void 0:i.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(a=e.renderTargetOptions)==null?void 0:a.generateMipmaps:!1,magFilter:((o=e.renderTargetOptions)==null?void 0:o.magFilter)!==void 0?(c=e.renderTargetOptions)==null?void 0:c.magFilter:en,minFilter:((u=e.renderTargetOptions)==null?void 0:u.minFilter)!==void 0?(f=e.renderTargetOptions)==null?void 0:f.minFilter:en,samples:((p=e.renderTargetOptions)==null?void 0:p.samples)!==void 0?(m=e.renderTargetOptions)==null?void 0:m.samples:void 0,wrapS:((g=e.renderTargetOptions)==null?void 0:g.wrapS)!==void 0?(y=e.renderTargetOptions)==null?void 0:y.wrapS:Pn,wrapT:((S=e.renderTargetOptions)==null?void 0:S.wrapT)!==void 0?(w=e.renderTargetOptions)==null?void 0:w.wrapT:Pn};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=aS.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Af,this._camera=new Bi,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!xV(this._type,this._renderer,this._camera,t)){let b;switch(this._type){case On:b=this._renderer.extensions.has("EXT_color_buffer_float")?En:void 0;break}b!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${En}`),this._type=b):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Tn(new Ho,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ei(this.width,this.height,t),this._renderTarget.texture.mapping=((x=e.renderTargetOptions)==null?void 0:x.mapping)!==void 0?(_=e.renderTargetOptions)==null?void 0:_.mapping:No}static instantiateRenderer(){const e=new qw;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=RI(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new rs(this.toArray(),this.width,this.height,Yn,this._type,(e==null?void 0:e.mapping)||No,(e==null?void 0:e.wrapS)||Pn,(e==null?void 0:e.wrapT)||Pn,(e==null?void 0:e.magFilter)||en,(e==null?void 0:e.minFilter)||en,(e==null?void 0:e.anisotropy)||1,ea);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Hr&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof pn&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof pn&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class II extends Error{}class PI extends Error{}const Qd=(n,e,t)=>{const r=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(r)return r[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(i){const s=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(a=>a.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},yV=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const r=e.indexOf("x:xmpmeta>",t),i=e.slice(t,r+10);try{const s=Qd(i,"hdrgm:GainMapMin","0"),a=Qd(i,"hdrgm:GainMapMax"),o=Qd(i,"hdrgm:Gamma","1"),c=Qd(i,"hdrgm:OffsetSDR","0.015625"),u=Qd(i,"hdrgm:OffsetHDR","0.015625"),f=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),p=f?f[1]:"0",m=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!m)throw new Error("Incomplete gainmap metadata");const g=m[1];return{gainMapMin:Array.isArray(s)?s.map(y=>parseFloat(y)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(a)?a.map(y=>parseFloat(y)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(o)?o.map(y=>parseFloat(y)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetSdr:Array.isArray(c)?c.map(y=>parseFloat(y)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetHdr:Array.isArray(u)?u.map(y=>parseFloat(y)):[parseFloat(u),parseFloat(u),parseFloat(u)],hdrCapacityMin:parseFloat(p),hdrCapacityMax:parseFloat(g)}}catch{}t=e.indexOf("<x:xmpmeta",r)}};class vV{constructor(e){Fn(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,r)=>{const i=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const a=s.byteLength;let o=2,c=0,u;for(;o<a;){if(++c>250){r(new Error(`Found no marker after ${c} loops `));return}if(s.getUint8(o)!==255){r(new Error(`Not a valid marker at offset 0x${o.toString(16)}, found: 0x${s.getUint8(o).toString(16)}`));return}if(u=s.getUint8(o+1),i&&console.log(`Marker: ${u.toString(16)}`),u===226){i&&console.log("Found APP2 marker (0xffe2)");const f=o+4;if(s.getUint32(f)===1297106432){const p=f+4;let m;if(s.getUint16(p)===18761)m=!1;else if(s.getUint16(p)===19789)m=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(p+2,!m)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const g=s.getUint32(p+4,!m);if(g<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const y=p+g,S=s.getUint16(y,!m),w=y+2;let x=0;for(let N=w;N<w+12*S;N+=12)s.getUint16(N,!m)===45057&&(x=s.getUint32(N+8,!m));const b=y+2+S*12+4,M=[];for(let N=b;N<b+x*16;N+=16){const C={MPType:s.getUint32(N,!m),size:s.getUint32(N+4,!m),dataOffset:s.getUint32(N+8,!m),dependantImages:s.getUint32(N+12,!m),start:-1,end:-1,isFII:!1};C.dataOffset?(C.start=p+C.dataOffset,C.isFII=!1):(C.start=0,C.isFII=!0),C.end=C.start+C.size,M.push(C)}if(this.options.extractNonFII&&M.length){const N=new Blob([s]),C=[];for(const I of M){if(I.isFII&&!this.options.extractFII)continue;const P=N.slice(I.start,I.end+1,"image/jpeg");C.push(P)}t(C)}}}o+=2+s.getUint16(o+2)}})}}const _V=async n=>{const e=yV(n);if(!e)throw new PI("Gain map XMP metadata not found");const r=await new vV({extractFII:!0,extractNonFII:!0}).extract(n);if(r.length!==2)throw new II("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:e}},v2=n=>new Promise((e,t)=>{const r=document.createElement("img");r.onload=()=>{e(r)},r.onerror=i=>{t(i)},r.src=URL.createObjectURL(n)});class bV extends Mr{constructor(t,r){super(r);Fn(this,"_renderer");Fn(this,"_renderTargetOptions");Fn(this,"_internalLoadingManager");Fn(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new Bx}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new pn,sdr:new pn});return this._config.createQuadRenderer({width:16,height:16,type:On,colorSpace:ea,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,r,i){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([t],{type:"image/jpeg"});let o,c,u=!1;if(typeof createImageBitmap>"u"){const f=await Promise.all([s?v2(s):Promise.resolve(void 0),v2(a)]);c=f[0],o=f[1],u=i==="flipY"}else{const f=await Promise.all([s?createImageBitmap(s,{imageOrientation:i||"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:i||"flipY"})]);c=f[0],o=f[1]}return{sdrImage:o,gainMapImage:c,needsFlip:u}}createTextures(t,r,i){const s=new pn(r||new ImageData(2,2),No,Pn,Pn,en,B1,Yn,gr,1,ea);s.flipY=i,s.needsUpdate=!0;const a=new pn(t,No,Pn,Pn,en,B1,Yn,gr,1,qr);return a.flipY=i,a.needsUpdate=!0,{gainMap:s,sdr:a}}updateQuadRenderer(t,r,i,s,a){t.width=r.width,t.height=r.height,t.material.gainMap=i,t.material.sdr=s,t.material.gainMapMin=a.gainMapMin,t.material.gainMapMax=a.gainMapMax,t.material.offsetHdr=a.offsetHdr,t.material.offsetSdr=a.offsetSdr,t.material.gamma=a.gamma,t.material.hdrCapacityMin=a.hdrCapacityMin,t.material.hdrCapacityMax=a.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,a.hdrCapacityMax),t.material.needsUpdate=!0}}const wV=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,SV=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class AV extends Hr{constructor({gamma:t,offsetHdr:r,offsetSdr:i,gainMapMin:s,gainMapMax:a,maxDisplayBoost:o,hdrCapacityMin:c,hdrCapacityMax:u,sdr:f,gainMap:p}){super({name:"GainMapDecoderMaterial",vertexShader:wV,fragmentShader:SV,uniforms:{sdr:{value:f},gainMap:{value:p},gamma:{value:new X(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new X().fromArray(r)},offsetSdr:{value:new X().fromArray(i)},gainMapMin:{value:new X().fromArray(s)},gainMapMax:{value:new X().fromArray(a)},weightFactor:{value:(Math.log2(o)-c)/(u-c)}},blending:As,depthTest:!1,depthWrite:!1});Fn(this,"_maxDisplayBoost");Fn(this,"_hdrCapacityMin");Fn(this,"_hdrCapacityMax");this._maxDisplayBoost=o,this._hdrCapacityMin=c,this._hdrCapacityMax=u,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const r=this.uniforms.gamma.value;r.x=1/t[0],r.y=1/t[1],r.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class BI extends bV{constructor(e,t){super({renderer:e,createMaterial:r=>new AV(r),createQuadRenderer:r=>new aS(r)},t)}async render(e,t,r,i){const{sdrImage:s,gainMapImage:a,needsFlip:o}=await this.processImages(r,i,"flipY"),{gainMap:c,sdr:u}=this.createTextures(s,a,o);this.updateQuadRenderer(e,s,c,u,t),e.render()}}class MV extends BI{load([e,t,r],i,s,a){const o=this.prepareQuadRenderer();let c,u,f;const p=async()=>{if(c&&u&&f){try{await this.render(o,f,c,u)}catch(T){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),typeof a=="function"&&a(T),o.disposeOnDemandRenderer();return}typeof i=="function"&&i(o),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),o.disposeOnDemandRenderer()}};let m=!0,g=0,y=0,S=!0,w=0,x=0,_=!0,b=0,M=0;const N=()=>{if(typeof s=="function"){const T=g+w+b,R=y+x+M,j=m&&S&&_;s(new ProgressEvent("progress",{lengthComputable:j,loaded:R,total:T}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);const C=new Sr(this._internalLoadingManager);C.setResponseType("arraybuffer"),C.setRequestHeader(this.requestHeader),C.setPath(this.path),C.setWithCredentials(this.withCredentials),C.load(e,async T=>{if(typeof T=="string")throw new Error("Invalid sdr buffer");c=T,await p()},T=>{m=T.lengthComputable,y=T.loaded,g=T.total,N()},T=>{this.manager.itemError(e),typeof a=="function"&&a(T)});const I=new Sr(this._internalLoadingManager);I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setPath(this.path),I.setWithCredentials(this.withCredentials),I.load(t,async T=>{if(typeof T=="string")throw new Error("Invalid gainmap buffer");u=T,await p()},T=>{S=T.lengthComputable,x=T.loaded,w=T.total,N()},T=>{this.manager.itemError(t),typeof a=="function"&&a(T)});const P=new Sr(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(r,async T=>{if(typeof T!="string")throw new Error("Invalid metadata string");f=JSON.parse(T),await p()},T=>{_=T.lengthComputable,M=T.loaded,b=T.total,N()},T=>{this.manager.itemError(r),typeof a=="function"&&a(T)}),o}}class CV extends BI{load(e,t,r,i){const s=this.prepareQuadRenderer(),a=new Sr(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async o=>{if(typeof o=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const c=new Uint8Array(o);let u,f,p;try{const m=await _V(c);u=m.sdr,f=m.gainMap,p=m.metadata}catch(m){if(m instanceof PI||m instanceof II)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),p={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},u=c;else throw m}try{await this.render(s,p,u.buffer,f==null?void 0:f.buffer)}catch(m){this.manager.itemError(e),typeof i=="function"&&i(m),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},r,o=>{this.manager.itemError(e),typeof i=="function"&&i(o)}),s}}const af={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},LI="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",bu=n=>Array.isArray(n),oS=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function jx({files:n=oS,path:e="",preset:t=void 0,encoding:r=void 0,extensions:i}={}){let s=null,a=!1;t&&(lS(t),n=af[t],e=LI),a=bu(n);const{extension:o,isCubemap:c}=cS(n);if(s=uS(o),!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);const u=Zr(g=>g.gl);F.useLayoutEffect(()=>{if(o!=="webp"&&o!=="jpg"&&o!=="jpeg")return;function g(){Ia.clear(s,a?[n]:n)}u.domElement.addEventListener("webglcontextlost",g,{once:!0})},[n,u.domElement]);const f=Ia(s,a?[n]:n,g=>{(o==="webp"||o==="jpg"||o==="jpeg")&&g.setRenderer(u),g.setPath==null||g.setPath(e),i&&i(g)});let p=a?f[0]:f;if(o==="jpg"||o==="jpeg"||o==="webp"){var m;p=(m=p.renderTarget)==null?void 0:m.texture}return p.mapping=c?Cs:Bu,"colorSpace"in p?p.colorSpace=r??c?"srgb":"srgb-linear":p.encoding=r??c?gV:mV,p}const EV={files:oS,path:"",preset:void 0,extensions:void 0};jx.preload=n=>{const e={...EV,...n};let{files:t,path:r=""}=e;const{preset:i,extensions:s}=e;i&&(lS(i),t=af[i],r=LI);const{extension:a}=cS(t);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const o=uS(a);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ia.preload(o,bu(t)?[t]:t,c=>{c.setPath==null||c.setPath(r),s&&s(c)})};const TV={files:oS,preset:void 0};jx.clear=n=>{const e={...TV,...n};let{files:t}=e;const{preset:r}=e;r&&(lS(r),t=af[r]);const{extension:i}=cS(t),s=uS(i);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ia.clear(s,bu(t)?[t]:t)};function lS(n){if(!(n in af))throw new Error("Preset must be one of: "+Object.keys(af).join(", "))}function cS(n){var e;const t=bu(n)&&n.length===6,r=bu(n)&&n.length===3&&n.some(a=>a.endsWith("json")),i=bu(n)?n[0]:n;return{extension:t?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:r}}function uS(n){return n==="cube"?RR:n==="hdr"?iV:n==="exr"?sV:n==="jpg"||n==="jpeg"?CV:n==="webp"?MV:null}const NV=n=>n.current&&n.current.isScene,RV=n=>NV(n)?n.current:n;function dS(n,e,t,r,i={}){var s,a,o,c;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const u=RV(e||t),f=u.background,p=u.environment,m={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:(s=(a=u.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:(o=(c=u.environmentRotation)==null||c.clone==null?void 0:c.clone())!==null&&o!==void 0?o:[0,0,0]};return n!=="only"&&(u.environment=r),n&&(u.background=r),ro(u,i),()=>{n!=="only"&&(u.environment=p),n&&(u.background=f),ro(u,m)}}function hS({scene:n,background:e=!1,map:t,...r}){const i=Zr(s=>s.scene);return F.useLayoutEffect(()=>{if(t)return dS(e,n,i,t,r)}),null}function DI({background:n=!1,scene:e,blur:t,backgroundBlurriness:r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:a,environmentRotation:o,...c}){const u=jx(c),f=Zr(p=>p.scene);return F.useLayoutEffect(()=>dS(n,e,f,u,{backgroundBlurriness:t??r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:a,environmentRotation:o})),F.useEffect(()=>()=>{u.dispose()},[u]),null}function IV({children:n,near:e=.1,far:t=1e3,resolution:r=256,frames:i=1,map:s,background:a=!1,blur:o,backgroundBlurriness:c,backgroundIntensity:u,backgroundRotation:f,environmentIntensity:p,environmentRotation:m,scene:g,files:y,path:S,preset:w=void 0,extensions:x}){const _=Zr(P=>P.gl),b=Zr(P=>P.scene),M=F.useRef(null),[N]=F.useState(()=>new Af),C=F.useMemo(()=>{const P=new px(r);return P.texture.type=On,P},[r]);F.useEffect(()=>()=>{C.dispose()},[C]),F.useLayoutEffect(()=>{if(i===1){const P=_.autoClear;_.autoClear=!0,M.current.update(_,N),_.autoClear=P}return dS(a,g,b,C.texture,{backgroundBlurriness:o??c,backgroundIntensity:u,backgroundRotation:f,environmentIntensity:p,environmentRotation:m})},[n,N,C.texture,g,b,a,i,_]);let I=1;return kx(()=>{if(i===1/0||I<i){const P=_.autoClear;_.autoClear=!0,M.current.update(_,N),_.autoClear=P,I++}}),F.createElement(F.Fragment,null,_8(F.createElement(F.Fragment,null,n,F.createElement("cubeCamera",{ref:M,args:[e,t,C]}),y||w?F.createElement(DI,{background:!0,files:y,preset:w,path:S,extensions:x}):s?F.createElement(hS,{background:!0,map:s,extensions:x}):null),N))}function PV(n){var e,t,r,i;const s=jx(n),a=n.map||s;F.useMemo(()=>$w({GroundProjectedEnvImpl:p9}),[]),F.useEffect(()=>()=>{s.dispose()},[s]);const o=F.useMemo(()=>[a],[a]),c=(e=n.ground)==null?void 0:e.height,u=(t=n.ground)==null?void 0:t.radius,f=(r=(i=n.ground)==null?void 0:i.scale)!==null&&r!==void 0?r:1e3;return F.createElement(F.Fragment,null,F.createElement(hS,Lo({},n,{map:a})),F.createElement("groundProjectedEnvImpl",{args:o,scale:f,height:c,radius:u}))}function BV(n){return n.ground?F.createElement(PV,n):n.map?F.createElement(hS,n):n.children?F.createElement(IV,n):F.createElement(DI,n)}function LV(){const{progress:n}=$8();return l.jsx(Y8,{center:!0,children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("div",{className:"w-32 h-2 bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${n}%`}})}),l.jsxs("span",{className:"text-white text-sm",children:[n.toFixed(0),"% ..."]})]})})}function DV({url:n,onLoad:e,onError:t}){const{scene:r}=Ff(n,!0,!0,i=>{console.error("Failed to load model:",i),t==null||t(i)});return Ys.useEffect(()=>{if(r){const i=new ir().setFromObject(r),s=i.getCenter(new X),a=i.getSize(new X);r.position.sub(s),r.position.y+=a.y/2,e==null||e({size:a,center:s})}},[r,e]),l.jsx("primitive",{object:r})}function FV({onCapture:n}){const{gl:e,scene:t,camera:r}=Zr();return Ys.useEffect(()=>{n&&n(()=>(e.render(t,r),e.domElement.toDataURL("image/png")))},[e,t,r,n]),null}function FI({modelUrl:n,className:e="",showGrid:t=!0,showAxes:r=!1,autoRotate:i=!1,backgroundColor:s="#1a1a2e",onScreenshot:a,onModelLoad:o,onError:c}){const u=F.useRef(null),[f,p]=F.useState(!1),[m,g]=F.useState(null),[y,S]=F.useState(null),[w,x]=F.useState(null),_=F.useCallback(()=>{var C,I,P;u.current&&(document.fullscreenElement?((P=document.exitFullscreen)==null||P.call(document),p(!1)):((I=(C=u.current).requestFullscreen)==null||I.call(C),p(!0)))},[]);Ys.useEffect(()=>{const C=()=>{p(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",C),()=>document.removeEventListener("fullscreenchange",C)},[]);const b=F.useCallback(()=>{if(m){const C=m();a==null||a(C);const I=document.createElement("a");I.download=`model-screenshot-${Date.now()}.png`,I.href=C,I.click()}},[m,a]),M=F.useCallback(C=>{S(C),x(null),o==null||o(C)},[o]),N=F.useCallback(C=>{x(C.message||""),c==null||c(C)},[c]);return n?l.jsxs("div",{ref:u,className:`relative bg-gray-900 rounded-lg overflow-hidden ${e}`,style:{backgroundColor:s},children:[l.jsxs("div",{className:"absolute top-3 right-3 z-10 flex gap-2",children:[l.jsx("button",{onClick:b,className:"p-2 bg-gray-800/80 hover:bg-gray-700 rounded-lg text-white transition-colors",title:"",children:l.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),l.jsx("button",{onClick:_,className:"p-2 bg-gray-800/80 hover:bg-gray-700 rounded-lg text-white transition-colors",title:f?"":"",children:f?l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),y&&l.jsxs("div",{className:"absolute bottom-3 left-3 z-10 text-xs text-gray-400 bg-gray-800/80 px-2 py-1 rounded",children:[": ",y.size.x.toFixed(2)," x ",y.size.y.toFixed(2)," x ",y.size.z.toFixed(2)]}),w&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/90 z-20",children:l.jsxs("div",{className:"text-center text-red-400",children:[l.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),l.jsx("p",{children:""}),l.jsx("p",{className:"text-sm mt-1",children:w})]})}),l.jsxs(j8,{camera:{position:[5,5,5],fov:50},shadows:!0,gl:{preserveDrawingBuffer:!0},children:[l.jsx("color",{attach:"background",args:[s]}),l.jsx("ambientLight",{intensity:.5}),l.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize":[2048,2048]}),l.jsx("directionalLight",{position:[-10,-10,-5],intensity:.3}),l.jsx(BV,{preset:"city"}),t&&l.jsx(fV,{args:[20,20],cellSize:.5,cellThickness:.5,cellColor:"#404040",sectionSize:2,sectionThickness:1,sectionColor:"#606060",fadeDistance:30,fadeStrength:1,position:[0,0,0]}),r&&l.jsx("axesHelper",{args:[5]}),l.jsx(F.Suspense,{fallback:l.jsx(LV,{}),children:l.jsx(pV,{children:l.jsx(DV,{url:n,onLoad:M,onError:N})})}),l.jsx(dV,{makeDefault:!0,autoRotate:i,autoRotateSpeed:1,enableDamping:!0,dampingFactor:.05,minDistance:1,maxDistance:50}),l.jsx(FV,{onCapture:g})]}),l.jsx("div",{className:"absolute bottom-3 right-3 text-xs text-gray-500",children:":  | :  | : "})]}):l.jsx("div",{className:`flex items-center justify-center bg-gray-800 rounded-lg ${e}`,children:l.jsxs("div",{className:"text-gray-400 text-center p-8",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),l.jsx("p",{children:" 3D "})]})})}FI.preload=n=>{Ff.preload(n)};const pa="http://localhost:3001/api",kV=Es((n,e)=>({config:null,presets:[],jobs:[],currentJob:null,isLoading:!1,error:null,loadConfig:async()=>{try{const r=await(await fetch(`${pa}/multiangle/config`)).json();if(r.success)return n({config:r.data,presets:r.data.presets}),r.data}catch(t){console.error("Failed to load multiangle config:",t)}return null},loadPresets:async()=>{try{const r=await(await fetch(`${pa}/multiangle/presets`)).json();if(r.success)return n({presets:r.data}),r.data}catch(t){console.error("Failed to load presets:",t)}return[]},getPresetDetail:async t=>{try{const i=await(await fetch(`${pa}/multiangle/presets/${t}`)).json();if(i.success)return i.data}catch(r){console.error("Failed to get preset detail:",r)}return null},generatePrompt:async(t,r,i)=>{try{const a=await(await fetch(`${pa}/multiangle/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({azimuth:t,elevation:r,distance:i})})).json();if(a.success)return a.data.prompt}catch(s){console.error("Failed to generate prompt:",s)}return null},startGeneration:async t=>{n({isLoading:!0,error:null});try{const i=await(await fetch(`${pa}/multiangle/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(i.success)return n({isLoading:!1}),e().loadJobs(),i.data;throw new Error(i.error)}catch(r){return n({error:r.message,isLoading:!1}),null}},loadJobs:async()=>{try{const r=await(await fetch(`${pa}/multiangle/jobs`)).json();if(r.success)return n({jobs:r.data}),r.data}catch(t){console.error("Failed to load jobs:",t)}return[]},loadJob:async t=>{try{const i=await(await fetch(`${pa}/multiangle/jobs/${t}`)).json();if(i.success)return n({currentJob:i.data}),n(s=>({jobs:s.jobs.map(a=>a.id===t?{...a,...i.data}:a)})),i.data}catch(r){console.error("Failed to load job:",r)}return null},deleteJob:async t=>{try{if((await(await fetch(`${pa}/multiangle/jobs/${t}`,{method:"DELETE"})).json()).success)return n(s=>{var a;return{jobs:s.jobs.filter(o=>o.id!==t),currentJob:((a=s.currentJob)==null?void 0:a.id)===t?null:s.currentJob}}),!0}catch(r){console.error("Failed to delete job:",r)}return!1},saveToAsset:async(t,r)=>{try{const s=await(await fetch(`${pa}/multiangle/save-to-asset`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobId:t,assetId:r})})).json();if(s.success)return s.data}catch(i){console.error("Failed to save to asset:",i)}return null},clearCurrentJob:()=>{n({currentJob:null})},clearError:()=>{n({error:null})}})),kI={front:"","front-right":"",right:"","back-right":"",back:"","back-left":"",left:"","front-left":""},jV={"product-basic":"bg-blue-500","product-full":"bg-blue-600","character-ortho":"bg-purple-500","character-full":"bg-purple-600","hero-shots":"bg-red-500","detail-closeups":"bg-amber-500",panoramic:"bg-teal-500"};function UV({preset:n,isSelected:e,onClick:t}){return l.jsxs("div",{onClick:t,className:rn("p-4 rounded-xl border-2 cursor-pointer transition-all",e?"border-blue-500 bg-blue-50 shadow-lg":"border-gray-200 bg-white hover:border-gray-300 hover:shadow"),children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:rn("w-10 h-10 rounded-lg flex items-center justify-center text-white",jV[n.id]||"bg-gray-500"),children:l.jsx(tc,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:n.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:[n.angleCount," "]})]}),e&&l.jsx(Jn,{className:"w-5 h-5 text-blue-500"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:n.description})]})}function OV({config:n,selectedAngles:e,onChange:t}){const[r,i]=F.useState(!1),s=(a,o,c)=>{const u=e.some(f=>f.azimuth===a&&f.elevation===o&&f.distance===c);t(u?e.filter(f=>!(f.azimuth===a&&f.elevation===o&&f.distance===c)):[...e,{azimuth:a,elevation:o,distance:c}])};return n?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"font-medium text-gray-700",children:""}),l.jsxs("span",{className:"text-sm text-gray-500",children:[" ",e.length," "]})]}),l.jsxs("div",{className:"relative w-48 h-48 mx-auto",children:[l.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-gray-200"}),l.jsx("div",{className:"absolute inset-8 rounded-full border border-gray-100"}),l.jsx("div",{className:"absolute inset-16 rounded-full bg-gray-100"}),n.camera.azimuth.map((a,o)=>{const c=(o*45-90)*(Math.PI/180),u=80,f=96+u*Math.cos(c)-16,p=96+u*Math.sin(c)-16,m=e.some(g=>g.azimuth===a.name);return l.jsx("button",{onClick:()=>s(a.name,"eye","medium"),className:rn("absolute w-8 h-8 rounded-full flex items-center justify-center text-lg transition-all",m?"bg-blue-500 text-white shadow-lg scale-110":"bg-white border-2 border-gray-200 hover:border-blue-300"),style:{left:f,top:p},title:a.label,children:kI[a.name]},a.name)}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-gray-400",children:""})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.camera.elevation.map(a=>l.jsxs("button",{onClick:()=>{const o=e.map(c=>({...c,elevation:a.name}));t(o)},className:rn("px-3 py-1.5 text-sm rounded-lg border transition-colors",e.some(o=>o.elevation===a.name)?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-200 hover:border-gray-300"),children:[a.label," (",a.value,")"]},a.name))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.camera.distance.map(a=>l.jsxs("button",{onClick:()=>{const o=e.map(c=>({...c,distance:a.name}));t(o)},className:rn("px-3 py-1.5 text-sm rounded-lg border transition-colors",e.some(o=>o.distance===a.name)?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-200 hover:border-gray-300"),children:[a.label," (",a.value,")"]},a.name))})]})]})]}):null}function zV({job:n,onRefresh:e}){var s,a,o;if(!n)return null;const t=((s=n.angles)==null?void 0:s.filter(c=>c.status==="ready").length)||0,r=((a=n.angles)==null?void 0:a.length)||0,i=r>0?t/r*100:0;return l.jsxs("div",{className:"bg-white rounded-xl border p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:""}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:rn("px-2 py-1 text-xs rounded-full",n.status==="completed"?"bg-green-100 text-green-700":n.status==="processing"||n.status==="submitted"?"bg-blue-100 text-blue-700":n.status==="failed"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:n.status==="completed"?"":n.status==="processing"?"":n.status==="submitted"?"":n.status==="failed"?"":n.status}),l.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded",children:l.jsx(Rg,{className:"w-4 h-4"})})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[l.jsxs("span",{children:[t," / ",r]}),l.jsxs("span",{children:[Math.round(i),"%"]})]}),l.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500",style:{width:`${i}%`}})})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:(o=n.angles)==null?void 0:o.map((c,u)=>l.jsx("div",{className:rn("aspect-square rounded-lg overflow-hidden border-2",c.status==="ready"?"border-green-300":c.status==="processing"||c.status==="submitted"?"border-blue-300":c.status==="failed"?"border-red-300":"border-gray-200"),children:c.status==="ready"&&c.outputPath?l.jsx("img",{src:`http://localhost:3001${c.outputPath}`,alt:`${c.azimuth} ${c.elevation}`,className:"w-full h-full object-cover"}):l.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gray-100",children:[c.status==="processing"||c.status==="submitted"?l.jsx(yi,{className:"w-5 h-5 text-blue-500 animate-spin"}):c.status==="failed"?l.jsx(Ba,{className:"w-5 h-5 text-red-500"}):l.jsx(tc,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"text-xs text-gray-500 mt-1",children:kI[c.azimuth]})]})},u))})]})}function HV({imageId:n,imageUrl:e,imageSrc:t,assetId:r,onComplete:i,onClose:s}){const{config:a,presets:o,currentJob:c,isLoading:u,error:f,loadConfig:p,loadPresets:m,startGeneration:g,loadJob:y,clearError:S}=kV(),[w,x]=F.useState(null),[_,b]=F.useState([]),[M,N]=F.useState(!1),[C,I]=F.useState({loraStrength:.9,steps:20,cfg:7}),[P,T]=F.useState(!1),[R,j]=F.useState(null);F.useEffect(()=>{p()},[p]),F.useEffect(()=>{if(!R)return;const k=setInterval(()=>{y(R)},3e3);return()=>clearInterval(k)},[R,y]),F.useEffect(()=>{c&&(c.status==="completed"||c.status==="partial")&&(i==null||i(c))},[c,i]);const O=async()=>{const k={imageId:n,imageUrl:e,assetId:r,options:C};M&&_.length>0?k.angles=_:w?k.presetId=w:k.presetId="product-basic";const Z=await g(k);Z&&j(Z.jobId)};return l.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center",children:l.jsx($N,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:""}),l.jsx("p",{className:"text-sm text-gray-500",children:" Qwen Multi-Angle LoRA "})]})]}),s&&l.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-200 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5"})})]}),t&&l.jsxs("div",{className:"flex gap-4",children:[l.jsx("div",{className:"w-32 h-32 rounded-lg overflow-hidden bg-gray-200 flex-shrink-0",children:l.jsx("img",{src:t,alt:"Source",className:"w-full h-full object-cover"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:""}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded",children:"96 "}),l.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded",children:"8   4   3 "})]})]})]}),f&&l.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-600",children:[l.jsx(Ba,{className:"w-5 h-5"}),l.jsx("span",{className:"text-sm",children:f}),l.jsx("button",{onClick:S,className:"ml-auto",children:l.jsx(Hn,{className:"w-4 h-4"})})]}),R&&c?l.jsx(zV,{job:c,onRefresh:()=>y(R)}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>N(!1),className:rn("flex-1 py-2 rounded-lg border-2 transition-colors",M?"border-gray-200 hover:border-gray-300":"border-blue-500 bg-blue-50 text-blue-700"),children:[l.jsx(K0,{className:"w-4 h-4 inline mr-2"}),""]}),l.jsxs("button",{onClick:()=>N(!0),className:rn("flex-1 py-2 rounded-lg border-2 transition-colors",M?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"),children:[l.jsx(Ng,{className:"w-4 h-4 inline mr-2"}),""]})]}),!M&&l.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.map(k=>l.jsx(UV,{preset:k,isSelected:w===k.id,onClick:()=>x(k.id)},k.id))}),M&&a&&l.jsx(OV,{config:a,selectedAngles:_,onChange:b}),l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>T(!P),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900",children:[P?l.jsx(Kb,{className:"w-4 h-4"}):l.jsx(J0,{className:"w-4 h-4"}),""]}),P&&l.jsxs("div",{className:"mt-3 p-4 bg-white rounded-lg border space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:["LoRA : ",C.loraStrength]}),l.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:C.loraStrength,onChange:k=>I(Z=>({...Z,loraStrength:parseFloat(k.target.value)})),className:"w-full"}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[l.jsx("span",{children:"0.5 ()"}),l.jsx("span",{children:"1.0 ()"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:""}),l.jsx("input",{type:"number",min:"10",max:"50",value:C.steps,onChange:k=>I(Z=>({...Z,steps:parseInt(k.target.value)})),className:"w-full px-3 py-2 border rounded-lg"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"CFG"}),l.jsx("input",{type:"number",min:"1",max:"15",step:"0.5",value:C.cfg,onChange:k=>I(Z=>({...Z,cfg:parseFloat(k.target.value)})),className:"w-full px-3 py-2 border rounded-lg"})]})]})]})]}),l.jsx("button",{onClick:O,disabled:u||!w&&!M||M&&_.length===0,className:rn("w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",u||!w&&!M||M&&_.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-blue-500 text-white hover:from-purple-600 hover:to-blue-600"),children:u?l.jsxs(l.Fragment,{children:[l.jsx(yi,{className:"w-5 h-5 animate-spin"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ew,{className:"w-5 h-5"})," ",M?`(${_.length} )`:""]})})]})]})}const Co=[{value:"character",label:"",color:"bg-purple-500"},{value:"mecha",label:"",color:"bg-blue-500"},{value:"monster",label:"",color:"bg-red-500"},{value:"vehicle",label:"",color:"bg-green-500"},{value:"prop",label:"",color:"bg-yellow-500"},{value:"environment",label:"",color:"bg-teal-500"},{value:"other",label:"",color:"bg-gray-500"}],of={pending:{label:"",color:"text-yellow-500",bg:"bg-yellow-100"},processing:{label:"",color:"text-blue-500",bg:"bg-blue-100"},ready:{label:"",color:"text-green-500",bg:"bg-green-100"},failed:{label:"",color:"text-red-500",bg:"bg-red-100"}};function _2({asset:n,isSelected:e,onClick:t,onDelete:r,viewMode:i}){const s=Co.find(o=>o.value===n.type)||Co[6],a=of[n.status]||of.pending;return i==="list"?l.jsxs("div",{className:rn("flex items-center gap-4 p-3 rounded-lg cursor-pointer transition-all border",e?"bg-blue-50 border-blue-300":"bg-white hover:bg-gray-50 border-gray-200"),onClick:t,children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.thumbnail?l.jsx("img",{src:n.thumbnail,alt:n.name,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx(Xh,{className:"w-8 h-8 text-gray-400"})})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-medium text-gray-900 truncate",children:n.name}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:rn("text-xs px-2 py-0.5 rounded-full text-white",s.color),children:s.label}),l.jsx("span",{className:rn("text-xs px-2 py-0.5 rounded-full",a.bg,a.color),children:a.label})]})]}),l.jsx("div",{className:"text-sm text-gray-500 uppercase",children:n.format||"GLB"}),l.jsx("button",{onClick:o=>{o.stopPropagation(),r==null||r(n)},className:"p-2 text-gray-400 hover:text-red-500 transition-colors",children:l.jsx(zr,{className:"w-4 h-4"})})]}):l.jsxs("div",{className:rn("group relative rounded-xl overflow-hidden cursor-pointer transition-all border-2",e?"border-blue-500 shadow-lg shadow-blue-100":"border-transparent hover:border-gray-300"),onClick:t,children:[l.jsxs("div",{className:"aspect-square bg-gray-100 relative",children:[n.thumbnail?l.jsx("img",{src:n.thumbnail,alt:n.name,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:l.jsx(Xh,{className:"w-12 h-12 text-gray-400"})}),n.status==="processing"&&l.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:l.jsx(yi,{className:"w-8 h-8 text-white animate-spin"})}),l.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-all flex items-center justify-center opacity-0 group-hover:opacity-100",children:l.jsx("button",{className:"p-2 bg-white rounded-full shadow-lg hover:scale-110 transition-transform",children:l.jsx(Y0,{className:"w-5 h-5 text-gray-700"})})})]}),l.jsxs("div",{className:"p-3 bg-white",children:[l.jsx("h3",{className:"font-medium text-gray-900 truncate text-sm",children:n.name}),l.jsx("div",{className:"flex items-center gap-1 mt-2",children:l.jsx("span",{className:rn("text-xs px-2 py-0.5 rounded-full text-white",s.color),children:s.label})})]}),l.jsx("button",{onClick:o=>{o.stopPropagation(),r==null||r(n)},className:"absolute top-2 right-2 p-1.5 bg-white/90 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-100",children:l.jsx(zr,{className:"w-4 h-4 text-gray-500 hover:text-red-500"})})]})}function GV({isOpen:n,onClose:e,onUpload:t}){const[r,i]=F.useState(null),[s,a]=F.useState({name:"",description:"",type:"other",tags:[]}),[o,c]=F.useState(!1),u=F.useRef(null),f=m=>{var y;const g=(y=m.target.files)==null?void 0:y[0];g&&(i(g),s.name||a(S=>({...S,name:g.name.replace(/\.[^/.]+$/,"")})))},p=async m=>{if(m.preventDefault(),!!r){c(!0);try{await t(r,s),e(),i(null),a({name:"",description:"",type:"other",tags:[]})}catch(g){console.error("Upload failed:",g)}finally{c(!1)}}};return n?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsx("h2",{className:"text-lg font-semibold",children:" 3D "}),l.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5"})})]}),l.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:rn("border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors",r?"border-blue-300 bg-blue-50":"border-gray-300 hover:border-gray-400"),onClick:()=>{var m;return(m=u.current)==null?void 0:m.click()},children:[l.jsx("input",{ref:u,type:"file",accept:".glb,.gltf,.obj,.fbx",onChange:f,className:"hidden"}),r?l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Gl,{className:"w-5 h-5 text-blue-500"}),l.jsx("span",{className:"text-sm text-gray-700",children:r.name})]}):l.jsxs(l.Fragment,{children:[l.jsx(q0,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),l.jsx("p",{className:"text-sm text-gray-500",children:""}),l.jsx("p",{className:"text-xs text-gray-400 mt-1",children:" GLB, GLTF, OBJ, FBX"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("input",{type:"text",value:s.name,onChange:m=>a(g=>({...g,name:m.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("select",{value:s.type,onChange:m=>a(g=>({...g,type:m.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:Co.map(m=>l.jsx("option",{value:m.value,children:m.label},m.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("textarea",{value:s.description,onChange:m=>a(g=>({...g,description:m.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:""})]}),l.jsxs("div",{className:"flex gap-3 pt-2",children:[l.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:""}),l.jsx("button",{type:"submit",disabled:!r||o,className:rn("flex-1 px-4 py-2 rounded-lg text-white transition-colors flex items-center justify-center gap-2",r&&!o?"bg-blue-500 hover:bg-blue-600":"bg-gray-300 cursor-not-allowed"),children:o?l.jsxs(l.Fragment,{children:[l.jsx(yi,{className:"w-4 h-4 animate-spin"}),"..."]}):""})]})]})]})}):null}function VV({isOpen:n,onClose:e,onGenerate:t}){const[r,i]=F.useState(""),[s,a]=F.useState({name:"",type:"other"}),[o,c]=F.useState(!1),u=async f=>{if(f.preventDefault(),!!r){c(!0);try{await t(r,s),e(),i(""),a({name:"",type:"other"})}catch(p){console.error("Generate failed:",p)}finally{c(!1)}}};return n?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[l.jsx("h2",{className:"text-lg font-semibold",children:" 3D "}),l.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-5 h-5"})})]}),l.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" URL  ID"}),l.jsx("input",{type:"text",value:r,onChange:f=>i(f.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:" URL  ID"}),l.jsx("p",{className:"text-xs text-gray-400 mt-1",children:" InstantMesh  3D "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("input",{type:"text",value:s.name,onChange:f=>a(p=>({...p,name:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("select",{value:s.type,onChange:f=>a(p=>({...p,type:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:Co.map(f=>l.jsx("option",{value:f.value,children:f.label},f.value))})]}),l.jsxs("div",{className:"flex gap-3 pt-2",children:[l.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:""}),l.jsx("button",{type:"submit",disabled:!r||o,className:rn("flex-1 px-4 py-2 rounded-lg text-white transition-colors flex items-center justify-center gap-2",r&&!o?"bg-purple-500 hover:bg-purple-600":"bg-gray-300 cursor-not-allowed"),children:o?l.jsxs(l.Fragment,{children:[l.jsx(yi,{className:"w-4 h-4 animate-spin"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Di,{className:"w-4 h-4"}),""]})})]})]})]})}):null}function WV({asset:n,onClose:e,onUpdate:t,onDelete:r,onAddVariant:i,onGenerateMultiAngle:s}){const[a,o]=F.useState(!1),[c,u]=F.useState({});F.useEffect(()=>{n&&u({name:n.name,description:n.description||"",type:n.type,tags:n.tags||[]})},[n]);const f=async()=>{await t(n.id,c),o(!1)},p=S=>{i==null||i(n.id,{type:"screenshot",imageUrl:S,camera:{position:[5,5,5]}})};if(!n)return null;const m=Co.find(S=>S.value===n.type)||Co[6],g=of[n.status]||of.pending,y=n.filePath?`http://localhost:3001${n.filePath}`:null;return l.jsxs("div",{className:"h-full flex flex-col bg-white border-l",children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[l.jsx("h3",{className:"font-semibold truncate",children:n.name}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>o(!a),className:"p-1.5 hover:bg-gray-100 rounded-lg",title:a?"":"",children:a?l.jsx(Hn,{className:"w-4 h-4"}):l.jsx(QN,{className:"w-4 h-4"})}),l.jsx("button",{onClick:e,className:"p-1.5 hover:bg-gray-100 rounded-lg",children:l.jsx(Hn,{className:"w-4 h-4"})})]})]}),l.jsx("div",{className:"h-64 flex-shrink-0",children:l.jsx(FI,{modelUrl:y,className:"w-full h-full",onScreenshot:p})}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:a?l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:""}),l.jsx("input",{type:"text",value:c.name,onChange:S=>u(w=>({...w,name:S.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:""}),l.jsx("select",{value:c.type,onChange:S=>u(w=>({...w,type:S.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",children:Co.map(S=>l.jsx("option",{value:S.value,children:S.label},S.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:""}),l.jsx("textarea",{value:c.description,onChange:S=>u(w=>({...w,description:S.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",rows:3})]}),l.jsx("button",{onClick:f,className:"w-full py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:""})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:rn("text-xs px-2 py-1 rounded-full text-white",m.color),children:m.label}),l.jsx("span",{className:rn("text-xs px-2 py-1 rounded-full",g.bg,g.color),children:g.label}),l.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-600 uppercase",children:n.format||"GLB"})]}),n.description&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-1",children:""}),l.jsx("p",{className:"text-sm text-gray-700",children:n.description})]}),n.sourceImageId&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-1",children:""}),l.jsx("p",{className:"text-sm text-blue-500",children:n.sourceImageId})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-1",children:""}),l.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[l.jsxs("p",{children:[": ",n.fileSize?`${(n.fileSize/1024/1024).toFixed(2)} MB`:"-"]}),l.jsxs("p",{children:[": ",new Date(n.createdAt).toLocaleString()]}),l.jsxs("p",{children:[": ",new Date(n.updatedAt).toLocaleString()]})]})]}),n.variants&&n.variants.length>0&&l.jsxs("div",{children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:[" (",n.variants.length,")"]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:n.variants.map(S=>l.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:S.imageUrl&&l.jsx("img",{src:S.imageUrl,alt:"variant",className:"w-full h-full object-cover"})},S.id))})]}),l.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[l.jsxs("button",{onClick:()=>s==null?void 0:s(n),className:"w-full py-2 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg hover:from-purple-600 hover:to-blue-600 transition-colors flex items-center justify-center gap-2",children:[l.jsx($N,{className:"w-4 h-4"}),""]}),l.jsxs("div",{className:"flex gap-2",children:[y&&l.jsxs("a",{href:y,download:!0,className:"flex-1 py-2 border rounded-lg text-center hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l.jsx(Jh,{className:"w-4 h-4"}),""]}),l.jsxs("button",{onClick:()=>r(n),className:"flex-1 py-2 border border-red-200 text-red-500 rounded-lg hover:bg-red-50 transition-colors flex items-center justify-center gap-2",children:[l.jsx(zr,{className:"w-4 h-4"}),""]})]})]})]})})]})}function XV(){var de,Ce;const{assets:n,currentAsset:e,isLoading:t,error:r,stats:i,filters:s,loadAssets:a,loadAsset:o,loadStats:c,uploadAsset:u,updateAsset:f,deleteAsset:p,generateFromImage:m,addVariant:g,setFilters:y,clearFilters:S,clearCurrentAsset:w,clearError:x}=g4(),[_,b]=F.useState("grid"),[M,N]=F.useState(""),[C,I]=F.useState(!1),[P,T]=F.useState(!1),[R,j]=F.useState(!1),[O,k]=F.useState(!1),[Z,te]=F.useState(null);F.useEffect(()=>{a(),c()},[a,c]);const K=n.filter(be=>{var se;if(M){const _e=M.toLowerCase();if(!be.name.toLowerCase().includes(_e)&&!((se=be.description)!=null&&se.toLowerCase().includes(_e)))return!1}return!0}),$=async(be,se)=>{await u(be,se)&&c()},U=async(be,se)=>{await m(be,se)&&c()},H=async be=>{window.confirm(` "${be.name}" `)&&(await p(be.id),c())},W=be=>{o(be.id)},Y=be=>{te(be),k(!0)},G=be=>{Z&&o(Z.id)};return l.jsxs("div",{className:"h-full flex",children:[l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-white",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"3D "}),i&&l.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Xh,{className:"w-4 h-4"}),i.total," "]}),((de=i.byStatus)==null?void 0:de.ready)>0&&l.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[l.jsx(Gl,{className:"w-4 h-4"}),i.byStatus.ready," "]}),((Ce=i.byStatus)==null?void 0:Ce.processing)>0&&l.jsxs("span",{className:"flex items-center gap-1 text-blue-600",children:[l.jsx(yi,{className:"w-4 h-4 animate-spin"}),i.byStatus.processing," "]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"relative",children:[l.jsx(nc,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),l.jsx("input",{type:"text",value:M,onChange:be=>N(be.target.value),placeholder:"...",className:"pl-9 pr-4 py-2 border rounded-lg text-sm w-64 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>j(!R),className:rn("p-2 rounded-lg transition-colors",R||s.type||s.status?"bg-blue-100 text-blue-600":"hover:bg-gray-100"),children:l.jsx(gF,{className:"w-5 h-5"})}),R&&l.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white border rounded-lg shadow-lg z-10 p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),l.jsxs("select",{value:s.type||"",onChange:be=>{y({type:be.target.value||null}),a({type:be.target.value||null})},className:"w-full px-2 py-1.5 border rounded text-sm",children:[l.jsx("option",{value:"",children:""}),Co.map(be=>l.jsx("option",{value:be.value,children:be.label},be.value))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),l.jsxs("select",{value:s.status||"",onChange:be=>{y({status:be.target.value||null}),a({status:be.target.value||null})},className:"w-full px-2 py-1.5 border rounded text-sm",children:[l.jsx("option",{value:"",children:""}),Object.entries(of).map(([be,se])=>l.jsx("option",{value:be,children:se.label},be))]})]}),(s.type||s.status)&&l.jsx("button",{onClick:()=>{S(),a()},className:"w-full py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded",children:""})]})]}),l.jsxs("div",{className:"flex border rounded-lg",children:[l.jsx("button",{onClick:()=>b("grid"),className:rn("p-2 transition-colors",_==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:l.jsx(K0,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>b("list"),className:rn("p-2 transition-colors",_==="list"?"bg-gray-100":"hover:bg-gray-50"),children:l.jsx(qb,{className:"w-5 h-5"})})]}),l.jsx("button",{onClick:()=>a(),disabled:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Rg,{className:rn("w-5 h-5",t&&"animate-spin")})}),l.jsxs("div",{className:"flex gap-2 ml-2",children:[l.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[l.jsx(q0,{className:"w-4 h-4"}),""]}),l.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[l.jsx(Di,{className:"w-4 h-4"}),""]})]})]})]}),r&&l.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-600",children:[l.jsx(Ba,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:"text-sm",children:r}),l.jsx("button",{onClick:x,className:"ml-auto p-1 hover:bg-red-100 rounded",children:l.jsx(Hn,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t&&n.length===0?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx(yi,{className:"w-8 h-8 animate-spin text-gray-400"})}):K.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[l.jsx(Xh,{className:"w-16 h-16 mb-4 opacity-50"}),l.jsx("p",{className:"text-lg",children:" 3D "}),l.jsx("p",{className:"text-sm mt-1",children:""})]}):_==="grid"?l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:K.map(be=>l.jsx(_2,{asset:be,isSelected:(e==null?void 0:e.id)===be.id,onClick:()=>W(be),onDelete:H,viewMode:_},be.id))}):l.jsx("div",{className:"space-y-2",children:K.map(be=>l.jsx(_2,{asset:be,isSelected:(e==null?void 0:e.id)===be.id,onClick:()=>W(be),onDelete:H,viewMode:_},be.id))})})]}),e&&l.jsx("div",{className:"w-96 flex-shrink-0",children:l.jsx(WV,{asset:e,onClose:w,onUpdate:f,onDelete:H,onAddVariant:g,onGenerateMultiAngle:Y})}),l.jsx(GV,{isOpen:C,onClose:()=>I(!1),onUpload:$}),l.jsx(VV,{isOpen:P,onClose:()=>T(!1),onGenerate:U}),O&&Z&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsx("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:l.jsx(HV,{imageId:Z.sourceImageId,assetId:Z.id,imageSrc:Z.thumbnail,onComplete:G,onClose:()=>{k(!1),te(null)}})})})]})}function JV(){return l.jsx(JD,{children:l.jsxs(Jr,{path:"/",element:l.jsx(gk,{}),children:[l.jsx(Jr,{index:!0,element:l.jsx(_k,{})}),l.jsx(Jr,{path:"gallery",element:l.jsx(Ak,{})}),l.jsx(Jr,{path:"characters",element:l.jsx(Tk,{})}),l.jsx(Jr,{path:"story",element:l.jsx(Rk,{})}),l.jsx(Jr,{path:"scenes",element:l.jsx(Pk,{})}),l.jsx(Jr,{path:"scene-flow",element:l.jsx(Fk,{})}),l.jsx(Jr,{path:"timeline",element:l.jsx(Xk,{})}),l.jsx(Jr,{path:"voiceover",element:l.jsx(n4,{})}),l.jsx(Jr,{path:"compositor",element:l.jsx(Qk,{})}),l.jsx(Jr,{path:"techniques",element:l.jsx($k,{})}),l.jsx(Jr,{path:"export",element:l.jsx(e4,{})}),l.jsx(Jr,{path:"chat",element:l.jsx(m4,{})}),l.jsx(Jr,{path:"assets3d",element:l.jsx(XV,{})})]})})}E_.createRoot(document.getElementById("root")).render(l.jsx(Ys.StrictMode,{children:l.jsx(tF,{children:l.jsx(JV,{})})}));
